"use strict";var zw=Object.defineProperty;var u=(e,t)=>zw(e,"name",{value:t,configurable:!0});var _=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Ba=_((O8,ug)=>{"use strict";var ag=require("fs"),yo=require("path"),al=u(e=>{try{let t=yo.join(__dirname,"..",e),r=ag.readFileSync(t);return JSON.parse(r.toString().replace(/\/\*[\s\S]*?\*\//g,""))}catch{return{}}},"getConfig"),ul=u(e=>{let t;return(...r)=>(t||(t=e(...r)),t)},"cacheResult"),Ww=ul(()=>al(yo.join("properties_pane","field_level","fieldLevelConfig.json"))),Qw=ul(()=>al(yo.join("properties_pane","entity_level","entityLevelConfig.json"))),Zw=ul(()=>{let e=u(n=>n.replace(/\.json/,""),"getName"),t=yo.join(__dirname,"..","types");return ag.readdirSync(t).reduce((n,i)=>(n[e(i)]=al(yo.join("types",i)),n),{})});ug.exports={getEntityLevelConfig:Qw,getFieldLevelConfig:Ww,getTypesConfig:Zw}});var tr=_((P8,fg)=>{"use strict";var{getTypesConfig:Yw,getFieldLevelConfig:Xw}=Ba(),Jw=2,eb=u((e,t=1)=>{let r=" ".repeat(t*Jw);return e.split(`
`).map(n=>r+n).join(`
`)},"tab"),Bn=u((e,t,r,n="")=>{let i=((e||[])[t]||{})[r];return i===void 0||i===""?n:i},"retrivePropertyFromConfig"),tb=u(e=>Bn(e,0,"code",Bn(e,0,"name","")),"retrieveContainerName"),rb=u(e=>Bn(e,0,"code",Bn(e,0,"collectionName","")),"retrieveEntityName"),nb=u(e=>Bn(e,1,"UDFs",[]),"retrieveUDF"),ib=u(e=>Bn(e,2,"UDAs",[]),"retrieveUDA"),sb=u(e=>Bn(e,1,"SecIndxs",[]),"retrieveIndexes"),ob=u((e,t)=>cg(e,`"${t}"`),"getTableNameStatement"),cg=u((e,t)=>`${e?`"${e}".`:""}${t}`,"getNameWithKeyspace"),ab=u(e=>Yw()[e],"getTypeConfig"),lg=u((e,t)=>{let r=Xw().structure;return r[e]?r[e].find(i=>i.propertyKeyword===t):void 0},"getFieldConfig"),cl=u((e,t)=>{let r=Object.assign({},e),n=u((s,o)=>Object.keys(s).reduce((a,c)=>{let l=s[c];return a[c]=o(cl(l,o),c),a},{}),"eachProperty"),i=u((s,o)=>s.map((a,c)=>o(cl(a,o),c)),"eachItem");if(r.hasOwnProperty("properties")&&(r.properties=n(r.properties,t)),r.hasOwnProperty("items")){let s=Array.isArray(r.items)?r.items:[r.items];r.items=i(s,t)}return r},"eachField"),ub=u((e,t)=>{let r=lg(e,"mode")||{};return Array.isArray(r.options)?r.options.includes(t):!1},"canTypeHaveSubtype"),cb=u((e,t=!0,r=!0,n=!0)=>{if(t||!r||!e)return e;let i=u((o,a="-- ")=>o.split(`
`).map(c=>`${a}${c}`).join(`
`),"insertBeforeEachLine");return n?u(o=>`/*
${i(o,"  ")}
*/`,"multiLineComment")(e):i(e)},"commentDeactivatedStatement"),lb=u(e=>Bn(e,0,"isActivated",!0),"retrieveIsItemActivated"),fb=u(e=>e.map(t=>t.functionBody).filter(t=>t).join(`
`),"getUserDefinedFunctions"),hb=u(e=>e.map(t=>t.storedProcFunction).filter(t=>t).join(`
`),"getUserDefinedAggregations"),pb=u(e=>{let{applyDropStatements:t,additionalOptions:r=[]}=e.options||{},n=(r.find(i=>i.id==="applyDropStatements")||{}).value;return t||n},"getApplyDropStatement");fg.exports={tab:eb,retrieveContainerName:tb,retrieveEntityName:rb,retrieveUDF:nb,retrieveUDA:ib,retrieveIndexes:sb,retrivePropertyFromConfig:Bn,getTableNameStatement:ob,getFieldConfig:lg,getTypeConfig:ab,getNameWithKeyspace:cg,eachField:cl,canTypeHaveSubtype:ub,commentDeactivatedStatement:cb,retrieveIsItemActivated:lb,getApplyDropStatement:pb,getUserDefinedAggregations:hb,getUserDefinedFunctions:fb}});var mo=_((q8,mg)=>{"use strict";var{getFieldConfig:db,getTypeConfig:hg,canTypeHaveSubtype:gb}=tr(),pg=u(e=>{let t,r=u((n,i)=>{if(n===e)t=i;else if(n===void 0)return t;return r},"handler");return r},"ifType"),ll=u((e,t,r)=>{if(e){let n=db(e,"mode"),i=n&&n.options?n.options[0]:e;return pl(e,r)({type:e,mode:i,frozen:!0,keyType:"char",keySubtype:"text",items:{type:"char",mode:"varchar"},properties:{field:{type:"char",mode:"varchar"}}})}return t},"getModeType"),dg=u((e,t)=>{let r=u(s=>s.type,"simpleType"),n=u(s=>`'${s.subType||"PointType"}'`,"geoSpatialType"),i=u(s=>{if(s.physicalType)return pl(s.physicalType)(Object.assign(s,{type:s.physicalType}))},"getJsonType");return pg(e)("char",s=>s.mode||"text")("numeric",s=>{let o=s.mode||"integer";return o==="integer"?"int":o})("binary",()=>"blob")("bool",()=>"boolean")("blob",r)("timestamp",r)("date",r)("time",r)("duration",r)("uuid",r)("timeuuid",r)("DseExecutorStateType",s=>`'${r(s)}'`)("DateRangeType",s=>`'${r(s)}'`)("geospatial",n)("udt",(s,o)=>fl(o,t)())("jsonObject",i)("jsonArray",i)()},"getScalarType"),gg=u((e,t,r)=>{let n=u(d=>!!d.frozen,"isFrozen"),i=u(d=>g=>{let p=d(g);return n(g)?hl(p):p},"setFrozen"),s=u((d,g,p,y)=>{var v,m,x,w,B,R;if(d.items)if(Array.isArray(d.items)){let L=((v=d.items[0])==null?void 0:v.code)||((m=d.items[0])==null?void 0:m.name)||((x=d.items[0])==null?void 0:x.displayName);return a(d.items[0],n(d),L||0)}else{let L=((w=d.items)==null?void 0:w.code)||((B=d.items)==null?void 0:B.name)||((R=d.items)==null?void 0:R.displayName);return a(d.items,n(d),L||0)}else{let L=hg(d.type);if(L.subtypes&&d.subtype){let Y=L.subtypes[d.subtype];if(Y&&Y.childValueType)return ll(Y.childValueType,g,p)}}return g},"getValueTypeFromArray"),o=u((d,g,p)=>{if(d.properties){let y=Object.keys(d.properties)[0];if(y){let v=d.properties[y];return a(v,n(d),y)}}else{let y=hg(d.type);if(y.subtypes&&d.subtype){let v=y.subtypes[d.subtype];if(v&&v.childValueType)return ll(v.childValueType,g,p)}}return g},"getValueTypeFromObject"),a=((d,g)=>(p,y,v)=>p?yb(p,!y&&d,g,v)??"":"text")(t,r),c=u((d,g)=>`set<${s(d,"varchar",r,g)}>`,"typeSet"),l=u((d,g)=>`list<${s(d,"text",r,g)}>`,"list"),f=u((d,g)=>`tuple<${(Array.isArray(d.items)?d.items:[d.items]).map((y,v)=>a(y,!0,v)).join(", ")}>`,"tuple"),h=u((d,g)=>{let p=gb(d.keyType,d.keySubtype)?d.keySubtype:ll(d.keyType,"text",r),y=o(d,"text",r);return`map<${p}, ${y}>`},"map");return pg(e)("map",i(h))("list",i(l))("set",i(c))("tuple",f)()},"getStructuralTypeHandler"),fl=u((e,t,r)=>()=>{let n=t[e]||{};return n.frozen&&!r?hl(n.name):n.name},"getUDTHandler"),hl=u(e=>e===void 0?void 0:`frozen<${e}>`,"getFrozen"),pl=u((e,t)=>dg(e,t)||gg(e,!0,t)||fl(e,t),"getHandlerByType"),yb=u((e,t,r,n)=>{let i=yg(e),s=dg(i,r);if(s)return s(e,n);let o=(gg(i,!1,r)||fl(i,r,t))(e,n);return t?hl(o):o},"getNestedTypeByData"),yg=u(e=>e.$ref?e.$ref.split("/").pop():e.type?e.type:"char","getTypeByPropertyData"),mb=u((e,t,r)=>{let n=yg(e);return pl(n,t)(e,r)},"getTypeByData");mg.exports={getTypeByData:mb}});var Eg=_((V8,vg)=>{"use strict";var vb=u(({index:e,numberOfStatements:t,lastIndexOfActivatedStatement:r,delimiter:n})=>{let i=e===t-1,s=e===r;return i?"":s?" --"+n:n},"getDelimiter"),Eb=u(({statements:e=[],delimiter:t=",",indent:r=`
`})=>{let n=e.findLastIndex(s=>!s.startsWith("--")),i=e.length;return e.map((s,o)=>{let a=vb({index:o,numberOfStatements:i,lastIndexOfActivatedStatement:n,delimiter:t});return s+a}).join(r)},"joinActivatedAndDeactivatedStatements");vg.exports={joinActivatedAndDeactivatedStatements:Eb}});var Na=_((K8,Cg)=>{"use strict";var{getTypeByData:Cb}=mo(),{commentDeactivatedStatement:Sb}=tr(),{joinActivatedAndDeactivatedStatements:xb}=Eg();Cg.exports={getColumnDefinition(e,t={},r=!1){let n=Object.keys(e).map(i=>{let s=e[i],o=wb(s,t,i);if(o===void 0)return"";{let a=_b(s.code||i,o,Tb(s));return Sb(a,s.isActivated,r,!1)}}).filter(i=>i);return xb({statements:n,indent:`
`})}};var Tb=u(e=>!!(e||{}).static,"isStatic"),_b=u((e,t,r)=>`"${e}" ${t}${r?" STATIC":""}`,"getColumn"),wb=u((e,t,r)=>Cb(e,t,r),"getTypeDefinition")});var Eo=_(($8,xg)=>{"use strict";var bb=["isActivated","type","compositePartitionKey"],Sg=u((e={})=>bb.reduce((t,r)=>!e.hasOwnProperty(r)||e[r]===void 0?t:{...t,[r]:e[r]},{}),"getAttributes"),vo=u((e,t,r)=>{if(e.GUID===t||e.id===t)return r;if(e.properties)return Object.keys(e.properties).reduce((n,i)=>{if(n)return n;let s=e.properties[i];return vo(s,t,[...r,s.GUID||s.id])},void 0);if(e.items)return Array.isArray(e.items)?e.items.reduce((n,i)=>n||vo(i,t,[...r,i.GUID||i.id]),void 0):vo(e.items,t,[...r,e.items.GUID])},"getPathById"),Ib=u((e,t)=>{let r=Object.keys(t).find(i=>t[i].GUID===e||t[i].id===e),n=t[r];return n&&(n.code||n.name)?{name:n.code||n.name,...Sg(t[r])}:{name:r,...Sg(t[r])}},"getRootItemMetadataById"),Ab=u((e,t)=>{let r=vo(t,e,[]);return r?Ib(r[0],t.properties):{name:""}},"findFieldMetadataById"),Bb=u((e,t)=>e.reduce((r,n)=>{for(let i=0;i<t.length;i++){let s=Ab(n,t[i]);if(s!=null&&s.name)return Object.assign({},r,{[n]:s})}return r},{}),"getAttributesDataByIds");xg.exports={getPathById:vo,getNamesByIds:Bb}});var Co=_((j8,Ig)=>{"use strict";var Tg="LINE",_g="INLINE",dl="MULTILINE",wg=u((e,t="-- ")=>e.split(`
`).map(r=>r&&`${t}${r}`).join(`
`),"insertBeforeEachLine"),Nb=u(e=>`/*
${wg(e,"  ")}
*/`,"multiLineComment"),bg=u(e=>`/* ${e} */`,"inlineComment"),Rb=u((e,t=!0,r=!0,n=dl)=>{if(t||!r||!e)return e;switch(n){case dl:return Nb(e);case _g:return bg(e);case Tg:return wg(e);default:return e}},"commentDeactivatedStatement");Ig.exports={commentDeactivatedStatement:Rb,inlineComment:bg,LINE:Tg,INLINE:_g,MULTILINE:dl}});var Dr=_((W8,Bg)=>{"use strict";var Ag={},Db=u(e=>{Ag.lodash=e.require("lodash")},"setDependencies");Bg.exports={setDependencies:Db,dependencies:Ag}});var yl=_((Z8,Pg)=>{"use strict";var{inlineComment:Ng}=Co(),{dependencies:Lb}=Dr(),Dg,Ob=u(({lodash:e})=>Dg=e,"setDependencies"),Fb="numeric",Pb="text",kb="details",qb="checkbox",Lg="otherProperties",Og="caching",Ub=[Og,Lg],Ra=u(e=>e===""?`
WITH`:"  AND","getStringStart"),Fg=u(e=>String(e||"").replace(/[\"\`]/g,"'"),"changeQuotes"),Rg={localReadRepairChance:"dclocal_read_repair_chance",readRepairChance:"read_repair_chance",gcGraceSeconds:"gc_grace_seconds",bloomFilterFalsePositiveChance:"bloom_filter_fp_chance",defaultTtl:"default_time_to_live",speculativeRetry:"speculative_retry",minIndexInterval:"min_index_interval",maxIndexInterval:"max_index_interval",crcCheckChance:"crc_check_chance",memtableFlushPeriod:"memtable_flush_period_in_ms"},gl=u(e=>Rg.hasOwnProperty(e)?Rg[e]:e,"convertKeywordToTableOptionName"),Vb=u(e=>Ub.includes(e.propertyKeyword)?Mb(e):Kb(e),"transformOption"),Mb=u(e=>{switch(e.propertyKeyword){case Og:return Wb(e);case Lg:return jb(e);default:return null}},"transformSpecialOption"),Kb=u(e=>{switch(e.propertyType){case Pb:return Hb(e);case qb:return zb(e);case Fb:return $b(e);case kb:return Gb(e);default:return null}},"transformOptionByPropertyType"),Hb=u(e=>`${gl(e.propertyKeyword)} = '${e.value}'`,"transformTextOption"),$b=u(e=>`${gl(e.propertyKeyword)} = ${e.value}`,"transformNumericOption"),Gb=u(e=>{let n=u(i=>typeof i=="object"?JSON.stringify(e.value):i,"getStringValue")(e.value).replace(/\n/g,"");return`${gl(e.propertyKeyword)} = ${Fg(n)}`},"transformDetailsOptions"),jb=u(e=>e.value.reduce((r,n)=>{let{name:i,value:s}=n;if(!i||!s)return r;let o=r===""?"":"  AND";return r.concat(`${o} ${i} = '${s}'
`)},"").replace(/\n$/,""),"transformOtherOptions"),zb=u(e=>{let t=e.propertyKeyword;return e.value?t==="cdc"?"cdc = TRUE":t==="compactStorage"?"COMPACT STORAGE":null:null},"transformBooleanOption"),Wb=u(e=>{let t=u(c=>i.includes(c)?c:null,"validateKeys"),r=u(c=>i.includes(c)?c:isNaN(c)?null:Number(c),"validateRows"),n=u((c,l)=>Object.assign({},c&&{keys:c},l&&{rows_per_partition:l}),"createValueObject"),i=["ALL","NONE"],s=t(e.value.keys),o=r(e.value.rowsPerPartition);if(!s&&!o)return null;let a=JSON.stringify(n(s,o));return`caching = ${Fg(a)}`},"transformCachingOption"),Qb=u((e,t)=>{if(!t.value&&typeof t.value!="number")return e;let r=Vb(t);if(!r)return e;let n=Ra(e);return e.concat(`${n} ${r}
`)},"generateOptionsStringReducer"),Zb=u((e,t)=>{if(t){let r=Ra(e);return e.concat(`${r} comment = '${t}'
`)}return e},"addCommentToOptionString"),Yb=u((e,t)=>{if(!e)return t;let r=Ra(t);return t.concat(`${r} ID = '${e}'
`)},"addId"),Xb=u((e,t,r,n)=>{if(Ob(Lb),!e.length)return r;let i=u(l=>l.map(f=>{let{keyId:h,type:d}=f,{name:g}=t[h];return`"${g}" ${d==="descending"?"DESC":"ASC"}`}),"mapKeys"),[s,o]=Dg.partition(e,({keyId:l})=>t[l].isActivated!==!1);s=i(s),o=i(o);let a;n?o.length===0?a=s.join(", "):s.length===0?a=Ng(o.join(", ")):a=`${s.join(", ")} ${Ng(`, ${o.join(", ")}`)}`:a=i(e).join(", ");let c=Ra(r);return r.concat(`${c} CLUSTERING ORDER BY (${a})
`)},"addClustering");Pg.exports={parseToString(e,t){let r=e.reduce(Qb,"");return Zb(r,t)},addId:Yb,addClustering:Xb}});var us=_((X8,jg)=>{"use strict";var{tab:Jb,retrieveContainerName:e2,retrieveEntityName:t2,retrivePropertyFromConfig:_i,getTableNameStatement:r2,commentDeactivatedStatement:n2}=tr(),{getColumnDefinition:i2}=Na(),{getNamesByIds:kg}=Eo(),{getEntityLevelConfig:s2}=Ba(),{parseToString:o2,addId:a2,addClustering:u2}=yl(),{inlineComment:qg}=Co(),{dependencies:Mg}=Dr(),Kg,Hg=u(({lodash:e})=>Kg=e,"setDependencies"),c2=u(({keyspaceName:e,tableName:t,columnDefinition:r,primaryKeys:n,options:i,ifNotExist:s})=>{let o=[];return r&&o.push(r),n&&o.push(`PRIMARY KEY (${n})`),`CREATE TABLE ${s?"IF NOT EXISTS ":""}${r2(e,t)} (
`+o.map(a=>Jb(a)).join(`,
`)+`
)${i};`},"getCreateTableStatement"),Ug=u((e,t,r)=>{Hg(Mg);let n=l2(e,r),i=f2(t,r),s=[];return n&&s.push(n),i&&s.push(i),s.join(i.startsWith("/*")||n.endsWith("*/")?" ":", ")},"getPrimaryKeyList"),l2=u((e,t)=>{let r=Object.keys(e);if(r.length){let n=Gg(r,e,t);return r.length>1?`(${n})`:n}else return""},"getPartitionKeys"),f2=u((e,t)=>{let r=Object.keys(e);return r.length?Gg(r,e,t):""},"getClusteringKeys"),h2=u((e,t)=>e.map(r=>{let n=t[r.propertyKeyword];return n===void 0?r:Object.assign({},r,{value:n})}),"seedOptionsWithValues"),p2=u(e=>e.structure.find(r=>r.propertyName==="Options").structure,"getOptionsFromTab"),$g=u(e=>{let[t]=s2(),r=p2(t);return h2(r,e)},"mergeValuesWithConfigOptions"),Vg=u((e,t,r,n,i,s)=>{let o=$g(n),a=a2(r,u2(e,t,o2(o,i),s));return a?a.replace(/\n$/,""):""},"getOptions"),Gg=u((e,t,r)=>{let n=u(o=>o.map(a=>t[a].name).join('", "'),"joinKeys");if(!r)return`"${n(e)}"`;let[i,s]=Kg.partition(e,o=>t[o].isActivated!==!1);return s.length===0?`"${n(i)}"`:i.length===0?`${qg(`"${n(s)}"`)}`:`"${n(i)}" ${qg(`, "${n(s)}"`)}`},"commentDeactivatedKeys");jg.exports={getOptions:Vg,getPrimaryKeyList:Ug,getTableStatement({tableData:e,tableMetaData:t,dataSources:r,keyspaceMetaData:n,udtTypeMap:i,isKeyspaceActivated:s}){Hg(Mg);let o=e2(n),a=t2(t),c=_i(t,0,"compositePartitionKey",[]),l=_i(t,0,"compositeClusteringKey",[]),f=_i(t,0,"schemaId",""),h=_i(t,0,"comments",""),d=_i(t,0,"tableOptions",""),g=_i(t,0,"isActivated",!1),p=s&&g,y=kg(c.map(x=>x.keyId),r),v=kg(l.map(x=>x.keyId),r),m=c2({keyspaceName:o,tableName:a,columnDefinition:i2(e.properties||{},i,p),primaryKeys:Ug(y,v,p),options:Vg(l,v,f,d,h,p),ifNotExist:_i(t,0,"tableIfNotExist",!1)});return n2(m,g,s)},mergeValuesWithConfigOptions:$g}});var Da=_((eq,Zg)=>{"use strict";var{tab:d2,getNameWithKeyspace:g2,eachField:ml}=tr(),{getColumnDefinition:y2}=Na(),m2=u((e,t,r,n)=>{let i=v2(r);return t.reduce((s,o)=>{let a=C2(o,i,n).map(({name:c,definition:l})=>E2(e,c,l));return s.concat(a)},[])},"getUdtScripts"),v2=u(e=>Object.keys(e).reduce((t,r)=>Object.assign(t,{[r]:Object.assign({},e[r],{frozen:!0})}),{}),"setFrozenForAllUdt"),zg=u((e,t)=>typeof e=="number"&&t.displayName?t.displayName:t.code||e,"getName"),E2=u((e,t,r)=>`CREATE TYPE IF NOT EXISTS ${g2(e,t)} (
${d2(r)}
);`,"getCreateTypeStatement"),Wg=u(e=>e.reduce((t,r)=>(ml(r,(n,i)=>{if(n.type==="udt"){let s=zg(i,n);t[s]={name:s,frozen:n.frozen}}return n}),t),{}),"getUdtMap"),C2=u((e,t,r)=>{let n=[];return ml(e,(i,s)=>(i.type==="udt"&&i.properties&&n.push({name:zg(s,i),definition:y2(i.properties,t,r)}),i)),n},"getAllUdt"),Qg=u(e=>{if(!e.properties)return e;let t=Object.keys(e.properties),r=[];t.forEach(i=>{let s=[];if(ml(e.properties[i],o=>{if(o.$ref){let a=o.$ref.split("/").pop();s.indexOf(a)===-1&&s.push(a)}}),s.length)r.push(...s.filter(o=>r.indexOf(o)===-1));else{let o=r.indexOf(i);o===-1?r.unshift(i):r.unshift(...r.splice(o,1))}}),t.forEach(i=>{r.indexOf(i)===-1&&r.push(i)});let n={};return r.forEach(i=>{e.properties[i]&&(n[i]=Object.assign({},e.properties[i]))}),e.properties=n,e},"sortUdt"),S2=u(e=>{let t=Qg(JSON.parse(e.modelDefinitions)),r=JSON.parse(e.externalDefinitions);return{udtTypeMap:Wg([t,r]),modelDefinitions:t,externalDefinitions:r}},"prepareDefinitions");Zg.exports={getUdtScripts:m2,getUdtMap:Wg,sortUdt:Qg,prepareDefinitions:S2}});var La=_((rq,Jg)=>{"use strict";var{commentDeactivatedStatement:Yg}=Co(),{tab:x2,getTableNameStatement:T2}=tr(),{getNamesByIds:Xg}=Eo(),_2=u((e,t,r,n,i,s)=>{let o=A2(e).map(a=>{let c=a.isActivated!==!1&&I2(a.SecIndxKey,t),l=w2({name:a.name,keyspaceName:n,tableName:r,indexColumnStatement:b2(a.SecIndxKey,t),ifNotExist:a.indexIfNotExist});return Yg(l,c,i&&s)}).join(`

`);return Yg(o,i,s)},"getIndexes"),w2=u(({name:e,keyspaceName:t,tableName:r,indexColumnStatement:n,ifNotExist:i})=>`CREATE INDEX ${i?"IF NOT EXISTS ":""}${e?`"${e}"`:""}
${x2(`ON ${T2(t,r)} (${n});`)}`,"getIndex"),b2=u((e,t)=>{let{name:r}=Xg([e.keyId],t)[e.keyId]||{};return`"${r}"`},"getIndexColumnStatement"),I2=u((e,t)=>{let{isActivated:r}=Xg([e.keyId],t)[e.keyId]||{};return r!==!1},"isIndexColumnKeyActivated"),A2=u(e=>e.reduce((t,r)=>[...t,...(r.SecIndxKey||[]).map((n,i)=>Object.assign({},r,{name:i>0?r.name+"_"+i:r.name,SecIndxKey:n}))],[]),"unwindIndexes");Jg.exports={getIndexes:_2}});var Oa=_((iq,iy)=>{"use strict";var{tab:ey,retrieveContainerName:B2,retrivePropertyFromConfig:So}=tr(),N2=u(({name:e,replication:t,durableWrites:r,ifNotExist:n})=>`CREATE KEYSPACE ${n?"IF NOT EXISTS ":""}"${e}" 
${ey(t)}
${r}; 

USE "${e}";`,"getCreateStatement"),R2=u(e=>`'class' : 'SimpleStrategy',
'replication_factor' : ${e}`,"getSimpleStrategy"),D2=u(e=>["'class' : 'NetworkTopologyStrategy'"].concat(e.reduce((t,r)=>[...t,`'${r.dataCenterName}' : ${ny(r.replFactorValue)}`],[])).join(`,
`),"getNetworkTopologyStrategy"),L2=u((e,t,r)=>e==="NetworkTopologyStrategy"?D2(r):R2(ny(t)),"getTopology"),ty=u((e,t,r)=>`WITH REPLICATION = {
${ey(L2(e,t,r))}
}`,"getReplication"),ry=u(e=>`AND DURABLE_WRITES = ${!!e+""}`,"getDurableWrites"),ny=u(e=>+e||1,"getFactor"),O2=u(e=>{let t=B2(e),r=So(e,0,"replStrategy",""),n=So(e,0,"replFactor",void 0),i=So(e,0,"dataCenters",[]),s=So(e,0,"durableWrites",!1);return e[0]&&!e[0].addToCqlScript||t===""?"":N2({name:t,replication:ty(r,n,i),durableWrites:ry(s),ifNotExist:So(e,0,"keyspaceIfNotExist",!1)})},"getKeyspaceStatement");iy.exports={getKeyspaceStatement:O2,getReplication:ty,getDurableWrites:ry}});var ay=_((oq,oy)=>{"use strict";var vl,{dependencies:F2}=Dr(),P2="caching",k2="compaction",q2="compression",U2="id",V2=[U2],M2=u(({lodash:e})=>vl=e,"setDependencies"),sy={localReadRepairChance:0,caching:{keys:"ALL",rows_per_partition:"NONE"},compaction:"{'class': 'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy', 'max_threshold': '32', 'min_threshold': '4'}",compression:"{'chunk_length_in_kb': '64', 'class': 'org.apache.cassandra.io.compress.LZ4Compressor'}",readRepairChance:0,gcGraceSeconds:864e3,bloomFilterFalsePositiveChance:.01,defaultTtl:0,speculativeRetry:"99PERCENTILE",minIndexInterval:128,maxIndexInterval:2048,crcCheckChance:1,memtableFlushPeriod:0},K2=u((e,t,r)=>{switch(r){case q2:case k2:return H2(e,t);case P2:return $2(e,t);default:return e!==t}},"isDiff"),H2=u((e,t)=>{if(e===""||t==="")return e!==t;let r=JSON.parse(e.replace(/[\'']/g,'"')),n=JSON.parse(t.replace(/[\'']/g,'"'));return!vl.isEqual(r,n)},"isDiffParsedJsonString"),$2=u((e,t)=>{let r=Object.assign({},e,{id:null}),n=Object.assign({},t,{id:null});return!vl.isEqual(r,n)},"isDiffCaching"),G2=u((e,t)=>Object.entries(e).reduce((r,[n,i])=>V2.includes(n)?r:!t.hasOwnProperty(n)||K2(t[n],i,n)?Object.assign({},r,{[n]:i}):r,{}),"getModifiedAndNewOptions"),j2=u((e,t)=>Object.keys(t).filter(r=>!e.hasOwnProperty(r)),"getDeletedOptions"),z2=u(e=>e.reduce((t,r)=>sy.hasOwnProperty(r)?Object.assign({},t,{[r]:sy[r]}):t,{}),"getDefaultOptionsByName");oy.exports={getDiff(e,t){M2(F2);let r=G2(e,t),n=j2(e,t);return Object.assign({},r,z2(n))}}});var fy=_((uq,ly)=>{"use strict";var{dependencies:W2}=Dr(),{getReplication:Q2,getDurableWrites:Z2}=Oa(),{retrivePropertyFromConfig:wi,getUserDefinedFunctions:Y2,getUserDefinedAggregations:X2,tab:Fa}=tr(),cs,J2=u(({lodash:e})=>cs=e,"setDependencies"),El={added:!1,deleted:!1,modified:!1,keySpaces:"keySpaces"},eI=u(e=>`CREATE KEYSPACE IF NOT EXISTS "${e}" 
`,"getAddKeyspacePrefix"),tI=u(e=>`DROP KEYSPACE IF EXISTS "${e}";`,"getDropKeyspace"),rI=u(e=>`ALTER KEYSPACE "${e}" 
`,"alterKeyspacePrefix"),nI=u(e=>e.name?`DROP FUNCTION IF EXISTS ${e.name};`:"","getDropUDFScript"),iI=u(e=>e.name?`DROP AGGREGATE IF EXISTS ${e.name};`:"","getDropUDAScript"),sI=["functionBody"],oI=["storedProcFunction"],aI={getDropScript:nI,requiredProps:sI,parser:"getUDFName",functionName:"functionBody"},uI={getDropScript:iI,requiredProps:oI,parser:"getUDAName",functionName:"storedProcFunction"},uy={regExpUDFForName:/^.+function(.+?)\(/is,regExpUDAForName:/^.+aggregate(.+?)\(/is,getResult(e,t){let r=e.match(t);if(r&&r[1])return r[1].trim()},getName(e,t){let r=this.getResult(e,t);return r&&r.replace(/if not exists/i,"").trim()},getUDFName(e){return this.getName(e,this.regExpUDFForName)},getUDAName(e){return this.getName(e,this.regExpUDAForName)}},cI=u((e,t,r)=>{let n=[],i=[];if(!e.length&&!t.length)return{dataForAddScript:n,dataForDropScript:i};if(!t.length)n=e;else if(!e.length)i=t;else{let s=u((a,c)=>r.every(l=>cs.isEqual(a[l],c[l])),"difference"),o=cs.intersectionWith(e,t,s);n=cs.xorWith(e,o,s),i=cs.xorWith(t,o,s)}return{dataForAddScript:n,dataForDropScript:i}},"getDataForScript"),cy=u(({new:e=[],old:t=[],udData:r})=>{e=e.map(a=>({...a,name:uy[r.parser](a[r.functionName])})),t=t.map(a=>({...a,name:uy[r.parser](a[r.functionName])}));let{dataForAddScript:n,dataForDropScript:i}=cI(e,t,r.requiredProps),s=n.filter(a=>Object.entries(a).every(([c,l])=>r.requiredProps.includes(c)?!!l:!0)).map(a=>({udf:"udf",added:!0,script:a[r.functionName]}));return[...i.filter(a=>!!a.name).map(a=>({udf:"udf",script:r.getDropScript(a),deleted:!0})),...s]},"getModifyUDFA"),lI=["replStrategy","replFactory","dataCenters"],fI=u((e,t)=>t.some(n=>{let{new:i,old:s}=e[n]||{};return i&&s&&!cs.isEqual(i,s)}),"getIsModifyKeysSpace"),hI=u(({child:e,mode:t})=>{J2(W2);let r=[e.role],n=e.role.code||e.role.name,i=wi(r,0,"replStrategy",""),s=wi(r,0,"replFactor",void 0),o=wi(r,0,"dataCenters",[]),a=wi(r,0,"durableWrites",!1),c=wi(r,0,"compMod",{}),l=Q2(i,s,o),f=Z2(a);if(t==="add"){let m=wi(r,0,"UDFs",[]),x=wi(r,0,"UDAs",[]),w=Y2(m),B=X2(x),R=[eI(n)+`${Fa(l)}
${Fa(f)};`,w||"",B||""].filter(Boolean).join(`

`);return[{...El,script:R,added:!0}]}else if(t==="delete"){let m=tI(n);return[{...El,script:m,deleted:!0}]}let h=(c==null?void 0:c.UDFs)||{},d=(c==null?void 0:c.UDAs)||{},g=cy({...h,udData:aI}),p=cy({...d,udData:uI}),v=fI(c,lI)?rI(n)+Fa(`${l}
`)+Fa(`${f};`):"";return[{...El,modified:!0,script:v},...p,...g]},"getKeySpaceScript");ly.exports={getKeySpaceScript:hI}});var Cl=_((lq,hy)=>{"use strict";var pI=u((e,t)=>[...e,...t],"mergeArrays"),dI={blob:["ascii","bigint","boolean","decimal","double","float","inet","int","timestamp","timeuuid","uuid","varchar","varint"],varint:["int"],varchar:["text"],uuid:["timeuuid"],text:["varchar"]},gI=u(e=>{let t=e.filter(n=>n.dbVersion)[0].dbVersion,r=t.search(/\d/);if(r!==-1)return t[r]<3},"checkIsOldModel"),yI=u((e,t)=>{let r=dI[t];return!(!r||!r.filter(i=>i===e).length)},"fieldTypeCompatible");hy.exports={mergeArrays:pI,checkIsOldModel:gI,fieldTypeCompatible:yI}});var Tl=_((hq,vy)=>{"use strict";var Wr,{dependencies:gy}=Dr(),{commentDeactivatedStatement:Pa,INLINE:Sl}=Co(),{retrieveContainerName:mI,retrieveEntityName:vI,retrivePropertyFromConfig:xo,retrieveIsItemActivated:py}=tr(),{getOptions:EI,getPrimaryKeyList:CI}=us(),yy=u(({lodash:e})=>Wr=e,"setDependencies"),SI=u(({columnsDefinitions:e,isParentActivated:t=!0})=>{let r=e.findIndex(n=>n.isActivated);return e.map(({name:n,isActivated:i},s)=>{let o=`${s===0||r===s?"":","} ${n}`;return Pa(o,i,t,Sl)})},"getColumnNames"),xI=u(({columns:e={},collectionRefsDefinitionsMap:t={}})=>Wr.uniq(Object.entries(e).map(([r,n])=>{let i=Wr.get(e,[r,"GUID"]),[,s]=Object.entries(t).find(([,o])=>o.definitionId===i)??[null,{}];return{name:`"${Wr.get(s,"name",r)}"`,isActivated:Wr.get(n,"isActivated",!0)}})).filter(({name:r})=>r),"getColumnDefinitions"),TI=u(({primaryKeysNames:e,columnsDefinitions:t,isParentActivated:r=!0})=>{if(Wr.isEmpty(t))return"";let n=t.findIndex(i=>i.isActivated);return"WHERE "+t.filter(({name:i})=>!e.includes(i)).reduce((i,{name:s,isActivated:o},a)=>i?`${i} ${Pa(`${n?"":"AND "}${s} IS NOT NULL`,o,r,Sl)}`:Pa(`${s} IS NOT NULL`,o,r,Sl),"")},"getWhereStatement"),xl=u((e,t)=>t.reduce((r,n)=>{let i=Wr.get(e,[n,"name"]);return i?Object.assign({},r,{[n]:{name:i}}):r},{}),"getNamesByIds"),my=u((e,t)=>{let r=xo(t,0,"compositeClusteringKey",[]),n=xl(e,r.map(i=>i.keyId));return{clusteringKeys:r,clusteringKeysHash:n}},"getClusteringKeyData"),_I=u((e,t)=>{let r=xo(t,0,"compositePartitionKey",[]),n=xl(e,r.map(i=>i.keyId));return Wr.values(n).filter(Wr.identity).map(i=>`"${i.name}"`)},"getPrimaryKeysNames"),wI=u((e,t,r)=>{let n=xo(t,0,"compositePartitionKey",[]),i=xl(e,n.map(a=>a.keyId)),s=my(e,t),o=CI(i,s.clusteringKeysHash,r);return o?`PRIMARY KEY (${o})`:""},"getPrimaryKeyScript"),bI=u(e=>Wr.trim(e||"").replace(/  /g,"    "),"addTab"),dy=u((e,t)=>{yy(gy);let r=my(e,t),n=xo(t,0,"comments",""),i=xo(t,0,"tableOptions","");return bI(EI(r.clusteringKeys,r.clusteringKeysHash,"",i,n))},"getOptionsScript");vy.exports={getOptionsScript:dy,getViewScript({schema:e,viewData:t,entityData:r,containerData:n,collectionRefsDefinitionsMap:i,isKeyspaceActivated:s=!0}){yy(gy);let o=[],a=e.properties||{},c=Wr.first(t)||{},l=vI(r),f=mI(n),h=f?`"${f}"."${l}"`:`"${l}"`,d=c.code||c.name,g=f?`"${f}"."${d}"`:`"${d}"`,p=py(r)&&py(t),v=wI(i,t,s&&p),m=dy(i,t);if(o.push(`CREATE MATERIALIZED VIEW ${c.viewIfNotExist?"IF NOT EXISTS ":""}${g}`),!a)o.push(`AS SELECT * FROM ${h};`);else{let x=xI({collectionRefsDefinitionsMap:i,columns:a}),w=SI({columnsDefinitions:x,isParentActivated:p});o.push(`AS SELECT${w.join("")}`),o.push(`FROM ${h}`);let B=_I(i,t);o.push(TI({primaryKeysNames:B,columnsDefinitions:x,isParentActivated:p}))}return v&&o.push(v),m&&o.push(m),Pa(o.join(`
  `)+";",p,s)}}});var _y=_((dq,Ty)=>{"use strict";var{getViewScript:II,getOptionsScript:AI}=Tl(),{tab:BI}=tr(),{dependencies:NI}=Dr(),_l,RI=u(({lodash:e})=>_l=e,"setDependencies"),To={added:!1,deleted:!1,modified:!1,view:"view"},Cy=u((e,t)=>`${e?`"${e}".`:""}"${t}"`,"getViewName"),DI=["code","name"],LI=u(e=>{let t=DI.some(s=>{let{new:o,old:a}=e[s]||{};return!_l.isEqual(o,a)}),{tableOptions:r={},comments:n={}}=e;if(n.old&&!n.new)return!1;let i=Object.entries(r.old||{}).some(([s])=>{var o;return!((o=r.new)!=null&&o[s])});return!t&&!i},"getIsOnlyOptionsModify"),Ey=u((e,t)=>{if(!t||!_l.isEqual(e,t))return e;if(!e)return t},"getProperty"),OI=u((e,t={})=>{let r=Ey(t.new,t.old),{new:n={},old:i={}}=e,s=Object.entries(n).map(([o,a])=>[o,Ey(a,i[o])]).filter(([o,a])=>a);return{comments:r,tableOptions:Object.fromEntries(s)}},"getDifferentOptions"),Sy=u(e=>{var s,o;let{compMod:t,properties:r={}}=e.role,n=Object.entries(r).map(([a,c])=>[c.code||c.name||c.displayName||a,c]),i={containerData:[{name:t.keyspaceName}],schema:{properties:Object.fromEntries(n)},viewData:[e.role],ifNotExist:!0,collectionRefsDefinitionsMap:((s=t.collectionData)==null?void 0:s.collectionRefsDefinitionsMap)||{},entityData:((o=t.collectionData)==null?void 0:o.entityData)||[{}]};return II(i)},"getAddView"),xy=u(e=>{let{compMod:t,name:r,code:n}=e.role;return`DROP MATERIALIZED VIEW IF EXISTS ${Cy(t.keyspaceName,n||r)};`},"getDropView"),FI=u(e=>{var s;let t=[e],r=AI(((s=e.compMod.collectionData)==null?void 0:s.collectionRefsDefinitionsMap)||{},t),n=e.name||e.code,i=e.compMod.keyspaceName;if(r)return`ALTER MATERIALIZED VIEW ${Cy(i,n)}
${BI(r)};`},"getAlterView"),PI=u(e=>{var o,a,c;let t=((o=e.role)==null?void 0:o.compMod)||{};if(!LI(t)){let l=((a=t.code)==null?void 0:a.old)||((c=t.name)==null?void 0:c.old),f=xy({...e,role:{...e.role,code:l}}),h=Sy(e);return[{...To,script:f,deleted:!0},{...To,script:h,added:!0}]}let{comments:n,tableOptions:i}=OI(t.tableOptions,t.comments),s={...e.role,comments:n,tableOptions:i};return[{...To,script:FI(s),modified:!0}]},"getModifyView"),kI=u(({child:e,data:t,mode:r})=>(RI(NI),r==="add"?[{...To,added:!0,script:Sy(e)}]:r==="delete"?[{...To,deleted:!0,script:xy(e)}]:PI(e)),"getViewScript");Ty.exports={getViewScript:kI}});var Fy=_((yq,Oy)=>{"use strict";var{dependencies:Ay}=Dr(),{getTableNameStatement:wl}=tr(),{getIndexes:By}=La(),{getNamesByIds:qI}=Eo(),rr,Ny=u(({lodash:e})=>rr=e,"setDependencies"),ka={dropIndexes:[],createIndexes:[]},bl={index:"index"},Ry=u((e,t,r)=>{let n=wl(e,t);return!!ka[r].filter(s=>s===n).length},"checkExistsScript"),Dy=u((e,t,r)=>{let n=wl(e,t);ka={...ka,[r]:[...ka[r],n]}},"setNameCollectionsScript"),wy=u(e=>e.reduce((t,r)=>[...t,...(r.SecIndxKey||[]).map((n,i)=>Object.assign({},r,{name:i>0?r.name+"_"+i:r.name,SecIndxKey:[n]}))],[]),"unwindIndexes"),UI=u((e,t)=>{let r,n;if(!e.length&&!t.length)return{};if(!e.length)n=t;else if(!t.length)r=e;else if(!rr.isEqual(e,t)){let i=rr.intersectionWith(e,t,rr.isEqual);n=rr.xorWith(t,i,rr.isEqual),r=rr.xorWith(e,i,rr.isEqual)}return{addData:r,dropData:n}},"getDataForScript"),Ly=u((e,t,r=[])=>r.map(n=>{let i=wl(e,n.name),s=`${t}.${n.name}`,o=Ry(e,s,"dropIndexes"),a="";return n.name&&!o&&(a=`DROP INDEX IF EXISTS ${i};`,Dy(e,s,"dropIndexes")),{...bl,deleted:!0,script:a}}),"getDropIndexScript"),VI=u(e=>{let{keyspaceName:t,indexes:r=[],dataSources:n,tableName:i,isActivated:s}=e,o=r.filter(c=>{let l=`${i}.${c.name}`;return Ry(t,l,"createIndexes")?!1:(Dy(t,l,"createIndexes"),!0)}),a=By(o,n,i,t,s,!0);return[{...bl,added:!0,script:a}]},"getAddIndexScript"),by=u(e=>{let{item:t,dataSources:r,tableName:n,keyspaceName:i,isActivated:s}=e,o=rr.get(t,"role.SecIndxs",[]),a=By(o,r,n,i,s,!0);return[{...bl,added:!0,script:a}]},"getCreatedIndex"),Iy=u(e=>{let{item:t,keyspaceName:r,tableName:n}=e,i=rr.get(t,"role.SecIndxs",[]);return[...Ly(r,n,i)]},"getDeletedIndex"),MI=u(e=>{let{item:t,keyspaceName:r,tableName:n,isActivated:i,dataSources:s}=e,{new:o=[],old:a=[]}=rr.get(t,"role.compMod.SecIndxs",{}),c=wy(o),l=wy(a),f=UI(c,l),h=Ly(r,n,f.dropData),d=VI({indexes:f.addData,dataSources:s,tableName:n,keyspaceName:r,isActivated:i});return[...h,...d]},"getUpdateIndex"),KI=u((e,t,r)=>{let n=qI([r],e)[r]||{};return n.name?n:{name:t[r]||""}},"getFieldDataByKeyId"),HI=u((e,t,r={},n="key")=>{Ny(Ay);let i=rr.get(r,`${n}[0].keyId`,""),s=KI(e,t,i);return{...rr.omit(r,n),...s}},"getDataColumnIndex"),$I=u((e,t)=>[{properties:{...e.properties||{},...e.role.properties||{}},...rr.omit(e.role||{},["properties"])},t.modelDefinitions,t.externalDefinitions,t.internalDefinitions,{properties:(e==null?void 0:e.properties)||{}},{properties:rr.get(e,"role.compMod.newProperties",[])},{properties:rr.get(e,"role.compMod.oldProperties",[])}],"createDataSources"),GI=u((e,t,r)=>{var c,l,f,h;Ny(Ay);let n=$I(e,t),i=((c=e.role)==null?void 0:c.code)||((l=e.role)==null?void 0:l.name),s=(f=e.role.compMod)==null?void 0:f.keyspaceName,o=(h=e.role)==null?void 0:h.isActivated,{compMod:a={}}=e.role||{};if(r){let d=by({item:e,dataSources:n,tableName:i,keyspaceName:s,isActivated:o}),g=Iy({item:e,keyspaceName:s,tableName:i});return[...d,...g]}return a.created?by({item:e,dataSources:n,tableName:i,keyspaceName:s,isActivated:o}):a.deleted?Iy({item:e,keyspaceName:s,tableName:i}):MI({item:e,keyspaceName:s,tableName:i,dataSources:n,isActivated:o})},"getIndexTable");Oy.exports={getIndexTable:GI,getDataColumnIndex:HI}});var Rl=_((vq,$y)=>{"use strict";var{getTypeByData:Py}=mo(),{getNamesByIds:Il}=Eo(),{dependencies:Vy}=Dr(),{eachField:jI,getTableNameStatement:My}=tr(),{getTableStatement:zI}=us(),Lr,$n={modifiedColumn:[],addTable:[],deleteTable:[]},Ky=u(({lodash:e})=>Lr=e,"setDependencies"),WI=u(e=>`DROP "${e}";`,"removeColumnStatement"),QI=u(e=>`ADD "${e.name}" ${e.type}`,"addColumnStatement"),Bl=u((e,t)=>t?`ALTER TABLE "${t}"."${e}"`:`ALTER TABLE "${e}"`,"alterTablePrefix"),ZI=u(e=>qa(e)?[]:[{deleted:!1,modified:!1,added:!0,script:`${Bl(e.tableName,e.keyspaceName)} ${QI(e.columnData)};`,field:"field"}],"getAdd"),YI=u(e=>qa(e)?[]:[{added:!1,modified:!1,deleted:!0,script:`${Bl(e.tableName,e.keyspaceName)} ${WI(e.columnData.name)}`,field:"field"}],"getDelete"),Hy=u(e=>{let{tableName:t,keyspaceName:r,columnData:n}=e,i=My(r,t);return n!=null&&n.name?`${i}.${n==null?void 0:n.name}`:i},"generateFullName"),Nl=u((e={},t="modifiedColumn")=>{let r=Hy(e);$n={...$n,[t]:[...($n==null?void 0:$n[t])||[],r]}},"addScriptToExistScripts"),qa=u((e={},t="modifiedColumn")=>{let r=Hy(e);return(($n==null?void 0:$n[t])||[]).some(n=>n===r)},"isScriptExists"),XI=u((e,t)=>{let r=u(i=>!i.hasOwnProperty("properties")||!Array.isArray(i.properties)?i:{...i,properties:i.properties.reduce((s,o)=>({...s,[o.name]:r(o)}),{})},"propertiesFromArrayToObj"),n=r(e);return jI(n,i=>{if((i==null?void 0:i.type)!=="reference"||Lr.isEmpty(i.refIdPath))return i;let s=Il([Lr.last(i.refIdPath)],t)[Lr.last(i.refIdPath)]||{};return{...i,...s}})},"prepareField"),JI=u(({tableName:e,keyspaceName:t,isOldModel:r,property:n,udtMap:i,dataSources:s})=>{Ky(Vy);let{oldField:o={},newField:a={}}=(n==null?void 0:n.compMod)||{},c=XI(o,s),l=Py(n,i,a.name),f=Py(c,i,o.name);return{property:n,isOldModel:r,oldName:o.name,newName:a.name,newType:l,oldType:f,isNameChange:o.name!==a.name,isTypeChange:l!==f,dataForScript:{tableName:e,keyspaceName:t,columnData:{name:a.name,type:l}}}},"hydrateColumn"),Al=u((e,t)=>{var n,i,s;let r=(i=(n=e==null?void 0:e.role)==null?void 0:n.compMod)==null?void 0:i[t];return(r==null?void 0:r.new)||((s=e==null?void 0:e.role)==null?void 0:s[t])},"getTableParameter"),ky=u((e,t)=>Object.entries(e).reduce((r,[n,i])=>{let s=(t.find(o=>o.keyId===n)||{}).type;return{...r,[n]:{...Lr.omit(i,"type"),...s?{type:s}:{}}}},{}),"addToKeysHashType"),qy=u((e,t)=>Lr.omitBy(e,(r,n)=>r===!1&&!t[n]),"deleteFalseValuesIfNotPresentInOtherColumn"),eA=u((e,t)=>{let r=qy(e,t),n=qy(t,e);return Lr.isEqual(r,n)},"areTableKeyColumnsEqual"),Uy=u(({newKeys:e=[],oldKeys:t=[],dataSources:r})=>{if(e.length!==t.length)return!1;let n=ky(Il(e.map(o=>o.keyId),r),e),i=ky(Il(t.map(o=>o.keyId),r),t),s=Lr.differenceWith(Lr.values(n),Lr.values(i),eA);return Lr.isEmpty(s)},"tableKeysIsEqual"),tA=u(({item:e,dataSources:t})=>{var c;Ky(Vy);let r=((c=e==null?void 0:e.role)==null?void 0:c.compMod)||{},n=["name","isActivated"],{compositeClusteringKey:i={},compositePartitionKey:s={}}=r||{},o=Uy({newKeys:i.new,oldKeys:i.old,dataSources:t}),a=Uy({newKeys:s.new,oldKeys:s.old,dataSources:t});return!o||!a||n.some(l=>{var f,h;return!Lr.isEqual((f=r[l])==null?void 0:f.new,(h=r[l])==null?void 0:h.old)})},"isTableChange"),rA=u(e=>{if(qa(e,"deleteTable"))return[];let r=`DROP TABLE IF EXISTS ${My(e.keyspaceName,e.tableName)};`;return Nl(e,"deleteTable"),[{modified:!1,added:!1,deleted:!0,script:r,table:"table"}]},"getDeleteTable"),nA=u(e=>{if(qa(e,"addTable"))return[];let t=e.item,r=e.data,n=Al(t,"compositePartitionKey")||[],i=Al(t,"compositeClusteringKey")||[],s=[{compositePartitionKey:n,compositeClusteringKey:i,collectionName:e.tableName,tableOptions:t.role.tableOptions||"",comments:t.role.comments||"",isActivated:t.role.isActivated}],o=zI({tableData:t,tableMetaData:s,keyspaceMetaData:[{name:e.keyspaceName}],dataSources:e.dataSources,udtTypeMap:r.udtTypeMap||{},isKeyspaceActivated:e.isKeyspaceActivated});return Nl(e,"addTable"),[{deleted:!1,modified:!1,added:!0,script:o,table:"table"}]},"getAddTable");$y.exports={getDelete:YI,getAdd:ZI,alterTablePrefix:Bl,hydrateColumn:JI,isTableChange:tA,getTableParameter:Al,addScriptToExistScripts:Nl,getDeleteTable:rA,getAddTable:nA}});var Qy=_((Cq,Wy)=>{"use strict";var{dependencies:jy}=Dr(),{getColumnDefinition:iA}=Na(),{tab:sA,eachField:oA}=tr(),{getTypeByData:Dl}=mo(),{checkIsOldModel:aA,fieldTypeCompatible:uA}=Cl(),{getDelete:cA}=Rl(),bi,zy=u(({lodash:e})=>bi=e,"setDependencies"),lA={Default_Keyspace:[]},Ii={added:!1,deleted:!1,modified:!1,udt:"udt"},Ll=u(e=>`ALTER TYPE "${e}"`,"getAlterTypePrefix"),fA=u(e=>`${Ll(e.keySpaceName)}."${e.udtName}" 
	RENAME "${e.oldFieldName}" TO "${e.newFieldName}";`,"getRenameType"),hA=u(e=>[{...Ii,script:`DROP TYPE IF EXISTS "${e.keyspaceName}"."${e.typeName}";`,deleted:!0}],"getDropUDT"),pA=u(e=>`${Ll(e.keySpaceName)}."${e.udtName}" 
	ALTER "${e.columnData.name}" TYPE ${e.columnData.type};`,"getUpdateType"),dA=u(e=>{let{keySpaces:t,udtName:r,name:n,type:i}=e;return Object.keys(t).map(s=>({...Ii,added:!0,script:`${Ll(s)}."${r}" ADD "${n}" ${i};`}))},"getAddToUDT"),gA=u(e=>`CREATE TYPE IF NOT EXISTS "${e.keySpaceName}"."${e.udtName}" (
${sA(e.columnScript)} 
);`,"getCreateUdt"),Ol=u(e=>{var r;let t=(r=e.compMod)==null?void 0:r.bucketsWithCurrentDefinition;return bi.isEmpty(t)?lA:t},"getKeySpaces"),yA=u((e,t)=>{let{role:r={},compMod:n={},properties:i={}}=e,s=Ol(r);if(n.created){let o=iA(i,t);return Object.keys(s).map(a=>{let c=r.code||r.name||"",l=gA({keySpaceName:a,udtName:c,columnScript:o});return{...Ii,added:!0,script:l}})}return Object.entries(i).reduce((o,[a,c])=>[...o,...dA({type:Dl(c,t),name:a,keySpaces:s,udtName:r.code||r.name||""})],[])},"getAddScript"),Gy=u((e,t)=>e.type!=="reference"||e.$ref||!t.$ref?e:{...e,$ref:t.$ref},"prepareField"),mA=u((e,t,r)=>{let{role:n={},properties:i}=e;if(!i)return[Ii];let s=Ol(n),o=n.code||n.name;return Object.entries(i).reduce((c,[l,f])=>{let h=bi.get(f,"compMod.oldField.name"),d=bi.get(f,"compMod.newField.name"),{compMod:g={}}=f,p=Dl(Gy(g.oldField,f),r,"newField"),y=Dl(Gy(g.newField,f),r,"oldField"),v=aA(bi.get(t,"modelData")),m=Object.keys(s).reduce((x,w)=>{if(y&&p&&y!==p&&uA(p,y)&&v){let R=pA({keySpaceName:w,udtName:o,columnData:{name:l,type:y}});x=[...x,{...Ii,script:R,modified:!0}]}if(d&&h&&h!==d){let R=fA({keySpaceName:w,oldFieldName:h,newFieldName:d,udtName:o});x=[...x,{...Ii,script:R,modified:!0}]}return x},[]);return[...c,...m]},[])},"getUpdateScript"),vA=u(e=>{let{properties:t,compMod:r={},role:n={}}=e;if(!(r!=null&&r.deleted)||!t)return[Ii];let i=Ol(n),s=n.code||n.name||"";return Object.entries(i).reduce((a,[c,l])=>{let f=l.reduce((h,d)=>{let g=cA({tableName:d.collectionName||d.code,keyspaceName:c,columnData:{name:s}}),p=hA({keyspaceName:c,typeName:s});return[...h,...g,...p]},[]);return[...a,...f]},[])},"getDeleteScript"),EA=u(({child:e,mode:t,data:r,udtMap:n})=>(zy(jy),t==="add"?yA(e,n):t==="update"?mA(e,r,n):vA(e)),"getUdtScript"),CA=u(e=>{var a;zy(jy);let t=(a=e.properties.added)==null?void 0:a.items;if(!t||!Array.isArray(t))return e;let r=t.filter(c=>{var f;return(f=c.properties[Object.keys(c.properties)[0]].compMod)==null?void 0:f.created}),n=bi.xorWith(t,r,bi.isEqual);r=r.map(c=>[Object.keys(c.properties)[0],c]);let i=r.map(([c,l])=>c),s=[];r.forEach(([c,l])=>{let f=new Set,h=l.properties[c];oA(h||{},g=>{if(g.$ref){let p=g.$ref.split("/").pop();f.add(p)}});let d=Array.from(f).filter(g=>i.includes(g)&&!s.includes(g));if(s.push(...d),!d.length){let g=s.indexOf(c);g===-1?s.unshift(c):s.unshift(...s.splice(g,1))}});let o=i.filter(c=>!s.includes(c));return r=Object.fromEntries(r),r=[...s,...o].map(c=>r[c]).filter(Boolean),e.properties.added.items=[...r,...n],e},"sortAddedUdt");Wy.exports={getUdtScript:EA,sortAddedUdt:CA}});var am=_((xq,om)=>{"use strict";var{getTypeByData:SA}=mo(),{commentDeactivatedStatement:xA,getApplyDropStatement:TA,tab:_A}=tr(),{mergeValuesWithConfigOptions:wA}=us(),{getDiff:bA}=ay(),{parseToString:Zy}=yl(),{dependencies:em}=Dr(),{getKeySpaceScript:IA}=fy(),{mergeArrays:mr,checkIsOldModel:AA,fieldTypeCompatible:BA}=Cl(),{getViewScript:NA}=_y(),{getIndexTable:Pl,getDataColumnIndex:RA}=Fy(),{getUdtScript:DA,sortAddedUdt:LA}=Qy(),{alterTablePrefix:kl,getDelete:tm,hydrateColumn:OA,isTableChange:FA,addScriptToExistScripts:PA,getAdd:rm,getDeleteTable:nm,getAddTable:im}=Rl(),{getUdtMap:kA}=Da(),Qr,sm=u(({lodash:e})=>Qr=e,"setDependencies"),qA=u(e=>`${kl(e.tableName,e.keySpace)} 
	ALTER "${e.columnData.name}" TYPE ${e.columnData.type};`,"getUpdateType"),UA=u(e=>`RENAME "${e.oldName}" TO "${e.newName}"`,"renameColumnStatement"),VA=u(e=>[{added:!1,deleted:!1,modified:!0,script:`${kl(e.tableName,e.keyspaceName)} ${UA(e.columnData)};`,field:"field"}],"getRenameColumn"),$t=u((e,t)=>!!e[t],"objectContainsProp"),MA=u(e=>e&&e.new&&e.new!==e.old,"isCommentNew"),KA=u(({options:e,comment:t})=>{let r=bA(e.new||{},e.old||{}),n=wA(r);return MA(t)?Zy(n,t.new):Zy(n)},"getChangeOption"),HA=u(e=>{let{collectionName:t={},code:r={}}=e;return{oldName:r.old||t.old,newName:r.new||t.new}},"getCollectionName"),Yy={alterDropCreate({dataForScript:e,oldName:t,newName:r}){let n=u(o=>({...e,columnData:{...e.columnData,...o}}),"getData"),i=tm(n({name:t})),s=rm(n({name:r}));return[...i,...s]},alterName(e){let{newName:t,oldName:r,dataForScript:n,property:i}=e;return i.primaryKey?VA({...n,columnData:{oldName:r,newName:t}}):this.alterDropCreate(e)},alterType(e){let{oldType:t,newType:r,dataForScript:n}=e;return!t||!r?[]:BA(t,r)?[{script:qA(n),added:!1,deleted:!1,modified:!0,field:"field"}]:this.alterDropCreate(e)}},$A=u(e=>{let t=OA(e),{newName:r,oldName:n}=t;return!n||!r?[]:t.isNameChange?Yy.alterName(t):t.isTypeChange?Yy.alterType(t):(PA(t.dataForScript),[])},"getUpdate"),GA=u((e,t,r)=>{let i=[{properties:e.properties||{},...Qr.omit(e.role||{},["properties"])},r.modelDefinitions];return Qr.get(e,"role.SecIndxs",[]).map(o=>RA(i,{},o,"SecIndxKey")).map(o=>o.name).filter(Boolean).includes(t)},"getIsColumnInIndex"),jA=u(e=>{let t=Object.entries(e).map(([r,n])=>{var o,a;if(!n.compMod)return[r,n];let i=((o=n.compMod)==null?void 0:o.newField)||{},s=((a=n.compMod)==null?void 0:a.oldField)||{};return Object.entries(i).forEach(([c,l])=>{s[c]!==l&&(n[c]=l),c==="name"&&s[c]!==l&&(r=l)}),[r,n]});return Object.fromEntries(t)},"getPropertiesForUpdateTable"),Xy=u(e=>{var h,d,g,p,y,v;let{item:t,propertiesScript:r=[]}=e,{oldName:n,newName:i}=HA((h=t.role)==null?void 0:h.compMod),s={...((d=t.role)==null?void 0:d.compMod)||{},name:{new:i,old:n}},o=FA({item:{...t,role:{...t.role,compMod:s}},data:e.data,dataSources:e.dataSources}),a=Pl(t,e.data,o);if(!o){let m=e.tableName||n||i;return[{added:!1,deleted:!1,modified:!0,script:zA(((g=t.role)==null?void 0:g.compMod)||{},m,e.isOptionScript),table:"table"},...a,...r]}if(!n||!i)return[];let c={keyspaceName:e.keyspaceName,data:e.data,item:{...t,properties:jA(((p=t.role)==null?void 0:p.properties)||t.properties),role:{...(t==null?void 0:t.role)||{},tableOptions:((v=(y=t==null?void 0:t.role)==null?void 0:y.compMod)==null?void 0:v.tableOptions)||{}}},isKeyspaceActivated:!0,dataSources:e.dataSources},l=nm({...c,tableName:n}),f=im({...c,tableName:i});return[...l,...f,...a]},"getUpdateTable"),zA=u((e,t,r)=>{if(!r||!e||!e.tableOptions)return"";let n=KA({options:e.tableOptions,comment:e.comments});return n?`${kl(t,e.keyspaceName)}${_A(n)};`:""},"getOptionsScript"),Fl=u((e,t,r,n)=>{let i=[];if($t(e,"items")&&e.items.length){let s=e.items.reduce((o,a)=>o.concat(Jy(a,t,r,n)),[]);i=i.concat(s)}else $t(e,"items")&&(i=i.concat(Jy(e.items,t,r,n)));return i},"handleChange"),Jy=u((e,t,r,n)=>{let i=[];if(!$t(e,"properties"))return i;let s=AA(Qr.get(n,"modelData")),o=e.properties;return i=Object.keys(o).reduce((a,c)=>{let l=o[c].role.compMod,f=Qr.get(o,`${c}.role.code`,""),h=f.length?f:c;if(!l)return a;let d=o[c].properties||{},g=l.keyspaceName;if(l.deleted){let m=Pl(o[c],n);return[...a,...nm({keyspaceName:g,tableName:h}),...m]}let p=[n.modelDefinitions,n.internalDefinitions,n.externalDefinitions,{properties:d},{properties:Qr.get(o[c],"role.properties",[])},{properties:Qr.get(o[c],"role.compMod.newProperties",[])},{properties:Qr.get(o[c],"role.compMod.oldProperties",[])}];if(l.created){let m=Pl(o[c],n);return[...a,...im({item:o[c],keyspaceName:g,data:n,tableName:h,dataSources:p}),...m]}if(l.modified){let m=Xy({keyspaceName:g,data:n,item:o[c],isOptionScript:!0,tableName:h,dataSources:p});return[...a,...m]}let y=WA({item:o[c],generator:r,tableProperties:d,udtMap:t,itemCompModData:l,tableName:h,isOldModel:s,data:n,dataSources:p}),v=Xy({item:o[c],isOptionScript:r.name==="getUpdate",propertiesScript:y,keyspaceName:g,tableName:h,data:n,dataSources:p});return[...a,...v]},[]),i},"handleItem"),WA=u(({generator:e,tableProperties:t,udtMap:r,itemCompModData:n,tableName:i,isOldModel:s,data:o,item:a,dataSources:c})=>Object.keys(t).reduce((l,f)=>{let h=t[f];if(e.name!=="getUpdate"&&(h.compositePartitionKey||h.compositeClusteringKey)||e.name==="getAdd"&&(h||{}).hasOwnProperty("compMod"))return l;let d=SA(h,r,f);if(h.$ref&&!d&&(d=Qr.last(h.$ref.split("/"))),!d)return l;let g=n==null?void 0:n.keyspaceName,p=GA(a,f,o);return e.name==="getUpdate"&&(!h.compMod||p)?l:[...l,...e({keyspaceName:g,tableName:i,columnData:{name:f,type:d},property:h,isOldModel:s,udtMap:r,dataSources:c})]},[]),"handleProperties"),QA={views:NA,containers:IA,udt:DA},ZA=u((e,t,r,n,i)=>{let s=QA[n];if(Array.isArray(e)&&e.length)return e.reduce((l,f)=>[...l,...s({child:f.properties[Object.keys(f.properties)[0]],udtMap:t,data:r,mode:i})],[]);let o=e.properties,a=Object.keys(o)[0],c=o[a];return s({child:c,udtMap:t,data:r,mode:i})},"generateScript"),Ai=u((e,t,r,n,i,s={})=>{var a;let o=[];return $t(e,"properties")&&(o=mr(o,Ai(e.properties,t,r,n,void 0,s))),$t(e,"modified")&&!((a=s[n])!=null&&a.skipModified)&&(o=mr(o,Ai(e.modified,t,r,n,"update",s))),$t(e,"added")&&(o=mr(o,Ai(e.added,t,r,n,"add",s))),$t(e,"deleted")&&(o=mr(o,Ai(e.deleted,t,r,n,"delete",s))),$t(e,"items")&&(o=mr(o,ZA(e.items,t,r,n,i))),o},"getScript"),_o=u((e,t,r)=>{let n=[];return $t(e,"properties")&&(n=mr(n,_o(e.properties,t,r))),$t(e,"items")&&(n=mr(n,_o(e.items,t,r))),$t(e,"entities")&&(n=mr(n,_o(e.entities,t,r))),$t(e,"views")&&(n=mr(n,Ai(e.views,t,r,"views"))),$t(e,"containers")&&(n=mr(n,Ai(e.containers,t,r,"containers",void 0,r.scriptOptions))),$t(e,"modelDefinitions")&&(n=mr(n,Ai(LA(e.modelDefinitions),t,r,"udt"))),$t(e,"modified")&&(n=mr(n,Fl(e.modified,t,$A,r))),$t(e,"added")&&(n=mr(n,Fl(e.added,t,rm,r))),$t(e,"deleted")&&(n=mr(n,Fl(e.deleted,t,tm,r))),n},"getAlterTableScript"),YA=u((e,t,r)=>{sm(em);let n=Object.assign({},t,kA([e])),i=_o(e,n,r);return i=Qr.uniqWith(i,Qr.isEqual),i=XA(i,r),i=eB(i),i.filter(Boolean).join(`

`)},"getAlterScript"),XA=u((e,t)=>TA(t)?e:e.map((n={})=>!n.deleted||!n.script?n:{...n,script:xA(n.script,!1)}),"getCommentedDropScript"),JA=u((e,t,r)=>(sm(em),_o(e,t,r).some(i=>!!i.script&&i.deleted)),"isDropInStatements"),eB=u(e=>{let t=u((s,o,a={})=>a[s]&&a[o],"filterProp"),r=u((s,o,a)=>o.reduce((c,l)=>t(s,a,l)?(c.scripts.push(l),c):(c.filteredScripts.push(l),c),{scripts:[],filteredScripts:[]}),"filter"),i=[["keySpaces","added"],["keySpaces","modified"],["view","deleted"],["index","deleted"],["renewal","deleted"],["table","deleted"],["udt","deleted"],["udt","added"],["udt","modified"],["table","added"],["table","modified"],["field","deleted"],["field","added"],["field","modified"],["index","added"],["index","modified"],["renewal","added"],["view","added"],["view","modified"],["udf","deleted"],["udf","added"],["keySpaces","deleted"]].reduce((s,[o,a])=>{let{scripts:c,filteredScripts:l}=r(a,s.filteredScripts,o);return{sorted:[...s.sorted,...c],filteredScripts:l}},{sorted:[],filteredScripts:e});return[...i.sorted,...i.filteredScripts].map(s=>s.script)},"sortScript");om.exports={getAlterScript:YA,isDropInStatements:JA}});var cm=_((wq,um)=>{"use strict";var{retrieveContainerName:tB,retrieveEntityName:rB,retrieveUDA:nB,retrieveUDF:iB,retrieveIndexes:sB,commentDeactivatedStatement:oB,retrieveIsItemActivated:aB}=tr(),{getTableStatement:uB}=us(),{getUdtMap:cB,getUdtScripts:lB}=Da(),{getIndexes:fB}=La(),{getKeyspaceStatement:_q}=Oa(),hB=u((e,t)=>{let r=tB(e.containerData),n=rB(e.entityData),i=aB(e.entityData),s=t&&i,o=[e.externalDefinitions,e.modelDefinitions,e.internalDefinitions,e.jsonSchema],a=cB(o),c=lB(r,o,a,s),l=uB({tableData:e.jsonSchema,tableMetaData:e.entityData,keyspaceMetaData:e.containerData,dataSources:o,udtTypeMap:a,isKeyspaceActivated:s}),f=fB(sB(e.entityData),o,n,r,s),h=dB(iB(e.containerData)),d=gB(nB(e.containerData)),g=pB([h,d,...c,l,f]);return oB(g,i&&t)},"getCreateTableScript"),pB=u(e=>e.filter(t=>t).join(`

`),"getScript"),dB=u(e=>e.map(t=>t.functionBody).filter(t=>t).join(`
`),"getUserDefinedFunctions"),gB=u(e=>e.map(t=>t.storedProcFunction).filter(t=>t).join(`
`),"getUserDefinedAggregations");um.exports={getCreateTableScript:hB}});var Ue=_(fn=>{"use strict";var Zr=require("util");function Lt(e){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.info="Cassandra Driver Error",this.message=e}u(Lt,"DriverError");Zr.inherits(Lt,Error);function lm(e,t){if(Lt.call(this,t),this.innerErrors=e,this.info="Represents an error when a query cannot be performed because no host is available or could be reached by the driver.",!t&&(this.message="All host(s) tried for query failed.",e)){let r=Object.keys(e);if(r.length>0){let n=r[0];this.message+=Zr.format(" First host tried, %s: %s. See innerErrors.",n,e[n])}}}u(lm,"NoHostAvailableError");Zr.inherits(lm,Lt);function fm(e,t){Lt.call(this,t),this.code=e,this.info="Represents an error message from the server"}u(fm,"ResponseError");Zr.inherits(fm,Lt);function hm(e){Lt.call(this,e),this.info="Represents a bug inside the driver or in a Cassandra host."}u(hm,"DriverInternalError");Zr.inherits(hm,Lt);function pm(e){Lt.call(this,e),this.info="Represents an authentication error from the driver or from a Cassandra node."}u(pm,"AuthenticationError");Zr.inherits(pm,Lt);function dm(e){Lt.call(this,e),this.info="Represents an error that is raised when one of the arguments provided to a method is not valid."}u(dm,"ArgumentError");Zr.inherits(dm,Lt);function gm(e,t){Lt.call(this,e,this.constructor),this.info="Represents a client-side error that is raised when the client did not hear back from the server within socketOptions.readTimeout",this.host=t}u(gm,"OperationTimedOutError");Zr.inherits(gm,Lt);function ym(e){Lt.call(this,e,this.constructor),this.info="Represents a feature that is not supported in the driver or in the Cassandra version."}u(ym,"NotSupportedError");Zr.inherits(ym,Lt);function mm(e,t,r){let n=Zr.format("All connections to host %s are busy, %d requests are in-flight on %s",e,t,r===1?"a single connection":"each connection");Lt.call(this,n,this.constructor),this.info="Represents a client-side error indicating that all connections to a certain host have reached the maximum amount of in-flight requests supported (pooling.maxRequestsPerConnection)"}u(mm,"BusyConnectionError");Zr.inherits(mm,Lt);fn.ArgumentError=dm;fn.AuthenticationError=pm;fn.BusyConnectionError=mm;fn.DriverError=Lt;fn.OperationTimedOutError=gm;fn.DriverInternalError=hm;fn.NoHostAvailableError=lm;fn.NotSupportedError=ym;fn.ResponseError=fm});var se=_(ie=>{"use strict";var Gn=require("util"),yB=require("net"),mB=require("events"),vm=Ue(),vB=9007199254740992,EB=2147483647,Em=Object.freeze({});function sr(){}u(sr,"noop");var CB=Buffer.alloc||TB,Cm=Buffer.allocUnsafe||Sm,SB=Int8Array.from!==Buffer.from&&Buffer.from||_B,xB=Int8Array.from!==Buffer.from&&Buffer.from||wB;function Sm(e){return new Buffer(e)}u(Sm,"allocBufferDeprecated");function TB(e){let t=Sm(e);return t.fill(0),t}u(TB,"allocBufferFillDeprecated");function _B(e,t){if(typeof e!="string")throw new TypeError("Expected string, obtained "+Gn.inspect(e));return new Buffer(e,t)}u(_B,"allocBufferFromStringDeprecated");function wB(e){if(!Array.isArray(e))throw new TypeError("Expected Array, obtained "+Gn.inspect(e));return new Buffer(e)}u(wB,"allocBufferFromArrayDeprecated");function bB(e){let t=e;return u(function(n,i){t(n,i),t=sr},"wrapperCallback")}u(bB,"callbackOnce");function IB(e){let t=Cm(e.length);return e.copy(t),t}u(IB,"copyBuffer");function AB(e,t){return e&&(t.stack+=`
  (event loop)
`+e.substr(e.indexOf(`
`)+1)),t}u(AB,"fixStack");function BB(e,t,r){if(!this.logEmitter){if(!this.options||!this.options.logEmitter)throw new Error("Log emitter not defined");this.logEmitter=this.options.logEmitter}this.logEmitter("log",e,this.constructor.name,t,r||"")}u(BB,"log");function NB(e){if(e.length===1)return e[0].length;let t=0;return e.forEach(function(r){let n=r.length;n=n||0,t+=n}),t}u(NB,"totalLength");function RB(e){return Array.prototype.slice.call(arguments,1).forEach(function(r){if(!r)return;let n=Object.keys(r);for(let i=0;i<n.length;i++){let s=n[i],o=r[s];o!==void 0&&(e[s]=o)}}),e}u(RB,"extend");function DB(e){let t=Object.keys(e),r={};for(let n=0;n<t.length;n++){let i=t[n];r[i.toLowerCase()]=e[i]}return r}u(DB,"toLowerCaseProperties");function xm(e){return Array.prototype.slice.call(arguments,1).forEach(function(r){for(let n in r){if(!r.hasOwnProperty(n))continue;let i=e[n],s=typeof i;!i||s==="number"||s==="string"||Gn.isArray(i)||Gn.isDate(i)||i.constructor.name!=="Object"?e[n]=r[n]:e[n]=xm({},i,r[n])}}),e}u(xm,"deepExtend");function LB(e){return function(t,r){return t[e]>r[e]?1:t[e]<r[e]?-1:0}}u(LB,"propCompare");function OB(e,t){return function(r,n){if(typeof r[e]>"u")return 0;let i=r[e].apply(r,t),s=n[e].apply(n,t);return i>s?1:i<s?-1:0}}u(OB,"funcCompare");function FB(e){let t=0;return{next:function(){return t>=e.length?{done:!0}:{value:e[t++],done:!1}}}}u(FB,"arrayIterator");function PB(e){let t=[],r=e.next();for(;!r.done;)t.push(r.value),r=e.next();return t}u(PB,"iteratorToArray");function Tm(e,t,r){let n=0,i=e.length-1;for(;n<=i;){let s=n+i>>>1,o=e[s],a=r(o,t);if(a<0)n=s+1;else if(a>0)i=s-1;else return s}return~n}u(Tm,"binarySearch");function kB(e,t,r){if(e.length===0)return e.push(t);let n=Tm(e,t,r);n<0&&(n=~n),e.splice(n,0,t)}u(kB,"insertSorted");function qB(e,t){if(typeof e!="function")throw new vm.ArgumentError(Gn.format("%s is not a function",t||"callback"));return e}u(qB,"validateFn");function UB(e,t){if(!e||Gn.isArray(e)||!t||t.length===0)return e;let r=new Array(t.length);e=DB(e);let n={};for(let i=0;i<t.length;i++){let s=t[i].name;if(!e.hasOwnProperty(s))throw new vm.ArgumentError(Gn.format('Parameter "%s" not defined',s));r[i]=e[s],n[s]=i}return r}u(UB,"adaptNamedParamsPrepared");function VB(e,t){if(!e||Gn.isArray(e))return{params:e,namedParameters:!1,keyIndexes:null};let r=Object.keys(e),n=new Array(r.length),i=new Array(r.length),s=t.getHints()||Em,o={};for(let a=0;a<r.length;a++){let c=r[a];n[a]={name:c.toLowerCase(),value:e[c]},i[a]=s[c],o[c]=a}return t.setHints(i),{params:n,namedParameters:!0,keyIndexes:o}}u(VB,"adaptNamedParamsWithHints");function MB(e,t){return!t||t<0?null:t===1?e:new Array(t+1).join(e)}u(MB,"stringRepeat");function KB(e){if(!e)return ie.emptyArray;let t=Object.keys(e),r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=e[t[n]];return r}u(KB,"objectValues");function HB(e,t,r){if(typeof t=="function"){r.call(this,t);return}let n=e.promiseFactory||$B,i=this;return n(u(function(o){r.call(i,o)},"handlerWrapper"))}u(HB,"promiseWrapper");function $B(e){return new Promise(u(function(r,n){e(u(function(s,o){if(s)return n(s);r(o)},"handlerCallback"))},"executor"))}u($B,"defaultPromiseFactory");function GB(e){for(let t=e.length-1;t>0;t--){let r=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[r],e[r]=n}}u(GB,"shuffleArray");function Ua(){this.length=0,this.items={}}u(Ua,"HashSet");Ua.prototype.add=function(e){return this.items[e]?!1:(this.items[e]=!0,this.length++,!0)};Ua.prototype.contains=function(e){return this.items[e]===!0};Ua.prototype.toArray=function(){return Object.keys(this.items)};var Ul=class Ul{constructor(t){if(!t||!t.nameOrIp||!t.dns)throw new Error("nameOrIp and dns lib must be provided as part of the options");this._dns=t.dns,this._nameOrIp=t.nameOrIp,this._isIp=yB.isIP(t.nameOrIp),this._index=0,this._addresses=null,this._refreshEvent=null}init(t){if(this._isIp)return process.nextTick(t);this._resolve(t)}refresh(t){if(this._isIp)return process.nextTick(t);if(this._refreshEvent!==null){this._refreshEvent.once("done",t);return}this._refreshEvent=new mB,this._refreshEvent.setMaxListeners(0),this._refreshEvent.once("done",t),this._resolve(()=>{let r=this._refreshEvent;this._refreshEvent=null,r.emit("done")})}_resolve(t){this._dns.resolve4(this._nameOrIp,(r,n)=>{r||(!n||n.length===0?r=new Error(`${this._nameOrIp} could not be resolved`):this._addresses=n),t(r)})}getIp(){if(this._isIp)return this._nameOrIp;let t=this._addresses[this._index%this._addresses.length];return this._index=this._index!==EB?this._index+1:0,t}};u(Ul,"AddressResolver");var ql=Ul;function jB(e,t,r){if(!Array.isArray(e))throw new TypeError("First parameter is not an Array");r=r||sr;let n=e.length;if(n===0)return r();let i=0;for(let o=0;o<n;o++)t(e[o],s);function s(o){if(o){let a=r;r=sr,a(o);return}++i===n&&r()}u(s,"next")}u(jB,"each");function zB(e,t,r){if(!Array.isArray(e))throw new TypeError("First parameter is not an Array");r=r||sr;let n=e.length;if(n===0)return r();let i,s=1;t(e[0],o),i===void 0&&(i=!1);function o(a){if(a)return r(a);if(s>=n)return r();if(i===void 0&&(i=!0),i)return process.nextTick(function(){t(e[s++],o)});t(e[s++],o)}u(o,"next")}u(zB,"eachSeries");function WB(e,t,r){return _m(e,t,!0,r)}u(WB,"forEachOf");function QB(e,t,r){return _m(e,t,!1,r)}u(QB,"map");function _m(e,t,r,n){if(!Array.isArray(e))throw new TypeError("First parameter must be an Array");n=n||sr;let i=e.length;if(i===0)return n(null,[]);let s=new Array(i),o=0,a=r?l:c;for(let h=0;h<i;h++)a(h);function c(h){t(e[h],u(function(g,p){s[h]=p,f(g)},"mapItemCallback"))}u(c,"invokeWithoutIndex");function l(h){t(e[h],h,u(function(g,p){s[h]=p,f(g)},"mapItemCallback"))}u(l,"invokeWithIndex");function f(h){if(h){let d=n;n=sr,d(h);return}++o===i&&n(null,s)}u(f,"next")}u(_m,"mapEach");function ZB(e,t,r){if(!Array.isArray(e))throw new TypeError("First parameter must be an Array");r=r||sr;let n=e.length;if(n===0)return r(null,[]);let i=new Array(n),s=0,o;a(0),o===void 0&&(o=!1);function a(l){t(e[l],u(function(h,d){i[l]=d,c(h)},"mapItemCallback"))}u(a,"invoke");function c(l){if(l)return r(l);if(++s===n)return r(null,i);o===void 0&&(o=!0);let f=s;if(o)return process.nextTick(function(){a(f)});a(s)}u(c,"next")}u(ZB,"mapSeries");function YB(e,t){if(!Array.isArray(e))throw new TypeError("First parameter must be an Array");t=t||sr;let r=e.length,n=0;for(let s=0;s<r;s++)e[s](i);function i(s){if(s){let o=t;return t=sr,o(s)}++n===r&&t()}u(i,"next")}u(YB,"parallel");function XB(e,t){if(!Array.isArray(e))throw new TypeError("First parameter must be an Array");t=t||sr;let r=0,n;i();function i(s,o){if(s)return t(s);if(r===e.length)return t(null,o);if(n)return process.nextTick(function(){n=!0,e[r++](i),n=!1});n=!0,e[r++](i),n=!1}u(i,"next")}u(XB,"series");function JB(e,t,r){if(r=r||sr,e=+e,isNaN(e)||e===0)return r();let n=0;for(let s=0;s<e;s++)t(s,i);function i(s){if(s){let o=r;return r=sr,o(s)}++n===e&&r()}u(i,"next")}u(JB,"times");function eN(e,t,r,n){let i;n=n||sr,t=Math.min(t,e);let s=t-1,o,a=0;for(o=0;o<t;o++)r(o,c);o=-1;function c(l){if(l){let f=n;n=sr,f(l);return}if(++a===e)return n();if(s++,!(s>=e)){if(i===void 0&&(i=o>=0),i){let f=s;return process.nextTick(function(){r(f,c)})}r(s,c)}}u(c,"next")}u(eN,"timesLimit");function tN(e,t,r){if(e=+e,isNaN(e)||e<1)return r();let n=1,i;t(0,s),i===void 0&&(i=!1);function s(o){if(o)return r(o);if(n===e)return r();i===void 0&&(i=!0);let a=n++;if(i)return process.nextTick(function(){t(a,s)});t(a,s)}u(s,"next")}u(tN,"timesSeries");function rN(e,t,r){let n=0;i();function i(s){if(s)return r(s);if(!e())return r();if(n===0){n=1,t(function(o){n===1&&(n=4),i(o)}),n===1&&(n=2);return}if(n===4)return process.nextTick(function(){t(i)});t(i)}u(i,"next")}u(rN,"whilst");ie.adaptNamedParamsPrepared=UB;ie.adaptNamedParamsWithHints=VB;ie.AddressResolver=ql;ie.allocBuffer=CB;ie.allocBufferUnsafe=Cm;ie.allocBufferFromArray=xB;ie.allocBufferFromString=SB;ie.arrayIterator=FB;ie.binarySearch=Tm;ie.callbackOnce=bB;ie.copyBuffer=IB;ie.deepExtend=xm;ie.each=jB;ie.eachSeries=zB;ie.emptyArray=Object.freeze([]);ie.emptyObject=Em;ie.extend=RB;ie.fixStack=AB;ie.forEachOf=WB;ie.funcCompare=OB;ie.insertSorted=kB;ie.iteratorToArray=PB;ie.log=BB;ie.map=QB;ie.mapSeries=ZB;ie.maxInt=vB;ie.noop=sr;ie.objectValues=KB;ie.parallel=YB;ie.promiseWrapper=HB;ie.propCompare=LB;ie.series=XB;ie.stringRepeat=MB;ie.shuffleArray=GB;ie.times=JB;ie.timesLimit=eN;ie.timesSeries=tN;ie.totalLength=NB;ie.validateFn=qB;ie.whilst=rN;ie.HashSet=Ua});var bm=_(Ml=>{"use strict";var wm=require("dns"),nN=require("util"),iN=se();function Vl(){}u(Vl,"AddressTranslator");Vl.prototype.translate=function(e,t,r){r(e+":"+t)};function Va(){}u(Va,"EC2MultiRegionTranslator");nN.inherits(Va,Vl);Va.prototype.translate=function(e,t,r){let n=e,i=this,s;iN.series([u(function(a){wm.reverse(e,function(c,l){if(c)return a(c);if(!l)return a();s=l[0],a()})},"resolve"),u(function(a){if(!s)return a();wm.lookup(s,function(c,l){if(c)return a(c);n=l,a()})},"lookup")],function(o){o&&i.logError(e,o),r(n+":"+t)})};Va.prototype.logError=function(e,t){};Ml.AddressTranslator=Vl;Ml.EC2MultiRegionTranslator=Va});var ls=_((Im,wo)=>{(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof require=="function"&&typeof wo=="object"&&wo&&wo.exports?wo.exports=t():(e.dcodeIO=e.dcodeIO||{}).Long=t()})(Im,function(){"use strict";function e(l,f,h){this.low=l|0,this.high=f|0,this.unsigned=!!h}u(e,"Long"),e.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=u(function(f){return(f&&f.__isLong__)===!0},"isLong");var t={},r={};e.fromInt=u(function(f,h){var d,g;return h?(f=f>>>0,0<=f&&f<256&&(g=r[f],g)?g:(d=new e(f,(f|0)<0?-1:0,!0),0<=f&&f<256&&(r[f]=d),d)):(f=f|0,-128<=f&&f<128&&(g=t[f],g)?g:(d=new e(f,f<0?-1:0,!1),-128<=f&&f<128&&(t[f]=d),d))},"fromInt"),e.fromNumber=u(function(f,h){return h=!!h,isNaN(f)||!isFinite(f)?e.ZERO:!h&&f<=-a?e.MIN_VALUE:!h&&f+1>=a?e.MAX_VALUE:h&&f>=o?e.MAX_UNSIGNED_VALUE:f<0?e.fromNumber(-f,h).negate():new e(f%s|0,f/s|0,h)},"fromNumber"),e.fromBits=u(function(f,h,d){return new e(f,h,d)},"fromBits"),e.fromString=u(function(f,h,d){if(f.length===0)throw Error("number format error: empty string");if(f==="NaN"||f==="Infinity"||f==="+Infinity"||f==="-Infinity")return e.ZERO;if(typeof h=="number"&&(d=h,h=!1),d=d||10,d<2||36<d)throw Error("radix out of range: "+d);var g;if((g=f.indexOf("-"))>0)throw Error('number format error: interior "-" character: '+f);if(g===0)return e.fromString(f.substring(1),h,d).negate();for(var p=e.fromNumber(Math.pow(d,8)),y=e.ZERO,v=0;v<f.length;v+=8){var m=Math.min(8,f.length-v),x=parseInt(f.substring(v,v+m),d);if(m<8){var w=e.fromNumber(Math.pow(d,m));y=y.multiply(w).add(e.fromNumber(x))}else y=y.multiply(p),y=y.add(e.fromNumber(x))}return y.unsigned=h,y},"fromString"),e.fromValue=u(function(f){return f instanceof e?f:typeof f=="number"?e.fromNumber(f):typeof f=="string"?e.fromString(f):new e(f.low,f.high,f.unsigned)},"fromValue");var n=65536,i=1<<24,s=n*n,o=s*s,a=o/2,c=e.fromInt(i);return e.ZERO=e.fromInt(0),e.UZERO=e.fromInt(0,!0),e.ONE=e.fromInt(1),e.UONE=e.fromInt(1,!0),e.NEG_ONE=e.fromInt(-1),e.MAX_VALUE=e.fromBits(-1,2147483647,!1),e.MAX_UNSIGNED_VALUE=e.fromBits(-1,-1,!0),e.MIN_VALUE=e.fromBits(0,-2147483648,!1),e.prototype.toInt=u(function(){return this.unsigned?this.low>>>0:this.low},"toInt"),e.prototype.toNumber=u(function(){return this.unsigned?(this.high>>>0)*s+(this.low>>>0):this.high*s+(this.low>>>0)},"toNumber"),e.prototype.toString=u(function(f){if(f=f||10,f<2||36<f)throw RangeError("radix out of range: "+f);if(this.isZero())return"0";var h;if(this.isNegative())if(this.equals(e.MIN_VALUE)){var d=e.fromNumber(f),g=this.divide(d);return h=g.multiply(d).subtract(this),g.toString(f)+h.toInt().toString(f)}else return"-"+this.negate().toString(f);var p=e.fromNumber(Math.pow(f,6),this.unsigned);h=this;for(var y="";;){var v=h.divide(p),m=h.subtract(v.multiply(p)).toInt()>>>0,x=m.toString(f);if(h=v,h.isZero())return x+y;for(;x.length<6;)x="0"+x;y=""+x+y}},"toString"),e.prototype.getHighBits=u(function(){return this.high},"getHighBits"),e.prototype.getHighBitsUnsigned=u(function(){return this.high>>>0},"getHighBitsUnsigned"),e.prototype.getLowBits=u(function(){return this.low},"getLowBits"),e.prototype.getLowBitsUnsigned=u(function(){return this.low>>>0},"getLowBitsUnsigned"),e.prototype.getNumBitsAbs=u(function(){if(this.isNegative())return this.equals(e.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var f=this.high!=0?this.high:this.low,h=31;h>0&&!(f&1<<h);h--);return this.high!=0?h+33:h+1},"getNumBitsAbs"),e.prototype.isZero=u(function(){return this.high===0&&this.low===0},"isZero"),e.prototype.isNegative=u(function(){return!this.unsigned&&this.high<0},"isNegative"),e.prototype.isPositive=u(function(){return this.unsigned||this.high>=0},"isPositive"),e.prototype.isOdd=u(function(){return(this.low&1)===1},"isOdd"),e.prototype.isEven=u(function(){return(this.low&1)===0},"isEven"),e.prototype.equals=u(function(f){return e.isLong(f)||(f=e.fromValue(f)),this.unsigned!==f.unsigned&&this.high>>>31===1&&f.high>>>31===1?!1:this.high===f.high&&this.low===f.low},"equals"),e.eq=e.prototype.equals,e.prototype.notEquals=u(function(f){return!this.equals(f)},"notEquals"),e.neq=e.prototype.notEquals,e.prototype.lessThan=u(function(f){return this.compare(f)<0},"lessThan"),e.prototype.lt=e.prototype.lessThan,e.prototype.lessThanOrEqual=u(function(f){return this.compare(f)<=0},"lessThanOrEqual"),e.prototype.lte=e.prototype.lessThanOrEqual,e.prototype.greaterThan=u(function(f){return this.compare(f)>0},"greaterThan"),e.prototype.gt=e.prototype.greaterThan,e.prototype.greaterThanOrEqual=u(function(f){return this.compare(f)>=0},"greaterThanOrEqual"),e.prototype.gte=e.prototype.greaterThanOrEqual,e.prototype.compare=u(function(f){if(e.isLong(f)||(f=e.fromValue(f)),this.equals(f))return 0;var h=this.isNegative(),d=f.isNegative();return h&&!d?-1:!h&&d?1:this.unsigned?f.high>>>0>this.high>>>0||f.high===this.high&&f.low>>>0>this.low>>>0?-1:1:this.subtract(f).isNegative()?-1:1},"compare"),e.prototype.negate=u(function(){return!this.unsigned&&this.equals(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},"negate"),e.prototype.neg=e.prototype.negate,e.prototype.add=u(function(f){e.isLong(f)||(f=e.fromValue(f));var h=this.high>>>16,d=this.high&65535,g=this.low>>>16,p=this.low&65535,y=f.high>>>16,v=f.high&65535,m=f.low>>>16,x=f.low&65535,w=0,B=0,R=0,L=0;return L+=p+x,R+=L>>>16,L&=65535,R+=g+m,B+=R>>>16,R&=65535,B+=d+v,w+=B>>>16,B&=65535,w+=h+y,w&=65535,e.fromBits(R<<16|L,w<<16|B,this.unsigned)},"add"),e.prototype.subtract=u(function(f){return e.isLong(f)||(f=e.fromValue(f)),this.add(f.negate())},"subtract"),e.prototype.sub=e.prototype.subtract,e.prototype.multiply=u(function(f){if(this.isZero()||(e.isLong(f)||(f=e.fromValue(f)),f.isZero()))return e.ZERO;if(this.equals(e.MIN_VALUE))return f.isOdd()?e.MIN_VALUE:e.ZERO;if(f.equals(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return f.isNegative()?this.negate().multiply(f.negate()):this.negate().multiply(f).negate();if(f.isNegative())return this.multiply(f.negate()).negate();if(this.lessThan(c)&&f.lessThan(c))return e.fromNumber(this.toNumber()*f.toNumber(),this.unsigned);var h=this.high>>>16,d=this.high&65535,g=this.low>>>16,p=this.low&65535,y=f.high>>>16,v=f.high&65535,m=f.low>>>16,x=f.low&65535,w=0,B=0,R=0,L=0;return L+=p*x,R+=L>>>16,L&=65535,R+=g*x,B+=R>>>16,R&=65535,R+=p*m,B+=R>>>16,R&=65535,B+=d*x,w+=B>>>16,B&=65535,B+=g*m,w+=B>>>16,B&=65535,B+=p*v,w+=B>>>16,B&=65535,w+=h*x+d*m+g*v+p*y,w&=65535,e.fromBits(R<<16|L,w<<16|B,this.unsigned)},"multiply"),e.prototype.mul=e.prototype.multiply,e.prototype.divide=u(function(f){if(e.isLong(f)||(f=e.fromValue(f)),f.isZero())throw new Error("division by zero");if(this.isZero())return this.unsigned?e.UZERO:e.ZERO;var h,d,g;if(this.equals(e.MIN_VALUE)){if(f.equals(e.ONE)||f.equals(e.NEG_ONE))return e.MIN_VALUE;if(f.equals(e.MIN_VALUE))return e.ONE;var p=this.shiftRight(1);return h=p.divide(f).shiftLeft(1),h.equals(e.ZERO)?f.isNegative()?e.ONE:e.NEG_ONE:(d=this.subtract(f.multiply(h)),g=h.add(d.divide(f)),g)}else if(f.equals(e.MIN_VALUE))return this.unsigned?e.UZERO:e.ZERO;if(this.isNegative())return f.isNegative()?this.negate().divide(f.negate()):this.negate().divide(f).negate();if(f.isNegative())return this.divide(f.negate()).negate();for(g=e.ZERO,d=this;d.greaterThanOrEqual(f);){h=Math.max(1,Math.floor(d.toNumber()/f.toNumber()));for(var y=Math.ceil(Math.log(h)/Math.LN2),v=y<=48?1:Math.pow(2,y-48),m=e.fromNumber(h),x=m.multiply(f);x.isNegative()||x.greaterThan(d);)h-=v,m=e.fromNumber(h,this.unsigned),x=m.multiply(f);m.isZero()&&(m=e.ONE),g=g.add(m),d=d.subtract(x)}return g},"divide"),e.prototype.div=e.prototype.divide,e.prototype.modulo=u(function(f){return e.isLong(f)||(f=e.fromValue(f)),this.subtract(this.divide(f).multiply(f))},"modulo"),e.prototype.mod=e.prototype.modulo,e.prototype.not=u(function(){return e.fromBits(~this.low,~this.high,this.unsigned)},"not"),e.prototype.and=u(function(f){return e.isLong(f)||(f=e.fromValue(f)),e.fromBits(this.low&f.low,this.high&f.high,this.unsigned)},"and"),e.prototype.or=u(function(f){return e.isLong(f)||(f=e.fromValue(f)),e.fromBits(this.low|f.low,this.high|f.high,this.unsigned)},"or"),e.prototype.xor=u(function(f){return e.isLong(f)||(f=e.fromValue(f)),e.fromBits(this.low^f.low,this.high^f.high,this.unsigned)},"xor"),e.prototype.shiftLeft=u(function(f){return e.isLong(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?e.fromBits(this.low<<f,this.high<<f|this.low>>>32-f,this.unsigned):e.fromBits(0,this.low<<f-32,this.unsigned)},"shiftLeft"),e.prototype.shl=e.prototype.shiftLeft,e.prototype.shiftRight=u(function(f){return e.isLong(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?e.fromBits(this.low>>>f|this.high<<32-f,this.high>>f,this.unsigned):e.fromBits(this.high>>f-32,this.high>=0?0:-1,this.unsigned)},"shiftRight"),e.prototype.shr=e.prototype.shiftRight,e.prototype.shiftRightUnsigned=u(function(f){if(e.isLong(f)&&(f=f.toInt()),f&=63,f===0)return this;var h=this.high;if(f<32){var d=this.low;return e.fromBits(d>>>f|h<<32-f,h>>>f,this.unsigned)}else return f===32?e.fromBits(h,0,this.unsigned):e.fromBits(h>>>f-32,0,this.unsigned)},"shiftRightUnsigned"),e.prototype.shru=e.prototype.shiftRightUnsigned,e.prototype.toSigned=u(function(){return this.unsigned?new e(this.low,this.high,!1):this},"toSigned"),e.prototype.toUnsigned=u(function(){return this.unsigned?this:new e(this.low,this.high,!0)},"toUnsigned"),e})});var Kl=_((Oq,Nm)=>{"use strict";var sN=require("crypto"),oN=se();function Yr(e){if(!e||e.length!==16)throw new Error("You must provide a buffer containing 16 bytes");this.buffer=e}u(Yr,"Uuid");Yr.fromString=function(e){if(typeof e!="string"||e.length!==36)throw new Error("Invalid string representation of Uuid, it should be in the 00000000-0000-0000-0000-000000000000");return new Yr(oN.allocBufferFromString(e.replace(/-/g,""),"hex"))};Yr.random=function(e){if(e)Bm(function(t,r){return t?e(t):e(null,Am(r))});else{let t=Bm();return Am(t)}};Yr.prototype.getBuffer=function(){return this.buffer};Yr.prototype.equals=function(e){return e instanceof Yr&&this.buffer.equals(e.buffer)};Yr.prototype.toString=function(){let e=aN(this);return e.substr(0,8)+"-"+e.substr(8,4)+"-"+e.substr(12,4)+"-"+e.substr(16,4)+"-"+e.substr(20,12)};Yr.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};Yr.prototype.toJSON=function(){return this.toString()};function Am(e){return e[6]&=15,e[6]|=64,e[8]&=63,e[8]|=128,new Yr(e)}u(Am,"createUuidFromBuffer");function aN(e){return e.buffer.toString("hex")}u(aN,"getHex");function Bm(e){return sN.randomBytes(16,e)}u(Bm,"getRandomBytes");Nm.exports=Yr});var km=_((Pq,Pm)=>{"use strict";var uN=require("util"),Lm=require("crypto"),fs=ls(),Hl=Kl(),jn=se(),Om=122192928e5,Ha=1e4,cN=jn.allocBufferFromString("808080808080","hex"),lN=jn.allocBufferFromString("8080","hex"),fN=jn.allocBufferFromString("7f7f7f7f7f7f","hex"),hN=jn.allocBufferFromString("7f7f","hex"),Ma=0,Ka=0,Rm=0;function Ot(e,t,r,n){let i;if(e instanceof Buffer){if(e.length!==16)throw new Error("Buffer for v1 uuid not valid");i=e}else i=vN(e,t,r,n);Hl.call(this,i)}u(Ot,"TimeUuid");uN.inherits(Ot,Hl);Ot.fromDate=function(e,t,r,n,i){if(typeof t=="function"?(i=t,t=r=n=null):typeof r=="function"?(i=r,r=n=null):typeof n=="function"&&(i=n,n=null),!i)return new Ot(e,t,r,n);jn.parallel([s=>Dm(r,6,(o,a)=>s(o,r=a)),s=>Dm(n,2,(o,a)=>s(o,n=a))],s=>{if(s)return i(s);let o;try{o=new Ot(e,t,r,n)}catch(a){return i(a)}i(null,o)})};Ot.fromString=function(e){return new Ot(Hl.fromString(e).getBuffer())};Ot.min=function(e,t){return new Ot(e,t,cN,lN)};Ot.max=function(e,t){return new Ot(e,t,fN,hN)};Ot.now=function(e,t,r){return Ot.fromDate(null,null,e,t,r)};Ot.prototype.getDatePrecision=function(){let e=this.buffer.readUInt32BE(0),t=0;t|=(this.buffer[4]&255)<<8,t|=this.buffer[5]&255,t|=(this.buffer[6]&15)<<24,t|=(this.buffer[7]&255)<<16;let r=fs.fromBits(e,t),n=fs.fromNumber(Ha),i=r.modulo(n),s=r.div(n).subtract(fs.fromNumber(Om));return{date:new Date(s.toNumber()),ticks:i.toNumber()}};Ot.prototype.getDate=function(){return this.getDatePrecision().date};Ot.prototype.getNodeId=function(){return this.buffer.slice(10)};Ot.prototype.getClockId=function(){return this.buffer.slice(8,10)};Ot.prototype.getNodeIdString=function(){return this.buffer.slice(10).toString("ascii")};function pN(e,t,r){let n=fs.fromNumber(t+Om).multiply(fs.fromNumber(1e4)).add(fs.fromNumber(r)),i=n.getHighBitsUnsigned();e.writeUInt32BE(n.getLowBitsUnsigned(),0),e.writeUInt16BE(i&65535,4),e.writeUInt16BE(i>>>16&65535,6)}u(pN,"writeTime");function dN(e){let t=e;if(typeof e=="string"&&(t=jn.allocBufferFromString(e,"ascii")),!(t instanceof Buffer))t=Fm(2);else if(t.length!==2)throw new Error("Clock identifier must have 2 bytes");return t}u(dN,"getClockId");function gN(e){let t=e;if(typeof e=="string"&&(t=jn.allocBufferFromString(e,"ascii")),!(t instanceof Buffer))t=Fm(6);else if(t.length!==6)throw new Error("Node identifier must have 6 bytes");return t}u(gN,"getNodeId");function yN(e){return(typeof e!="number"||e>=Ha)&&(Ma++,Ma>=Ha&&(Ma=0),e=Ma),e}u(yN,"getTicks");function mN(e,t){if(!(e instanceof Date)||isNaN(e.getTime())){e=new Date;let r=e.getTime();Ka++,(Ka>Ha||r>Rm)&&(Ka=0,Rm=r),t=Ka}return{time:e.getTime(),ticks:yN(t)}}u(mN,"getTimeWithTicks");function Fm(e){return Lm.randomBytes(e)}u(Fm,"getRandomBytes");function Dm(e,t,r){if(e)return r(null,e);Lm.randomBytes(t,r)}u(Dm,"getOrGenerateRandom");function vN(e,t,r,n){let i=mN(e,t);r=gN(r),n=dN(n);let s=jn.allocBufferUnsafe(16);return pN(s,i.time,i.ticks),n.copy(s,8,0),r.copy(s,10,0),s[6]=s[6]&15,s[6]=s[6]|16,s[8]=s[8]&63,s[8]=s[8]|128,s}u(vN,"generateBuffer");Pm.exports=Ot});var Um=_((qq,qm)=>{"use strict";var EN=/(\d+)\.(\d+)(?:\.(\d+))?(?:\.(\d+)?)?(?:[-~]([\w+]*(?:-\w[.\w]*)*))?(?:\+([.\w]+))?/,$a=class $a{constructor(t,r,n,i,s,o){this.major=t,this.minor=r,this.patch=n,this.dsePatch=i,this.preReleases=s,this.build=o}toString(){let t=this.major+"."+this.minor;return this.patch!==void 0&&(t+="."+this.patch),this.dsePatch!==void 0&&(t+="."+this.dsePatch),this.preReleases!==void 0&&this.preReleases.forEach(r=>{t+="-"+r}),this.build&&(t+="+"+this.build),t}compare(t){if(this.major<t.major)return-1;if(this.major>t.major)return 1;if(this.minor<t.minor)return-1;if(this.minor>t.minor)return 1;let r=this.patch||0,n=t.patch||0;if(r<n)return-1;if(r>n)return 1;if(this.dsePatch===void 0){if(t.dsePatch!==void 0)return-1}else{if(t.dsePatch===void 0)return 1;if(this.dsePatch<t.dsePatch)return-1;if(this.dsePatch>t.dsePatch)return 1}if(this.preReleases===void 0){if(t.preReleases!==void 0)return 1}else if(t.preReleases===void 0)return-1;return 0}static parse(t){if(!t)return null;let r=t.match(EN);if(r){let n=parseInt(r[1],10),i=parseInt(r[2],10),s=r[3]?parseInt(r[3],10):void 0,o=r[4]?parseInt(r[4],10):void 0,a=r[5]?r[5].split("-"):void 0,c=r[6];return new $a(n,i,s,o,a,c)}throw new TypeError("Could not extract version from '"+t+"'")}};u($a,"VersionNumber");var $l=$a;qm.exports=$l});var Mm=_((Vq,Vm)=>{"use strict";var CN=se(),bo=Um(),SN=bo.parse("2.0.0"),xN=bo.parse("2.1.0"),TN=bo.parse("2.2.0"),_N=bo.parse("3.0.0"),wN={v1:1,v2:2,v3:3,v4:4,v5:5,maxSupported:4,minSupported:1,isSupported:function(e){return e<=4&&e>=1},supportsPreparedPartitionKey:function(e){return e>=this.v4},supportsSchemaChangeFullMetadata:function(e){return e>=this.v3},supportsPaging:function(e){return e>=this.v2},supportsTimestamp:function(e){return e>=this.v3},supportsNamedParameters:function(e){return e>=this.v3},supportsUnset:function(e){return e>=this.v4},uses2BytesStreamIds:function(e){return e>=this.v3},uses4BytesCollectionLength:function(e){return e>=this.v3},canStartupResponseErrorBeWrapped:function(e){return e>=this.v4},getLowerSupported:function(e){return e>=this.v5?this.v4:e<=this.v1?0:e-1},getHighestCommon:function(e,t){let r=e.log?e.log.bind(e):CN.noop,n=e.protocolVersion,i=!1,s=n;if(t.forEach(o=>{if(!o.cassandraVersion||o.cassandraVersion.length===0){r("warning","Encountered host "+o.address+" with no cassandra version, skipping as part of protocol version evaluation");return}try{let a=bo.parse(o.cassandraVersion);r("verbose","Encountered host "+o.address+" with cassandra version "+a),a.compare(_N)>=0?(i=!0,n=Math.min(this.v4,n),s=n):a.compare(TN)>=0?(n=Math.min(this.v4,n),s=n):a.compare(xN)>=0?(n=Math.min(this.v3,n),s=n):a.compare(SN)>=0?n=Math.min(this.v2,n):n=this.v1}catch{r("warning","Encountered host "+o.address+" with unparseable cassandra version "+o.cassandraVersion+" skipping as part of protocol version evaluation")}}),i&&n<this.v3){let o=". This should not be possible as nodes within a cluster can't be separated by more than one major version";s<this.v3?r("error","Detected hosts that require at least protocol version 0x3, but currently connected to "+e.address+":"+e.port+" using protocol version 0x"+s+". Will not be able to connect to these hosts"+o):r("error","Detected hosts with maximum protocol version of 0x"+n.toString(16)+" but there are some hosts that require at least version 0x3. Will not be able to connect to these older hosts"+o),n=s}return r("verbose","Resolved protocol version 0x"+n.toString(16)+" as the highest common protocol version among hosts"),n}};Vm.exports=wN});var Gl=_((Mq,Hm)=>{var Km=se();function K(e,t){this.bits_=[],this.sign_=t;for(var r=!0,n=e.length-1;n>=0;n--){var i=e[n]|0;(!r||i!=t)&&(this.bits_[n]=i,r=!1)}}u(K,"Integer");K.IntCache_={};K.fromInt=function(e){if(-128<=e&&e<128){var t=K.IntCache_[e];if(t)return t}var r=new K([e|0],e<0?-1:0);return-128<=e&&e<128&&(K.IntCache_[e]=r),r};K.fromNumber=function(e){if(isNaN(e)||!isFinite(e))return K.ZERO;if(e<0)return K.fromNumber(-e).negate();for(var t=[],r=1,n=0;e>=r;n++)t[n]=e/r|0,r*=K.TWO_PWR_32_DBL_;return new K(t,0)};K.fromBits=function(e){var t=e[e.length-1];return new K(e,t&1<<31?-1:0)};K.fromString=function(e,t){if(e.length==0)throw TypeError("number format error: empty string");var r=t||10;if(r<2||36<r)throw Error("radix out of range: "+r);if(e.charAt(0)=="-")return K.fromString(e.substring(1),r).negate();if(e.indexOf("-")>=0)throw TypeError('number format error: interior "-" character');for(var n=K.fromNumber(Math.pow(r,8)),i=K.ZERO,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),r);if(o<8){var c=K.fromNumber(Math.pow(r,o));i=i.multiply(c).add(K.fromNumber(a))}else i=i.multiply(n),i=i.add(K.fromNumber(a))}return i};K.fromBuffer=function(e){for(var t=new Array(Math.ceil(e.length/4)),r=e[0]&128?-1:0,n=0;n<t.length;n++){var i=e.length-(n+1)*4,s;if(i<0){i=i+4,s=0;for(var o=0;o<i;o++){var a=e[o];r===-1&&(a=~a&255),s=s|a<<(i-o-1)*8}r===-1&&(s=~s)}else s=e.readInt32BE(i);t[n]=s}return new K(t,r)};K.toBuffer=function(e){var t=e.sign_,r=e.bits_;if(r.length===0)return Km.allocBufferFromArray([e.sign_]);var n=r[r.length-1];t===-1&&(n=~n);var i=[];n>>>24>0&&i.push(n>>24&255),n>>>16>0&&i.push(n>>16&255),n>>>8>0&&i.push(n>>8&255),i.push(n&255),i[0]>>7&&i.unshift(0);for(var s=Km.allocBufferUnsafe(i.length+(r.length-1)*4),o=0;o<i.length;o++){var a=i[o];t===-1?s[o]=~a:s[o]=a}for(var c=0;c<r.length-1;c++){var l=r[r.length-2-c],f=i.length+c*4;s.writeInt32BE(l,f)}return s};K.TWO_PWR_32_DBL_=65536*65536;K.ZERO=K.fromInt(0);K.ONE=K.fromInt(1);K.TWO_PWR_24_=K.fromInt(1<<24);K.prototype.toInt=function(){return this.bits_.length>0?this.bits_[0]:this.sign_};K.prototype.toNumber=function(){if(this.isNegative())return-this.negate().toNumber();for(var e=0,t=1,r=0;r<this.bits_.length;r++)e+=this.getBitsUnsigned(r)*t,t*=K.TWO_PWR_32_DBL_;return e};K.prototype.toString=function(e){var t=e||10;if(t<2||36<t)throw Error("radix out of range: "+t);if(this.isZero())return"0";if(this.isNegative())return"-"+this.negate().toString(t);for(var r=K.fromNumber(Math.pow(t,6)),n=this,i="";;){var s=n.divide(r),o=n.subtract(s.multiply(r)).toInt(),a=o.toString(t);if(n=s,n.isZero())return a+i;for(;a.length<6;)a="0"+a;i=""+a+i}};K.prototype.getBits=function(e){return e<0?0:e<this.bits_.length?this.bits_[e]:this.sign_};K.prototype.getBitsUnsigned=function(e){var t=this.getBits(e);return t>=0?t:K.TWO_PWR_32_DBL_+t};K.prototype.getSign=function(){return this.sign_};K.prototype.isZero=function(){if(this.sign_!=0)return!1;for(var e=0;e<this.bits_.length;e++)if(this.bits_[e]!=0)return!1;return!0};K.prototype.isNegative=function(){return this.sign_==-1};K.prototype.isOdd=function(){return this.bits_.length==0&&this.sign_==-1||this.bits_.length>0&&(this.bits_[0]&1)!=0};K.prototype.equals=function(e){if(this.sign_!=e.sign_)return!1;for(var t=Math.max(this.bits_.length,e.bits_.length),r=0;r<t;r++)if(this.getBits(r)!=e.getBits(r))return!1;return!0};K.prototype.notEquals=function(e){return!this.equals(e)};K.prototype.greaterThan=function(e){return this.compare(e)>0};K.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0};K.prototype.lessThan=function(e){return this.compare(e)<0};K.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0};K.prototype.compare=function(e){var t=this.subtract(e);return t.isNegative()?-1:t.isZero()?0:1};K.prototype.shorten=function(e){for(var t=e-1>>5,r=(e-1)%32,n=[],i=0;i<t;i++)n[i]=this.getBits(i);var s=r==31?4294967295:(1<<r+1)-1,o=this.getBits(t)&s;return o&1<<r?(o|=4294967295-s,n[t]=o,new K(n,-1)):(n[t]=o,new K(n,0))};K.prototype.negate=function(){return this.not().add(K.ONE)};K.prototype.add=function(e){for(var t=Math.max(this.bits_.length,e.bits_.length),r=[],n=0,i=0;i<=t;i++){var s=this.getBits(i)>>>16,o=this.getBits(i)&65535,a=e.getBits(i)>>>16,c=e.getBits(i)&65535,l=n+o+c,f=(l>>>16)+s+a;n=f>>>16,l&=65535,f&=65535,r[i]=f<<16|l}return K.fromBits(r)};K.prototype.subtract=function(e){return this.add(e.negate())};K.prototype.multiply=function(e){if(this.isZero())return K.ZERO;if(e.isZero())return K.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(K.TWO_PWR_24_)&&e.lessThan(K.TWO_PWR_24_))return K.fromNumber(this.toNumber()*e.toNumber());for(var t=this.bits_.length+e.bits_.length,r=[],n=0;n<2*t;n++)r[n]=0;for(var n=0;n<this.bits_.length;n++)for(var i=0;i<e.bits_.length;i++){var s=this.getBits(n)>>>16,o=this.getBits(n)&65535,a=e.getBits(i)>>>16,c=e.getBits(i)&65535;r[2*n+2*i]+=o*c,K.carry16_(r,2*n+2*i),r[2*n+2*i+1]+=s*c,K.carry16_(r,2*n+2*i+1),r[2*n+2*i+1]+=o*a,K.carry16_(r,2*n+2*i+1),r[2*n+2*i+2]+=s*a,K.carry16_(r,2*n+2*i+2)}for(var n=0;n<t;n++)r[n]=r[2*n+1]<<16|r[2*n];for(var n=t;n<2*t;n++)r[n]=0;return new K(r,0)};K.carry16_=function(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535};K.prototype.divide=function(e){if(e.isZero())throw Error("division by zero");if(this.isZero())return K.ZERO;if(this.isNegative())return e.isNegative()?this.negate().divide(e.negate()):this.negate().divide(e).negate();if(e.isNegative())return this.divide(e.negate()).negate();for(var t=K.ZERO,r=this;r.greaterThanOrEqual(e);){for(var n=Math.max(1,Math.floor(r.toNumber()/e.toNumber())),i=Math.ceil(Math.log(n)/Math.LN2),s=i<=48?1:Math.pow(2,i-48),o=K.fromNumber(n),a=o.multiply(e);a.isNegative()||a.greaterThan(r);)n-=s,o=K.fromNumber(n),a=o.multiply(e);o.isZero()&&(o=K.ONE),t=t.add(o),r=r.subtract(a)}return t};K.prototype.modulo=function(e){return this.subtract(this.divide(e).multiply(e))};K.prototype.not=function(){for(var e=this.bits_.length,t=[],r=0;r<e;r++)t[r]=~this.bits_[r];return new K(t,~this.sign_)};K.prototype.and=function(e){for(var t=Math.max(this.bits_.length,e.bits_.length),r=[],n=0;n<t;n++)r[n]=this.getBits(n)&e.getBits(n);return new K(r,this.sign_&e.sign_)};K.prototype.or=function(e){for(var t=Math.max(this.bits_.length,e.bits_.length),r=[],n=0;n<t;n++)r[n]=this.getBits(n)|e.getBits(n);return new K(r,this.sign_|e.sign_)};K.prototype.xor=function(e){for(var t=Math.max(this.bits_.length,e.bits_.length),r=[],n=0;n<t;n++)r[n]=this.getBits(n)^e.getBits(n);return new K(r,this.sign_^e.sign_)};K.prototype.shiftLeft=function(e){for(var t=e>>5,r=e%32,n=this.bits_.length+t+(r>0?1:0),i=[],s=0;s<n;s++)r>0?i[s]=this.getBits(s-t)<<r|this.getBits(s-t-1)>>>32-r:i[s]=this.getBits(s-t);return new K(i,this.sign_)};K.prototype.shiftRight=function(e){for(var t=e>>5,r=e%32,n=this.bits_.length-t,i=[],s=0;s<n;s++)r>0?i[s]=this.getBits(s+t)>>>r|this.getBits(s+t+1)<<32-r:i[s]=this.getBits(s+t);return new K(i,this.sign_)};K.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};K.prototype.abs=function(){return this.sign_===0?this:this.negate()};K.prototype.toJSON=function(){return this.toString()};Hm.exports=K});var jm=_((Hq,Gm)=>{"use strict";var Nn=Gl(),$m=se();function Pe(e,t){typeof e=="number"&&(e=Nn.fromNumber(e)),this._intVal=e,this._scale=t}u(Pe,"BigDecimal");Pe.fromBuffer=function(e){let t=e.readInt32BE(0),r=Nn.fromBuffer(e.slice(4));return new Pe(r,t)};Pe.toBuffer=function(e){let t=Nn.toBuffer(e._intVal),r=$m.allocBufferUnsafe(4);return r.writeInt32BE(e._scale,0),Buffer.concat([r,t],r.length+t.length)};Pe.fromString=function(e){if(!e)throw new TypeError("Invalid null or undefined value");e=e.trim();let t=e.indexOf("."),r=0;return t>=0&&(r=e.length-1-t,e=e.substr(0,t)+e.substr(t+1)),new Pe(Nn.fromString(e),r)};Pe.fromNumber=function(e){if(isNaN(e))return new Pe(Nn.ZERO,0);let t=e.toString();return t.indexOf("e")>=0&&(t=e.toFixed(20)),Pe.fromString(t)};Pe.prototype.equals=function(e){return e instanceof Pe&&this.compare(e)===0};Pe.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};Pe.prototype.notEquals=function(e){return!this.equals(e)};Pe.prototype.compare=function(e){let t=this.subtract(e);return t.isNegative()?-1:t.isZero()?0:1};Pe.prototype.subtract=function(e){let t=this;if(t._scale===e._scale)return new Pe(t._intVal.subtract(e._intVal),t._scale);let r,n;return t._scale<e._scale?(r=e._scale-t._scale,n=t._intVal.multiply(Nn.fromNumber(Math.pow(10,r))).subtract(e._intVal),new Pe(n,e._scale)):(r=t._scale-e._scale,n=t._intVal.subtract(e._intVal.multiply(Nn.fromNumber(Math.pow(10,r)))),new Pe(n,t._scale))};Pe.prototype.add=function(e){let t=this;if(t._scale===e._scale)return new Pe(t._intVal.add(e._intVal),t._scale);let r,n;return t._scale<e._scale?(r=e._scale-t._scale,n=t._intVal.multiply(Nn.fromNumber(Math.pow(10,r))).add(e._intVal),new Pe(n,e._scale)):(r=t._scale-e._scale,n=t._intVal.add(e._intVal.multiply(Nn.fromNumber(Math.pow(10,r)))),new Pe(n,t._scale))};Pe.prototype.greaterThan=function(e){return this.compare(e)===1};Pe.prototype.isNegative=function(){return this._intVal.isNegative()};Pe.prototype.isZero=function(){return this._intVal.isZero()};Pe.prototype.toString=function(){let e=this._intVal.toString();if(this._scale===0)return e;let t="";e.charAt(0)==="-"&&(t="-",e=e.substr(1));let r=e.length-this._scale;return r<=0&&(e=$m.stringRepeat("0",-r+1)+e,r=e.length-this._scale),t+e.substr(0,r)+"."+e.substr(r)};Pe.prototype.toNumber=function(){return parseFloat(this.toString())};Pe.prototype.toJSON=function(){return this.toString()};Gm.exports=Pe});var Zm=_((Gq,Qm)=>{"use strict";var Ge=ls(),zn=require("util"),Ga=se(),hs={months:Ga.allocBuffer(9),days:Ga.allocBuffer(9),nanoseconds:Ga.allocBuffer(9)},Wl=2147483647,Ql=Ge.fromInt(1e3),ja=Ql,za=Ql.multiply(ja),Wa=Ql.multiply(za),Qa=Ge.fromInt(60).multiply(Wa),jl=Ge.fromInt(60).multiply(Qa),zm=7,zl=12,Wm=/(\d+)(y|mo|w|d|h|s|ms|us|µs|ns|m)/gi,bN=/P((\d+)Y)?((\d+)M)?((\d+)D)?(T((\d+)H)?((\d+)M)?((\d+)S)?)?/,IN=/P(\d+)W/,AN=/P(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/;function hn(e,t,r){this.months=e,this.days=t,this.nanoseconds=typeof r=="number"?Ge.fromNumber(r):r}u(hn,"Duration");hn.prototype.equals=function(e){return e instanceof hn?this.months===e.months&&this.days===e.days&&this.nanoseconds.equals(e.nanoseconds):!1};hn.prototype.toBuffer=function(){let e=ps.writeVInt(Ge.fromNumber(this.months),hs.months),t=ps.writeVInt(Ge.fromNumber(this.days),hs.days),r=ps.writeVInt(this.nanoseconds,hs.nanoseconds),n=Ga.allocBufferUnsafe(e+t+r);hs.months.copy(n,0,0,e);let i=e;return hs.days.copy(n,i,0,t),i+=t,hs.nanoseconds.copy(n,i,0,r),n};hn.prototype.toString=function(){let e="";function t(i,s,o){return i===0||i<s?i:(e+=(i/s).toFixed(0)+o,i%s)}u(t,"append");function r(i,s,o){return i.equals(Ge.ZERO)||i.lessThan(s)?i:(e+=i.divide(s).toString()+o,i.modulo(s))}u(r,"append64"),(this.months<0||this.days<0||this.nanoseconds.isNegative())&&(e="-");let n=t(Math.abs(this.months),zl,"y");if(t(n,1,"mo"),t(Math.abs(this.days),1,"d"),!this.nanoseconds.equals(Ge.ZERO)){let i=this.nanoseconds.isNegative()?this.nanoseconds.negate():this.nanoseconds;n=r(i,jl,"h"),n=r(n,Qa,"m"),n=r(n,Wa,"s"),n=r(n,za,"ms"),n=r(n,ja,"us"),r(n,Ge.ONE,"ns")}return e};hn.fromBuffer=function(e){let t={value:0},r=ps.readVInt(e,t).toNumber(),n=ps.readVInt(e,t).toNumber(),i=ps.readVInt(e,t);return new hn(r,n,i)};hn.fromString=function(e){let t=e.charAt(0)==="-",r=t?e.substr(1):e;return r.charAt(0)==="P"?r.charAt(r.length-1)==="W"?RN(t,r):r.indexOf("-")>0?DN(t,r):NN(t,r):BN(t,r)};function BN(e,t){let r=new nt(e);Wm.lastIndex=0;let n;for(;(n=Wm.exec(t))&&n.length<=3;)r.add(n[1],n[2]);return r.build()}u(BN,"parseStandardFormat");function NN(e,t){let r=bN.exec(t);if(!r||r[0]!==t)throw new TypeError(zn.format("Unable to convert '%s' to a duration",t));let n=new nt(e);return r[1]&&n.addYears(r[2]),r[3]&&n.addMonths(r[4]),r[5]&&n.addDays(r[6]),r[7]&&(r[8]&&n.addHours(r[9]),r[10]&&n.addMinutes(r[11]),r[12]&&n.addSeconds(r[13])),n.build()}u(NN,"parseIso8601Format");function RN(e,t){let r=IN.exec(t);if(!r||r[0]!==t)throw new TypeError(zn.format("Unable to convert '%s' to a duration",t));return new nt(e).addWeeks(r[1]).build()}u(RN,"parseIso8601WeekFormat");function DN(e,t){let r=AN.exec(t);if(!r||r[0]!==t)throw new TypeError(zn.format("Unable to convert '%s' to a duration",t));return new nt(e).addYears(r[1]).addMonths(r[2]).addDays(r[3]).addHours(r[4]).addMinutes(r[5]).addSeconds(r[6]).build()}u(DN,"parseIso8601AlternativeFormat");function nt(e){this._isNegative=e,this._unitIndex=0,this._months=0,this._days=0,this._nanoseconds=Ge.ZERO,this._addMethods={y:this.addYears,mo:this.addMonths,w:this.addWeeks,d:this.addDays,h:this.addHours,m:this.addMinutes,s:this.addSeconds,ms:this.addMillis,\u00B5s:this.addMicros,us:this.addMicros,ns:this.addNanos},this._unitByIndex=[null,"years","months","weeks","days","hours","minutes","seconds","milliseconds","microseconds","nanoseconds"]}u(nt,"Builder");nt.prototype._validateOrder=function(e){if(e===this._unitIndex)throw new TypeError(zn.format("Invalid duration. The %s are specified multiple times",this._getUnitName(e)));if(e<=this._unitIndex)throw new TypeError(zn.format("Invalid duration. The %s should be after %s",this._getUnitName(this._unitIndex),this._getUnitName(e)));this._unitIndex=e};nt.prototype._validateMonths=function(e,t){this._validate32(e,(Wl-this._months)/t,"months")};nt.prototype._validateDays=function(e,t){this._validate32(e,(Wl-this._days)/t,"days")};nt.prototype._validateNanos=function(e,t){this._validate64(e,Ge.MAX_VALUE.subtract(this._nanoseconds).divide(t),"nanoseconds")};nt.prototype._validate32=function(e,t,r){if(e>t)throw new TypeError(zn.format("Invalid duration. The total number of %s must be less or equal to %s",r,Wl))};nt.prototype._validate64=function(e,t,r){if(e.greaterThan(t))throw new TypeError(zn.format("Invalid duration. The total number of %s must be less or equal to %s",r,Ge.MAX_VALUE.toString()))};nt.prototype._getUnitName=function(e){let t=this._unitByIndex[+e];if(!t)throw new Error("unknown unit index: "+e);return t};nt.prototype.add=function(e,t){let r=this._addMethods[t.toLowerCase()];if(!r)throw new TypeError(zn.format("Unknown duration symbol '%s'",t));return r.call(this,e)};nt.prototype.addYears=function(e){let t=+e;return this._validateOrder(1),this._validateMonths(t,zl),this._months+=t*zl,this};nt.prototype.addMonths=function(e){let t=+e;return this._validateOrder(2),this._validateMonths(t,1),this._months+=t,this};nt.prototype.addWeeks=function(e){let t=+e;return this._validateOrder(3),this._validateDays(t,zm),this._days+=t*zm,this};nt.prototype.addDays=function(e){let t=+e;return this._validateOrder(4),this._validateDays(t,1),this._days+=t,this};nt.prototype.addHours=function(e){let t=typeof e=="string"?Ge.fromString(e):e;return this._validateOrder(5),this._validateNanos(t,jl),this._nanoseconds=this._nanoseconds.add(t.multiply(jl)),this};nt.prototype.addMinutes=function(e){let t=typeof e=="string"?Ge.fromString(e):e;return this._validateOrder(6),this._validateNanos(t,Qa),this._nanoseconds=this._nanoseconds.add(t.multiply(Qa)),this};nt.prototype.addSeconds=function(e){let t=typeof e=="string"?Ge.fromString(e):e;return this._validateOrder(7),this._validateNanos(t,Wa),this._nanoseconds=this._nanoseconds.add(t.multiply(Wa)),this};nt.prototype.addMillis=function(e){let t=typeof e=="string"?Ge.fromString(e):e;return this._validateOrder(8),this._validateNanos(t,za),this._nanoseconds=this._nanoseconds.add(t.multiply(za)),this};nt.prototype.addMicros=function(e){let t=typeof e=="string"?Ge.fromString(e):e;return this._validateOrder(9),this._validateNanos(t,ja),this._nanoseconds=this._nanoseconds.add(t.multiply(ja)),this};nt.prototype.addNanos=function(e){let t=typeof e=="string"?Ge.fromString(e):e;return this._validateOrder(10),this._validateNanos(t,Ge.ONE),this._nanoseconds=this._nanoseconds.add(t),this};nt.prototype.build=function(){return this._isNegative?new hn(-this._months,-this._days,this._nanoseconds.negate()):new hn(this._months,this._days,this._nanoseconds)};var ps=function(){function e(p){return p.toUnsigned().shiftLeft(1).xor(p.shiftRight(63))}u(e,"encodeZigZag64");function t(p){return p.shiftRightUnsigned(1).xor(p.and(Ge.ONE).negate())}u(t,"decodeZigZag64");function r(p,y){return n(e(p),y)}u(r,"writeVInt");function n(p,y){let v=i(p);return v===1?(y[0]=p.getLowBits(),1):(s(p,v,y),v)}u(n,"writeUnsignedVInt");function i(p){return 639-o(p.or(Ge.ONE))*9>>6}u(i,"computeUnsignedVIntSize");function s(p,y,v){let m=y-1,x=p.getLowBits(),w,B=4;for(w=m;w>=0&&B-- >0;w--)v[w]=255&x,x>>=8;for(x=p.getHighBits();w>=0;w--)v[w]=255&x,x>>=8;v[0]|=a(m)}u(s,"encodeVInt");function o(p){if(p.equals(Ge.ZERO))return 64;let y=1,v=p.getHighBits();return v===0&&(y+=32,v=p.getLowBits()),v>>>16||(y+=16,v<<=16),v>>>24||(y+=8,v<<=8),v>>>28||(y+=4,v<<=4),v>>>30||(y+=2,v<<=2),y-=v>>>31,y}u(o,"numberOfLeadingZeros");function a(p){return~(255>>p)}u(a,"encodeExtraBytesToRead");function c(p,y){return t(l(p,y))}u(c,"readVInt");function l(p,y){let v=p[y.value++];if(!(v&128))return Ge.fromInt(v);let m=f(v),x=d(m),w=Ge.fromInt(m&g(x));for(let B=0;B<x;B++){let R=Ge.fromInt(p[y.value++]);w=w.shiftLeft(8).or(R)}return w}u(l,"readUnsignedVInt");function f(p){return p>127?p-256:p}u(f,"fromSignedByteToInt");function h(p){if(p===0)return 32;let y=1;return p>>>16||(y+=16,p<<=16),p>>>24||(y+=8,p<<=8),p>>>28||(y+=4,p<<=4),p>>>30||(y+=2,p<<=2),y-=p>>>31,y}u(h,"numberOfLeadingZerosInt32");function d(p){return h(~p)-24}u(d,"numberOfExtraBytesToRead");function g(p){return 255>>p}return u(g,"firstByteValueMask"),{readVInt:c,writeVInt:r}}();Qm.exports=hn});var Xm=_((zq,Ym)=>{"use strict";var Zl=se();function Xr(e){if(!(e instanceof Buffer)||e.length!==4&&e.length!==16)throw new TypeError("The ip address must contain 4 or 16 bytes");this.buffer=e,this.length=e.length,this.version=e.length===4?4:6}u(Xr,"InetAddress");Xr.fromString=function(e){if(!e)return new Xr(Zl.allocBufferFromArray([0,0,0,0]));let t=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,r=/^[\da-f:.]+$/i,n;if(t.test(e))return n=e.split("."),new Xr(Zl.allocBufferFromArray(n));if(!r.test(e))throw new TypeError("Value could not be parsed as InetAddress: "+e);if(n=e.split(":"),n.length<3)throw new TypeError("Value could not be parsed as InetAddress: "+e);let i=Zl.allocBufferUnsafe(16),s=8-n.length+1,o=!1,a=0,c=t.test(n[n.length-1]);c&&(s-=1);function l(f){i.writeUInt8(+f,a++)}u(l,"writeItem");for(let f=0;f<n.length;f++){let h=n[f];if(h){if(c&&f===n.length-1){h.split(".").forEach(l);break}i.writeUInt16BE(parseInt(h,16),a),a=a+2;continue}o&&(s=1),o=!0;for(let d=0;d<s;d++)i[a++]=0,i[a++]=0}if(c&&!LN(i))throw new TypeError("Only IPv4-Mapped IPv6 addresses are allowed as IPv6 address with embedded IPv4 address");return new Xr(i)};Xr.prototype.equals=function(e){return e instanceof Xr?this.buffer.length===e.buffer.length&&this.buffer.toString("hex")===e.buffer.toString("hex"):!1};Xr.prototype.getBuffer=function(){return this.buffer};Xr.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};Xr.prototype.toString=function(e){if(e==="hex")return this.buffer.toString("hex");if(this.buffer.length===4)return this.buffer[0]+"."+this.buffer[1]+"."+this.buffer[2]+"."+this.buffer[3];let t=-1,r={length:0,start:-1};function n(s){if(t>=0){let o=s-t;o>r.length&&(r.length=o,r.start=t,t=-1)}}u(n,"checkLongest");for(let s=0;s<this.buffer.length;s=s+2){if(this.buffer[s]===0&&this.buffer[s+1]===0){t<0&&(t=s),s===this.buffer.length-2&&n(s+2);continue}n(s)}let i="";for(let s=0;s<this.buffer.length;s=s+2){if(s===r.start){i+=":";continue}s<r.start+r.length&&s>r.start||(i.length>0&&(i+=":"),i+=(this.buffer[s]<<8|this.buffer[s+1]).toString(16))}return i.charAt(i.length-1)===":"&&(i+=":"),i};Xr.prototype.toJSON=function(){return this.toString()};function LN(e){for(let t=0;t<e.length-6;t++)if(e[t]!==0)return!1;return!(e[10]!==255||e[11]!==255)}u(LN,"isValidIPv4Mapped");Ym.exports=Xr});var rv=_((Qq,tv)=>{"use strict";var ON=require("util"),Jm=se(),Ya=864e5,ev=Math.pow(2,31);function Et(e,t,r){if(typeof e=="number"&&typeof t=="number"&&typeof r=="number"){if(this.date=new Date,this.date.setUTCHours(0,0,0,0),this.date.setUTCFullYear(e,t-1,r),isNaN(this.date.getTime()))throw new Error(ON.format("%d-%d-%d does not form a valid ES5 date!",e,t,r))}else if(typeof t>"u"&&typeof r>"u"&&typeof e=="number"){if(e<-2147483648||e>2147483647)throw new Error("You must provide a valid value for days since epoch (-2147483648 <= value <= 2147483647).");this.date=new Date(e*Ya)}if(typeof this.date>"u")throw new Error("You must provide a valid year, month and day");this._value=isNaN(this.date.getTime())?e:null,this.year=this.date.getUTCFullYear(),this.month=this.date.getUTCMonth()+1,this.day=this.date.getUTCDate()}u(Et,"LocalDate");Et.now=function(){return Et.fromDate(new Date)};Et.utcNow=function(){return new Et(Date.now())};Et.fromDate=function(e){if(isNaN(e.getTime()))throw new TypeError("Invalid date: "+e);return new Et(e.getFullYear(),e.getMonth()+1,e.getDate())};Et.fromString=function(e){if((e.match(/-/g)||[]).length>=2){let r=1;e[0]==="-"&&(e=e.substring(1),r=-1);let n=e.split("-");return new Et(r*parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10))}if(e.match(/^-?\d+$/))return new Et(parseInt(e,10));throw new Error("Invalid input '"+e+"'.")};Et.fromBuffer=function(e){return new Et(e.readUInt32BE(0)-ev)};Et.prototype.compare=function(e){let t=isNaN(this.date.getTime())?this._value*Ya:this.date.getTime(),r=isNaN(e.date.getTime())?e._value*Ya:e.date.getTime(),n=t-r;return n<0?-1:n>0?1:0};Et.prototype.equals=function(e){return e instanceof Et&&this.compare(e)===0};Et.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};Et.prototype.toBuffer=function(){let t=(isNaN(this.date.getTime())?this._value:Math.floor(this.date.getTime()/Ya))+ev,r=Jm.allocBufferUnsafe(4);return r.writeUInt32BE(t,0),r};Et.prototype.toString=function(){let e;return isNaN(this.date.getTime())?this._value.toString():(this.year<0?e="-"+Za((this.year*-1).toString(),4):e=Za(this.year.toString(),4),e+="-"+Za(this.month.toString(),2)+"-"+Za(this.day.toString(),2),e)};Et.prototype.toJSON=function(){return this.toString()};function Za(e,t){return e.length>=t?e:Jm.stringRepeat("0",t-e.length)+e}u(Za,"fillZeros");tv.exports=Et});var sv=_((Yq,iv)=>{"use strict";var Wn=ls(),Yl=require("util"),Xl=se(),FN=Wn.fromString("86399999999999"),nv=Wn.fromNumber(1e9),PN=Wn.fromNumber(1e6),kN=864e5;function dt(e){if(!(e instanceof Wn))throw new Error("You must specify a Long value as totalNanoseconds");if(e.lessThan(Wn.ZERO)||e.greaterThan(FN))throw new Error("Total nanoseconds out of range");this.value=e,this.hour=this._getParts()[0],this.minute=this._getParts()[1],this.second=this._getParts()[2],this.nanosecond=this._getParts()[3]}u(dt,"LocalTime");dt.fromString=function(e){if(typeof e!="string")throw new Error("Argument type invalid: "+Yl.inspect(e));let t=e.split(":"),r=parseInt(t[0],10)*36e5+parseInt(t[1],10)*6e4,n;if(t.length===3){let i=t[2].split(".");r+=parseInt(i[0],10)*1e3,i.length===2&&(n=i[1],n=n+Xl.stringRepeat("0",9-n.length))}return dt.fromMilliseconds(r,parseInt(n,10)||0)};dt.now=function(e){return dt.fromDate(new Date,e)};dt.fromDate=function(e,t){if(!Yl.isDate(e))throw new Error("Not a valid date");let r=(e.getTime()+e.getTimezoneOffset()*-6e4)%kN;return dt.fromMilliseconds(r,t)};dt.fromMilliseconds=function(e,t){return typeof t!="number"&&(t=0),new dt(Wn.fromNumber(e).multiply(PN).add(Wn.fromNumber(t)))};dt.fromBuffer=function(e){if(!(e instanceof Buffer))throw new TypeError("Expected Buffer, obtained "+Yl.inspect(e));return new dt(new Wn(e.readInt32BE(4),e.readInt32BE(0)))};dt.prototype.compare=function(e){return this.value.compare(e.value)};dt.prototype.equals=function(e){return e instanceof dt&&this.compare(e)===0};dt.prototype.getTotalNanoseconds=function(){return this.value};dt.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};dt.prototype.toBuffer=function(){let e=Xl.allocBufferUnsafe(8);return e.writeUInt32BE(this.value.getHighBitsUnsigned(),0),e.writeUInt32BE(this.value.getLowBitsUnsigned(),4),e};dt.prototype.toString=function(){return qN(this._getParts())};dt.prototype.toJSON=function(){return this.toString()};dt.prototype._getParts=function(){if(!this._partsCache){let e=[0,0,0,0],t=this.value.div(nv);e[3]=this.value.subtract(t.multiply(nv)).toNumber(),e[2]=t.toNumber(),e[2]>=60&&(e[1]=Math.floor(e[2]/60),e[2]=e[2]%60),e[1]>=60&&(e[0]=Math.floor(e[1]/60),e[1]=e[1]%60),this._partsCache=e}return this._partsCache};function qN(e){let t;if(e[0]<10?t="0"+e[0]+":":t=e[0]+":",e[1]<10?t+="0"+e[1]+":":t+=e[1]+":",e[2]<10?t+="0"+e[2]:t+=e[2],e[3]>0){let r=e[3].toString();r.length<9&&(r=Xl.stringRepeat("0",9-r.length)+r);let n;for(let i=r.length-1;i>0&&r[i]==="0";i--)n=i;n&&(r=r.substring(0,n)),t+="."+r}return t}u(qN,"formatTime");iv.exports=dt});var av=_((Jq,ov)=>{"use strict";var UN=se();function ds(e,t,r,n,i,s){n===-1&&(n=0),this.info={queriedHost:t,triedHosts:r,speculativeExecutions:n,achievedConsistency:i,traceId:null,warnings:null,customPayload:null,isSchemaInAgreement:s},e.flags&&(this.info.traceId=e.flags.traceId,this.info.warnings=e.flags.warnings,this.info.customPayload=e.flags.customPayload),this.rows=e.rows,this.rowLength=this.rows?this.rows.length:e.rowLength,this.columns=null,this.pageState=null,this.nextPage=void 0;let o=e.meta;o&&(this.columns=o.columns,o.pageState&&(this.pageState=o.pageState.toString("hex"),Object.defineProperty(this,"rawPageState",{value:o.pageState,enumerable:!1})))}u(ds,"ResultSet");ds.prototype.first=function(){return this.rows&&this.rows.length?this.rows[0]:null};ds.prototype.getPageState=function(){return this.pageState};ds.prototype.getColumns=function(){return this.columns};ds.prototype.wasApplied=function(){if(!this.rows||this.rows.length===0)return!0;let t=this.rows[0]["[applied]"];return typeof t=="boolean"?t:!0};ds.prototype[Symbol.iterator]=u(function(){return this.rows?this.rows[Symbol.iterator]():UN.emptyArray[Symbol.iterator]()},"getIterator");ov.exports=ds});var lv=_((tU,cv)=>{"use strict";var VN=require("util"),uv=require("stream");function Io(e){uv.Readable.call(this,e),this.buffer=[],this.paused=!0}u(Io,"ResultStream");VN.inherits(Io,uv.Readable);Io.prototype._read=function(){for(this.paused=!1,this.buffer.length===0&&(this._readableState.reading=!1);!this.paused&&this.buffer.length>0;)this.paused=!this.push(this.buffer.shift());!this.paused&&!this.buffer.length&&this._readNext&&(this._readNext(),this._readNext=null)};Io.prototype._valve=function(e){this._readNext=null,e&&(this.paused||this.buffer.length?this._readNext=e:e())};Io.prototype.add=function(e){this.buffer.push(e),this.read(0)};cv.exports=Io});var hv=_((nU,fv)=>{"use strict";function Ao(e){if(!e)throw new Error("Columns not defined");Object.defineProperty(this,"__columns",{value:e,enumerable:!1,writable:!1})}u(Ao,"Row");Ao.prototype.get=function(e){return typeof e=="number"?this[this.__columns[e].name]:this[e]};Ao.prototype.values=function(){let e=[];return this.forEach(function(t){e.push(t)}),e};Ao.prototype.keys=function(){let e=[];return this.forEach(function(t,r){e.push(r)}),e};Ao.prototype.forEach=function(e){for(let t in this)this.hasOwnProperty(t)&&e(this[t],t)};fv.exports=Ao});var dv=_((sU,pv)=>{"use strict";function Bi(){if(this.elements=Array.prototype.slice.call(arguments),this.elements.length===0)throw new TypeError("Tuple must contain at least one value");this.length=this.elements.length}u(Bi,"Tuple");Bi.fromArray=function(e){return new(Function.prototype.bind.apply(Bi,[null].concat(e)))};Bi.prototype.get=function(e){return this.elements[e||0]};Bi.prototype.toString=function(){return"("+this.elements.reduce(function(e,t,r){return e+(r>0?",":"")+t.toString()},"")+")"};Bi.prototype.toJSON=function(){return this.elements};Bi.prototype.values=function(){return this.elements.slice(0)};pv.exports=Bi});var Ve=_(Ne=>{"use strict";var Qn=require("util"),Bo=Ue(),gv=km(),Jl=Kl(),eu=Mm(),No=se(),Or=ls(),Fr={any:0,one:1,two:2,three:3,quorum:4,all:5,localQuorum:6,eachQuorum:7,serial:8,localSerial:9,localOne:10},Pr={};Pr[Fr.any]="ANY";Pr[Fr.one]="ONE";Pr[Fr.two]="TWO";Pr[Fr.three]="THREE";Pr[Fr.quorum]="QUORUM";Pr[Fr.all]="ALL";Pr[Fr.localQuorum]="LOCAL_QUORUM";Pr[Fr.eachQuorum]="EACH_QUORUM";Pr[Fr.serial]="SERIAL";Pr[Fr.localSerial]="LOCAL_SERIAL";Pr[Fr.localOne]="LOCAL_ONE";var Ja={custom:0,ascii:1,bigint:2,blob:3,boolean:4,counter:5,decimal:6,double:7,float:8,int:9,text:10,timestamp:11,uuid:12,varchar:13,varint:14,timeuuid:15,inet:16,date:17,time:18,smallint:19,tinyint:20,list:32,map:33,set:34,udt:48,tuple:49,getByName:function(e){if(e=e.toLowerCase(),e.indexOf("<")>0){let r=/^(list|set)<(.+)>$/.exec(e);if(r)return{code:this[r[1]],info:this.getByName(r[2])};let n=/^(map)< *(.+) *, *(.+)>$/.exec(e);if(n)return{code:this[n[1]],info:[this.getByName(n[2]),this.getByName(n[3])]};let i=/^(udt)<(.+)>$/.exec(e);if(i)return{code:this[i[1]],info:i[2]};let s=/^(tuple)<(.+)>$/.exec(e);if(s)return{code:this[s[1]],info:s[2].split(",").map(function(o){return this.getByName(o.trim())},this)}}let t={code:this[e],info:null};if(typeof t.code!="number")throw new TypeError("Data type with name "+e+" not valid");return t}},MN=function(){let e={};for(let t in Ja){if(!Ja.hasOwnProperty(t))continue;let r=Ja[t];typeof r=="number"&&(e[r]=t)}return e}(),KN={local:0,remote:1,ignored:2},HN={error:0,startup:1,ready:2,authenticate:3,credentials:4,options:5,supported:6,query:7,result:8,prepare:9,execute:10,register:11,event:12,batch:13,authChallenge:14,authResponse:15,authSuccess:16,isInRange:function(e){return e>this.error&&e>this.event}},$N={topologyChange:"TOPOLOGY_CHANGE",statusChange:"STATUS_CHANGE",schemaChange:"SCHEMA_CHANGE"},GN={serverError:0,protocolError:10,badCredentials:256,unavailableException:4096,overloaded:4097,isBootstrapping:4098,truncateError:4099,writeTimeout:4352,readTimeout:4608,readFailure:4864,functionFailure:5120,writeFailure:5376,syntaxError:8192,unauthorized:8448,invalid:8704,configError:8960,alreadyExists:9216,unprepared:9472},jN={voidResult:1,rows:2,setKeyspace:3,prepared:4,schemaChange:5},zN={compression:1,tracing:2,customPayload:4,warning:8},WN=Object.freeze({unset:!0}),QN=Or.fromInt(1e3),Xa=0;function ZN(e,t,r){let n,i,s,o;e&&(typeof e.msecs=="number"&&(n=new Date(e.msecs)),e.msecs instanceof Date&&(n=e.msecs),Qn.isArray(e.node)&&(s=No.allocBufferFromArray(e.node)),typeof e.clockseq=="number"&&(o=No.allocBufferUnsafe(2),o.writeUInt16BE(e.clockseq,0)),typeof e.nsecs=="number"&&(i=e.nsecs));let a=new gv(n,i,s,o);return t instanceof Buffer?(a.getBuffer().copy(t,r||0),t):a.toString()}u(ZN,"timeuuid");function YN(e,t,r){let n;return e&&Qn.isArray(e.random)&&(n=new Jl(No.allocBufferFromArray(e.random))),n||(n=Jl.random()),t instanceof Buffer?(n.getBuffer().copy(t,r||0),t):n.toString()}u(YN,"uuid");function ef(e){if(!e||typeof e.code!="number")throw new Bo.ArgumentError("Invalid signature type definition");let t=MN[e.code];if(!t)throw new Bo.ArgumentError(Qn.format("Type with code %d not found",e.code));return e.info?Qn.isArray(e.info)?t+"<"+e.info.map(function(r){return ef(r)}).join(", ")+">":typeof e.info.code=="number"?t+"<"+ef(e.info)+">":t:t}u(ef,"getDataTypeNameByCode");function Ni(e,t,r,n,i){this.version=e,this.flags=t,this.streamId=r,this.opcode=n,this.bodyLength=i}u(Ni,"FrameHeader");Ni.size=function(e){return eu.uses2BytesStreamIds(e)?9:8};Ni.getProtocolVersion=function(e){return e[0]&127};Ni.fromBuffer=function(e,t){let r=0;t||(t=0);let n=e[t++]&127,i=e.readUInt8(t++);return eu.uses2BytesStreamIds(n)?(r=e.readInt16BE(t),t+=2):r=e.readInt8(t++),new Ni(n,i,r,e.readUInt8(t++),e.readUInt32BE(t))};Ni.prototype.toBuffer=function(){let e=No.allocBufferUnsafe(Ni.size(this.version));e.writeUInt8(this.version,0),e.writeUInt8(this.flags,1);let t=3;return eu.uses2BytesStreamIds(this.version)?(e.writeInt16BE(this.streamId,2),t=4):e.writeInt8(this.streamId,2),e.writeUInt8(this.opcode,t++),e.writeUInt32BE(this.bodyLength,t),e};Or.fromBuffer=function(e){if(!(e instanceof Buffer))throw new TypeError("Expected Buffer, obtained "+Qn.inspect(e));return new Or(e.readInt32BE(4),e.readInt32BE(0))};Or.toBuffer=function(e){if(!(e instanceof Or))throw new TypeError("Expected Long, obtained "+Qn.inspect(e));let t=No.allocBufferUnsafe(8);return t.writeUInt32BE(e.getHighBitsUnsigned(),0),t.writeUInt32BE(e.getLowBitsUnsigned(),4),t};Or.prototype.inspect=function(){return"Long: "+this.toString()};Or.prototype.toJSON=function(){return this.toString()};function XN(e,t){e||(e=new Date);let r=Or.ZERO;return typeof t=="number"&&t>=0&&t<1e3?r=Or.fromInt(t):(Xa>999&&(Xa=0),r=Or.fromInt(Xa),Xa++),Or.fromNumber(e.getTime()).multiply(QN).add(r)}u(XN,"generateTimestamp");function yv(e){yv.super_.call(this,e.message,this.constructor),this.internalError=e}u(yv,"QueryParserError");Qn.inherits(yv,Bo.DriverError);function tf(e){tf.super_.call(this,e,this.constructor),this.info="Represents an error that happens when the maximum amount of time for an operation passed."}u(tf,"TimeoutError");Qn.inherits(tf,Bo.DriverError);Ne.opcodes=HN;Ne.consistencies=Fr;Ne.consistencyToString=Pr;Ne.dataTypes=Ja;Ne.getDataTypeNameByCode=ef;Ne.distance=KN;Ne.frameFlags=zN;Ne.protocolEvents=$N;Ne.protocolVersion=eu;Ne.responseErrorCodes=GN;Ne.resultKind=jN;Ne.timeuuid=ZN;Ne.uuid=YN;Ne.BigDecimal=jm();Ne.Duration=Zm();Ne.FrameHeader=Ni;Ne.InetAddress=Xm();Ne.Integer=Gl();Ne.LocalDate=rv();Ne.LocalTime=sv();Ne.Long=Or;Ne.ResultSet=av();Ne.ResultStream=lv();Ne.Row=hv();Ne.DriverError=Bo.DriverError;Ne.TimeoutError=tf;Ne.TimeUuid=gv;Ne.Tuple=dv();Ne.Uuid=Jl;Ne.unset=WN;Ne.generateTimestamp=XN});var vv=_(ms=>{"use strict";var Ro=require("util"),gs=Ve(),mv=se(),JN=Ue(),rf=Object.freeze({done:!0});function Rn(){}u(Rn,"LoadBalancingPolicy");Rn.prototype.init=function(e,t,r){this.client=e,this.hosts=t,r()};Rn.prototype.getDistance=function(e){return gs.distance.local};Rn.prototype.newQueryPlan=function(e,t,r){r(new Error("You must implement a query plan for the LoadBalancingPolicy class"))};Rn.prototype.getOptions=function(){return new Map};function nf(){this.index=0}u(nf,"RoundRobinPolicy");Ro.inherits(nf,Rn);nf.prototype.newQueryPlan=function(e,t,r){if(!this.hosts)return r(new Error("Load balancing policy not initialized"));let n=this.hosts.values(),i=this,s=0,o=i.index%n.length;i.index+=1,i.index>=mv.maxInt&&(i.index=0),r(null,{next:function(){return++s>n.length?rf:{value:n[o++%n.length],done:!1}}})};function Dn(e){this.localDc=e,this.index=0,this.localHostsArray=null}u(Dn,"DCAwareRoundRobinPolicy");Ro.inherits(Dn,Rn);Dn.prototype.init=function(e,t,r){if(this.client=e,this.hosts=t,t.on("add",this._cleanHostCache.bind(this)),t.on("remove",this._cleanHostCache.bind(this)),e&&e.options&&(this.localDc&&!e.options.localDataCenter&&this.client.log("info","Local data center '"+this.localDc+"' was provided as an argument to DCAwareRoundRobinPolicy. It is more preferable to specify the local data center using 'localDataCenter' in Client options instead when your application is targeting a single data center."),this.localDc=this.localDc||e.options.localDataCenter),!this.localDc)return r(new JN.ArgumentError("'localDataCenter' is not defined in Client options and also was not specified in constructor. At least one is required."));r()};Dn.prototype.getDistance=function(e){return e.datacenter?e.datacenter===this.localDc?gs.distance.local:gs.distance.remote:gs.distance.ignored};Dn.prototype._cleanHostCache=function(){this.localHostsArray=null};Dn.prototype._resolveLocalHosts=function(){let e=this.hosts.values();this.localHostsArray||(this.localHostsArray=[],e.forEach(function(t){t.datacenter&&t.datacenter===this.localDc&&this.localHostsArray.push(t)},this))};Dn.prototype.newQueryPlan=function(e,t,r){if(!this.hosts)return r(new Error("Load balancing policy not initialized"));this.index+=1,this.index>=mv.maxInt&&(this.index=0),this._resolveLocalHosts();let n=this.localHostsArray,i=this.index,s=0;r(null,{next:function(){let o;return s++<n.length?(o=n[i++%n.length],{value:o,done:!1}):rf}})};Dn.prototype.getOptions=function(){return new Map([["localDataCenter",this.localDc]])};function ys(e){if(!e)throw new Error("You must specify a child load balancing policy");this.childPolicy=e}u(ys,"TokenAwarePolicy");Ro.inherits(ys,Rn);ys.prototype.init=function(e,t,r){this.client=e,this.hosts=t,this.childPolicy.init(e,t,r)};ys.prototype.getDistance=function(e){return this.childPolicy.getDistance(e)};ys.prototype.newQueryPlan=function(e,t,r){let n;t&&(n=t.getRoutingKey(),t.getKeyspace()&&(e=t.getKeyspace()));let i;if(n&&(i=this.client.getReplicas(e,n)),!n||!i)return this.childPolicy.newQueryPlan(e,t,r);new sf(e,t,i,this.childPolicy).iterate(r)};function sf(e,t,r,n){this.keyspace=e,this.childPolicy=n,this.options=t,this.localReplicas=[],this.replicaIndex=0,this.replicaMap={},this.childIterator=null;for(let i=0;i<r.length;i++){let s=r[i];this.childPolicy.getDistance(s)===gs.distance.local&&(this.replicaMap[s.address]=!0,this.localReplicas.push(s))}this.startIndex=Math.floor(Math.random()*this.localReplicas.length)}u(sf,"TokenAwareIterator");sf.prototype.iterate=function(e){let t=this;this.childPolicy.newQueryPlan(this.keyspace,this.options,function(r,n){if(r)return e(r);t.childIterator=n,e(null,{next:function(){return t.computeNext()}})})};sf.prototype.computeNext=function(){let e;if(this.replicaIndex<this.localReplicas.length)return e=this.localReplicas[(this.startIndex+this.replicaIndex++)%this.localReplicas.length],{value:e,done:!1};let t;for(;(t=this.childIterator.next())&&!t.done;)if(!this.replicaMap[t.value.address])return t;return rf};ys.prototype.getOptions=function(){let e=new Map([["childPolicy",this.childPolicy.constructor!==void 0?this.childPolicy.constructor.name:null]]);return this.childPolicy instanceof Dn&&e.set("localDataCenter",this.childPolicy.localDc),e};function Zn(e,t){if(!e)throw new Error("You must specify a child load balancing policy");if(!Ro.isArray(t))throw new Error("You must provide the white list of host addresses");this.childPolicy=e;let r={};t.forEach(function(n){r[n]=!0}),this.whiteList=r}u(Zn,"WhiteListPolicy");Ro.inherits(Zn,Rn);Zn.prototype.init=function(e,t,r){this.childPolicy.init(e,t,r)};Zn.prototype.getDistance=function(e){return this._contains(e)?this.childPolicy.getDistance(e):gs.distance.ignored};Zn.prototype._contains=function(e){return!!this.whiteList[e.address]};Zn.prototype.newQueryPlan=function(e,t,r){let n=this;this.childPolicy.newQueryPlan(e,t,function(i,s){if(i)return r(i);r(null,n._filter(s))})};Zn.prototype._filter=function(e){let t=this;return{next:function(){let r=e.next();return!r.done&&!t._contains(r.value)?this.next():r}}};Zn.prototype.getOptions=function(){return new Map([["childPolicy",this.childPolicy.constructor!==void 0?this.childPolicy.constructor.name:null],["whitelist",Object.keys(this.whiteList)]])};ms.DCAwareRoundRobinPolicy=Dn;ms.LoadBalancingPolicy=Rn;ms.RoundRobinPolicy=nf;ms.TokenAwarePolicy=ys;ms.WhiteListPolicy=Zn});var Cv=_(ru=>{"use strict";var Ev=require("util");function Do(){}u(Do,"ReconnectionPolicy");Do.prototype.newSchedule=function(){throw new Error("You must implement a new schedule for the Reconnection class")};Do.prototype.getOptions=function(){return new Map};function tu(e){this.delay=e}u(tu,"ConstantReconnectionPolicy");Ev.inherits(tu,Do);tu.prototype.newSchedule=function(){let e=this;return{next:function(){return{value:e.delay,done:!1}}}};tu.prototype.getOptions=function(){return new Map([["delay",this.delay]])};function Lo(e,t,r){this.baseDelay=e,this.maxDelay=t,this.startWithNoDelay=r}u(Lo,"ExponentialReconnectionPolicy");Ev.inherits(Lo,Do);Lo.prototype.newSchedule=function*(){let e=this.startWithNoDelay?-1:0;for(;;){let t=0;e>=64?t=this.maxDelay:e!==-1&&(t=Math.min(Math.pow(2,e)*this.baseDelay,this.maxDelay)),e++,yield this._addJitter(t)}};Lo.prototype._addJitter=function(e){if(e===0)return e;let t=.85,r=.3;return!this.startWithNoDelay&&e===this.baseDelay?(t=1,r=.15):e===this.maxDelay&&(r=.15),Math.floor(e*(Math.random()*r+t))};Lo.prototype.getOptions=function(){return new Map([["baseDelay",this.baseDelay],["maxDelay",this.maxDelay],["startWithNoDelay",this.startWithNoDelay]])};ru.ReconnectionPolicy=Do;ru.ConstantReconnectionPolicy=tu;ru.ExponentialReconnectionPolicy=Lo});var af=_(of=>{"use strict";var eR=require("util");function kr(){}u(kr,"RetryPolicy");kr.prototype.onUnavailable=function(e,t,r,n){return e.nbRetry>0?this.rethrowResult():this.retryResult(void 0,!1)};kr.prototype.onReadTimeout=function(e,t,r,n,i){return e.nbRetry>0?this.rethrowResult():r>=n&&!i?this.retryResult():this.rethrowResult()};kr.prototype.onWriteTimeout=function(e,t,r,n,i){return e.nbRetry>0?this.rethrowResult():i==="BATCH_LOG"?this.retryResult():this.rethrowResult()};kr.prototype.onRequestError=function(e,t,r){return this.retryResult(void 0,!1)};kr.prototype.retryResult=function(e,t){return{decision:kr.retryDecision.retry,consistency:e,useCurrentHost:t!==!1}};kr.prototype.rethrowResult=function(){return{decision:kr.retryDecision.rethrow}};kr.retryDecision={rethrow:0,retry:1,ignore:2};function vs(e){this._childPolicy=e||new kr}u(vs,"IdempotenceAwareRetryPolicy");eR.inherits(vs,kr);vs.prototype.onReadTimeout=function(e,t,r,n,i){return this._childPolicy.onReadTimeout(e,t,r,n,i)};vs.prototype.onRequestError=function(e,t,r){return e.executionOptions.isIdempotent()?this._childPolicy.onRequestError(e,t,r):this.rethrowResult()};vs.prototype.onUnavailable=function(e,t,r,n){return this._childPolicy.onUnavailable(e,t,r,n)};vs.prototype.onWriteTimeout=function(e,t,r,n,i){return e.executionOptions.isIdempotent()?this._childPolicy.onWriteTimeout(e,t,r,n,i):this.rethrowResult()};of.RetryPolicy=kr;of.IdempotenceAwareRetryPolicy=vs});var Tv=_(iu=>{"use strict";var xv=require("util"),Sv=Ue();function Ri(){}u(Ri,"SpeculativeExecutionPolicy");Ri.prototype.init=function(e){};Ri.prototype.shutdown=function(){};Ri.prototype.newPlan=function(e,t){throw new Error("You must implement newPlan() method in the SpeculativeExecutionPolicy")};Ri.prototype.getOptions=function(){return new Map};function uf(){this._plan={nextExecution:function(){return-1}}}u(uf,"NoSpeculativeExecutionPolicy");xv.inherits(uf,Ri);uf.prototype.newPlan=function(){return this._plan};function nu(e,t){if(!(e>=0))throw new Sv.ArgumentError("delay must be a positive number or zero");if(!(t>0))throw new Sv.ArgumentError("maxSpeculativeExecutions must be a positive number");this._delay=e,this._maxSpeculativeExecutions=t}u(nu,"ConstantSpeculativeExecutionPolicy");xv.inherits(nu,Ri);nu.prototype.newPlan=function(){let e=0,t=this;return{nextExecution:function(){return e++<t._maxSpeculativeExecutions?t._delay:-1}}};nu.prototype.getOptions=function(){return new Map([["delay",this._delay],["maxSpeculativeExecutions",this._maxSpeculativeExecutions]])};iu.NoSpeculativeExecutionPolicy=uf;iu.SpeculativeExecutionPolicy=Ri;iu.ConstantSpeculativeExecutionPolicy=nu});var wv=_(ff=>{"use strict";var _v=require("util"),cf=Ve().Long,tR=Ue(),rR=9007199254740,nR=cf.fromInt(1e3);function lf(){}u(lf,"TimestampGenerator");lf.prototype.next=function(e){throw new Error("next() must be implemented")};function Oo(e,t){if(e<0)throw new tR.ArgumentError("warningThreshold can not be lower than 0");this._warningThreshold=e||1e3,this._minLogInterval=1e3,typeof t=="number"&&(this._minLogInterval=t),this._micros=-1,this._lastDate=0,this._lastLogDate=0}u(Oo,"MonotonicTimestampGenerator");_v.inherits(Oo,lf);Oo.prototype.getDate=function(){return Date.now()};Oo.prototype.next=function(e){let t=this.getDate(),r=0;if(t>this._lastDate)return this._micros=0,this._lastDate=t,this._generateMicroseconds();t<this._lastDate&&(r=this._lastDate-t,t=this._lastDate),++this._micros===1e3&&(this._micros=0,t===this._lastDate&&(t++,r++));let n=this._lastDate;this._lastDate=t;let i=this._generateMicroseconds();if(r>=this._warningThreshold){let s=Date.now();if(this._minLogInterval>0&&this._lastLogDate+this._minLogInterval<=s){let o=_v.format("Timestamp generated using current date was %d milliseconds behind the last generated timestamp (which millisecond portion was %d), the returned value (%s) is being artificially incremented to guarantee monotonicity.",r,n,i);this._lastLogDate=s,e.log("warning",o)}}return i};Oo.prototype._generateMicroseconds=function(){return this._lastDate<rR?this._lastDate*1e3+this._micros:cf.fromNumber(this._lastDate).multiply(nR).add(cf.fromInt(this._micros))};ff.TimestampGenerator=lf;ff.MonotonicTimestampGenerator=Oo});var hf=_(xr=>{"use strict";var iR=xr.addressResolution=bm(),bv=xr.loadBalancing=vv(),sR=xr.reconnection=Cv(),oR=xr.retry=af(),aR=xr.speculativeExecution=Tv(),uR=xr.timestampGeneration=wv();xr.defaultAddressTranslator=function(){return new iR.AddressTranslator};xr.defaultLoadBalancingPolicy=function(){return new bv.TokenAwarePolicy(new bv.DCAwareRoundRobinPolicy)};xr.defaultRetryPolicy=function(){return new oR.RetryPolicy};xr.defaultReconnectionPolicy=function(){return new sR.ExponentialReconnectionPolicy(1e3,10*60*1e3,!1)};xr.defaultSpeculativeExecutionPolicy=function(){return new aR.NoSpeculativeExecutionPolicy};xr.defaultTimestampGenerator=function(){return new uR.MonotonicTimestampGenerator}});var gf=_((CU,Iv)=>{"use strict";var df=class df{onSuccess(t,r,n,i,s,o,a){}onError(t,r,n,i,s,o,a){}shutdown(){}};u(df,"RequestTracker");var pf=df;Iv.exports=pf});var Lv=_((xU,Dv)=>{"use strict";var cR=require("events"),lR=gf(),fR=Ue(),Fo=require("util").format,hR=1e6,pR=500,dR=50,Av=200,mf=class mf extends lR{constructor(t){if(super(),!t)throw new fR.ArgumentError("RequestLogger options parameter is required");this._options=t,this.logNormalRequests=this._options.logNormalRequests,this.logErroredRequests=this._options.logErroredRequests,this.emitter=new cR.EventEmitter}onSuccess(t,r,n,i,s,o,a){this._options.slowThreshold>0&&Es(a)>this._options.slowThreshold?this._logSlow(t,r,n,i,s,o,a):this._options.requestSizeThreshold>0&&s>this._options.requestSizeThreshold?this._logLargeRequest(t,r,n,i,s,o,a):this.logNormalRequests&&this._logNormalRequest(t,r,n,i,s,o,a)}onError(t,r,n,i,s,o,a){this._options.requestSizeThreshold>0&&s>this._options.requestSizeThreshold?this._logLargeErrorRequest(t,r,n,i,s,o,a):this.logErroredRequests&&this._logErrorRequest(t,r,n,i,s,o,a)}_logSlow(t,r,n,i,s,o,a){let c=Fo("[%s] Slow request, took %d ms (%s): %s",t.address,Math.floor(Es(a)),ko(s,o),Po(r,n,i,this._options));this.emitter.emit("slow",c)}_logLargeRequest(t,r,n,i,s,o,a){let c=Fo("[%s] Request exceeded length, %s (took %d ms): %s",t.address,ko(s,o),~~Es(a),Po(r,n,i,this._options));this.emitter.emit("large",c)}_logNormalRequest(t,r,n,i,s,o,a){let c=Fo("[%s] Request completed normally, took %d ms (%s): %s",t.address,~~Es(a),ko(s,o),Po(r,n,i,this._options));this.emitter.emit("normal",c)}_logLargeErrorRequest(t,r,n,i,s,o,a){let c=this._options.messageMaxErrorStackTraceLength||Av,l=Fo("[%s] Request exceeded length and execution failed, %s (took %d ms): %s; error: %s",t.address,ko(s),~~Es(a),Po(r,n,i,this._options),o.stack.substr(0,c));this.emitter.emit("large",l)}_logErrorRequest(t,r,n,i,s,o,a){let c=this._options.messageMaxErrorStackTraceLength||Av,l=Fo("[%s] Request execution failed, took %d ms (%s): %s; error: %s",t.address,~~Es(a),ko(s),Po(r,n,i,this._options),o.stack.substr(0,c));this.emitter.emit("failure",l)}};u(mf,"RequestLogger");var yf=mf;function Es(e){return e[0]*1e3+e[1]/hR}u(Es,"toMillis");function Po(e,t,r,n){let i=n.messageMaxQueryLength||pR,s=n.messageMaxParameterValueLength||dR;if(Array.isArray(e))return gR(e,r,i,s);let o=e.substr(0,i),a=i-o.length-1;return o+=Rv(t,a,s),r.isPrepared()||(o+=" (not prepared)"),o}u(Po,"getStatementInfo");function gR(e,t,r,n){let i=(t.isBatchLogged()?"LOGGED ":"")+"BATCH w/ "+e.length+(t.isPrepared()?"":" not prepared")+" queries (",s=r,o;for(o=0;o<e.length&&s>0;o++){let a=e[o],c=a.params;typeof a!="string"&&(a=a.query),o>0&&(i+=",",s--);let l=Math.min(s,a.length);if(i+=a.substr(0,l),s-=l,s<=0)break;let f=Rv(c,s,n);s-=f.length,i+=f}return i+=o<e.length?",...)":")",i}u(gR,"getBatchStatementInfo");function Rv(e,t,r){if(t<=3)return" [...]";if(!e)return" []";let n=u((o,a)=>Bv(e[o],a),"paramStringifier");if(!Array.isArray(e)){let o=e;e=Object.keys(e),n=u((a,c)=>{let l=e[a],f=l.substr(0,c),h=c-f.length-1;return h<=0||(f+=":"+Bv(o[l],h)),f},"paramStringifier")}let i=" [",s;for(s=0;t>0&&s<e.length;s++){s>0&&(i+=",",t--);let o=n(s,Math.min(r,t));t-=o.length,i+=o}return s<e.length&&(i+="..."),i+="]",i}u(Rv,"getParametersInfo");function Bv(e,t){return e===void 0?"undefined":e===null?"null":e.toString().substr(0,t)}u(Bv,"formatParam");function ko(e,t){let r="request size "+Nv(e);return t!==void 0&&(r+=" / response size "+Nv(t)),r}u(ko,"getPayloadSizes");function Nv(e){return e>1e3?Math.round(e/1024)+" KB":e+" bytes"}u(Nv,"formatSize");Dv.exports=yf});var Ef=_(vf=>{"use strict";vf.RequestLogger=Lv();vf.RequestTracker=gf()});var xf=_((wU,Ov)=>{"use strict";var Sf=class Sf{onAuthenticationError(t){}onClientTimeoutError(t){}onConnectionError(t){}onOtherError(t){}onReadTimeoutError(t){}onWriteTimeoutError(t){}onUnavailableError(t){}onClientTimeoutRetry(t){}onOtherErrorRetry(t){}onReadTimeoutRetry(t){}onUnavailableRetry(t){}onWriteTimeoutRetry(t){}onIgnoreError(t){}onSpeculativeExecution(){}onSuccessfulResponse(t){}onResponse(t){}};u(Sf,"ClientMetrics");var Cf=Sf;Ov.exports=Cf});var Pv=_((IU,Fv)=>{"use strict";var yR=xf(),Ft=require("events"),_f=class _f extends yR{constructor(){super(),this.errors=new Ft,this.errors.authentication=new Ft,this.errors.clientTimeout=new Ft,this.errors.connection=new Ft,this.errors.other=new Ft,this.errors.readTimeout=new Ft,this.errors.unavailable=new Ft,this.errors.writeTimeout=new Ft,this.retries=new Ft,this.retries.clientTimeout=new Ft,this.retries.other=new Ft,this.retries.readTimeout=new Ft,this.retries.unavailable=new Ft,this.retries.writeTimeout=new Ft,this.speculativeExecutions=new Ft,this.ignoredErrors=new Ft,this.responses=new Ft,this.responses.success=new Ft}onAuthenticationError(t){this.errors.authentication.emit("increment",t),this.errors.emit("increment",t)}onConnectionError(t){this.errors.connection.emit("increment",t),this.errors.emit("increment",t)}onReadTimeoutError(t){this.errors.readTimeout.emit("increment",t),this.errors.emit("increment",t)}onWriteTimeoutError(t){this.errors.writeTimeout.emit("increment",t),this.errors.emit("increment",t)}onUnavailableError(t){this.errors.unavailable.emit("increment",t),this.errors.emit("increment",t)}onClientTimeoutError(t){this.errors.clientTimeout.emit("increment",t),this.errors.emit("increment",t)}onOtherError(t){this.errors.other.emit("increment",t),this.errors.emit("increment",t)}onClientTimeoutRetry(t){this.retries.clientTimeout.emit("increment",t),this.retries.emit("increment",t)}onOtherErrorRetry(t){this.retries.other.emit("increment",t),this.retries.emit("increment",t)}onReadTimeoutRetry(t){this.retries.readTimeout.emit("increment",t),this.retries.emit("increment",t)}onUnavailableRetry(t){this.retries.unavailable.emit("increment",t),this.retries.emit("increment",t)}onWriteTimeoutRetry(t){this.retries.writeTimeout.emit("increment",t),this.retries.emit("increment",t)}onIgnoreError(t){this.ignoredErrors.emit("increment",t)}onSpeculativeExecution(){this.speculativeExecutions.emit("increment")}onSuccessfulResponse(t){this.responses.success.emit("increment",t)}onResponse(t){this.responses.emit("increment",t)}};u(_f,"DefaultMetrics");var Tf=_f;Fv.exports=Tf});var wf=_((BU,kv)=>{"use strict";var mR=xf(),vR=Pv();kv.exports={ClientMetrics:mR,DefaultMetrics:vR}});var If=_(bf=>{"use strict";function qv(){}u(qv,"AuthProvider");qv.prototype.newAuthenticator=function(e,t){throw new Error("This is an abstract class, you must implement newAuthenticator method or use another auth provider that inherits from this class")};function su(){}u(su,"Authenticator");su.prototype.initialResponse=function(e){e(new Error("Not implemented"))};su.prototype.evaluateChallenge=function(e,t){t(new Error("Not implemented"))};su.prototype.onAuthenticationSuccess=function(e){};bf.AuthProvider=qv;bf.Authenticator=su});var Kv=_((DU,Mv)=>{"use strict";var Uv=require("util"),Vv=If(),ou=se(),ER=Vv.AuthProvider,CR=Vv.Authenticator;function Af(e,t){this.username=e,this.password=t}u(Af,"PlainTextAuthProvider");Uv.inherits(Af,ER);Af.prototype.newAuthenticator=function(){return new au(this.username,this.password)};function au(e,t){this.username=e,this.password=t}u(au,"PlainTextAuthenticator");Uv.inherits(au,CR);au.prototype.initialResponse=function(e){let t=Buffer.concat([ou.allocBufferFromArray([0]),ou.allocBufferFromString(this.username,"utf8"),ou.allocBufferFromArray([0]),ou.allocBufferFromString(this.password,"utf8")]);e(null,t)};au.prototype.evaluateChallenge=function(e,t){t()};Mv.exports=Af});var cu=_(uu=>{"use strict";var Hv=If();uu.AuthProvider=Hv.AuthProvider;uu.Authenticator=Hv.Authenticator;uu.PlainTextAuthProvider=Kv()});var fu=_(Yn=>{"use strict";var lu=require("util"),Jr=hf(),pn=Ve(),Gv=se(),SR=Ef(),jv=wf(),$v=cu(),zv={[pn.distance.local]:2,[pn.distance.remote]:1,[pn.distance.ignored]:0},Wv={[pn.distance.local]:1,[pn.distance.remote]:1,[pn.distance.ignored]:0},Qv=128,Zv=2048;function Yv(){return{policies:{addressResolution:Jr.defaultAddressTranslator(),loadBalancing:Jr.defaultLoadBalancingPolicy(),reconnection:Jr.defaultReconnectionPolicy(),retry:Jr.defaultRetryPolicy(),speculativeExecution:Jr.defaultSpeculativeExecutionPolicy(),timestampGeneration:Jr.defaultTimestampGenerator()},queryOptions:{fetchSize:5e3,prepare:!1,captureStackTrace:!1},protocolOptions:{port:9042,maxSchemaAgreementWaitSeconds:10,maxVersion:0,noCompact:!1},pooling:{heartBeatInterval:3e4,warmup:!0},socketOptions:{connectTimeout:5e3,defunctReadTimeoutThreshold:64,keepAlive:!0,keepAliveDelay:0,readTimeout:12e3,tcpNoDelay:!0,coalescingThreshold:65536},authProvider:null,requestTracker:null,metrics:new jv.DefaultMetrics,maxPrepared:500,refreshSchemaDelay:1e3,isMetadataSyncEnabled:!0,prepareOnAllHosts:!0,rePrepareOnUp:!0,encoding:{copyBuffer:!0,useUndefinedAsUnset:!0}}}u(Yv,"defaultOptions");function xR(e,t){arguments.length===1&&(t=arguments[0],e={});let r=Gv.deepExtend(e,Yv(),t);if(r.cloud)TR(r);else{if(!lu.isArray(r.contactPoints)||r.contactPoints.length===0)throw new TypeError("Contacts points are not defined.");for(let n=0;n<r.contactPoints.length;n++){let i=r.contactPoints[n];if(!i)throw new TypeError(lu.format("Contact point %s (%s) is not a valid host name, the following values are valid contact points: ipAddress, hostName or ipAddress:port",n,i))}r.sni=void 0}if(r.logEmitter||(r.logEmitter=function(){}),!r.queryOptions)throw new TypeError("queryOptions not defined in options");if(r.requestTracker!==null&&!(r.requestTracker instanceof SR.RequestTracker))throw new TypeError("requestTracker must be an instance of RequestTracker");if(!(r.metrics instanceof jv.ClientMetrics))throw new TypeError("metrics must be an instance of ClientMetrics");if(_R(r.policies),wR(r.protocolOptions),bR(r.socketOptions),IR(r),r.encoding=r.encoding||{},AR(r.encoding),r.profiles&&!lu.isArray(r.profiles))throw new TypeError("profiles must be an Array of ExecutionProfile instances");return r}u(xR,"extend");function TR(e){let t=e.cloud.secureConnectBundle;if(!(typeof t=="string"||typeof URL<"u"&&t instanceof URL))throw new TypeError("secureConnectBundle in cloud options must be of type string");if(e.contactPoints)throw new TypeError("Contact points can not be defined when cloud settings are provided");if(e.sslOptions)throw new TypeError("SSL options can not be defined when cloud settings are provided")}u(TR,"validateCloudOptions");function _R(e){if(!e)throw new TypeError("policies not defined in options");if(!(e.loadBalancing instanceof Jr.loadBalancing.LoadBalancingPolicy))throw new TypeError("Load balancing policy must be an instance of LoadBalancingPolicy");if(!(e.reconnection instanceof Jr.reconnection.ReconnectionPolicy))throw new TypeError("Reconnection policy must be an instance of ReconnectionPolicy");if(!(e.retry instanceof Jr.retry.RetryPolicy))throw new TypeError("Retry policy must be an instance of RetryPolicy");if(!(e.addressResolution instanceof Jr.addressResolution.AddressTranslator))throw new TypeError("Address resolution policy must be an instance of AddressTranslator");if(e.timestampGeneration!==null&&!(e.timestampGeneration instanceof Jr.timestampGeneration.TimestampGenerator))throw new TypeError("Timestamp generation policy must be an instance of TimestampGenerator")}u(_R,"validatePoliciesOptions");function wR(e){if(!e)throw new TypeError("protocolOptions not defined in options");let t=e.maxVersion;if(t&&(typeof t!="number"||!pn.protocolVersion.isSupported(t)))throw new TypeError(lu.format("protocolOptions.maxVersion provided (%s) is invalid",t))}u(wR,"validateProtocolOptions");function bR(e){if(!e)throw new TypeError("socketOptions not defined in options");if(typeof e.readTimeout!="number")throw new TypeError("socketOptions.readTimeout must be a Number");if(typeof e.coalescingThreshold!="number"||e.coalescingThreshold<=0)throw new TypeError("socketOptions.coalescingThreshold must be a positive Number")}u(bR,"validateSocketOptions");function IR(e){let t=e.credentials;if(t&&!e.authProvider){if(typeof t.username!="string"||typeof t.password!="string")throw new TypeError("credentials username and password must be a string");e.authProvider=new $v.PlainTextAuthProvider(t.username,t.password)}if(e.authProvider&&!(e.authProvider instanceof $v.AuthProvider))throw new TypeError("options.authProvider must be an instance of AuthProvider")}u(IR,"validateAuthenticationOptions");function AR(e){if(e.map){let t=e.map;if(typeof t!="function"||typeof t.prototype.forEach!="function"||typeof t.prototype.set!="function")throw new TypeError("Map constructor not valid")}if(e.set){let t=e.set;if(typeof t!="function"||typeof t.prototype.forEach!="function"||typeof t.prototype.add!="function")throw new TypeError("Set constructor not valid")}if((e.useBigIntAsLong||e.useBigIntAsVarint)&&typeof BigInt>"u")throw new TypeError("BigInt is not supported by the JavaScript engine")}u(AR,"validateEncodingOptions");function BR(e){let t=e.controlConnection.protocolVersion,r=Wv,n=Zv;pn.protocolVersion.uses2BytesStreamIds(t)||(r=zv,n=Qv),e.options.queryOptions.consistency===void 0&&(e.options.queryOptions.consistency=e.metadata.isDbaas()?pn.consistencies.localQuorum:pn.consistencies.localOne),e.options.pooling=Gv.deepExtend({},{coreConnectionsPerHost:r,maxRequestsPerConnection:n},e.options.pooling)}u(BR,"setMetadataDependent");Yn.extend=xR;Yn.defaultOptions=Yv;Yn.coreConnectionsPerHostV2=zv;Yn.coreConnectionsPerHostV3=Wv;Yn.maxRequestsPerConnectionV2=Qv;Yn.maxRequestsPerConnectionV3=Zv;Yn.setMetadataDependent=BR});var Rf=_(Nf=>{"use strict";var Jv=se(),Xv=Ve();function Bf(e,t){if(typeof e!="string")throw new TypeError("Execution profile name must be a string");t=t||Jv.emptyObject,this.name=e,this.consistency=t.consistency,this.loadBalancing=t.loadBalancing,this.readTimeout=t.readTimeout,this.retry=t.retry,this.serialConsistency=t.serialConsistency}u(Bf,"ExecutionProfile");function Di(e){this._profiles=e.profiles||[],this._setDefault(e),this._loadBalancingPolicies=[],this._profilesMap={},this._profiles.forEach(function(t){return this._profilesMap[t.name]=t,t.loadBalancing=t.loadBalancing||this._defaultProfile.loadBalancing,this._loadBalancingPolicies.indexOf(t.loadBalancing)===-1&&this._loadBalancingPolicies.push(t.loadBalancing),t},this)}u(Di,"ProfileManager");Di.prototype.init=function(e,t,r){Jv.eachSeries(this._loadBalancingPolicies,function(n,i){n.init(e,t,i)},r)};Di.prototype.getDistance=function(e){let t=Xv.distance.ignored;for(let r=0;r<this._loadBalancingPolicies.length;r++){let n=this._loadBalancingPolicies[r].getDistance(e);if(n<t&&(t=n,t===Xv.distance.local))break}return e.setDistance(t),t};Di.prototype.getProfile=function(e){return e instanceof Bf?e:this._profilesMap[e||"default"]};Di.prototype.getDefault=function(){return this._defaultProfile};Di.prototype.getDefaultLoadBalancing=function(){return this._defaultProfile.loadBalancing};Di.prototype._setDefault=function(e){this._defaultProfile=this._profiles.filter(function(t){return t.name==="default"})[0],this._defaultProfile||this._profiles.push(this._defaultProfile=new Bf("default")),this._defaultProfile.loadBalancing=this._defaultProfile.loadBalancing||e.policies.loadBalancing,this._defaultProfile.retry=this._defaultProfile.retry||e.policies.retry};Nf.ProfileManager=Di;Nf.ExecutionProfile=Bf});var kf=_(Of=>{"use strict";var NR=require("events"),hu=Ve(),Cs=se(),RR=hu.FrameHeader,Ff=class Ff{constructor(t){if(!t)throw new Error("Opcode not provided");this.buffers=[],this.opcode=t,this.bodyLength=0}add(t){this.buffers.push(t),this.bodyLength+=t.length}writeShort(t){let r=Cs.allocBufferUnsafe(2);r.writeUInt16BE(t,0),this.add(r)}writeInt(t){let r=Cs.allocBufferUnsafe(4);r.writeInt32BE(t,0),this.add(r)}writeLong(t){this.add(hu.Long.toBuffer(t))}writeBytes(t){if(t===null){this.writeInt(-1);return}if(t===hu.unset){this.writeInt(-2);return}this.writeInt(t.length),this.add(t)}writeShortBytes(t){if(t===null){this.writeShort(-1);return}this.writeShort(t.length),this.add(t)}writeByte(t){this.add(Cs.allocBufferFromArray([t]))}writeString(t){if(typeof t>"u")throw new Error("can not write undefined");let r=Buffer.byteLength(t,"utf8"),n=Cs.allocBufferUnsafe(2+r);n.writeUInt16BE(r,0),n.write(t,2,n.length-2,"utf8"),this.add(n)}writeLString(t){let r=Buffer.byteLength(t,"utf8"),n=Cs.allocBufferUnsafe(4+r);n.writeInt32BE(r,0),n.write(t,4,n.length-4,"utf8"),this.add(n)}writeStringList(t){this.writeShort(t.length),t.forEach(this.writeString,this)}writeCustomPayload(t){let r=Object.keys(t);this.writeShort(r.length),r.forEach(function(n){this.writeString(n),this.writeBytes(t[n])},this)}writeStringMap(t){let r=[];for(let n in t)t.hasOwnProperty(n)&&r.push(n);this.writeShort(r.length);for(let n=0;n<r.length;n++){let i=r[n];this.writeString(i),this.writeString(t[i])}}write(t,r,n){let s=new RR(t,n||0,r,this.opcode,this.bodyLength).toBuffer();return this.buffers.unshift(s),Buffer.concat(this.buffers,s.length+this.bodyLength)}};u(Ff,"FrameWriter");var Df=Ff,Pf=class Pf extends NR.EventEmitter{constructor(t,r,n){super(),this.netClient=t,this.encoder=r,this.isRunning=!1,this.queue=[],this.coalescingThreshold=n.socketOptions.coalescingThreshold,this.error=null}push(t,r){let n=this;if(this.error)return process.nextTick(u(function(){r(n.error)},"writePushError"));this.queue.push({operation:t,callback:r}),this.run()}run(){this.isRunning||(this.isRunning=!0,process.nextTick(()=>this.process()))}process(){if(this.error)return;let t=[],r=[],n=0;for(;this.queue.length>0&&n<this.coalescingThreshold;){let i=this.queue.shift();if(!i.operation.canBeWritten()){i.callback(new Error("The operation was already cancelled or timeout elapsed"));continue}let s;try{s=i.operation.request.write(this.encoder,i.operation.streamId)}catch(o){i.callback(o);continue}n+=s.length,t.push(s),r.push(i.callback)}if(n===0){this.isRunning=!1;return}for(let i=0;i<r.length;i++)r[i]();this.netClient.write(Buffer.concat(t,n),i=>{if(i){this.setWriteError(i);return}if(this.queue.length===0){this.isRunning=!1;return}setImmediate(()=>this.process())})}setWriteError(t){t.isSocketError=!0,this.error=new hu.DriverError("Socket was closed"),this.error.isSocketError=!0,this.error.requestNotWritten=!0,this.error.innerError=t;let r=this.queue;this.queue=Cs.emptyArray;for(let n=0;n<r.length;n++)r[n].callback(this.error)}};u(Pf,"WriteQueue");var Lf=Pf;Of.WriteQueue=Lf;Of.FrameWriter=Df});var Ss=_((MU,rE)=>{"use strict";var eE=se(),tE=Ve(),DR=Ue(),du=class du{constructor(){}static empty(){return new du}getCaptureStackTrace(){}getConsistency(){}getCustomPayload(){}getFetchSize(){}getFixedHost(){}getHints(){}isAutoPage(){}isBatchCounter(){}isBatchLogged(){}isIdempotent(){}isPrepared(){}isQueryTracing(){}getKeyspace(){}getLoadBalancingPolicy(){}getPageState(){}getRawQueryOptions(){}getReadTimeout(){}getRetryPolicy(){}getRowCallback(){}getOrGenerateTimestamp(){}getRoutingIndexes(){}getRoutingKey(){}getRoutingNames(){}getSerialConsistency(){}getTimestamp(){}setHints(t){}setKeyspace(t){}setPageState(){}setRoutingIndexes(t){}setRoutingKey(t){}};u(du,"ExecutionOptions");var pu=du,gu=class gu extends pu{constructor(t,r,n){if(super(),this._queryOptions=t,this._rowCallback=n,this._routingKey=this._queryOptions.routingKey,this._hints=this._queryOptions.hints,this._keyspace=this._queryOptions.keyspace,this._routingIndexes=this._queryOptions.routingIndexes,this._pageState=typeof this._queryOptions.pageState=="string"?eE.allocBufferFromString(this._queryOptions.pageState,"hex"):this._queryOptions.pageState,this._client=r,this._defaultQueryOptions=r.options.queryOptions,this._profile=r.profileManager.getProfile(this._queryOptions.executionProfile),!this._profile)throw new DR.ArgumentError(`Execution profile "${this._queryOptions.executionProfile}" not found`)}static create(t,r,n){return(!t||typeof t=="function")&&(t=eE.emptyObject),new gu(t,r,n)}getCaptureStackTrace(){return Xn(this._queryOptions.captureStackTrace,this._defaultQueryOptions.captureStackTrace)}getConsistency(){return qo(this._queryOptions.consistency,this._profile.consistency,this._defaultQueryOptions.consistency)}getCustomPayload(){return Xn(this._queryOptions.customPayload,this._defaultQueryOptions.customPayload)}getFetchSize(){return Xn(this._queryOptions.fetchSize,this._defaultQueryOptions.fetchSize)}getFixedHost(){return this._queryOptions.host}getHints(){return this._hints}isAutoPage(){return Xn(this._queryOptions.autoPage,this._defaultQueryOptions.autoPage)}isBatchCounter(){return Xn(this._queryOptions.counter,!1)}isBatchLogged(){return qo(this._queryOptions.logged,this._defaultQueryOptions.logged,!0)}isIdempotent(){return Xn(this._queryOptions.isIdempotent,this._defaultQueryOptions.isIdempotent)}isPrepared(){return Xn(this._queryOptions.prepare,this._defaultQueryOptions.prepare)}isQueryTracing(){return Xn(this._queryOptions.traceQuery,this._defaultQueryOptions.traceQuery)}getKeyspace(){return this._keyspace}getLoadBalancingPolicy(){return this._profile.loadBalancing}getOrGenerateTimestamp(){let t=this.getTimestamp();if(t===void 0){let r=this._client.options.policies.timestampGeneration;tE.protocolVersion.supportsTimestamp(this._client.controlConnection.protocolVersion)&&r?t=r.next(this._client):t=null}return typeof t=="number"?tE.Long.fromNumber(t):t}getPageState(){return this._pageState}getRawQueryOptions(){return this._queryOptions}getReadTimeout(){return qo(this._queryOptions.readTimeout,this._profile.readTimeout,this._client.options.socketOptions.readTimeout)}getRetryPolicy(){return qo(this._queryOptions.retry,this._profile.retry,this._client.options.policies.retry)}getRoutingIndexes(){return this._routingIndexes}getRoutingKey(){return this._routingKey}getRoutingNames(){return this._queryOptions.routingNames}getRowCallback(){return this._rowCallback}getSerialConsistency(){return qo(this._queryOptions.serialConsistency,this._profile.serialConsistency,this._defaultQueryOptions.serialConsistency)}getTimestamp(){return this._queryOptions.timestamp}setHints(t){this._hints=t}setKeyspace(t){this._keyspace=t}setPageState(t){this._pageState=t}setRoutingIndexes(t){this._routingIndexes=t}setRoutingKey(t){this._routingKey=t}};u(gu,"DefaultExecutionOptions");var qf=gu;function Xn(e,t){return e!==void 0?e:t}u(Xn,"ifUndefined");function qo(e,t,r){return e!==void 0?e:t!==void 0?t:r}u(qo,"ifUndefined3");rE.exports={ExecutionOptions:pu,DefaultExecutionOptions:qf}});var Uo=_((HU,LR)=>{LR.exports={name:"cassandra-driver",version:"4.3.1",description:"DataStax Node.js Driver for Apache Cassandra",author:"DataStax",keywords:["cassandra","cql","cql3","connection","pool","datastax","nosql","driver","database"],license:"Apache-2.0",types:"./index.d.ts",dependencies:{long:"^2.2.0","adm-zip":"^0.4.13","@types/node":">=4","@types/long":"^4.0.0"},devDependencies:{mocha:"~5.2.0",proxyquire:"~2.1.3",sinon:"~7.5.0",chai:"4.2.0"},repository:{type:"git",url:"https://github.com/datastax/nodejs-driver.git"},bugs:{url:"https://groups.google.com/a/lists.datastax.com/forum/#!forum/nodejs-driver-user"},scripts:{test:"./node_modules/.bin/mocha test/unit -R spec -t 5000 --recursive",ci_jenkins:"./node_modules/.bin/mocha test/unit test/integration/short --recursive -R mocha-jenkins-reporter --exit",ci_appveyor:"./node_modules/.bin/mocha test/unit test/integration/short --recursive -R mocha-appveyor-reporter --exit",ci_unit_appveyor:"./node_modules/.bin/mocha test/unit --recursive -R mocha-appveyor-reporter --exit",eslint:"eslint lib test"},engines:{node:">=4"}}});var Li=_(rn=>{"use strict";var OR=require("util"),Ln=kf().FrameWriter,gt=Ve(),Vf=se(),FR=Ss().ExecutionOptions,nE=Uo(),en={values:1,skipMetadata:2,pageSize:4,withPagingState:8,withSerialConsistency:16,withDefaultTimestamp:32,withNameForValues:64},yu={withSerialConsistency:16,withDefaultTimestamp:32,withNameForValues:64},Uf={logged:0,unlogged:1,counter:2},Qf=class Qf{constructor(){this.length=0}write(t,r){throw new Error("Method must be implemented")}clone(){let t=new this.constructor,r=Object.keys(this);for(let n=0;n<r.length;n++){let i=r[n];t[i]=this[i]}return t}};u(Qf,"Request");var tn=Qf,Zf=class Zf extends tn{constructor(t,r,n,i,s){super(),this.query=t,this.queryId=r,this.params=n,this.meta=s,this.options=i||FR.empty(),this.consistency=this.options.getConsistency()||gt.consistencies.one,this.namedParameters=!1}getParamType(t){let r=this.meta.columns[t];return r?r.type:null}write(t,r){let n=new Ln(gt.opcodes.execute),i=this.options.isQueryTracing()?gt.frameFlags.tracing:0;return this.options.getCustomPayload()&&(i|=gt.frameFlags.customPayload,n.writeCustomPayload(this.options.getCustomPayload())),n.writeShortBytes(this.queryId),this.writeQueryParameters(n,t),this.length=n.bodyLength,n.write(t.protocolVersion,r,i)}writeQueryParameters(t,r){let n=0,i=this.options.getOrGenerateTimestamp();if(gt.protocolVersion.supportsPaging(r.protocolVersion)&&(n|=this.params&&this.params.length?en.values:0,n|=this.options.getFetchSize()>0?en.pageSize:0,n|=this.options.getPageState()?en.withPagingState:0,n|=this.options.getSerialConsistency()?en.withSerialConsistency:0,n|=i!=null?en.withDefaultTimestamp:0,n|=this.namedParameters?en.withNameForValues:0,t.writeShort(this.consistency),t.writeByte(n)),this.params&&this.params.length){t.writeShort(this.params.length);for(let s=0;s<this.params.length;s++){let o=this.params[s];n&en.withNameForValues&&(t.writeString(o.name),o=o.value),t.writeBytes(r.encode(o,this.getParamType(s)))}}if(!gt.protocolVersion.supportsPaging(r.protocolVersion)){(!this.params||!this.params.length)&&t.writeShort(0),t.writeShort(this.consistency);return}n&en.pageSize&&t.writeInt(this.options.getFetchSize()),n&en.withPagingState&&t.writeBytes(this.options.getPageState()),n&en.withSerialConsistency&&t.writeShort(this.options.getSerialConsistency()),n&en.withDefaultTimestamp&&t.writeLong(i)}};u(Zf,"ExecuteRequest");var mu=Zf,Yf=class Yf extends mu{constructor(t,r,n,i){super(t,null,r,n,null),this.hints=this.options.getHints()||Vf.emptyArray,this.namedParameters=i}getParamType(t){return this.hints[t]}write(t,r){let n=new Ln(gt.opcodes.query),i=this.options.isQueryTracing()?gt.frameFlags.tracing:0;return this.options.getCustomPayload()&&(i|=gt.frameFlags.customPayload,n.writeCustomPayload(this.options.getCustomPayload())),n.writeLString(this.query),gt.protocolVersion.supportsPaging(t.protocolVersion)?this.writeQueryParameters(n,t):n.writeShort(this.consistency),this.length=n.bodyLength,n.write(t.protocolVersion,r,i)}};u(Yf,"QueryRequest");var Mf=Yf,Xf=class Xf extends tn{constructor(t){super(),this.query=t}write(t,r){let n=new Ln(gt.opcodes.prepare);return n.writeLString(this.query),n.write(t.protocolVersion,r)}};u(Xf,"PrepareRequest");var Kf=Xf,Jf=class Jf extends tn{constructor(t){super(),this.options=t||{}}write(t,r){let n=new Ln(gt.opcodes.startup),i={CQL_VERSION:this.options.cqlVersion||"3.0.0",DRIVER_NAME:nE.description,DRIVER_VERSION:nE.version};return this.options.noCompact&&(i.NO_COMPACT="true"),n.writeStringMap(i),n.write(t.protocolVersion,r)}};u(Jf,"StartupRequest");var Hf=Jf,eh=class eh extends tn{constructor(t){super(),this.events=t}write(t,r){let n=new Ln(gt.opcodes.register);return n.writeStringList(this.events),n.write(t.protocolVersion,r)}};u(eh,"RegisterRequest");var $f=eh,th=class th extends tn{constructor(t){super(),this.token=t}write(t,r){let n=new Ln(gt.opcodes.authResponse);return n.writeBytes(this.token),n.write(t.protocolVersion,r)}};u(th,"AuthResponseRequest");var Gf=th,rh=class rh extends tn{constructor(t,r){super(),this.username=t,this.password=r}write(t,r){let n=new Ln(gt.opcodes.credentials);return n.writeStringMap({username:this.username,password:this.password}),n.write(t.protocolVersion,r)}};u(rh,"CredentialsRequest");var jf=rh,vu=class vu extends tn{constructor(t,r){super(),this.queries=t,this.options=r,this.hints=r.getHints()||Vf.emptyArray,this.type=Uf.logged,r.isBatchCounter()?this.type=Uf.counter:r.isBatchLogged()||(this.type=Uf.unlogged)}write(t,r){if(!this.queries||!(this.queries.length>0))throw new TypeError(OR.format("Invalid queries provided %s",this.queries));let n=new Ln(gt.opcodes.batch),i=this.options.isQueryTracing()?gt.frameFlags.tracing:0;this.options.getCustomPayload()&&(i|=gt.frameFlags.customPayload,n.writeCustomPayload(this.options.getCustomPayload())),n.writeByte(this.type),n.writeShort(this.queries.length);let s=this;if(this.queries.forEach(u(function(a,c){let l=s.hints[c],f=a.params||Vf.emptyArray,h;a.queryId?(n.writeByte(1),n.writeShortBytes(a.queryId),h=u(d=>a.meta.columns[d].type,"getParamType")):(n.writeByte(0),n.writeLString(a.query),h=l?d=>l[d]:()=>null),n.writeShort(f.length),f.forEach((d,g)=>n.writeBytes(t.encode(d,h(g))))},"eachQuery"),this),n.writeShort(this.options.getConsistency()),gt.protocolVersion.supportsTimestamp(t.protocolVersion)){let o=this.options.getSerialConsistency()?yu.withSerialConsistency:0,a=this.options.getOrGenerateTimestamp();o|=a!=null?yu.withDefaultTimestamp:0,n.writeByte(o),o&yu.withSerialConsistency&&n.writeShort(this.options.getSerialConsistency()),o&yu.withDefaultTimestamp&&n.writeLong(a)}return this.length=n.bodyLength,n.write(t.protocolVersion,r,i)}clone(){return new vu(this.queries,this.options)}};u(vu,"BatchRequest");var zf=vu,nh=class nh extends tn{write(t,r){return new Ln(gt.opcodes.options).write(t.protocolVersion,r,0)}clone(){return this}};u(nh,"OptionsRequest");var Wf=nh,PR=new Wf;rn.AuthResponseRequest=Gf;rn.BatchRequest=zf;rn.CredentialsRequest=jf;rn.ExecuteRequest=mu;rn.PrepareRequest=Kf;rn.QueryRequest=Mf;rn.Request=tn;rn.RegisterRequest=$f;rn.StartupRequest=Hf;rn.options=PR});var oE=_((jU,sE)=>{"use strict";var kR=require("util"),iE=Ue();function Oi(e,t,r){this._hosts=e,this._openConnections=t,this._inFlightQueries=r}u(Oi,"ClientState");Oi.from=function(e){let t={},r={},n=[];return e.hosts.forEach(u(function(s){s.pool.connections.length!==0&&(n.push(s),t[s.address]=s.pool.connections.length,r[s.address]=s.getInFlight())},"each")),new Oi(n,t,r)};Oi.prototype.getConnectedHosts=function(){return this._hosts};Oi.prototype.getOpenConnections=function(e){if(!e)throw new iE.ArgumentError("Host is not defined");return this._openConnections[e.address]||0};Oi.prototype.getInFlightQueries=function(e){if(!e)throw new iE.ArgumentError("Host is not defined");return this._inFlightQueries[e.address]||0};Oi.prototype.toString=function(){return kR.format('{"hosts": %j, "openConnections": %j, "inFlightQueries": %j}',this._hosts.map(function(e){return e.address}),this._openConnections,this._inFlightQueries)};sE.exports=Oi});var sh=_((WU,uE)=>{"use strict";var qR=ls(),aE=65536,ih=aE*aE,UR=new he(1,0,0,0);function he(e,t,r,n){this._arr=[e&65535,t&65535,r&65535,n&65535]}u(he,"MutableLong");he.fromNumber=u(function(t){if(isNaN(t)||!isFinite(t))return new he;if(t<0)return he.fromNumber(-t).negate();let r=t%ih,n=t/ih;return he.fromBits(r,n)},"fromNumber");he.fromBits=u(function(t,r){return new he(t,t>>>16,r,r>>>16)},"fromBits");he.fromString=u(function(t,r){if(typeof t!="string")throw new Error("String format is not valid: "+t);if(t.length===0)throw Error("number format error: empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return new he;if(r=r||10,r<2||r>36)throw Error("radix out of range: "+r);let n;if((n=t.indexOf("-"))>0)throw Error('number format error: interior "-" character: '+t);if(n===0)return he.fromString(t.substring(1),r).negate();let i=he.fromNumber(Math.pow(r,8)),s=new he;for(let o=0;o<t.length;o+=8){let a=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+a),r);if(a<8){let l=he.fromNumber(Math.pow(r,a));s.multiply(l).add(he.fromNumber(c));break}s.multiply(i),s.add(he.fromNumber(c))}return s},"fromString");he.prototype.toString=u(function(){return this.toImmutable().toString()},"toString");he.prototype.compare=function(e){let t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this._compareBits(e)};he.prototype._compareBits=function(e){for(let t=3;t>=0;t--){if(this._arr[t]>e._arr[t])return 1;if(this._arr[t]<e._arr[t])return-1}return 0};he.prototype.getUint16=function(e){return this._arr[e]};he.prototype.getLowBitsUnsigned=function(){return(this._arr[0]|(this._arr[1]&65535)<<16)>>>0};he.prototype.getHighBitsUnsigned=function(){return(this._arr[2]|this._arr[3]<<16)>>>0};he.prototype.toNumber=function(){return(this._arr[3]<<16|this._arr[2])*ih+((this._arr[1]<<16|this._arr[0])>>>0)};he.prototype.not=function(){return this._arr[0]=~this._arr[0]&65535,this._arr[1]=~this._arr[1]&65535,this._arr[2]=~this._arr[2]&65535,this._arr[3]=~this._arr[3]&65535,this};he.prototype.add=function(e){let t=0,r=0,n=0,i=0;return i+=this._arr[0]+e._arr[0],this._arr[0]=i&65535,n+=i>>>16,n+=this._arr[1]+e._arr[1],this._arr[1]=n&65535,r+=n>>>16,r+=this._arr[2]+e._arr[2],this._arr[2]=r&65535,t+=r>>>16,t+=this._arr[3]+e._arr[3],this._arr[3]=t&65535,this};he.prototype.shiftLeft=function(e){if(e===0)return this;if(e>=64)return this.toZero();let t=e%16,r=Math.floor(e/16);return r>0&&(this._arr[3]=this._arr[3-r],this._arr[2]=r>2?0:this._arr[2-r],this._arr[1]=r>1?0:this._arr[0],this._arr[0]=0),t>0&&(this._arr[3]=(this._arr[3]<<t|this._arr[2]>>>16-t)&65535,this._arr[2]=(this._arr[2]<<t|this._arr[1]>>>16-t)&65535,this._arr[1]=(this._arr[1]<<t|this._arr[0]>>>16-t)&65535,this._arr[0]=this._arr[0]<<t&65535),this};he.prototype.shiftRightUnsigned=function(e){if(e===0)return this;if(e>=64)return this.toZero();let t=e%16,r=Math.floor(e/16);return r>0&&(this._arr[0]=this._arr[r],this._arr[1]=r>2?0:this._arr[1+r],this._arr[2]=r>1?0:this._arr[3],this._arr[3]=0),t>0&&(this._arr[0]=this._arr[0]>>>t|this._arr[1]<<16-t&65535,this._arr[1]=this._arr[1]>>>t|this._arr[2]<<16-t&65535,this._arr[2]=this._arr[2]>>>t|this._arr[3]<<16-t&65535,this._arr[3]=this._arr[3]>>>t),this};he.prototype.or=function(e){return this._arr[0]|=e._arr[0],this._arr[1]|=e._arr[1],this._arr[2]|=e._arr[2],this._arr[3]|=e._arr[3],this};he.prototype.xor=function(e){return this._arr[0]^=e._arr[0],this._arr[1]^=e._arr[1],this._arr[2]^=e._arr[2],this._arr[3]^=e._arr[3],this};he.prototype.clone=function(){return new he(this._arr[0],this._arr[1],this._arr[2],this._arr[3])};he.prototype.multiply=u(function(t){let r=!1;if(this.isZero()||t.isZero())return this.toZero();this.isNegative()&&(this.negate(),r=!r),t.isNegative()&&(t=t.clone().negate(),r=!r);let n=0,i=0,s=0,o=0;return o+=this._arr[0]*t._arr[0],s+=o>>>16,s+=this._arr[1]*t._arr[0],i+=s>>>16,s&=65535,s+=this._arr[0]*t._arr[1],i+=s>>>16,i+=this._arr[2]*t._arr[0],n+=i>>>16,i&=65535,i+=this._arr[1]*t._arr[1],n+=i>>>16,i&=65535,i+=this._arr[0]*t._arr[2],n+=i>>>16,n+=this._arr[3]*t._arr[0]+this._arr[2]*t._arr[1]+this._arr[1]*t._arr[2]+this._arr[0]*t._arr[3],this._arr[0]=o&65535,this._arr[1]=s&65535,this._arr[2]=i&65535,this._arr[3]=n&65535,r&&this.negate(),this},"multiply");he.prototype.toZero=function(){return this._arr[3]=this._arr[2]=this._arr[1]=this._arr[0]=0,this};he.prototype.isZero=function(){return this._arr[3]===0&&this._arr[2]===0&&this._arr[1]===0&&this._arr[0]===0};he.prototype.isNegative=function(){return(this._arr[3]&32768)>0};he.prototype.negate=function(){return this.not().add(UR)};he.prototype.equals=function(e){return e instanceof he?this._arr[0]===e._arr[0]&&this._arr[1]===e._arr[1]&&this._arr[2]===e._arr[2]&&this._arr[3]===e._arr[3]:!1};he.prototype.toImmutable=function(){return qR.fromBits(this.getLowBitsUnsigned(),this.getHighBitsUnsigned(),!1)};uE.exports=he});var Vo=_(Ts=>{"use strict";var lh=Ve(),cE=require("util"),VR=lh.dataTypes.getByName("bigint"),MR=lh.dataTypes.getByName("varint"),KR=lh.dataTypes.getByName("blob"),fh=class fh{constructor(t){this._value=t}getType(){throw new Error("You must implement a getType function for this Token instance")}getValue(){return this._value}toString(){return this._value.toString()}compare(t){return this._value.compare(t._value)}equals(t){return this.compare(t)===0}inspect(){return this.constructor.name+" { "+this.toString()+" }"}};u(fh,"Token");var xs=fh,hh=class hh extends xs{constructor(t){super(t)}getType(){return VR}};u(hh,"Murmur3Token");var oh=hh,ph=class ph extends xs{constructor(t){super(t)}getType(){return MR}};u(ph,"RandomToken");var ah=ph,dh=class dh extends xs{constructor(t){super(t)}getType(){return KR}toString(){return this._value.toString("hex").toUpperCase()}};u(dh,"ByteOrderedToken");var uh=dh,Jn=class Jn{constructor(t,r,n){this.start=t,this.end=r,Object.defineProperty(this,"_tokenizer",{value:n,enumerable:!1})}splitEvenly(t){if(t<1)throw new Error(cE.format("numberOfSplits (%d) must be greater than 0.",t));if(this.isEmpty())throw new Error("Can't split empty range "+this.toString());let r=[],n=this._tokenizer.split(this.start,this.end,t),i=this.start,s;for(let o=0;o<n.length;o++)s=n[o],r.push(new Jn(i,s,this._tokenizer)),i=s;return r.push(new Jn(i,this.end,this._tokenizer)),r}isEmpty(){return this.start.equals(this.end)&&!this.start.equals(this._tokenizer.minToken())}isWrappedAround(){return this.start.compare(this.end)>0&&!this.end.equals(this._tokenizer.minToken())}unwrap(){return this.isWrappedAround()?[new Jn(this.start,this._tokenizer.minToken(),this._tokenizer),new Jn(this._tokenizer.minToken(),this.end,this._tokenizer)]:[this]}contains(t){if(this.isEmpty())return!1;let r=this._tokenizer.minToken();if(this.end.equals(r))return this.start.equals(r)||t.equals(r)?!0:t.compare(this.start)>0;let n=t.compare(this.start)>0,i=t.compare(this.end)<=0;return this.isWrappedAround()?n||i:n&&i}equals(t){return t===this?!0:t instanceof Jn?this.compare(t)===0:!1}compare(t){let r=this.start.compare(t.start);return r!==0?r:this.end.compare(t.end)}toString(){return cE.format("]%s, %s]",this.start.toString(),this.end.toString())}};u(Jn,"TokenRange");var ch=Jn;Ts.Token=xs;Ts.TokenRange=ch;Ts.ByteOrderedToken=uh;Ts.Murmur3Token=oh;Ts.RandomToken=ah});var mh=_((XU,mE)=>{"use strict";var je=require("util"),pe=Ve(),P=pe.dataTypes,Fi=pe.Long,_s=pe.Integer,ws=pe.BigDecimal,HR=sh(),Me=se(),lE=Vo(),$R=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,bs={int16Zero:Me.allocBufferFromArray([0,0]),int32Zero:Me.allocBufferFromArray([0,0,0,0]),int8Zero:Me.allocBufferFromArray([0]),int8One:Me.allocBufferFromArray([1]),int8MaxValue:Me.allocBufferFromArray([255])},Is=typeof BigInt<"u",fE=Is?BigInt(32):null,hE=Is?BigInt(8):null,Eu=Is?BigInt(0):null,pE=Is?BigInt(-1):null,GR=Is?BigInt(4294967295):null,gh=Is?BigInt(255):null,ke=Object.freeze({list:"org.apache.cassandra.db.marshal.ListType",set:"org.apache.cassandra.db.marshal.SetType",map:"org.apache.cassandra.db.marshal.MapType",udt:"org.apache.cassandra.db.marshal.UserType",tuple:"org.apache.cassandra.db.marshal.TupleType",frozen:"org.apache.cassandra.db.marshal.FrozenType",reversed:"org.apache.cassandra.db.marshal.ReversedType",composite:"org.apache.cassandra.db.marshal.CompositeType",empty:"org.apache.cassandra.db.marshal.EmptyType",collection:"org.apache.cassandra.db.marshal.ColumnToCollectionType"}),Gt=Object.freeze({frozen:"frozen",list:"list",set:"set",map:"map",tuple:"tuple",empty:"empty",duration:"duration"}),yE=Object.freeze({"org.apache.cassandra.db.marshal.UTF8Type":P.varchar,"org.apache.cassandra.db.marshal.AsciiType":P.ascii,"org.apache.cassandra.db.marshal.UUIDType":P.uuid,"org.apache.cassandra.db.marshal.TimeUUIDType":P.timeuuid,"org.apache.cassandra.db.marshal.Int32Type":P.int,"org.apache.cassandra.db.marshal.BytesType":P.blob,"org.apache.cassandra.db.marshal.FloatType":P.float,"org.apache.cassandra.db.marshal.DoubleType":P.double,"org.apache.cassandra.db.marshal.BooleanType":P.boolean,"org.apache.cassandra.db.marshal.InetAddressType":P.inet,"org.apache.cassandra.db.marshal.SimpleDateType":P.date,"org.apache.cassandra.db.marshal.TimeType":P.time,"org.apache.cassandra.db.marshal.ShortType":P.smallint,"org.apache.cassandra.db.marshal.ByteType":P.tinyint,"org.apache.cassandra.db.marshal.DateType":P.timestamp,"org.apache.cassandra.db.marshal.TimestampType":P.timestamp,"org.apache.cassandra.db.marshal.LongType":P.bigint,"org.apache.cassandra.db.marshal.DecimalType":P.decimal,"org.apache.cassandra.db.marshal.IntegerType":P.varint,"org.apache.cassandra.db.marshal.CounterColumnType":P.counter}),jR=Object.keys(yE).reduce(function(e,t){return t.length>e?t.length:e},0),Cu="org.apache.cassandra.db.marshal.DurationType",dE=Me.allocBufferFromArray([255,255,255,255]),gE=Me.allocBufferFromArray([255,255,255,254]),zR=new Set([P.text,P.ascii,P.varchar,P.custom,P.blob]);function Mo(e,t){this.encodingOptions=t.encoding||Me.emptyObject,WR.call(this),this.setProtocolVersion(e),QR.call(this),this.encodingOptions.copyBuffer?this.handleBuffer=XR:this.handleBuffer=JR}u(Mo,"Encoder");function WR(){this.setProtocolVersion=function(r){this.protocolVersion=r,this.decodeCollectionLength=eD,this.getLengthBuffer=YR,this.collectionLengthSize=4,pe.protocolVersion.uses4BytesCollectionLength(this.protocolVersion)||(this.decodeCollectionLength=tD,this.getLengthBuffer=ZR,this.collectionLengthSize=2)};let e={},t={};this.decodeBlob=function(r){return this.handleBuffer(r)},this.decodeCustom=function(r,n){let i=e[n];return i?i.call(this,r):this.handleBuffer(r)},this.decodeDuration=function(r){return pe.Duration.fromBuffer(r)},this.decodeUtf8String=function(r){return r.toString("utf8")},this.decodeAsciiString=function(r){return r.toString("ascii")},this.decodeBoolean=function(r){return!!r.readUInt8(0)},this.decodeDouble=function(r){return r.readDoubleBE(0)},this.decodeFloat=function(r){return r.readFloatBE(0)},this.decodeInt=function(r){return r.readInt32BE(0)},this.decodeSmallint=function(r){return r.readInt16BE(0)},this.decodeTinyint=function(r){return r.readInt8(0)},this._decodeCqlLongAsLong=function(r){return Fi.fromBuffer(r)},this._decodeCqlLongAsBigInt=function(r){return BigInt.asIntN(64,BigInt(r.readUInt32BE(0))<<fE|BigInt(r.readUInt32BE(4)))},this.decodeLong=this.encodingOptions.useBigIntAsLong?this._decodeCqlLongAsBigInt:this._decodeCqlLongAsLong,this._decodeVarintAsInteger=function(r){return _s.fromBuffer(r)},this._decodeVarintAsBigInt=u(function(n){let i=Eu;if(n[0]<=127)for(let s=0;s<n.length;s++){let o=BigInt(n[n.length-1-s]);i=i|o<<BigInt(s*8)}else{for(let s=0;s<n.length;s++){let o=BigInt(n[n.length-1-s]);i=i|(~o&gh)<<BigInt(s*8)}i=~i}return i},"decodeVarintAsBigInt"),this.decodeVarint=this.encodingOptions.useBigIntAsVarint?this._decodeVarintAsBigInt:this._decodeVarintAsInteger,this.decodeDecimal=function(r){return ws.fromBuffer(r)},this.decodeTimestamp=function(r){return new Date(this._decodeCqlLongAsLong(r).toNumber())},this.decodeDate=function(r){return pe.LocalDate.fromBuffer(r)},this.decodeTime=function(r){return pe.LocalTime.fromBuffer(r)},this.decodeList=function(r,n){let i=this.decodeCollectionLength(r,0),s=this.collectionLengthSize,o=new Array(i);for(let a=0;a<i;a++){let c=this.decodeCollectionLength(r,s);s+=this.collectionLengthSize,o[a]=this.decode(r.slice(s,s+c),n),s+=c}return o},this.decodeSet=function(r,n){let i=this.decodeList(r,n);if(this.encodingOptions.set){let s=this.encodingOptions.set;return new s(i)}return i},this.decodeMap=function(r,n){let i,s=this.decodeCollectionLength(r,0),o=this.collectionLengthSize,a=this;function c(l,f){for(let h=0;h<s;h++){let d=a.decodeCollectionLength(r,o);o+=a.collectionLengthSize;let g=a.decode(r.slice(o,o+d),n[0]);o+=d;let p=a.decodeCollectionLength(r,o);if(o+=a.collectionLengthSize,p<0){l.call(f,g,null);continue}let y=a.decode(r.slice(o,o+p),n[1]);o+=p,l.call(f,g,y)}}if(u(c,"readValues"),this.encodingOptions.map){let l=this.encodingOptions.map;i=new l,c(i.set,i)}else i={},c(function(l,f){i[l]=f});return i},this.decodeUuid=function(r){return new pe.Uuid(this.handleBuffer(r))},this.decodeTimeUuid=function(r){return new pe.TimeUuid(this.handleBuffer(r))},this.decodeInet=function(r){return new pe.InetAddress(this.handleBuffer(r))},this.decodeUdt=function(r,n){let i={},s=0;for(let o=0;o<n.fields.length&&s<r.length;o++){let a=r.readInt32BE(s);s+=4;let c=n.fields[o];if(a<0){i[c.name]=null;continue}i[c.name]=this.decode(r.slice(s,s+a),c.type),s+=a}return i},this.decodeTuple=function(r,n){let i=new Array(n.length),s=0;for(let o=0;o<n.length&&s<r.length;o++){let a=r.readInt32BE(s);if(s+=4,a<0){i[o]=null;continue}i[o]=this.decode(r.slice(s,s+a),n[o]),s+=a}return pe.Tuple.fromArray(i)},this.encodeFloat=function(r){if(typeof r=="string"&&(r=parseFloat(r),Number.isNaN(r)))throw new TypeError(`Expected string representation of a number, obtained ${je.inspect(r)}`);if(typeof r!="number")throw new TypeError("Expected Number, obtained "+je.inspect(r));let n=Me.allocBufferUnsafe(4);return n.writeFloatBE(r,0),n},this.encodeDouble=function(r){if(typeof r=="string"&&(r=parseFloat(r),Number.isNaN(r)))throw new TypeError(`Expected string representation of a number, obtained ${je.inspect(r)}`);if(typeof r!="number")throw new TypeError("Expected Number, obtained "+je.inspect(r));let n=Me.allocBufferUnsafe(8);return n.writeDoubleBE(r,0),n},this.encodeTimestamp=function(r){let n=r;if(typeof r=="string"&&(r=new Date(r)),r instanceof Date&&(r=r.getTime(),isNaN(r)))throw new TypeError("Invalid date: "+n);return this.encodeLong(r)},this.encodeDate=function(r){let n=r;try{typeof r=="string"&&(r=pe.LocalDate.fromString(r)),r instanceof Date&&(r=pe.LocalDate.fromDate(r))}catch(i){throw new TypeError("LocalDate could not be parsed "+i)}if(!(r instanceof pe.LocalDate))throw new TypeError("Expected Date/String/LocalDate, obtained "+je.inspect(n));return r.toBuffer()},this.encodeTime=function(r){let n=r;try{typeof r=="string"&&(r=pe.LocalTime.fromString(r))}catch(i){throw new TypeError("LocalTime could not be parsed "+i)}if(!(r instanceof pe.LocalTime))throw new TypeError("Expected String/LocalTime, obtained "+je.inspect(n));return r.toBuffer()},this.encodeUuid=function(r){if(typeof r=="string")try{r=pe.Uuid.fromString(r).getBuffer()}catch(n){throw new TypeError(n.message)}else if(r instanceof pe.Uuid)r=r.getBuffer();else throw new TypeError("Not a valid Uuid, expected Uuid/String/Buffer, obtained "+je.inspect(r));return r},this.encodeInet=function(r){if(typeof r=="string"&&(r=pe.InetAddress.fromString(r)),r instanceof pe.InetAddress&&(r=r.getBuffer()),!(r instanceof Buffer))throw new TypeError("Not a valid Inet, expected InetAddress/Buffer, obtained "+je.inspect(r));return r},this._encodeBigIntFromLong=function(r){typeof r=="number"?r=Fi.fromNumber(r):typeof r=="string"&&(r=Fi.fromString(r));let n=null;if(r instanceof Fi?n=Fi.toBuffer(r):r instanceof HR&&(n=Fi.toBuffer(r.toImmutable())),n===null)throw new TypeError("Not a valid bigint, expected Long/Number/String/Buffer, obtained "+je.inspect(r));return n},this._encodeBigIntFromBigInt=function(r){if(typeof r=="string"&&(r=BigInt(r)),typeof r!="bigint")throw new TypeError("Not a valid BigInt value, obtained "+je.inspect(r));let n=Me.allocBufferUnsafe(8);return n.writeUInt32BE(Number(r>>fE)>>>0,0),n.writeUInt32BE(Number(r&GR),4),n},this.encodeLong=this.encodingOptions.useBigIntAsLong?this._encodeBigIntFromBigInt:this._encodeBigIntFromLong,this._encodeVarintFromInteger=function(r){typeof r=="number"&&(r=_s.fromNumber(r)),typeof r=="string"&&(r=_s.fromString(r));let n=null;if(r instanceof Buffer&&(n=r),r instanceof _s&&(n=_s.toBuffer(r)),n===null)throw new TypeError("Not a valid varint, expected Integer/Number/String/Buffer, obtained "+je.inspect(r));return n},this._encodeVarintFromBigInt=function(r){if(typeof r=="string"&&(r=BigInt(r)),typeof r!="bigint")throw new TypeError("Not a valid varint, expected BigInt, obtained "+je.inspect(r));if(r===Eu)return bs.int8Zero;if(r===pE)return bs.int8MaxValue;let n=[];if(r>Eu){for(;r!==Eu;)n.unshift(Number(r&gh)),r=r>>hE;n[0]>127&&n.unshift(0)}else{for(;r!==pE;)n.unshift(Number(r&gh)),r=r>>hE;n[0]<=127&&n.unshift(255)}return Me.allocBufferFromArray(n)},this.encodeVarint=this.encodingOptions.useBigIntAsVarint?this._encodeVarintFromBigInt:this._encodeVarintFromInteger,this.encodeDecimal=function(r){typeof r=="number"?r=ws.fromNumber(r):typeof r=="string"&&(r=ws.fromString(r));let n=null;if(r instanceof ws)n=ws.toBuffer(r);else throw new TypeError("Not a valid varint, expected BigDecimal/Number/String/Buffer, obtained "+je.inspect(r));return n},this.encodeString=function(r,n){if(typeof r!="string")throw new TypeError("Not a valid text value, expected String obtained "+je.inspect(r));return Me.allocBufferFromString(r,n)},this.encodeUtf8String=function(r){return this.encodeString(r,"utf8")},this.encodeAsciiString=function(r){return this.encodeString(r,"ascii")},this.encodeBlob=function(r){if(!(r instanceof Buffer))throw new TypeError("Not a valid blob, expected Buffer obtained "+je.inspect(r));return r},this.encodeCustom=function(r,n){let i=t[n];if(i)return i.call(this,r);throw new TypeError("No encoding handler found for type "+n)},this.encodeDuration=function(r){if(!(r instanceof pe.Duration))throw new TypeError("Not a valid duration, expected Duration/Buffer obtained "+je.inspect(r));return r.toBuffer()},this.encodeBoolean=function(r){return r?bs.int8One:bs.int8Zero},this.encodeInt=function(r){if(isNaN(r))throw new TypeError("Expected Number, obtained "+je.inspect(r));let n=Me.allocBufferUnsafe(4);return n.writeInt32BE(r,0),n},this.encodeSmallint=function(r){if(isNaN(r))throw new TypeError("Expected Number, obtained "+je.inspect(r));let n=Me.allocBufferUnsafe(2);return n.writeInt16BE(r,0),n},this.encodeTinyint=function(r){if(isNaN(r))throw new TypeError("Expected Number, obtained "+je.inspect(r));let n=Me.allocBufferUnsafe(1);return n.writeInt8(r,0),n},this.encodeList=function(r,n){if(!je.isArray(r))throw new TypeError("Not a valid list value, expected Array obtained "+je.inspect(r));if(r.length===0)return null;let i=[];i.push(this.getLengthBuffer(r));for(let s=0;s<r.length;s++){let o=r[s];if(o===null||typeof o>"u"||o===pe.unset)throw new TypeError("A collection can't contain null or unset values");let a=this.encode(o,n);i.push(this.getLengthBuffer(a)),i.push(a)}return Buffer.concat(i)},this.encodeSet=function(r,n){if(this.encodingOptions.set&&r instanceof this.encodingOptions.set){let i=[];return r.forEach(function(s){i.push(s)}),this.encodeList(i,n)}return this.encodeList(r,n)},this.encodeMap=function(r,n){let i=[],s=0,o=null,a=null,c=this;n&&(o=n[0],a=n[1]);function l(f,h){if(h===null||typeof h>"u"||h===pe.unset)throw new TypeError("A map can't contain null or unset keys");if(f===null||typeof f>"u"||f===pe.unset)throw new TypeError("A map can't contain null or unset values");let d=c.encode(h,o);i.push(c.getLengthBuffer(d)),i.push(d);let g=c.encode(f,a);i.push(c.getLengthBuffer(g)),g!==null&&i.push(g),s++}if(u(l,"addItem"),this.encodingOptions.map&&r instanceof this.encodingOptions.map)r.forEach(l);else for(let f in r){if(!r.hasOwnProperty(f))continue;let h=r[f];l(h,f)}return i.unshift(this.getLengthBuffer(s)),Buffer.concat(i)},this.encodeUdt=function(r,n){let i=[],s=0;for(let o=0;o<n.fields.length;o++){let a=n.fields[o],c=this.encode(r[a.name],a.type);if(!c){i.push(dE),s+=4;continue}if(c===pe.unset){i.push(gE),s+=4;continue}let l=Me.allocBufferUnsafe(4);l.writeInt32BE(c.length,0),i.push(l),i.push(c),s+=c.length+4}return Buffer.concat(i,s)},this.encodeTuple=function(r,n){let i=[],s=0,o=Math.min(n.length,r.length);for(let a=0;a<o;a++){let c=n[a],l=this.encode(r.get(a),c);if(!l){i.push(dE),s+=4;continue}if(l===pe.unset){i.push(gE),s+=4;continue}let f=Me.allocBufferUnsafe(4);f.writeInt32BE(l.length,0),i.push(f),i.push(l),s+=l.length+4}return Buffer.concat(i,s)},this.setRoutingKeyFromUser=function(r,n,i){let s=0,o=n.getRoutingKey();if(je.isArray(o)){if(o.length===1){n.setRoutingKey(o[0]);return}s=0;for(let h=0;h<o.length;h++){let d=o[h];if(!d){n.setRoutingKey(null);return}s+=d.length+3}n.setRoutingKey(yh(o,s));return}if(o){if(o instanceof Buffer||o instanceof lE.Token||o instanceof lE.TokenRange)return;throw new TypeError(`Unexpected routingKey '${je.inspect(o)}' provided. Expected Buffer, Array<Buffer>, Token, or TokenRange.`)}if(!r||r.length===0)return;let a=n.getRoutingIndexes();if(n.getRoutingNames()&&(a=n.getRoutingNames().map(h=>i[h])),!a)return;let c=[],l=n.getHints()||Me.emptyArray,f=i?h=>this.encode(r[h].value,l[h]):h=>this.encode(r[h],l[h]);try{s=this._encodeRoutingKeyParts(c,a,f)}catch{}s!==0&&n.setRoutingKey(yh(c,s))},this.setRoutingKeyFromMeta=function(r,n,i){let s=i.getRoutingIndexes();if(!s)return;let o=new Array(s.length),a=u(l=>{let f=r.columns[l];return this.encode(n[l],f?f.type:null)},"encodeParam"),c=0;try{c=this._encodeRoutingKeyParts(o,s,a)}catch{}c!==0&&i.setRoutingKey(yh(o,c))},this._encodeRoutingKeyParts=function(r,n,i){let s=0;for(let o=0;o<n.length;o++){let a=n[o];if(a===void 0)return 0;let c=i(a);if(c==null||c===pe.unset)return 0;s+=c.length+3,r[o]=c}return s},this.parseTypeName=function(r,n,i,s,o,a){i=i||0,s||(s=n.length);let c={code:0,info:null,options:{frozen:!1}},l;if(n.indexOf("'",i)===i)return c.info=n.substr(i+1,s-2),a(null,c);if(s||(s=n.length),n.indexOf(Gt.frozen,i)===i&&(i+=Gt.frozen.length+1,s-=Gt.frozen.length+2,c.options.frozen=!0),n.indexOf(Gt.list,i)===i)return i+=Gt.list.length+1,s-=Gt.list.length+2,l=On(n,i,s,"<",">"),l.length!==1?a(new TypeError("Not a valid type "+n)):(c.code=P.list,this.parseTypeName(r,l[0],0,null,o,function(d,g){if(d)return a(d);c.info=g,a(null,c)}));if(n.indexOf(Gt.set,i)===i)return i+=Gt.set.length+1,s-=Gt.set.length+2,l=On(n,i,s,"<",">"),l.length!==1?a(new TypeError("Not a valid type "+n)):(c.code=P.set,this.parseTypeName(r,l[0],0,null,o,function(d,g){if(d)return a(d);c.info=g,a(null,c)}));if(n.indexOf(Gt.map,i)===i)return i+=Gt.map.length+1,s-=Gt.map.length+2,l=On(n,i,s,"<",">"),l.length!==2?a(new TypeError("Not a valid type "+n)):(c.code=P.map,this._parseChildTypes(r,c,l,o,a));if(n.indexOf(Gt.tuple,i)===i){if(i+=Gt.tuple.length+1,s-=Gt.tuple.length+2,l=On(n,i,s,"<",">"),l.length<1)throw new TypeError("Not a valid type "+n);return c.code=P.tuple,this._parseChildTypes(r,c,l,o,a)}let f=n.indexOf('"',i)===i;f&&(i++,s-=2),i>0&&(n=n.substr(i,s)),f&&(n=n.replace('""','"'));let h=P[n];if(typeof h=="number")return c.code=h,a(null,c);if(n===Gt.duration)return c.info=Cu,a(null,c);if(n===Gt.empty)return c.info="empty",a(null,c);o(r,n,function(d,g){if(d)return a(d);if(g)return c.code=P.udt,c.info=g,a(null,c);a(new TypeError('Not a valid type "'+n+'"'))})},this._parseChildTypes=function(r,n,i,s,o){let a=this;Me.mapSeries(i,function(c,l){a.parseTypeName(r,c.trim(),0,null,s,l)},function(c,l){if(c)return o(c);n.info=l,o(null,n)})},this.parseFqTypeName=function(r,n,i){let s={code:0,info:null,options:{reversed:!1,frozen:!1}};n=n||0;let o;if(i||(i=r.length),i>ke.reversed.length&&r.indexOf(ke.reversed)===n&&(n+=ke.reversed.length+1,i-=ke.reversed.length+2,s.options.reversed=!0),i>ke.frozen.length&&r.indexOf(ke.frozen,n)===n&&(n+=ke.frozen.length+1,i-=ke.frozen.length+2,s.options.frozen=!0),r===ke.empty)return s.info="empty",s;if(i<=jR){n>0&&(r=r.substr(n,i));let a=yE[r];if(typeof a=="number")return s.code=a,s;throw new TypeError('Not a valid type "'+r+'"')}if(r.indexOf(ke.list,n)===n){if(n+=ke.list.length+1,i-=ke.list.length+2,o=On(r,n,i),o.length!==1)throw new TypeError("Not a valid type "+r);return s.code=P.list,s.info=this.parseFqTypeName(o[0]),s}if(r.indexOf(ke.set,n)===n){if(n+=ke.set.length+1,i-=ke.set.length+2,o=On(r,n,i),o.length!==1)throw new TypeError("Not a valid type "+r);return s.code=P.set,s.info=this.parseFqTypeName(o[0]),s}if(r.indexOf(ke.map,n)===n){if(n+=ke.map.length+1,i-=ke.map.length+2,o=On(r,n,i),o.length!==2)throw new TypeError("Not a valid type "+r);return s.code=P.map,s.info=[this.parseFqTypeName(o[0]),this.parseFqTypeName(o[1])],s}if(r.indexOf(ke.udt,n)===n)return n+=ke.udt.length+1,i-=ke.udt.length+2,this._parseUdtName(r,n,i);if(r.indexOf(ke.tuple,n)===n){if(n+=ke.tuple.length+1,i-=ke.tuple.length+2,o=On(r,n,i),o.length<1)throw new TypeError("Not a valid type "+r);return s.code=P.tuple,s.info=o.map(a=>this.parseFqTypeName(a)),s}return s.info=r.substr(n,i),s},this.parseKeyTypes=function(r){let n=0,i=r.length,s=r.indexOf(ke.composite)===0;s&&(n=ke.composite.length+1,i--);let o=[],a=n,c=0,l=!1,f=!1;for(;++n<i;)switch(r[n]){case",":if(c>0)break;l&&(a=r.indexOf(":",a)+1),o.push(r.substring(a,n)),a=n+1;break;case"(":if(c===0&&r.indexOf(ke.collection,a)===a){l=!0,f=!0,n++,a=n;break}c++;break;case")":if(l&&c===0){o.push(r.substring(r.indexOf(":",a)+1,n)),a=n+1;break}c--;break}return a<i&&o.push(r.substring(a,i)),{types:o.map(h=>this.parseFqTypeName(h)),hasCollections:f,isComposite:s}},this._parseUdtName=function(r,n,i){let s=On(r,n,i);if(s.length<2)throw new TypeError("Not a valid type "+r);let o={code:P.udt,info:null},a={keyspace:s[0],name:Me.allocBufferFromString(s[1],"hex").toString(),fields:[]};for(let c=2;c<s.length;c++){let l=s[c],f=l.indexOf(":"),h=this.parseFqTypeName(l,f+1,l.length-(f+1));a.fields.push({name:Me.allocBufferFromString(l.substr(0,f),"hex").toString(),type:h})}return o.info=a,o},e[Cu]=this.decodeDuration,t[Cu]=this.encodeDuration}u(WR,"defineInstanceMembers");function QR(){this.decoders={[P.custom]:this.decodeCustom,[P.ascii]:this.decodeAsciiString,[P.bigint]:this.decodeLong,[P.blob]:this.decodeBlob,[P.boolean]:this.decodeBoolean,[P.counter]:this.decodeLong,[P.decimal]:this.decodeDecimal,[P.double]:this.decodeDouble,[P.float]:this.decodeFloat,[P.int]:this.decodeInt,[P.text]:this.decodeUtf8String,[P.timestamp]:this.decodeTimestamp,[P.uuid]:this.decodeUuid,[P.varchar]:this.decodeUtf8String,[P.varint]:this.decodeVarint,[P.timeuuid]:this.decodeTimeUuid,[P.inet]:this.decodeInet,[P.date]:this.decodeDate,[P.time]:this.decodeTime,[P.smallint]:this.decodeSmallint,[P.tinyint]:this.decodeTinyint,[P.list]:this.decodeList,[P.map]:this.decodeMap,[P.set]:this.decodeSet,[P.udt]:this.decodeUdt,[P.tuple]:this.decodeTuple},this.encoders={[P.custom]:this.encodeCustom,[P.ascii]:this.encodeAsciiString,[P.bigint]:this.encodeLong,[P.blob]:this.encodeBlob,[P.boolean]:this.encodeBoolean,[P.counter]:this.encodeLong,[P.decimal]:this.encodeDecimal,[P.double]:this.encodeDouble,[P.float]:this.encodeFloat,[P.int]:this.encodeInt,[P.text]:this.encodeUtf8String,[P.timestamp]:this.encodeTimestamp,[P.uuid]:this.encodeUuid,[P.varchar]:this.encodeUtf8String,[P.varint]:this.encodeVarint,[P.timeuuid]:this.encodeUuid,[P.inet]:this.encodeInet,[P.date]:this.encodeDate,[P.time]:this.encodeTime,[P.smallint]:this.encodeSmallint,[P.tinyint]:this.encodeTinyint,[P.list]:this.encodeList,[P.map]:this.encodeMap,[P.set]:this.encodeSet,[P.udt]:this.encodeUdt,[P.tuple]:this.encodeTuple}}u(QR,"setEncoders");Mo.prototype.decode=function(e,t){if(e===null||e.length===0&&!zR.has(t.code))return null;let r=this.decoders[t.code];if(!r)throw new Error("Unknown data type: "+t.code);return r.call(this,e,t.info)};Mo.prototype.encode=function(e,t){if(e===void 0&&(e=this.encodingOptions.useUndefinedAsUnset&&this.protocolVersion>=4?pe.unset:null),e===pe.unset){if(!pe.protocolVersion.supportsUnset(this.protocolVersion))throw new TypeError("Unset value can not be used for this version of Cassandra, protocol version: "+this.protocolVersion);return e}if(e===null||e instanceof Buffer)return e;let r={code:null,info:null};if(t){if(typeof t=="number"?r.code=t:typeof t=="string"&&(r=P.getByName(t)),typeof t.code=="number"&&(r.code=t.code,r.info=t.info),typeof r.code!="number")throw new TypeError("Type information not valid, only String and Number values are valid hints")}else if(r=Mo.guessDataType(e),!r)throw new TypeError("Target data type could not be guessed, you should use prepared statements for accurate type mapping. Value: "+je.inspect(e));let n=this.encoders[r.code];if(!n)throw new Error("Type not supported "+r.code);return n.call(this,e,r.info)};Mo.guessDataType=function(e){let t=null,r=null,n=typeof e;return n==="number"?t=P.double:n==="string"?(t=P.text,e.length===36&&$R.test(e)&&(t=P.uuid)):n==="boolean"?t=P.boolean:e instanceof Buffer?t=P.blob:e instanceof Date?t=P.timestamp:e instanceof Fi?t=P.bigint:e instanceof _s?t=P.varint:e instanceof ws?t=P.decimal:e instanceof pe.Uuid?t=P.uuid:e instanceof pe.InetAddress?t=P.inet:e instanceof pe.Tuple?t=P.tuple:e instanceof pe.LocalDate?t=P.date:e instanceof pe.LocalTime?t=P.time:e instanceof pe.Duration?(t=P.custom,r=Cu):je.isArray(e)&&(t=P.list),t===null?null:{code:t,info:r}};function ZR(e){if(!e)return bs.int16Zero;let t=Me.allocBufferUnsafe(2);return typeof e=="number"?t.writeUInt16BE(e,0):t.writeUInt16BE(e.length,0),t}u(ZR,"getLengthBufferV2");function YR(e){if(!e)return bs.int32Zero;let t=Me.allocBufferUnsafe(4);return typeof e=="number"?t.writeInt32BE(e,0):t.writeInt32BE(e.length,0),t}u(YR,"getLengthBufferV3");function XR(e){return e===null?null:Me.copyBuffer(e)}u(XR,"handleBufferCopy");function JR(e){return e}u(JR,"handleBufferRef");function eD(e,t){return e.readInt32BE(t)}u(eD,"decodeCollectionLengthV3");function tD(e,t){return e.readUInt16BE(t)}u(tD,"decodeCollectionLengthV2");function On(e,t,r,n,i){n=n||"(",i=i||")";let s=[],o=t,a=0;for(let c=t;c<t+r;c++){let l=e[c];l===n&&a++,l===i&&a--,a===0&&l===","&&(s.push(e.substr(o,c-o)),o=c+1)}return s.push(e.substr(o,r-(o-t))),s}u(On,"parseParams");function yh(e,t){if(t===0)return null;if(e.length===1)return e[0];let r=Me.allocBufferUnsafe(t),n=0;for(let i=0;i<e.length;i++){let s=e[i];r.writeUInt16BE(s.length,n),n+=2,s.copy(r,n),n+=s.length,r[n]=0,n++}return r}u(yh,"concatRoutingKey");mE.exports=Mo});var CE=_(EE=>{"use strict";var As=require("util"),Ko=se(),ve=Ve(),rD=Ue(),vE={globalTablesSpec:1,hasMorePages:2,noMetadata:4};function Xe(e,t,r){this.header=e,this.opcode=e.opcode,this.offset=r||0,this.buf=t}u(Xe,"FrameReader");Xe.prototype.remainingLength=function(){return this.buf.length-this.offset};Xe.prototype.getBuffer=function(){return this.buf};Xe.prototype.slice=function(e,t){return typeof t>"u"&&(t=this.buf.length),this.buf.slice(e,t)};Xe.prototype.unshift=function(e){if(this.offset>0)throw new Error("Can not modify the underlying buffer if already read");this.buf=Buffer.concat([e,this.buf],e.length+this.buf.length)};Xe.prototype.read=function(e){let t=this.buf.length;typeof e<"u"&&this.offset+e<this.buf.length&&(t=this.offset+e);let r=this.slice(this.offset,t);return this.offset=t,r};Xe.prototype.toEnd=function(){this.offset=this.buf.length};Xe.prototype.readInt=function(){let e=this.buf.readInt32BE(this.offset);return this.offset+=4,e};Xe.prototype.readShort=function(){let e=this.buf.readUInt16BE(this.offset);return this.offset+=2,e};Xe.prototype.readByte=function(){let e=this.buf.readUInt8(this.offset);return this.offset+=1,e};Xe.prototype.readString=function(){let e=this.readShort();this.checkOffset(e);let t=this.buf.toString("utf8",this.offset,this.offset+e);return this.offset+=e,t};Xe.prototype.checkOffset=function(e){if(this.offset+e>this.buf.length){let t=new RangeError("Trying to access beyond buffer length");throw t.expectedLength=e,t}};Xe.prototype.readStringList=function(){let e=this.readShort(),t=new Array(e);for(let r=0;r<e;r++)t[r]=this.readString();return t};Xe.prototype.readBytes=function(){let e=this.readInt();return e<0?null:(this.checkOffset(e),this.read(e))};Xe.prototype.readShortBytes=function(){let e=this.readShort();return e<0?null:(this.checkOffset(e),this.read(e))};Xe.prototype.readBytesMap=function(){let e=this.readShort();if(e<0)return null;let t={};for(let r=0;r<e;r++)t[this.readString()]=this.readBytes();return t};Xe.prototype.readStringMultiMap=function(){let e=this.readShort();if(e<0)return null;let t={};for(let r=0;r<e;r++)t[this.readString()]=this.readStringList();return t};Xe.prototype.readType=function(){let e,t={code:this.readShort(),type:null};switch(t.code){case ve.dataTypes.custom:t.info=this.readString();break;case ve.dataTypes.list:case ve.dataTypes.set:t.info=this.readType();break;case ve.dataTypes.map:t.info=[this.readType(),this.readType()];break;case ve.dataTypes.udt:for(t.info={keyspace:this.readString(),name:this.readString(),fields:new Array(this.readShort())},e=0;e<t.info.fields.length;e++)t.info.fields[e]={name:this.readString(),type:this.readType()};break;case ve.dataTypes.tuple:for(t.info=new Array(this.readShort()),e=0;e<t.info.length;e++)t.info[e]=this.readType();break}return t};Xe.prototype.readInet=function(){let e=this.readByte(),t=this.read(e);return{address:new ve.InetAddress(t),port:this.readInt()}};Xe.prototype.readFlagsInfo=function(){if(this.header.flags===0)return Ko.emptyObject;let e={};return this.header.flags&ve.frameFlags.tracing&&(this.checkOffset(16),e.traceId=new ve.Uuid(Ko.copyBuffer(this.read(16)))),this.header.flags&ve.frameFlags.warning&&(e.warnings=this.readStringList()),this.header.flags&ve.frameFlags.customPayload&&(e.customPayload=this.readBytesMap()),e};Xe.prototype.readMetadata=function(e){let t,r=e===ve.resultKind.prepared,n={},i=this.readInt(),s=this.readInt();if(ve.protocolVersion.supportsPreparedPartitionKey(this.header.version)&&r)for(n.partitionKeys=new Array(this.readInt()),t=0;t<n.partitionKeys.length;t++)n.partitionKeys[t]=this.readShort();for(i&vE.hasMorePages&&(n.pageState=Ko.copyBuffer(this.readBytes())),i&vE.globalTablesSpec&&(n.global_tables_spec=!0,n.keyspace=this.readString(),n.table=this.readString()),n.columns=new Array(s),n.columnsByName=Ko.emptyObject,r&&(n.columnsByName={}),t=0;t<s;t++){let o={};n.global_tables_spec||(o.ksname=this.readString(),o.tablename=this.readString()),o.name=this.readString(),o.type=this.readType(),n.columns[t]=o,r&&(n.columnsByName[o.name]=t)}return n};var nD="Server timeout during write query at consistency %s (%d peer(s) acknowledged the write over %d required)",iD="Server timeout during batchlog write at consistency %s (%d peer(s) acknowledged the write over %d required)",sD="Server failure during write query at consistency %s (%d responses were required but only %d replicas responded, %d failed)",oD="Not enough replicas available for query at consistency %s (%d required but only %d alive)",aD="Server timeout during read query at consistency %s (%s)",uD="Server failure during read query at consistency %s (%d responses were required but only %d replicas responded, %d failed)";Xe.prototype.readError=function(){let e=this.readInt(),t=this.readString(),r=new rD.ResponseError(e,t);switch(e){case ve.responseErrorCodes.unavailableException:r.consistencies=this.readShort(),r.required=this.readInt(),r.alive=this.readInt(),r.message=As.format(oD,ve.consistencyToString[r.consistencies],r.required,r.alive);break;case ve.responseErrorCodes.readTimeout:case ve.responseErrorCodes.readFailure:if(r.consistencies=this.readShort(),r.received=this.readInt(),r.blockFor=this.readInt(),e===ve.responseErrorCodes.readFailure&&(r.failures=this.readInt()),r.isDataPresent=this.readByte(),e===ve.responseErrorCodes.readTimeout){let n;r.received<r.blockFor?n=As.format("%d replica(s) responded over %d required",r.received,r.blockFor):r.isDataPresent?n="timeout while waiting for repair of inconsistent replica":n="the replica queried for the data didn't respond",r.message=As.format(aD,ve.consistencyToString[r.consistencies],n)}else r.message=As.format(uD,ve.consistencyToString[r.consistencies],r.blockFor,r.received,r.failures);break;case ve.responseErrorCodes.writeTimeout:case ve.responseErrorCodes.writeFailure:if(r.consistencies=this.readShort(),r.received=this.readInt(),r.blockFor=this.readInt(),e===ve.responseErrorCodes.writeFailure&&(r.failures=this.readInt()),r.writeType=this.readString(),e===ve.responseErrorCodes.writeTimeout){let n=r.writeType==="BATCH_LOG"?iD:nD;r.message=As.format(n,ve.consistencyToString[r.consistencies],r.received,r.blockFor)}else r.message=As.format(sD,ve.consistencyToString[r.consistencies],r.blockFor,r.received,r.failures);break;case ve.responseErrorCodes.unprepared:r.queryId=Ko.copyBuffer(this.readShortBytes());break;case ve.responseErrorCodes.functionFailure:r.keyspace=this.readString(),r.functionName=this.readString(),r.argTypes=this.readStringList();break;case ve.responseErrorCodes.alreadyExists:{r.keyspace=this.readString();let n=this.readString();n.length>0&&(r.table=n);break}}return r};Xe.prototype.readEvent=function(){let e=this.readString();switch(e){case ve.protocolEvents.topologyChange:return{added:this.readString()==="NEW_NODE",inet:this.readInet(),eventType:e};case ve.protocolEvents.statusChange:return{up:this.readString()==="UP",inet:this.readInet(),eventType:e};case ve.protocolEvents.schemaChange:return this.parseSchemaChange()}return{eventType:e}};Xe.prototype.parseSchemaChange=function(){let e;if(!ve.protocolVersion.supportsSchemaChangeFullMetadata(this.header.version))return e={eventType:ve.protocolEvents.schemaChange,schemaChangeType:this.readString(),keyspace:this.readString(),table:this.readString()},e.isKeyspace=!e.table,e;switch(e={eventType:ve.protocolEvents.schemaChange,schemaChangeType:this.readString(),target:this.readString(),keyspace:this.readString(),table:null,udt:null,signature:null},e.isKeyspace=e.target==="KEYSPACE",e.target){case"TABLE":e.table=this.readString();break;case"TYPE":e.udt=this.readString();break;case"FUNCTION":e.functionName=this.readString(),e.signature=this.readStringList();break;case"AGGREGATE":e.aggregate=this.readString(),e.signature=this.readStringList()}return e};EE.FrameReader=Xe});var _E=_(Tu=>{"use strict";var vh=require("util"),SE=require("stream"),xu=SE.Transform,xE=SE.Writable,jt=Ve(),TE=se(),Ho=Ue(),Su=jt.FrameHeader,cD=CE().FrameReader;function $o(e){xu.call(this,e),this.header=null,this.bodyLength=0,this.clearHeaderChunks(),this.version=0,this.headerSize=0}u($o,"Protocol");vh.inherits($o,xu);$o.prototype._transform=function(e,t,r){let n=null;try{this.readItems(e)}catch(i){n=i}r(n)};$o.prototype.readItems=function(e){if(!e||e.length===0)return;this.version===0&&(this.version=Su.getProtocolVersion(e),this.headerSize=Su.size(this.version));let t=0,r=this.header;if(this.header=null,this.headerChunks.byteLength!==0){if(this.headerChunks.parts.push(e),this.headerChunks.byteLength+e.length<this.headerSize){this.headerChunks.byteLength+=e.length;return}r=Su.fromBuffer(Buffer.concat(this.headerChunks.parts,this.headerSize)),t=this.headerSize-this.headerChunks.byteLength,this.clearHeaderChunks()}let n=[];for(;;){if(!r){if(this.headerSize>e.length-t){if(e.length-t<=0)break;let s=e.slice(t,e.length);this.headerChunks.parts.push(s),this.headerChunks.byteLength=s.length;break}r=Su.fromBuffer(e,t),t+=this.headerSize}let i=e.length-t;if(r.bodyLength<=i+this.bodyLength)n.push({header:r,chunk:e,offset:t,frameEnded:!0}),t+=r.bodyLength-this.bodyLength,this.bodyLength=0;else if(i>=0){this.header=r,this.bodyLength+=i,i>0&&n.push({header:r,chunk:e,offset:t,frameEnded:!1});break}r=null}for(let i=0;i<n.length;i++)this.push(n[i])};$o.prototype.clearHeaderChunks=function(){this.headerChunks={byteLength:0,parts:[]}};function Tr(e,t){xu.call(this,e),this.frames={},this.encoder=t}u(Tr,"Parser");vh.inherits(Tr,xu);Tr.prototype._transform=function(e,t,r){let n=this.frameState(e),i=null;try{this.parseBody(n,e)}catch(s){i=s}r(i),e.frameEnded&&(n.cellBuffer&&this.push({header:n.header,error:new Ho.DriverInternalError("There was an problem while parsing streaming frame, opcode "+n.header.opcode)}),this.push({header:n.header,frameEnded:!0}))};Tr.prototype.parseBody=function(e,t){if(e.isStreaming=e.byRow&&t.header.opcode===jt.opcodes.result,!this.handleFrameBuffers(e,t))return;let r=new cD(t.header,t.chunk,t.offset);if(e.flagsInfo===void 0){let n=r.offset;try{e.flagsInfo=r.readFlagsInfo()}catch(i){return this.handleParsingError(i,e,r,n)}}switch(t.header.opcode){case jt.opcodes.result:return this.parseResult(e,r);case jt.opcodes.ready:case jt.opcodes.authSuccess:return this.push({header:e.header,ready:!0});case jt.opcodes.authChallenge:return this.push({header:e.header,authChallenge:!0,token:r.readBytes()});case jt.opcodes.authenticate:return this.push({header:e.header,mustAuthenticate:!0,authenticatorName:r.readString()});case jt.opcodes.error:return this.push({header:e.header,error:r.readError()});case jt.opcodes.supported:return this.push({header:e.header,supported:r.readStringMultiMap()});case jt.opcodes.event:return this.push({header:e.header,event:r.readEvent()});default:return this.push({header:e.header,error:new Error("Received invalid opcode: "+t.header.opcode)})}};Tr.prototype.handleFrameBuffers=function(e,t){if(!e.isStreaming)return(e.bufferLength||0)+t.chunk.length-t.offset<t.header.bodyLength?(this.addFrameBuffer(e,t),!1):(e.buffers&&(t.chunk=this.getFrameBuffer(e,t),t.offset=0),!0);if(e.cellBuffer){if(t.offset!==0)throw new Ho.DriverInternalError("Following chunks can not have an offset greater than zero");if(e.cellBuffer.parts.push(t.chunk),!e.cellBuffer.expectedLength){if(e.cellBuffer.parts.length!==2)throw new Ho.DriverInternalError("Buffer for streaming frame can not contain more than 1 item");return t.chunk=Buffer.concat(e.cellBuffer.parts,e.cellBuffer.byteLength+t.chunk.length),e.cellBuffer=null,!0}if(e.cellBuffer.expectedLength>e.cellBuffer.byteLength+t.chunk.length)return e.cellBuffer.byteLength+=t.chunk.length,!1;t.chunk=Buffer.concat(e.cellBuffer.parts,e.cellBuffer.byteLength+t.chunk.length),e.cellBuffer=null}return!0};Tr.prototype.addFrameBuffer=function(e,t){if(!e.buffers){e.buffers=[t.chunk.slice(t.offset)],e.bufferLength=t.chunk.length-t.offset;return}if(t.offset>0)throw new Ho.DriverInternalError("Following chunks can not have an offset greater than zero");e.buffers.push(t.chunk),e.bufferLength+=t.chunk.length};Tr.prototype.getFrameBuffer=function(e,t){e.buffers.push(t.chunk);let r=Buffer.concat(e.buffers,e.bodyLength);return e.buffers=null,r};Tr.prototype.parseResult=function(e,t){let r,n=t.offset;try{if(!e.meta)switch(e.kind=t.readInt(),e.kind){case jt.resultKind.voidResult:r={header:e.header,flags:e.flagsInfo};break;case jt.resultKind.rows:e.meta=t.readMetadata(e.kind);break;case jt.resultKind.setKeyspace:r={header:e.header,keyspaceSet:t.readString(),flags:e.flagsInfo};break;case jt.resultKind.prepared:{let i=TE.copyBuffer(t.readShortBytes());e.meta=t.readMetadata(e.kind),r={header:e.header,id:i,meta:e.meta,flags:e.flagsInfo};break}case jt.resultKind.schemaChange:r={header:e.header,schemaChange:t.parseSchemaChange(),flags:e.flagsInfo};break;default:throw Ho.DriverInternalError("Unexpected result kind: "+e.kind)}}catch(i){return this.handleParsingError(i,e,t,n)}if(r)return e.emitted?void 0:(e.emitted=!0,this.push(r));t.remainingLength()>0&&this.parseRows(e,t)};Tr.prototype.parseRows=function(e,t){if(e.parsingError)return;if(e.rowLength===void 0)try{e.rowLength=t.readInt()}catch(n){return this.handleParsingError(n,e,t)}if(e.rowLength===0)return this.push({header:e.header,result:{rows:TE.emptyArray,meta:e.meta,flags:e.flagsInfo}});let r=e.meta;e.rowIndex=e.rowIndex||0;for(let n=e.rowIndex;n<e.rowLength;n++){let i=t.offset,s=new jt.Row(r.columns),o;for(let a=0;a<r.columns.length;a++){let c=r.columns[a];try{o=t.readBytes()}catch(l){return this.handleParsingError(l,e,t,i,n)}try{s[c.name]=this.encoder.decode(o,c.type)}catch(l){return this.handleParsingError(l,e,null)}}this.push({header:e.header,row:s,meta:e.meta,byRow:e.byRow,length:e.rowLength,flags:e.flagsInfo})}};Tr.prototype.setOptions=function(e,t){if(this.frames[e.toString()])throw new jt.DriverError("There was already state for this frame");this.frames[e.toString()]=t};Tr.prototype.frameState=function(e){let t=this.frames[e.header.streamId];return t?e.frameEnded&&delete this.frames[e.header.streamId]:(t={},e.frameEnded||(this.frames[e.header.streamId]=t)),t.header=e.header,t};Tr.prototype.handleParsingError=function(e,t,r,n,i){if(r&&t.isStreaming&&e instanceof RangeError)return this.bufferResultCell(t,r,n,i,e.expectedLength);t.parsingError=!0,t.cellBuffer=null,this.push({header:t.header,error:e})};Tr.prototype.bufferResultCell=function(e,t,r,n,i){!r&&r!==0&&(r=t.offset),e.rowIndex=n;let s=t.slice(r);e.cellBuffer={parts:[s],byteLength:s.length,expectedLength:i}};function Go(e){xE.call(this,e),this.rowBuffer={}}u(Go,"ResultEmitter");vh.inherits(Go,xE);Go.prototype._write=function(e,t,r){let n=null;try{this.each(e)}catch(i){n=i}r(n)};Go.prototype.each=function(e){return e.error||e.result?this.emit("result",e.header,e.error,e.result):e.frameEnded?this.emit("frameEnded",e.header):e.byRow?this.emit("row",e.header,e.row,e.meta,e.length,e.flags):e.row?this.bufferAndEmit(e):e.event?this.emit("nodeEvent",e.header,e.event):this.emit("result",e.header,null,e)};Go.prototype.bufferAndEmit=function(e){let t=this.rowBuffer[e.header.streamId];t||(t=this.rowBuffer[e.header.streamId]=[]),t.push(e.row),t.length===e.length&&(this.emit("result",e.header,null,{rows:t,meta:e.meta,flags:e.flags}),delete this.rowBuffer[e.header.streamId])};Tu.Protocol=$o;Tu.Parser=Tr;Tu.ResultEmitter=Go});var AE=_((i5,IE)=>{"use strict";var lD=Ve(),_u=128,wE=7,Eh=4,fD=256,hD=5e3,Sh=class Sh{constructor(t){this.currentGroup=bE(0),this.groupIndex=0,this.groups=[this.currentGroup],this.releaseTimeout=null,this.setVersion(t),this.inUse=0,this.releaseDelay=hD}setVersion(t){this.maxGroups=lD.protocolVersion.uses2BytesStreamIds(t)?fD:1}pop(){let t=this.currentGroup.pop();if(typeof t<"u")return this.inUse++,t;for(;this.groupIndex<this.groups.length-1;)if(this.currentGroup=this.groups[++this.groupIndex],t=this.currentGroup.pop(),typeof t<"u")return this.inUse++,t;return this._tryCreateGroup()}push(t){this.inUse--;let r=t>>wE,n=this.groups[r];n.push(t),r<this.groupIndex&&(this.groupIndex=r,this.currentGroup=n),this._tryIssueRelease()}clear(){this.releaseTimeout&&(clearTimeout(this.releaseTimeout),this.releaseTimeout=null)}_tryCreateGroup(){return this.groups.length===this.maxGroups?null:(this.groupIndex=this.groups.length,this.currentGroup=bE(this.groupIndex<<wE),this.groups.push(this.currentGroup),this.inUse++,this.currentGroup.pop())}_tryIssueRelease(){this.releaseTimeout||this.groups.length<=Eh||(this.releaseTimeout=setTimeout(()=>this._releaseGroups(),this.releaseDelay))}_releaseGroups(){let t=0,r=this.groups.length-1;for(;t++<Eh&&this.groups.length>Eh&&r>this.groupIndex&&this.groups[r].length===_u;)this.groups.pop(),r--;this.releaseTimeout=null,this._tryIssueRelease()}};u(Sh,"StreamIdStack");var Ch=Sh;function bE(e){let t=new Array(_u),r=e+_u-1;for(let n=0;n<_u;n++)t[n]=r-n;return t}u(bE,"generateGroup");IE.exports=Ch});var LE=_((o5,DE)=>{"use strict";var pD=require("util"),BE=se(),NE=Ue(),RE=Li(),dD=RE.ExecuteRequest,gD=RE.QueryRequest,Fn={init:0,completed:1,timedOut:2,cancelled:3},Th=class Th{constructor(t,r,n){this.request=t,this._rowCallback=r,this._callback=n,this._timeout=null,this._state=Fn.init,this._rowIndex=0,this.streamId=-1}cancel(){this._state===Fn.init&&(this._timeout!==null&&clearTimeout(this._timeout),this._state=Fn.cancelled,this._callback=BE.noop)}canBeWritten(){return this._state===Fn.init}isByRow(){return this._rowCallback&&(this.request instanceof dD||this.request instanceof gD)}setRequestTimeout(t,r,n,i,s){if(this._state!==Fn.init)return;let o=t.getReadTimeout()!==void 0?t.getReadTimeout():r;if(!(o>0))return;let a=this;this._timeout=setTimeout(u(function(){i();let l=pD.format("The host %s did not reply before timeout %d ms",n,o);a._markAsTimedOut(new NE.OperationTimedOutError(l,n),s)},"requestTimedOut"),o)}setResultRow(t,r,n,i,s){if(this._markAsCompleted(),!this._rowCallback)return this.setResult(new NE.DriverInternalError("RowCallback not found for streaming frame handler"));this._rowCallback(this._rowIndex++,t,n),this._rowIndex===n&&this._swapCallbackAndInvoke(null,{rowLength:n,meta:r,flags:i},s.bodyLength)}_markAsTimedOut(t,r){this._state===Fn.init&&(this._state=Fn.timedOut,this._swapCallbackAndInvoke(t,null,null,r))}_markAsCompleted(){this._state===Fn.init&&(this._timeout!==null&&clearTimeout(this._timeout),this._state=Fn.completed)}setResult(t,r,n){this._markAsCompleted(),this._swapCallbackAndInvoke(t,r,n)}_swapCallbackAndInvoke(t,r,n,i){let s=this._callback;this._callback=i||BE.noop,s(t,r,n)}};u(Th,"OperationState");var xh=Th;DE.exports=xh});var Ih=_((u5,OE)=>{"use strict";var wh=require("events"),bh=require("util"),yD=require("tls"),mD=require("net"),vD=mh(),ED=kf().WriteQueue,Ns=Li(),_h=_E(),Bs=se(),nn=Ve(),Pi=Ue(),CD=AE(),SD=LE(),xD=Ss().ExecutionOptions;function Oe(e,t,r){if(wh.EventEmitter.call(this),this.setMaxListeners(0),!r)throw new Error("options is not defined");if(this.endpoint=e,this.endpointFriendlyName=this.endpoint,r.sni&&(this._serverName=e,this.endpoint=`${r.sni.addressResolver.getIp()}:${r.sni.port}`,this.endpointFriendlyName=`${this.endpoint} (${this._serverName})`),!this.endpoint||this.endpoint.indexOf(":")<0)throw new Error("EndPoint must contain the ip address and port separated by : symbol");let n=this.endpoint.lastIndexOf(":");this.address=this.endpoint.substr(0,n),this.port=this.endpoint.substr(n+1),Object.defineProperty(this,"options",{value:r,enumerable:!1,writable:!1}),t===null&&(t=nn.protocolVersion.maxSupported,r.protocolOptions.maxVersion&&(t=r.protocolOptions.maxVersion),this._checkingVersion=!0),this.protocolVersion=t,this._operations={},this._pendingWrites=[],this._preparing={},this._idleTimeout=null,this.timedOutOperations=0,this._streamIds=new CD(this.protocolVersion),this._metrics=r.metrics,this.encoder=new vD(t,r),this.keyspace=null,this.emitDrain=!1,this.connected=!1,this.isSocketOpen=!1}u(Oe,"Connection");bh.inherits(Oe,wh.EventEmitter);Oe.prototype.log=Bs.log;Oe.prototype.bindSocketListeners=function(){this.netClient.removeAllListeners("connect"),this.netClient.removeAllListeners("timeout"),this.isSocketOpen=!0,this.netClient.on("close",()=>{this.log("info",`Connection to ${this.endpointFriendlyName} closed`),this.isSocketOpen=!1;let t=this.connected;this.close(),t&&this.emit("socketClose")}),this.protocol=new _h.Protocol({objectMode:!0}),this.parser=new _h.Parser({objectMode:!0},this.encoder);let e=new _h.ResultEmitter({objectMode:!0});e.on("result",this.handleResult.bind(this)),e.on("row",this.handleRow.bind(this)),e.on("frameEnded",this.freeStreamId.bind(this)),e.on("nodeEvent",this.handleNodeEvent.bind(this)),this.netClient.pipe(this.protocol).pipe(this.parser).pipe(e),this.writeQueue=new ED(this.netClient,this.encoder,this.options)};Oe.prototype.open=function(e){let t=this;if(this.log("info",`Connecting to ${this.endpointFriendlyName}`),!this.options.sslOptions)this.netClient=new mD.Socket({highWaterMark:this.options.socketOptions.coalescingThreshold}),this.netClient.connect(this.port,this.address,u(function(){t.log("verbose",`Socket connected to ${t.endpointFriendlyName}`),t.bindSocketListeners(),t.startup(e)},"connectCallback"));else{let r=Bs.extend({rejectUnauthorized:!1},this.options.sslOptions);this.options.sni&&(r.servername=this._serverName),this.netClient=yD.connect(this.port,this.address,r,u(function(){t.log("verbose",`Secure socket connected to ${t.endpointFriendlyName}`),t.bindSocketListeners(),t.startup(e)},"tlsConnectCallback")),this.netClient.setMaxSendFragment(this.options.socketOptions.coalescingThreshold)}this.netClient.once("error",u(function(n){t.errorConnecting(n,!1,e)},"socketError")),this.netClient.once("timeout",u(function(){let n=new nn.DriverError("Connection timeout");t.errorConnecting(n,!0,e)},"connectTimedOut")),this.netClient.setTimeout(this.options.socketOptions.connectTimeout),this.options.socketOptions.keepAlive&&this.netClient.setKeepAlive(!0,this.options.socketOptions.keepAliveDelay),this.netClient.setNoDelay(!!this.options.socketOptions.tcpNoDelay)};Oe.prototype.startup=function(e){this._checkingVersion&&this.log("info","Trying to use protocol version 0x"+this.protocolVersion.toString(16));let t=this,r=new Ns.StartupRequest({noCompact:this.options.protocolOptions.noCompact});this.sendStream(r,null,u(function(s,o){if(s&&t._checkingVersion){let a=s instanceof Pi.ResponseError&&s.code===nn.responseErrorCodes.protocolError&&s.message.indexOf("Invalid or unsupported protocol version")>=0;if(!a&&nn.protocolVersion.canStartupResponseErrorBeWrapped(t.protocolVersion)&&(a=s instanceof Pi.ResponseError&&s.code===nn.responseErrorCodes.serverError&&s.message.indexOf("ProtocolException: Invalid or unsupported protocol version")>0),a){let c=t.protocol.version;if(c===t.protocolVersion&&(c=nn.protocolVersion.getLowerSupported(t.protocolVersion)),!c)return n(new Error("Connection was unable to STARTUP using protocol version "+t.protocolVersion));t.log("info","Protocol 0x"+t.protocolVersion.toString(16)+" not supported, using 0x"+c.toString(16)),t.decreaseVersion(c),setImmediate(u(function(){t.close(u(function(){t.open(e)},"decreasingVersionOpening"))},"decreasingVersionClosing"));return}}if(o&&o.mustAuthenticate)return t.startAuthenticating(o.authenticatorName,n);n(s)},"responseCallback"));function n(i){return i?t.errorConnecting(i,!1,e):t.connectionReady(e)}u(n,"startupCallback")};Oe.prototype.errorConnecting=function(e,t,r){this.log("warning",`There was an error when trying to connect to the host ${this.endpointFriendlyName}`,e),t&&this.netClient.destroy(),this._metrics.onConnectionError(e),r(e)};Oe.prototype.connectionReady=function(e){this.emit("connected"),this.connected=!0,this.netClient.removeAllListeners("error"),this.netClient.on("error",this.handleSocketError.bind(this)),e()};Oe.prototype.decreaseVersion=function(e){this.protocolVersion=e,this.encoder.setProtocolVersion(e),this._streamIds.setVersion(e)};Oe.prototype.handleSocketError=function(e){this._metrics.onConnectionError(e),this.clearAndInvokePending(e)};Oe.prototype.clearAndInvokePending=function(e){this._idleTimeout&&(clearTimeout(this._idleTimeout),this._idleTimeout=null),this._streamIds.clear(),this.emitDrain&&this.emit("drain");let t=new nn.DriverError("Socket was closed");t.isSocketError=!0,e&&(t.innerError=e);let r=Bs.objectValues(this._operations);this._operations={},r.length>0&&this.log("info","Invoking "+r.length+" pending callbacks"),Bs.each(r,function(i,s){i.setResult(t),s()});let n=this._pendingWrites;this._pendingWrites=[],Bs.each(n,function(i,s){i.setResult(t),s()})};Oe.prototype.startAuthenticating=function(e,t){if(!this.options.authProvider)return t(new Pi.AuthenticationError("Authentication provider not set"));let r=this.options.authProvider.newAuthenticator(this.endpoint,e),n=this;r.initialResponse(u(function(s,o){if(s)return n.onAuthenticationError(t,s);n.authenticate(r,o,t)},"initialResponseCallback"))};Oe.prototype.authenticate=function(e,t,r){let n=this,i=new Ns.AuthResponseRequest(t);if(this.protocolVersion===1){if(!e.username)return n.onAuthenticationError(r,new Pi.AuthenticationError("Only plain text authenticator providers allowed under protocol v1"));i=new Ns.CredentialsRequest(e.username,e.password)}this.sendStream(i,null,u(function(o,a){if(o){if(o instanceof Pi.ResponseError&&o.code===nn.responseErrorCodes.badCredentials){let c=new Pi.AuthenticationError(o.message);c.additionalInfo=o,o=c}return n.onAuthenticationError(r,o)}if(a.ready)return e.onAuthenticationSuccess(),r();if(a.authChallenge)return e.evaluateChallenge(a.token,u(function(l,f){if(l)return n.onAuthenticationError(r,l);n.authenticate(e,f,r)},"evaluateCallback"));r(new Pi.DriverInternalError("Unexpected response from Cassandra: "+bh.inspect(a)))},"authResponseCallback"))};Oe.prototype.onAuthenticationError=function(e,t){this._metrics.onAuthenticationError(t),e(t)};Oe.prototype.changeKeyspace=function(e,t){if(!e||this.keyspace===e)return t();if(this.once("keyspaceChanged",t),this.toBeKeyspace===e)return;this.toBeKeyspace=e;let r=bh.format('USE "%s"',e),n=this;this.sendStream(new Ns.QueryRequest(r,null,null),null,u(function(s){s?n.log("error",`Connection to ${n.endpointFriendlyName} could not switch active keyspace`,s):n.keyspace=e,n.toBeKeyspace=null,n.emit("keyspaceChanged",s,e)},"changeKeyspaceResponseCallback"))};Oe.prototype.prepareOnce=function(e,t){let r=(this.keyspace||"")+e,n=this._preparing[r];if(this._preparing[r])return n.once("prepared",t);n=new wh.EventEmitter,n.setMaxListeners(0),n.once("prepared",t),this._preparing[r]=n;let i=this;this.sendStream(new Ns.PrepareRequest(e),null,function(s,o){n.emit("prepared",s,o),delete i._preparing[r]})};Oe.prototype.sendStream=function(e,t,r){t=t||xD.empty();let n=new SD(e,t.getRowCallback(),(s,o,a)=>{(!s||!s.isSocketError)&&this.emit("responseDequeued"),r(s,o,a)}),i=this._getStreamId();return n.setRequestTimeout(t,this.options.socketOptions.readTimeout,this.endpoint,()=>this.timedOutOperations++,()=>this.timedOutOperations--),i===null?(this.log("info","Enqueuing "+this._pendingWrites.length+", if this message is recurrent consider configuring more connections per host or lowering the pressure"),this._pendingWrites.push(n),n):(this._write(n,i),n)};Oe.prototype._write=function(e,t){e.streamId=t;let r=this;this.writeQueue.push(e,u(function(i){if(i)return r._streamIds.push(t),e.setResult(i);r.log("verbose","Sent stream #"+t+" to "+r.endpointFriendlyName),e.isByRow()&&r.parser.setOptions(t,{byRow:!0}),r._setIdleTimeout(),r._operations[t]=e},"writeCallback"))};Oe.prototype._setIdleTimeout=function(){if(!this.options.pooling.heartBeatInterval)return;let e=this,t=this._idleTimeout;e._idleTimeout=setTimeout(()=>e._idleTimeoutHandler(),e.options.pooling.heartBeatInterval),t&&clearTimeout(t)};Oe.prototype._idleTimeoutHandler=function(){if(this.sendingIdleQuery){this._idleTimeout=setTimeout(()=>this._idleTimeoutHandler(),this.options.pooling.heartBeatInterval);return}this.log("verbose",`Connection to ${this.endpointFriendlyName} idling, issuing a request to prevent disconnects`),this.sendingIdleQuery=!0,this.sendStream(Ns.options,null,e=>{this.sendingIdleQuery=!1,e&&(this.log("warning","Received heartbeat request error",e),this.emit("idleRequestError",e,this))})};Oe.prototype._getStreamId=function(){return this._streamIds.pop()};Oe.prototype.freeStreamId=function(e){let t=e.streamId;t<0||(delete this._operations[t],this._streamIds.push(t),this.emitDrain&&this._streamIds.inUse===0&&this._pendingWrites.length===0&&this.emit("drain"),this._writeNext())};Oe.prototype._writeNext=function(){if(this._pendingWrites.length===0)return;let e=this._getStreamId();if(e===null)return;let t=this,r;for(;(r=this._pendingWrites.shift())&&!r.canBeWritten(););if(!r){this._streamIds.push(e);return}setImmediate(u(function(){t._write(r,e)},"writeNextPending"))};Oe.prototype.getInFlight=function(){return this._streamIds.inUse};Oe.prototype.handleResult=function(e,t,r){let n=e.streamId;if(n<0)return this.log("verbose","event received",e);let i=this._operations[n];if(!i)return this.log("error","The server replied with a wrong streamId #"+n);this.log("verbose","Received frame #"+n+" from "+this.endpointFriendlyName),i.setResult(t,r,e.bodyLength)};Oe.prototype.handleNodeEvent=function(e,t){switch(t.eventType){case nn.protocolEvents.schemaChange:this.emit("nodeSchemaChange",t);break;case nn.protocolEvents.topologyChange:this.emit("nodeTopologyChange",t);break;case nn.protocolEvents.statusChange:this.emit("nodeStatusChange",t);break}};Oe.prototype.handleRow=function(e,t,r,n,i){let s=e.streamId;if(s<0)return this.log("verbose","Event received",e);let o=this._operations[s];if(!o)return this.log("error","The server replied with a wrong streamId #"+s);o.setResultRow(t,r,n,i,e)};Oe.prototype.close=function(e){if(e=e||Bs.noop,!this.connected&&!this.isSocketOpen||(this.connected=!1,this.removeAllListeners("drain"),this.clearAndInvokePending(),!this.isSocketOpen))return e();this.isSocketOpen=!1,this.log("verbose",`Closing connection to ${this.endpointFriendlyName}`);let t=this,r=setTimeout(()=>{this.log("info",`${this.endpointFriendlyName} did not respond to connection close within ${this.options.socketOptions.connectTimeout}ms, destroying connection`),this.netClient.destroy()},this.options.socketOptions.connectTimeout);this.netClient.once("close",function(n){clearTimeout(r),n&&t.log("info","The socket closed with a transmission error"),setImmediate(e)}),this.netClient.removeAllListeners("error"),this.netClient.on("error",n=>this.clearAndInvokePending(n)),this.netClient.end()};Oe.prototype.getLocalAddress=function(){if(this.netClient)return this.netClient.localAddress};OE.exports=Oe});var PE=_((l5,FE)=>{"use strict";var ki=require("util"),TD=require("events"),_D=Ih(),Pn=se(),wD=Ue(),bD=fu().defaultOptions(),jo=0,ID=Math.pow(2,15),_r={initial:0,closing:1,shuttingDown:2,shutDown:4},wu=class wu extends TD.EventEmitter{constructor(t,r){super(),this._address=t.address,this._newConnectionTimeout=null,this._creating=!1,this._state=_r.initial,this._host=t,this.responseCounter=0,this.options=t.options,this.protocolVersion=r,this.coreConnectionsLength=1,this.connections=Pn.emptyArray,this.setMaxListeners(0),this.log=Pn.log}createAndBorrowConnection(t,r){this.create(!1,n=>{if(n)return r(n);this.borrowConnection(t,null,r)})}getInFlight(){let t=this.connections.length;if(t===1)return this.connections[0].getInFlight();let r=0;for(let n=0;n<t;n++)r+=this.connections[n].getInFlight();return r}borrowConnection(t,r,n){if(this.connections.length===0)return n(new Error("No connection available"));let i=this.options.pooling.maxRequestsPerConnection,s=wu.minInFlight(this.connections,i,r);if(s.getInFlight()>=i)return n(new wD.BusyConnectionError(this._address,i,this.connections.length));if(!t||t===s.keyspace)return n(null,s);s.changeKeyspace(t,o=>{n(o,s)})}static minInFlight(t,r,n){let i=t.length;if(i===1)return t[0];jo++,jo>=ID&&(jo=0);let s;for(let o=jo;o<jo+i;o++){s=t[o%i],s===n&&(s=t[++o%i]);let a=t[(o+1)%i];if(a===n&&(a=t[(o+2)%i]),a.getInFlight()<s.getInFlight()&&(s=a),s.getInFlight()<r)break}return s}create(t,r){if(this.isClosing())return r(new Error("Pool is being closed when calling create"));if(this.connections.length>=this.coreConnectionsLength)return r();if(!t&&this.connections.length>0)return this.increaseSize(),r();if(this.once("creation",r),this._creating)return;this._creating=!0;let n=this.coreConnectionsLength;t||(n=1);let i=this;Pn.whilst(u(function(){return i.connections.length<n},"condition"),u(function(o){i._attemptNewConnection(o)},"iterator"),u(function(o){if(i._creating=!1,o)return i.isClosing()?(i.log("info","Connection pool created but it was being closed"),i._closeAllConnections(),o=new Error("Pool is being closed")):i.log("warning",ki.format("Connection pool to host %s could not be created",i._address),o),i.emit("creation",o);i.log("info",ki.format("Connection pool to host %s created with %d connection(s)",i._address,i.connections.length)),i.emit("creation"),i.increaseSize()},"whilstEnded"))}_createConnection(){let t=this.options.sni?this._host.hostId.toString():this._address,r=new _D(t,this.protocolVersion,this.options);return this._addListeners(r),r}_addListeners(t){t.on("responseDequeued",()=>this.responseCounter++);let r=this;function n(){r.remove(t)}u(n,"connectionErrorCallback"),t.on("idleRequestError",n),t.on("socketClose",n)}addExistingConnection(t){this._addListeners(t),this.connections=this.connections.slice(0),this.connections.push(t)}clearNewConnectionAttempt(){this._newConnectionTimeout&&(clearTimeout(this._newConnectionTimeout),this._newConnectionTimeout=null)}_attemptNewConnection(t){let r=this._createConnection(),n=this;this.once("open",t),!this._opening&&(this._opening=!0,r.open(u(function(s){if(n._opening=!1,s)return n.log("warning",ki.format("Connection to %s could not be created: %s",n._address,s),s),r.close(),n.emit("open",s);if(n.isClosing())return n.log("info",ki.format("Connection to %s opened successfully but pool was being closed",n._address)),r.close(),n.emit("open",new Error("Connection closed"));let o=n.connections.slice(0);o.push(r),n.connections=o,n.log("info",ki.format("Connection to %s opened successfully",n._address)),n.emit("open",null,r)},"attemptOpenCallback")))}attemptNewConnectionImmediate(){let t=this;function r(){t.clearNewConnectionAttempt(),t.scheduleNewConnectionAttempt(0)}if(u(r,"openConnection"),this._state===_r.initial)return r();if(this._state===_r.closing)return this.once("close",r)}remove(t){let r=this.connections.indexOf(t);if(r<0)return;let n=this.connections.slice(0);n.splice(r,1),this.connections=n,setImmediate(u(function(){t.close()},"removeClose")),this.emit("remove")}scheduleNewConnectionAttempt(t){if(this.isClosing())return;let r=this;this._newConnectionTimeout=setTimeout(u(function(){if(r._newConnectionTimeout=null,!(r.connections.length>=r.coreConnectionsLength)){if(t>0&&r.options.sni){r.options.sni.addressResolver.refresh(()=>r._attemptNewConnection(Pn.noop));return}r._attemptNewConnection(Pn.noop)}},"newConnectionTimeoutExpired"),t)}hasScheduledNewConnection(){return!!this._newConnectionTimeout||this._opening}increaseSize(){this.connections.length<this.coreConnectionsLength&&!this.hasScheduledNewConnection()&&this.scheduleNewConnectionAttempt(0)}getAndResetResponseCounter(){let t=this.responseCounter;return this.responseCounter=0,t}isClosing(){return this._state!==_r.initial}drainAndShutdown(){if(this.isClosing())return;this._state=_r.closing,this.clearNewConnectionAttempt();let t=this;if(this.connections.length===0)return this._afterClosing();let r=this.connections;this.connections=Pn.emptyArray;let n=0;this.log("info",ki.format("Draining and closing %d connections to %s",r.length,this._address));let i=!1,s;for(let c=0;c<r.length;c++){let l=r[c];if(l.getInFlight()===0){o(l)();continue}l.emitDrain=!0,l.once("drain",o(l))}function o(c){return u(function(){c.close(),!(++n<r.length)&&(i||(i=!0,s&&clearTimeout(s),t._afterClosing()))},"delayedClose")}u(o,"getDelayedClose");let a=(this.options.socketOptions.readTimeout||bD.socketOptions.readTimeout)+100;s=setTimeout(u(function(){i=!0,r.forEach(u(function(f){f.close()},"connectionEach")),t._afterClosing()},"checkShutdown"),a)}_afterClosing(){let t=this;function r(){t._state===_r.shuttingDown?t._state=_r.shutDown:t._state=_r.initial,t.emit("close")}if(u(r,"resetState"),this._creating)return this.once("creation",r);if(this._opening)return this.once("open",r);r()}shutdown(t){if(this.clearNewConnectionAttempt(),!this.connections.length)return this._state=_r.shutDown,t();let r=this._state;if(this._state=_r.shuttingDown,r===_r.closing)return this.once("close",t);if(this.once("shutdown",t),r===_r.shuttingDown)return;let n=this;this._closeAllConnections(u(function(){n._state=_r.shutDown,n.emit("shutdown")},"closeAllCallback"))}_closeAllConnections(t){t=t||Pn.noop;let r=this.connections;if(this.connections=Pn.emptyArray,r.length===0)return t();this.log("info",ki.format("Closing %d connections to %s",r.length,this._address)),Pn.each(r,u(function(i,s){i.close(u(function(){s()},"closedCallback"))},"closeEach"),t)}};u(wu,"HostConnectionPool");var Ah=wu;FE.exports=Ah});var VE=_((h5,UE)=>{"use strict";var zo=Ue(),kE=Li(),bu=af(),ei=Ve(),qE=se(),AD=Object.freeze({decision:bu.RetryPolicy.retryDecision.retry,useCurrentHost:!0,consistency:void 0}),Bh=Object.freeze({decision:bu.RetryPolicy.retryDecision.rethrow}),de={none:0,socketError:1,socketErrorBeforeRequestWritten:2,clientTimeout:3,serverErrorUnprepared:4,serverErrorOverloaded:5,serverErrorReadTimeout:6,serverErrorUnavailable:7,serverErrorWriteTimeout:8,serverErrorOther:9},BD=new Map([[de.none,(e,t,r)=>e.onSuccessfulResponse(r)],[de.socketError,(e,t)=>e.onConnectionError(t)],[de.clientTimeout,(e,t)=>e.onClientTimeoutError(t)],[de.serverErrorOverloaded,(e,t)=>e.onOtherError(t)],[de.serverErrorReadTimeout,(e,t)=>e.onReadTimeoutError(t)],[de.serverErrorUnavailable,(e,t)=>e.onUnavailableError(t)],[de.serverErrorWriteTimeout,(e,t)=>e.onWriteTimeoutError(t)],[de.serverErrorOther,(e,t)=>e.onOtherError(t)]]),ND=new Map([[de.socketError,(e,t)=>e.onOtherErrorRetry(t)],[de.clientTimeout,(e,t)=>e.onClientTimeoutRetry(t)],[de.serverErrorOverloaded,(e,t)=>e.onOtherErrorRetry(t)],[de.serverErrorReadTimeout,(e,t)=>e.onReadTimeoutRetry(t)],[de.serverErrorUnavailable,(e,t)=>e.onUnavailableRetry(t)],[de.serverErrorWriteTimeout,(e,t)=>e.onWriteTimeoutRetry(t)],[de.serverErrorOther,(e,t)=>e.onOtherErrorRetry(t)]]),Rs=class Rs{constructor(t){this._parent=t,this._operation=null,this._host=null,this._cancelled=!1,this._startTime=null,this._retryCount=0,this._request=this._parent.request}start(t){let r=this;t=t||qE.noop,this._parent.getNextConnection(u(function(i,s,o){if(!r._cancelled){if(i)return r._parent.handleNoHostAvailable(i,r);r._connection=s,r._host=o,t(o),r._retryCount===0&&r._parent.speculativeExecutions++,r._sendOnConnection()}},"nextConnectionCallback"))}_sendOnConnection(){this._startTime=process.hrtime(),this._operation=this._connection.sendStream(this._request,this._parent.executionOptions,(t,r,n)=>{let i=Rs._getErrorCode(t);if(this._trackResponse(process.hrtime(this._startTime),i,t,n),!this._cancelled){if(i!==de.none)return this._handleError(i,t);if(r.schemaChange)return this._parent.client.handleSchemaAgreementAndRefresh(this._connection,r.schemaChange,s=>{this._cancelled||this._parent.setCompleted(null,this._getResultSet(r,s))});r.keyspaceSet&&(this._parent.client.keyspace=r.keyspaceSet),this._parent.setCompleted(null,this._getResultSet(r))}})}_trackResponse(t,r,n,i){Rs._invokeMetricsHandler(r,this._parent.client.metrics,n,t);let s=this._parent.client.options.requestTracker;if(s===null)return;let o=this._request.query||this._request.queries,a=this._request.params,c=this._request.length;n?s.onError(this._host,o,a,this._parent.executionOptions,c,n,t):s.onSuccess(this._host,o,a,this._parent.executionOptions,c,i,t)}_getResultSet(t,r){return new ei.ResultSet(t,this._host.address,this._parent.triedHosts,this._parent.speculativeExecutions,this._request.consistency,r===void 0||r)}static _invokeMetricsHandler(t,r,n,i){let s=BD.get(t);s!==void 0&&s(r,n,i),(!n||n instanceof zo.ResponseError)&&r.onResponse(i)}static _invokeMetricsHandlerForRetry(t,r,n){let i=ND.get(t);i!==void 0&&i(r,n)}cancel(){this._cancelled=!0,this._operation!==null&&this._operation.cancel()}wasCancelled(){return this._cancelled}_handleError(t,r){if(this._parent.triedHosts[this._host.address]=r,r.coordinator=this._host.address,t===de.serverErrorUnprepared)return this._prepareAndRetry(r.queryId);t===de.socketError||t===de.socketErrorBeforeRequestWritten?this._host.removeFromPool(this._connection):t===de.clientTimeout&&(this._parent.log("warning",r.message),this._host.checkHealth(this._connection));let n=this._getDecision(t,r);if(!n||n.decision===bu.RetryPolicy.retryDecision.rethrow)return(this._request instanceof kE.QueryRequest||this._request instanceof kE.ExecuteRequest)&&(r.query=this._request.query),this._parent.setCompleted(r);let i=this._parent.client.metrics;return n.decision===bu.RetryPolicy.retryDecision.ignore?(i.onIgnoreError(r),this._parent.setCompleted(null,this._getResultSet(qE.emptyObject))):(Rs._invokeMetricsHandlerForRetry(t,i,r),this._retry(n.consistency,n.useCurrentHost))}_getDecision(t,r){let n={query:this._request&&this._request.query,executionOptions:this._parent.executionOptions,nbRetry:this._retryCount},i=n.executionOptions.getRetryPolicy();switch(t){case de.socketErrorBeforeRequestWritten:return AD;case de.socketError:case de.clientTimeout:case de.serverErrorOverloaded:return n.executionOptions.isIdempotent()?i.onRequestError(n,this._request.consistency,r):Bh;case de.serverErrorUnavailable:return i.onUnavailable(n,r.consistencies,r.required,r.alive);case de.serverErrorReadTimeout:return i.onReadTimeout(n,r.consistencies,r.received,r.blockFor,r.isDataPresent);case de.serverErrorWriteTimeout:return n.executionOptions.isIdempotent()?i.onWriteTimeout(n,r.consistencies,r.received,r.blockFor,r.writeType):Bh;default:return Bh}}static _getErrorCode(t){if(!t)return de.none;if(t.isSocketError)return t.requestNotWritten?de.socketErrorBeforeRequestWritten:de.socketError;if(t instanceof zo.OperationTimedOutError)return de.clientTimeout;if(t instanceof zo.ResponseError)switch(t.code){case ei.responseErrorCodes.overloaded:case ei.responseErrorCodes.isBootstrapping:case ei.responseErrorCodes.truncateError:return de.serverErrorOverloaded;case ei.responseErrorCodes.unavailableException:return de.serverErrorUnavailable;case ei.responseErrorCodes.readTimeout:return de.serverErrorReadTimeout;case ei.responseErrorCodes.writeTimeout:return de.serverErrorWriteTimeout;case ei.responseErrorCodes.unprepared:return de.serverErrorUnprepared}return de.serverErrorOther}_retry(t,r){if(!this._cancelled){if(this._parent.log("info","Retrying request"),this._retryCount++,typeof t=="number"&&this._request.consistency!==t&&(this._request=this._request.clone(),this._request.consistency=t),r!==!1){let n=this._parent.client.keyspace;return this._host.borrowConnection(n,this._connection,(i,s)=>{if(i)return this.start();this._connection=s,this._sendOnConnection()})}this.start()}}_prepareAndRetry(t){let r=this._connection;this._parent.log("info",`Query 0x${t.toString("hex")} not prepared on host ${r.endpointFriendlyName}, preparing and retrying`);let n=this._parent.client.metadata.getPreparedById(t);if(!n)return this._parent.setCompleted(new zo.DriverInternalError(`Unprepared response invalid, id: 0x${t.toString("hex")}`));if(n.keyspace&&n.keyspace!==r.keyspace)return this._parent.setCompleted(new Error(`Query was prepared on keyspace ${n.keyspace}, can't execute it on ${r.keyspace} (${n.query})`));let i=this;this._connection.prepareOnce(n.query,function(s){if(s)return!s.isSocketError&&s instanceof zo.OperationTimedOutError&&i._parent.log("warning",`Unexpected timeout error when re-preparing query on host ${r.endpointFriendlyName}`),i._retry(void 0,!1);i._retry(void 0,!0)})}};u(Rs,"RequestExecution");var Nh=Rs;UE.exports=Nh});var Lh=_((d5,KE)=>{"use strict";var RD=require("util"),ME=Ue(),DD=Ve(),Rh=se(),LD=VE(),qi=class qi{constructor(t,r,n){this.client=n,this._speculativeExecutionPlan=n.options.policies.speculativeExecution.newPlan(n.keyspace,t.query||t.queries),this.logEmitter=n.options.logEmitter,this.log=Rh.log,this.request=t,this.executionOptions=r,this.stackContainer=null,this.triedHosts={},this.speculativeExecutions=-1,this._hostIterator=null,this._callback=null,this._newExecutionTimeout=null,this._executions=[]}static borrowNextConnection(t,r,n,i,s){r=r||{};let o=qi._getNextHost(t,n,r);if(o===null)return s(new ME.NoHostAvailableError(r));o.borrowConnection(i,null,u(function(c,l){if(c)return r[o.address]=c,l&&o.removeFromPool(l),process.nextTick(()=>qi.borrowNextConnection(t,r,n,i,s));r[o.address]=null,s(null,l,o)},"borrowFromHostCallback"))}static _getNextHost(t,r,n){let i;for(;;){let s=t.next();if(s.done)return null;if(i=s.value,r.getDistance(i)!==DD.distance.ignored){if(i.isUp())break;n[i.address]="Host considered as DOWN"}}return i}static send(t,r,n,i){new qi(t,r,n).send(i)}getNextConnection(t){qi.borrowNextConnection(this._hostIterator,this.triedHosts,this.client.profileManager,this.client.keyspace,t)}send(t){this.executionOptions.getCaptureStackTrace()&&Error.captureStackTrace(this.stackContainer={});let r=this.executionOptions.getLoadBalancingPolicy(),n=this.executionOptions.getFixedHost(),i=this;this._callback=t,n?(i._hostIterator=Rh.arrayIterator([n]),i._startNewExecution()):r.newQueryPlan(this.client.keyspace,this.executionOptions,u(function(o,a){if(o)return i._callback(o);i._hostIterator=a,i._startNewExecution()},"newPlanCb"))}_startNewExecution(t){t&&this.client.metrics.onSpeculativeExecution();let r=new LD(this);this._executions.push(r);let n=this;r.start(u(function(s){if(!n.executionOptions.isIdempotent())return;let o=n._speculativeExecutionPlan.nextExecution(s);if(!(typeof o!="number"||o<0)){if(o===0)return process.nextTick(u(function(){r.wasCancelled()||n._startNewExecution(!0)},"startNextInParallel"));n._newExecutionTimeout=setTimeout(()=>n._startNewExecution(!0),o)}},"hostAcquired"))}static setKeyspace(t,r){let n,i=t.hosts.values();for(let s=0;s<i.length&&(n=i[s].getActiveConnection(),!n);s++);if(!n)return r(new ME.DriverInternalError("No active connection found"));n.changeKeyspace(t.keyspace,r)}setCompleted(t,r){this._newExecutionTimeout!==null&&clearTimeout(this._newExecutionTimeout);for(let n=0;n<this._executions.length;n++)this._executions[n].cancel();if(t)return this.executionOptions.getCaptureStackTrace()&&Rh.fixStack(this.stackContainer.stack,t),process.nextTick(()=>this._callback(t));r.info.warnings&&r.info.warnings.forEach(function(n,i,s){this.log("warning",RD.format('Received warning (%d of %d) "%s" for "%s"',i+1,s.length,n,this.request.query||"batch"))},this),process.nextTick(()=>this._callback(null,r))}handleNoHostAvailable(t,r){let n=this._executions.indexOf(r);this._executions.splice(n,1),this._executions.length===0&&this.setCompleted(t)}};u(qi,"RequestHandler");var Dh=qi;KE.exports=Dh});var Fh=_((y5,$E)=>{"use strict";var OD=require("util"),HE=Ue(),Ui=se(),FD=Lh(),Vi=class Vi{constructor(t,r){this._client=t,this._loadBalancing=r,this.logEmitter=t.options.logEmitter,this.log=Ui.log}static getPrepared(t,r,n,i,s){let o=t.metadata.getPreparedInfo(i,n);if(o.queryId)return s(null,o.queryId,o.meta);if(o.once("prepared",s),o.preparing)return;new Vi(t,r)._prepare(o,n,i)}static getPreparedMultiple(t,r,n,i,s){let o=new Array(n.length);Ui.forEachOf(n,u(function(c,l,f){let h;if(c&&(h=typeof c=="string"?c:c.query),typeof h!="string")return f(new HE.ArgumentError("Query item should be a string"));Vi.getPrepared(t,r,h,i,u(function(g,p,y){if(g)return f(g);o[l]={query:h,params:Ui.adaptNamedParamsPrepared(c.params,y.columns),queryId:p,meta:y},f()},"getPrepareCb"))},"eachQuery"),u(function(c){if(c)return s(c);s(null,o)},"eachEnded"))}_prepare(t,r,n){t.preparing=!0;let i=this;this._loadBalancing.newQueryPlan(n,null,function(s,o){if(s)return t.preparing=!1,t.emit("prepared",s);i._prepareWithQueryPlan(t,o,null,r,n)})}_prepareWithQueryPlan(t,r,n,i,s){n=n||{};let o=this;FD.borrowNextConnection(r,n,this._client.profileManager,s,u(function(c,l,f){if(c)return o._onPrepareError(c,f,n,t,r,i,s);l.prepareOnce(i,u(function(d,g){if(d)return o._onPrepareError(d,f,n,t,r,i,s);if(o._client.options.prepareOnAllHosts)return o._prepareOnAllHosts(t,g,f,r,i,s);o._onPrepareSuccess(t,g)},"prepareOnceCallback"))},"borrowCallback"))}_onPrepareSuccess(t,r){t.preparing=!1,t.queryId=r.id,t.meta=r.meta,this._client.metadata.setPreparedById(t),t.emit("prepared",null,t.queryId,t.meta)}_onPrepareError(t,r,n,i,s,o,a){if(t.isSocketError||t instanceof HE.OperationTimedOutError){let c=this;return n[r.address]=t,c._prepareWithQueryPlan(i,s,n,o,a)}return i.preparing=!1,t.query=o,i.emit("prepared",t)}static prepareAllQueries(t,r,n){let i=[],s={};r.forEach(function(o){let a=i;o.keyspace&&(a=s[o.keyspace]=s[o.keyspace]||[]),a.push(o.query)}),Ui.eachSeries(Object.keys(s),u(function(a,c){Vi._borrowAndPrepare(t,a,s[a],c)},"eachKeyspace"),function(o){if(o)return n(o);Vi._borrowAndPrepare(t,null,i,n)})}static _borrowAndPrepare(t,r,n,i){if(n.length===0)return i();t.borrowConnection(r,null,u(function(o,a){if(o)return i(o);Ui.each(n,u(function(l,f){a.prepareOnce(l,f)},"prepareEach"),i)},"borrowCallback"))}_prepareOnAllHosts(t,r,n,i,s,o){let a=this;Ui.each(Ui.iteratorToArray(i),function(c,l){if(c.address===n.address)return l();c.borrowConnection(o,null,u(function(h,d){if(h)return l();d.prepareOnce(s,function(g){return g&&a.log("verbose",OD.format("Unexpected error while preparing query (%s) on %s",s,c.address)),l()})},"borrowCallback"))},u(function(){a._onPrepareSuccess(t,r)},"eachEnded"))}};u(Vi,"PrepareHandler");var Oh=Vi;$E.exports=Oh});var kh=_(Ph=>{"use strict";var Wo=require("util"),Au=require("events"),Ds=se(),Iu=Ve(),PD=PE(),kD=Fh(),qD=200;function lt(e,t,r,n){Au.EventEmitter.call(this),this.address=e,this.setDownAt=0,this.isUpSince=null,Object.defineProperty(this,"options",{value:r,enumerable:!1,writable:!1}),Object.defineProperty(this,"pool",{value:new PD(this,t),enumerable:!1});let i=this;this.pool.on("open",this._onNewConnectionOpen.bind(this)),this.pool.on("remove",u(function(){i._checkPoolState()},"onConnectionRemovedFromPool")),this.cassandraVersion=null,this.datacenter=null,this.rack=null,this.tokens=null,this.hostId=null,this._distance=Iu.distance.ignored,this._healthResponseCounter=0,Object.defineProperty(this,"_metadata",{value:n,enumerable:!1}),Object.defineProperty(this,"_healthResponseCountTimer",{value:null,enumerable:!1,writable:!0}),this.reconnectionSchedule=this.options.policies.reconnection.newSchedule(),this.reconnectionDelay=0}u(lt,"Host");Wo.inherits(lt,Au.EventEmitter);lt.prototype.setDown=function(){this.setDownAt===0&&(this.pool.isClosing()||(this.setDownAt=Date.now(),this.pool.coreConnectionsLength>0?this.log("warning",`Host ${this.address} considered as DOWN. Reconnection delay ${this.reconnectionDelay}ms.`):this.log("info",`Host ${this.address} considered as DOWN.`),this.emit("down"),this._checkPoolState()))};lt.prototype.setUp=function(e){this.setDownAt&&(this.log("info",Wo.format("Setting host %s as UP",this.address)),this.setDownAt=0,this.isUpSince=Date.now(),this.reconnectionSchedule=this.options.policies.reconnection.newSchedule(),e&&this.pool.clearNewConnectionAttempt(),this.emit("up"))};lt.prototype.checkIsUp=function(){this.isUp()||(this.reconnectionSchedule=this.options.policies.reconnection.newSchedule(),this.reconnectionDelay=0,this.pool.attemptNewConnectionImmediate())};lt.prototype.shutdown=function(e,t){if(t=t||Ds.noop,this._healthResponseCountTimer&&clearInterval(this._healthResponseCountTimer),e)return this.pool.drainAndShutdown(),t();this.pool.shutdown(t)};lt.prototype.isUp=function(){return!this.setDownAt};lt.prototype.canBeConsideredAsUp=function(){let e=this;function t(){return new Date().getTime()-e.setDownAt>=e.reconnectionDelay}return u(t,"hasTimePassed"),!this.setDownAt||t()};lt.prototype.setDistance=function(e){let t=this._distance;return this._distance=e||Iu.distance.local,this.options.pooling.coreConnectionsPerHost?this.pool.coreConnectionsLength=this.options.pooling.coreConnectionsPerHost[this._distance]||0:this.pool.coreConnectionsLength=1,this._distance===t?this._distance:(this._healthResponseCountTimer&&clearInterval(this._healthResponseCountTimer),this._distance===Iu.distance.ignored?(this.emit("ignore"),this.pool.drainAndShutdown()):(this.isUp()||this.checkIsUp(),this._healthResponseCountTimer=setInterval(()=>{this._healthResponseCounter=this.pool.getAndResetResponseCounter()},qD)),this._distance)};lt.prototype.setProtocolVersion=function(e){this.pool.protocolVersion=e};lt.prototype.borrowConnection=function(e,t,r){if(t)return this.pool.borrowConnection(e,t,r);this.pool.createAndBorrowConnection(e,r)};lt.prototype.warmupPool=function(e){this.pool.create(!0,e)};lt.prototype.getActiveConnection=function(){return!this.isUp()||!this.pool.connections.length?null:this.pool.connections[0]};lt.prototype.getResponseCount=function(){return this._healthResponseCounter+this.pool.responseCounter};lt.prototype.checkHealth=function(e){e.timedOutOperations<=this.options.socketOptions.defunctReadTimeoutThreshold||this.removeFromPool(e)};lt.prototype.removeFromPool=function(e){this.pool.remove(e),this._checkPoolState()};lt.prototype.getInFlight=function(){return this.pool.getInFlight()};lt.prototype._checkPoolState=function(){if(this.pool.isClosing())return;this.pool.connections.length<this.pool.coreConnectionsLength&&(this.pool.hasScheduledNewConnection()||(this.reconnectionDelay=this.reconnectionSchedule.next().value,this.pool.scheduleNewConnectionAttempt(this.reconnectionDelay))),this._distance!==Iu.distance.ignored&&this.pool.coreConnectionsLength>0&&this.pool.connections.length===0&&this.setDown()};lt.prototype._onNewConnectionOpen=function(e){if(e){this._checkPoolState();return}let t=this;function r(i){i&&t.log("warning",Wo.format("Failed re-preparing on host %s: %s",t.address,i),i),t.setUp(),t.pool.increaseSize()}if(u(r,"setUpAndContinue"),this.isUp()||!this.options.rePrepareOnUp)return r();this.log("info",Wo.format("Re-preparing all queries on host %s before setting it as UP",this.address));let n=this._metadata.getAllPrepared();kD.prepareAllQueries(this,n,r)};lt.prototype.getCassandraVersion=function(){return this.cassandraVersion?this.cassandraVersion.split("-")[0].split(".").map(e=>parseInt(e,10)):Ds.emptyArray};lt.prototype.log=Ds.log;function or(){Au.EventEmitter.call(this),this._items={},this._values=null,Object.defineProperty(this,"length",{get:function(){return this.values().length},enumerable:!0})}u(or,"HostMap");Wo.inherits(or,Au.EventEmitter);or.prototype.forEach=function(e){let t=this._items;for(let r in t)t.hasOwnProperty(r)&&e(t[r],r)};or.prototype.get=function(e){return this._items[e]};or.prototype.keys=function(){return Object.keys(this._items)};or.prototype.remove=function(e){if(!this._items.hasOwnProperty(e))return;this._values=null;let t=Ds.extend({},this._items),r=t[e];delete t[e],this._items=t,this.emit("remove",r)};or.prototype.removeMultiple=function(e){this._values=null;let t=Ds.extend({},this._items),r=[];for(let n=0;n<e.length;n++){let i=t[e[n]];i&&(r.push(i),delete t[e[n]])}this._items=t,r.forEach(function(n){this.emit("remove",n)},this)};or.prototype.set=function(e,t){this._values=null;let r=this._items[e];if(r){this._items[e]=t,this.emit("remove",r),this.emit("add",t);return}let n=Ds.extend({},this._items);return n[e]=t,this._items=n,this.emit("add",t),t};or.prototype.slice=function(e,t){return!e&&!t?this.values():(e=e||0,this.values().slice(e,t))};or.prototype.push=or.prototype.set;or.prototype.values=function(){if(!this._values){let e=[];for(let t in this._items)this._items.hasOwnProperty(t)&&e.push(this._items[t]);this._values=Object.freeze(e)}return this._values};or.prototype.clear=function(){let e=this.values();this._values=null,this._items={};for(let t=0;t<e.length;t++)this.emit("remove",e[t]);return e};or.prototype.inspect=function(){return this._items};or.prototype.toJSON=function(){return this._items};Ph.Host=lt;Ph.HostMap=or});var zE=_(Ru=>{"use strict";var jE=require("util"),UD=Ve(),ti=Vo(),qh=se(),st=sh(),Pt=UD.Integer,Bu=new st(21461,4418,31633,34755),Nu=new st(37759,10053,44355,19701),GE=st.fromNumber(5),VD=new st(36045,60757,45015,65361),MD=new st(60499,6789,47614,50382),KD=st.fromNumber(1390208809),HD=st.fromNumber(944331445),Kh=class Kh{constructor(){}hash(t){throw new Error("You must implement a hash function for the tokenizer")}parse(t){throw new Error("You must implement a parse function for the tokenizer")}minToken(){throw new Error("You must implement a minToken function for the tokenizer")}split(t,r,n){throw new Error("You must implement a split function for the tokenizer")}splitBase(t,r,n,i,s){let o=Pt.fromInt(s),a=r.divide(o),c=r.modulo(o),l=[],f=t,h=a.add(Pt.ONE);for(let d=1;d<s;d++)c.greaterThan(Pt.ZERO)?f=f.add(h):f=f.add(a),i&&f.greaterThan(n)&&(f=f.subtract(i)),l.push(f),c=c.subtract(Pt.ONE);return l}stringify(t){return t.getValue().toString()}};u(Kh,"Tokenizer");var Qo=Kh,Hh=class Hh extends Qo{constructor(){super()}hash(t){let r=t,n=0,i=r.length,s=i>>4,o=new st,a=new st,c=new st,l=new st;for(let f=0;f<s;f++)c=this.getBlock(r,n,f*2),l=this.getBlock(r,n,f*2+1),c.multiply(Bu),this.rotl64(c,31),c.multiply(Nu),o.xor(c),this.rotl64(o,27),o.add(a),o.multiply(GE).add(KD),l.multiply(Nu),this.rotl64(l,33),l.multiply(Bu),a.xor(l),this.rotl64(a,31),a.add(o),a.multiply(GE).add(HD);switch(n+=s*16,c=new st,l=new st,i&15){case 15:l.xor(ar(r[n+14]).shiftLeft(48));case 14:l.xor(ar(r[n+13]).shiftLeft(40));case 13:l.xor(ar(r[n+12]).shiftLeft(32));case 12:l.xor(ar(r[n+11]).shiftLeft(24));case 11:l.xor(ar(r[n+10]).shiftLeft(16));case 10:l.xor(ar(r[n+9]).shiftLeft(8));case 9:l.xor(ar(r[n+8])),l.multiply(Nu),this.rotl64(l,33),l.multiply(Bu),a.xor(l);case 8:c.xor(ar(r[n+7]).shiftLeft(56));case 7:c.xor(ar(r[n+6]).shiftLeft(48));case 6:c.xor(ar(r[n+5]).shiftLeft(40));case 5:c.xor(ar(r[n+4]).shiftLeft(32));case 4:c.xor(ar(r[n+3]).shiftLeft(24));case 3:c.xor(ar(r[n+2]).shiftLeft(16));case 2:c.xor(ar(r[n+1]).shiftLeft(8));case 1:c.xor(ar(r[n])),c.multiply(Bu),this.rotl64(c,31),c.multiply(Nu),o.xor(c)}return o.xor(st.fromNumber(i)),a.xor(st.fromNumber(i)),o.add(a),a.add(o),this.fmix(o),this.fmix(a),o.add(a),new ti.Murmur3Token(o)}getBlock(t,r,n){let i=n<<3,s=r+i;return new st(t[s]|t[s+1]<<8,t[s+2]|t[s+3]<<8,t[s+4]|t[s+5]<<8,t[s+6]|t[s+7]<<8)}rotl64(t,r){let n=t.clone().shiftLeft(r);t.shiftRightUnsigned(64-r).or(n)}fmix(t){t.xor(new st(t.getUint16(2)>>>1|t.getUint16(3)<<15&65535,t.getUint16(3)>>>1,0,0)),t.multiply(VD);let r=new st(t.getUint16(2)>>>1|t.getUint16(3)<<15&65535,t.getUint16(3)>>>1,0,0);t.xor(r),t.multiply(MD),t.xor(new st(t.getUint16(2)>>>1|t.getUint16(3)<<15&65535,t.getUint16(3)>>>1,0,0))}parse(t){return new ti.Murmur3Token(st.fromString(t))}minToken(){return this._minToken||(this._minToken=this.parse("-9223372036854775808")),this._minToken}maxToken(){return this._maxToken||(this._maxToken=this.parse("9223372036854775807")),this._maxToken}maxValue(){return this._maxValue||(this._maxValue=Pt.fromString("9223372036854775807")),this._maxValue}minValue(){return this._minValue||(this._minValue=Pt.fromString("-9223372036854775808")),this._minValue}ringLength(){return this._ringLength||(this._ringLength=this.maxValue().subtract(this.minValue())),this._ringLength}split(t,r,n){t.equals(r)&&t.equals(this.minToken())&&(r=this.maxToken());let i=Pt.fromString(t.getValue().toString()),o=Pt.fromString(r.getValue().toString()).subtract(i);return o.isNegative()&&(o=o.add(this.ringLength())),this.splitBase(i,o,this.maxValue(),this.ringLength(),n).map(c=>this.parse(c.toString()))}stringify(t){let r=t.getValue();return r.getUint16(0)+","+r.getUint16(1)+","+r.getUint16(2)+","+r.getUint16(3)}};u(Hh,"Murmur3Tokenizer");var Uh=Hh,$h=class $h extends Qo{constructor(){super(),this._crypto=require("crypto")}hash(t){jE.isArray(t)&&(t=qh.allocBufferFromArray(t));let r=this._crypto.createHash("md5").update(t).digest();return new ti.RandomToken(Pt.fromBuffer(r).abs())}parse(t){return new ti.RandomToken(Pt.fromString(t))}minToken(){return this._minToken||(this._minToken=this.parse("-1")),this._minToken}maxValue(){return this._maxValue||(this._maxValue=Pt.fromNumber(Math.pow(2,127))),this._maxValue}maxToken(){return this._maxToken||(this._maxToken=new ti.RandomToken(this.maxValue())),this._maxToken}ringLength(){return this._ringLength||(this._ringLength=this.maxValue().add(Pt.ONE)),this._ringLength}split(t,r,n){t.equals(r)&&t.equals(this.minToken())&&(r=this.maxToken());let i=t.getValue(),o=r.getValue().subtract(i);return o.lessThan(Pt.ZERO)&&(o=o.add(this.ringLength())),this.splitBase(i,o,this.maxValue(),this.ringLength(),n).map(c=>new ti.RandomToken(c))}};u($h,"RandomTokenizer");var Vh=$h,Gh=class Gh extends Qo{constructor(){super()}hash(t){jE.isArray(t)&&(t=qh.allocBufferFromArray(t));let r=t.length;for(let n=t.length-1;n>0&&t[n]===0;n--)r=n;return new ti.ByteOrderedToken(t.slice(0,r))}stringify(t){return t.getValue().toString("hex")}parse(t){return this.hash(qh.allocBufferFromString(t,"hex"))}minToken(){return this._minToken||(this._minToken=this.hash([])),this._minToken}_toNumber(t,r){let n=t;t.length!==r&&(n=Buffer.alloc(r),t.copy(n));let i=new Array(Math.ceil(n.length/4));for(let s=0;s<i.length;s++){let o=n.length-(s+1)*4,a;if(o<0){o=o+4,a=0;for(let c=0;c<o;c++){let l=n[c];a=a|l<<(o-c-1)*8}}else a=n.readInt32BE(o);i[s]=a}return new Pt(i,0)}_toBuffer(t,r){let n=Pt.toBuffer(t);if(n.length===r)return n;let i,s;n[0]===0?(i=1,s=n.length-1):(i=0,s=n.length);let o=Buffer.alloc(r);return n.copy(o,r-s,i,s+i),o}split(t,r,n){let i=t.compare(r);if(i===0&&t.equals(this.minToken()))throw new Error("Cannot split whole ring with ordered partitioner");let s,o,a,c,l,f=Pt.fromNumber(n),h=Math.max(t.getValue().length,r.getValue().length);if(i<0){let g=0;for(;s=this._toNumber(t.getValue(),h),o=this._toNumber(r.getValue(),h),a=o.subtract(s),!(g===4||a.compare(f)>=0);)h+=1,g+=1}else{let g=0;for(;s=this._toNumber(t.getValue(),h),o=this._toNumber(r.getValue(),h),c=Pt.fromNumber(Math.pow(2,h*8)),l=c.subtract(Pt.ONE),a=o.subtract(s).add(c),!(g===4||a.compare(f)>=0);)h+=1,g+=1}return this.splitBase(s,a,l,c,n).map(g=>new ti.ByteOrderedToken(this._toBuffer(g,h)))}};u(Gh,"ByteOrderedTokenizer");var Mh=Gh;function ar(e){return e<128?new st(e,0,0,0):new st(e-256&65535,65535,65535,65535)}u(ar,"fromSignedByte");Ru.Murmur3Tokenizer=Uh;Ru.RandomTokenizer=Vh;Ru.ByteOrderedTokenizer=Mh});var jh=_((x5,ZE)=>{"use strict";var $D=require("util"),WE=require("events");function QE(e){WE.EventEmitter.call(this),this.setMaxListeners(0),Object.defineProperty(this,"loading",{value:!1,enumerable:!1,writable:!0}),Object.defineProperty(this,"loaded",{value:!1,enumerable:!1,writable:!0}),this.name=e,this.bloomFilterFalsePositiveChance=0,this.caching=null,this.comment=null,this.gcGraceSeconds=0,this.compactionClass=null,this.compactionOptions=null,this.compression=null,this.localReadRepairChance=0,this.readRepairChance=0,this.extensions=null,this.crcCheckChance=null,this.populateCacheOnFlush=!1,this.defaultTtl=0,this.speculativeRetry="NONE",this.minIndexInterval=128,this.maxIndexInterval=2048,this.columns=null,this.columnsByName=null,this.partitionKeys=[],this.clusteringKeys=[],this.clusteringOrder=[]}u(QE,"DataCollection");$D.inherits(QE,WE.EventEmitter);ZE.exports=QE});var e1=_((_5,JE)=>{"use strict";var GD=require("util"),YE=jh();function XE(e){YE.call(this,e),this.replicateOnWrite=!0,this.memtableFlushPeriod=0,this.indexInterval=null,this.isCompact=!1,this.indexes=null,this.cdc=null,this.virtual=!1}u(XE,"TableMetadata");GD.inherits(XE,YE);JE.exports=XE});var r1=_((b5,t1)=>{"use strict";function jD(){this.name=null,this.keyspaceName=null,this.signature=null,this.argumentTypes=null,this.stateFunction=null,this.stateType=null,this.finalFunction=null,this.initConditionRaw=null,this.initCondition=null,this.returnType=null}u(jD,"Aggregate");t1.exports=jD});var i1=_((A5,n1)=>{"use strict";function zD(){this.name=null,this.keyspaceName=null,this.signature=null,this.argumentNames=null,this.argumentTypes=null,this.body=null,this.calledOnNullInput=null,this.language=null,this.returnType=null}u(zD,"SchemaFunction");n1.exports=zD});var o1=_((N5,s1)=>{"use strict";var zh=require("util"),WD=se(),Wh=Ve(),Zo={custom:0,keys:1,composites:2};function ri(e,t,r,n){this.name=e,this.target=t,this.kind=typeof r=="string"?Qh(r):r,this.options=n}u(ri,"Index");ri.prototype.isCompositesKind=function(){return this.kind===Zo.composites};ri.prototype.isKeysKind=function(){return this.kind===Zo.keys};ri.prototype.isCustomKind=function(){return this.kind===Zo.custom};ri.fromRows=function(e){return!e||e.length===0?WD.emptyArray:e.map(function(t){let r=t.options;return new ri(t.index_name,r.target,Qh(t.kind),r)})};ri.fromColumnRows=function(e,t){let r=[];for(let n=0;n<e.length;n++){let i=e[n],s=i.index_name;if(!s)continue;let o=t[i.column_name],a,c=JSON.parse(i.index_options);c!==null&&c.index_keys!==void 0?a=zh.format("keys(%s)",o.name):c!==null&&c.index_keys_and_values!==void 0?a=zh.format("entries(%s)",o.name):o.type.options.frozen&&(o.type.code===Wh.dataTypes.map||o.type.code===Wh.dataTypes.list||o.type.code===Wh.dataTypes.set)?a=zh.format("full(%s)",o.name):a=o.name,r.push(new ri(s,a,Qh(i.index_type),c))}return r};function Qh(e){return e?Zo[e.toLowerCase()]:Zo.custom}u(Qh,"getKindByName");s1.exports=ri});var l1=_((D5,c1)=>{"use strict";var QD=require("util"),a1=jh();function u1(e){a1.call(this,e),this.tableName=null,this.whereClause=null,this.includeAllColumns=!1}u(u1,"MaterializedView");QD.inherits(u1,a1);c1.exports=u1});var C1=_(Zh=>{"use strict";var vr=require("util"),h1=require("events"),ZD=Ve(),De=se(),YD=Ue(),XD=e1(),p1=r1(),d1=i1(),g1=o1(),y1=l1(),JD="SELECT * FROM system.schema_keyspaces",eL="SELECT * FROM system.schema_keyspaces where keyspace_name = '%s'",m1="SELECT * FROM system_schema.keyspaces",v1="SELECT * FROM system_schema.keyspaces where keyspace_name = '%s'",tL="SELECT * FROM system.schema_columnfamilies WHERE keyspace_name='%s' AND columnfamily_name='%s'",rL="SELECT * FROM system_schema.tables WHERE keyspace_name='%s' AND table_name='%s'",nL="SELECT * FROM system.schema_columns WHERE keyspace_name='%s' AND columnfamily_name='%s'",iL="SELECT * FROM system_schema.columns WHERE keyspace_name='%s' AND table_name='%s'",sL="SELECT * FROM system_schema.indexes WHERE keyspace_name='%s' AND table_name='%s'",oL="SELECT * FROM system.schema_usertypes WHERE keyspace_name='%s' AND type_name='%s'",aL="SELECT * FROM system_schema.types WHERE keyspace_name='%s' AND type_name='%s'",uL="SELECT * FROM system.schema_functions WHERE keyspace_name = '%s' AND function_name = '%s'",cL="SELECT * FROM system_schema.functions WHERE keyspace_name = '%s' AND function_name = '%s'",lL="SELECT * FROM system.schema_aggregates WHERE keyspace_name = '%s' AND aggregate_name = '%s'",fL="SELECT * FROM system_schema.aggregates WHERE keyspace_name = '%s' AND aggregate_name = '%s'",hL="SELECT * FROM system_schema.views WHERE keyspace_name = '%s' AND view_name = '%s'",pL="SELECT * FROM system_virtual_schema.keyspaces",dL="SELECT * FROM system_virtual_schema.keyspaces where keyspace_name = '%s'",f1="SELECT * FROM system_virtual_schema.tables where keyspace_name = '%s' and table_name='%s'",gL="SELECT * FROM system_virtual_schema.columns where keyspace_name = '%s' and table_name='%s'";function zt(e,t){this.cc=t,this.encodingOptions=e.encoding,this.selectTable=null,this.selectColumns=null,this.selectIndexes=null,this.selectUdt=null,this.selectAggregates=null,this.selectFunctions=null,this.supportsVirtual=!1}u(zt,"SchemaParser");zt.prototype._createKeyspace=function(e,t,r,n,i){let s={name:e,durableWrites:t,strategy:r,strategyOptions:n,tokenToReplica:null,virtual:i===!0,udts:{},tables:{},functions:{},aggregates:{},views:{}};return s.tokenToReplica=vL(r,n),s};zt.prototype.getKeyspace=function(e,t){};zt.prototype.getKeyspaces=function(e,t){};zt.prototype.getTable=function(e,t,r,n,i){let s=r&&r[t];if(s||(s=new XD(t),r&&(r[t]=s)),s.loaded)return i(null,s);if(s.once("load",i),s.loading)return;s.loading=!0;let o,a,c,l=this,f=n;De.series([u(function(d){let g=f?f1:l.selectTable,p=vr.format(g,e,t);l.cc.query(p,function(y,v){if(y)return d(y);o=v.rows[0],d()})},"getTableRow"),u(function(d){if(!o&&l.supportsVirtual&&f===void 0){let g=vr.format(f1,e,t);l.cc.query(g,function(p,y){if(p)return d();o=y.rows[0],o&&(f=!0),d()})}else return d()},"getVirtualTableRow"),u(function(d){if(!o)return d();let g=f?gL:l.selectColumns,p=vr.format(g,e,t);l.cc.query(p,function(y,v){if(y)return d(y);a=v.rows,d()})},"getColumnRows"),u(function(d){if(!o||!l.selectIndexes||f)return d();let g=vr.format(l.selectIndexes,e,t);l.cc.query(g,function(p,y){if(p)return d(p);c=y.rows,d()})},"getIndexes")],u(function(d){if(d||!o)return s.loading=!1,s.emit("load",d,null);l._parseTableOrView(s,o,a,c,f,function(g){s.loading=!1,s.loaded=!g,s.emit("load",g,s)})},"afterQuery"))};zt.prototype.getUdt=function(e,t,r,n){let i=r&&r[t];if(i||(i=new h1.EventEmitter,r&&(r[t]=i),i.setMaxListeners(0),i.loading=!1,i.name=t,i.fields=null),i.fields)return n(null,i);if(i.once("load",n),i.loading)return;i.loading=!0;let s=vr.format(this.selectUdt,e,t),o=this;this.cc.query(s,function(a,c){if(a)return i.emit("load",a);let l=c.rows[0];if(!l)return i.loading=!1,i.emit("load",null,null);o._parseUdt(i,l,function(f){return i.loading=!1,f?i.emit("load",f):i.emit("load",null,i)})})};zt.prototype._parseUdt=function(e,t,r){};zt.prototype._parseTableOrView=function(e,t,r,n,i,s){};zt.prototype.getMaterializedView=function(e,t,r,n){};zt.prototype.getFunctions=function(e,t,r,n,i){let s=this.selectFunctions,o=this._parseFunction.bind(this);r&&(s=this.selectAggregates,o=this._parseAggregate.bind(this));let a=n&&n[t];if(a||(a=new h1.EventEmitter,n&&(n[t]=a),a.setMaxListeners(0)),a.values)return i(null,a.values);a.once("load",i),!a.loading&&(a.loading=!0,s=vr.format(s,e,t),this.cc.query(s,function(c,l){if(a.loading=!1,c||l.rows.length===0)return a.emit("load",c,null);l.rows.length>0&&(a.values={}),De.each(l.rows,function(f,h){o(f,function(d,g){if(d)return h(d);a.values["("+g.signature.join(",")+")"]=g,h()})},function(f){if(f)return a.emit("load",f);a.emit("load",null,a.values)})}))};zt.prototype._parseAggregate=function(e,t){};zt.prototype._parseFunction=function(e,t){};zt.prototype._asMap=function(e){return e?this.encodingOptions.map&&e instanceof this.encodingOptions.map?e:new Map(Object.keys(e).map(t=>[t,e[t]])):new Map};zt.prototype._mapAsObject=function(e){if(!e)return e;if(this.encodingOptions.map&&e instanceof this.encodingOptions.map){let t={};return e.forEach((r,n)=>t[n]=r),t}return e};function kn(e,t){zt.call(this,e,t),this.selectTable=tL,this.selectColumns=nL,this.selectUdt=oL,this.selectAggregates=lL,this.selectFunctions=uL}u(kn,"SchemaParserV1");vr.inherits(kn,zt);kn.prototype.getKeyspaces=function(e,t){let r=this,n={};this.cc.query(JD,e,function(i,s){if(i)return t(i);for(let o=0;o<s.rows.length;o++){let a=s.rows[o],c=r._createKeyspace(a.keyspace_name,a.durable_writes,a.strategy_class,JSON.parse(a.strategy_options||null));n[c.name]=c}t(null,n)})};kn.prototype.getKeyspace=function(e,t){let r=this;this.cc.query(vr.format(eL,e),function(n,i){if(n)return t(n);let s=i.rows[0];if(!s)return t(null,null);t(null,r._createKeyspace(s.keyspace_name,s.durable_writes,s.strategy_class,JSON.parse(s.strategy_options)))})};kn.prototype._parseTableOrView=function(e,t,r,n,i,s){let o,a,c,l,f=this.cc.getEncoder(),h={},d=[],g=[];e.bloomFilterFalsePositiveChance=t.bloom_filter_fp_chance,e.caching=t.caching,e.comment=t.comment,e.compactionClass=t.compaction_strategy_class,e.compactionOptions=JSON.parse(t.compaction_strategy_options),e.compression=JSON.parse(t.compression_parameters),e.gcGraceSeconds=t.gc_grace_seconds,e.localReadRepairChance=t.local_read_repair_chance,e.readRepairChance=t.read_repair_chance,e.populateCacheOnFlush=t.populate_io_cache_on_flush||e.populateCacheOnFlush,e.memtableFlushPeriod=t.memtable_flush_period_in_ms||e.memtableFlushPeriod,e.defaultTtl=t.default_time_to_live||e.defaultTtl,e.speculativeRetry=t.speculative_retry||e.speculativeRetry,e.indexInterval=t.index_interval||e.indexInterval,typeof t.min_index_interval<"u"?(e.minIndexInterval=t.min_index_interval||e.minIndexInterval,e.maxIndexInterval=t.max_index_interval||e.maxIndexInterval):(e.minIndexInterval=null,e.maxIndexInterval=null),typeof t.replicate_on_write<"u"&&(e.replicateOnWrite=t.replicate_on_write),e.columns=[];try{u(function(){for(o=0;o<r.length;o++){let m=r[o],x=f.parseFqTypeName(m.validator);switch(a={name:m.column_name,type:x,isStatic:!1},e.columns.push(a),h[a.name]=a,m.type){case"partition_key":d.push({c:a,index:m.component_index||0});break;case"clustering_key":g.push({c:a,index:m.component_index||0,order:a.type.options.reversed?"DESC":"ASC"});break;case"static":a.isStatic=!0;break}}},"parseColumns")(),d.length>0&&(e.partitionKeys=d.sort(De.propCompare("index")).map(function(v){return v.c}),g.sort(De.propCompare("index")),e.clusteringKeys=g.map(function(v){return v.c}),e.clusteringOrder=g.map(function(v){return v.order}));let p=e.partitionKeys.length===0;if(p&&t.key_aliases)for(d=JSON.parse(t.key_aliases),l=f.parseKeyTypes(t.key_validator).types,o=0;o<d.length;o++)c=d[o],a=h[c],a||(a={name:c,type:l[o]},e.columns.push(a)),e.partitionKeys.push(a);let y=f.parseKeyTypes(t.comparator);if(p&&t.column_aliases)for(g=JSON.parse(t.column_aliases),o=0;o<g.length;o++)c=g[o],a=h[c],a||(a={name:c,type:y.types[o]},e.columns.push(a)),e.clusteringKeys.push(a),e.clusteringOrder.push(a.type.options.reversed?"DESC":"ASC");e.isCompact=!!t.is_dense,e.isCompact||(e.isCompact=!y.isComposite||!y.hasCollections&&e.clusteringKeys.length!==y.types.length-1),c=t.value_alias,e.isCompact&&c&&!h[c]&&(a={name:c,type:f.parseFqTypeName(t.default_validator)},e.columns.push(a),h[c]=a),e.columnsByName=h,e.indexes=g1.fromColumnRows(r,e.columnsByName)}catch(p){return s(p)}s()};kn.prototype.getMaterializedView=function(e,t,r,n){n(new YD.NotSupportedError("Materialized views are not supported on Cassandra versions below 3.0"))};kn.prototype._parseAggregate=function(e,t){let r=this.cc.getEncoder(),n=new p1;n.name=e.aggregate_name,n.keyspaceName=e.keyspace_name,n.signature=e.signature||De.emptyArray,n.stateFunction=e.state_func,n.finalFunction=e.final_func,n.initConditionRaw=e.initcond;try{n.argumentTypes=(e.argument_types||De.emptyArray).map(function(s){return r.parseFqTypeName(s)}),n.stateType=r.parseFqTypeName(e.state_type);let i=r.decode(n.initConditionRaw,n.stateType);i!==null&&typeof i<"u"&&(n.initCondition=i.toString()),n.returnType=r.parseFqTypeName(e.return_type)}catch(i){return t(i)}t(null,n)};kn.prototype._parseFunction=function(e,t){let r=this.cc.getEncoder(),n=new d1;n.name=e.function_name,n.keyspaceName=e.keyspace_name,n.signature=e.signature||De.emptyArray,n.argumentNames=e.argument_names||De.emptyArray,n.body=e.body,n.calledOnNullInput=e.called_on_null_input,n.language=e.language;try{n.argumentTypes=(e.argument_types||De.emptyArray).map(function(i){return r.parseFqTypeName(i)}),n.returnType=r.parseFqTypeName(e.return_type)}catch(i){return t(i)}t(null,n)};kn.prototype._parseUdt=function(e,t,r){let n=this.cc.getEncoder(),i=t.field_names,s=t.field_types,o=new Array(i.length);try{for(let a=0;a<i.length;a++)o[a]={name:i[a],type:n.parseFqTypeName(s[a])}}catch(a){return r(a)}e.fields=o,r(null,e)};function wr(e,t,r){zt.call(this,e,t),this.udtResolver=r,this.selectTable=rL,this.selectColumns=iL,this.selectUdt=aL,this.selectAggregates=fL,this.selectFunctions=cL,this.selectIndexes=sL}u(wr,"SchemaParserV2");vr.inherits(wr,zt);wr.prototype.getKeyspaces=function(e,t){let r=this,n={};this.cc.query(m1,e,function(i,s){if(i)return t(i);for(let o=0;o<s.rows.length;o++){let a=r._parseKeyspace(s.rows[o]);n[a.name]=a}t(null,n)})};wr.prototype.getKeyspace=function(e,t){let r=this;this.cc.query(vr.format(v1,e),function(n,i){if(n)return t(n);let s=i.rows[0];if(!s)return t(null,null);t(null,r._parseKeyspace(s))})};wr.prototype.getMaterializedView=function(e,t,r,n){let i=r&&r[t];if(i||(i=new y1(t),r&&(r[t]=i)),i.loaded)return n(null,i);if(i.once("load",n),i.loading)return;i.loading=!0;let s,o,a=this;De.series([u(function(l){let f=vr.format(hL,e,t);a.cc.query(f,function(h,d){if(h)return l(h);s=d.rows[0],l()})},"getTableRow"),u(function(l){if(!s)return l();let f=vr.format(a.selectColumns,e,t);a.cc.query(f,function(h,d){if(h)return l(h);o=d.rows,l()})},"getColumnRows")],u(function(l){if(i.loading=!1,l||!s)return i.emit("load",l,null);a._parseTableOrView(i,s,o,null,!1,function(f){i.loading=!1,i.loaded=!f,i.emit("load",f,i)})},"afterQuery"))};wr.prototype._parseKeyspace=function(e,t){let r=e.replication,n,i;if(r){n=r.class,i={};for(let s in r)!r.hasOwnProperty(s)||s==="class"||(i[s]=r[s])}return this._createKeyspace(e.keyspace_name,e.durable_writes,n,i,t)};wr.prototype._parseTableOrView=function(e,t,r,n,i,s){let o=this.cc.getEncoder(),a={},c=[],l=[],f=this,h=u((p,y)=>{o.parseTypeName(t.keyspace_name,p.type,0,null,f.udtResolver,function(v,m){if(v)return y(v);let x={name:p.column_name,type:m,isStatic:!1};switch(a[x.name]=x,p.kind){case"partition_key":c.push({c:x,index:p.position||0});break;case"clustering":l.push({c:x,index:p.position||0,order:p.clustering_order==="desc"?"DESC":"ASC"});break;case"static":x.isStatic=!0;break}y(null,x)})},"columnRowMapper");if(i){e.virtual=!0,De.map(r,h,function(p,y){if(p)return s(p);e.columns=y,e.columnsByName=a,e.partitionKeys=c.sort(De.propCompare("index")).map(function(v){return v.c}),l.sort(De.propCompare("index")),e.clusteringKeys=l.map(function(v){return v.c}),e.clusteringOrder=l.map(function(v){return v.order}),s()});return}let d=e instanceof y1;e.bloomFilterFalsePositiveChance=t.bloom_filter_fp_chance,e.caching=JSON.stringify(t.caching),e.comment=t.comment;let g=this._asMap(t.compaction);if(g&&(e.compactionOptions={},e.compactionClass=g.get("class"),g.forEach((p,y)=>{y!=="class"&&(e.compactionOptions[y]=g.get(y))})),e.compression=this._mapAsObject(t.compression),e.gcGraceSeconds=t.gc_grace_seconds,e.localReadRepairChance=t.dclocal_read_repair_chance,e.readRepairChance=t.read_repair_chance,e.extensions=this._mapAsObject(t.extensions),e.crcCheckChance=t.crc_check_chance,e.memtableFlushPeriod=t.memtable_flush_period_in_ms||e.memtableFlushPeriod,e.defaultTtl=t.default_time_to_live||e.defaultTtl,e.speculativeRetry=t.speculative_retry||e.speculativeRetry,e.minIndexInterval=t.min_index_interval||e.minIndexInterval,e.maxIndexInterval=t.max_index_interval||e.maxIndexInterval,!d){let p=t.cdc;p!==void 0&&(e.cdc=p)}De.map(r,h,(p,y)=>{if(p)return s(p);if(e.columns=y,e.columnsByName=a,e.partitionKeys=c.sort(De.propCompare("index")).map(function(R){return R.c}),l.sort(De.propCompare("index")),e.clusteringKeys=l.map(function(R){return R.c}),e.clusteringOrder=l.map(function(R){return R.order}),d)return e.tableName=t.base_table_name,e.whereClause=t.where_clause,e.includeAllColumns=t.include_all_columns,s();e.indexes=this._getIndexes(n);let v=t.flags;Array.isArray(v)&&(v=new Set(v));let m=v.has("dense"),x=v.has("super"),w=v.has("compound");e.isCompact=x||m||!w,!x&&!m&&!w?yL(e):m&&mL(e),s()})};wr.prototype._getIndexes=function(e){return!e||e.length===0?De.emptyArray:e.map(t=>{let r=this._mapAsObject(t.options);return new g1(t.index_name,r.target,t.kind,r)})};wr.prototype._parseAggregate=function(e,t){let r=this.cc.getEncoder(),n=new p1;n.name=e.aggregate_name,n.keyspaceName=e.keyspace_name,n.signature=e.argument_types||De.emptyArray,n.stateFunction=e.state_func,n.finalFunction=e.final_func,n.initConditionRaw=e.initcond,n.initCondition=n.initConditionRaw;let i=this;De.series([u(function(o){De.map(e.argument_types||De.emptyArray,function(a,c){r.parseTypeName(e.keyspace_name,a,0,null,i.udtResolver,c)},function(a,c){n.argumentTypes=c,o(a)})},"parseArguments"),u(function(o){r.parseTypeName(e.keyspace_name,e.state_type,0,null,i.udtResolver,function(a,c){n.stateType=c,o(a)})},"parseStateType"),u(function(o){r.parseTypeName(e.keyspace_name,e.return_type,0,null,i.udtResolver,function(a,c){n.returnType=c,o(a)})},"parseReturnType")],function(s){if(s)return t(s);t(null,n)})};wr.prototype._parseFunction=function(e,t){let r=this.cc.getEncoder(),n=new d1;n.name=e.function_name,n.keyspaceName=e.keyspace_name,n.signature=e.argument_types||De.emptyArray,n.argumentNames=e.argument_names||De.emptyArray,n.body=e.body,n.calledOnNullInput=e.called_on_null_input,n.language=e.language;let i=this;De.series([u(function(o){De.map(e.argument_types||De.emptyArray,function(a,c){r.parseTypeName(e.keyspace_name,a,0,null,i.udtResolver,c)},function(a,c){n.argumentTypes=c,o(a)})},"parseArguments"),u(function(o){r.parseTypeName(e.keyspace_name,e.return_type,0,null,i.udtResolver,function(a,c){n.returnType=c,o(a)})},"parseReturnType")],function(s){if(s)return t(s);t(null,n)})};wr.prototype._parseUdt=function(e,t,r){let n=this.cc.getEncoder(),i=t.field_types,s=t.keyspace_name,o=new Array(i.length),a=this;De.forEachOf(t.field_names,function(c,l,f){n.parseTypeName(s,i[l],0,null,a.udtResolver,function(h,d){if(h)return f(h);o[l]={name:c,type:d},f()})},function(c){if(c)return r(c);e.fields=o,r(null,e)})};function Yo(e,t,r){wr.call(this,e,t,r),this.supportsVirtual=!0}u(Yo,"SchemaParserV3");vr.inherits(Yo,wr);Yo.prototype.getKeyspaces=function(e,t){let r=this,n={},i=[{query:m1,virtual:!1},{query:pL,virtual:!0}];De.each(i,(s,o)=>{r.cc.query(s.query,e,(a,c)=>{if(a)return s.virtual?o():o(a);for(let l=0;l<c.rows.length;l++){let f=r._parseKeyspace(c.rows[l],s.virtual);n[f.name]=f}o()})},s=>{t(s,n)})};Yo.prototype.getKeyspace=function(e,t){this._getKeyspace(v1,e,!1,(r,n)=>r?t(r):n?t(null,n):this._getKeyspace(dL,e,!0,t))};Yo.prototype._getKeyspace=function(e,t,r,n){this.cc.query(vr.format(e,t),(i,s)=>{if(i)return r?n(null,null):n(i);let o=s.rows[0];if(!o)return n(null,null);n(null,this._parseKeyspace(o,r))})};function yL(e){let t,r;for(t=0;t<e.clusteringKeys.length;t++){r=e.clusteringKeys[t];let n=e.columns.indexOf(r);e.columns.splice(n,1),delete e.columnsByName[r.name]}for(e.clusteringKeys=De.emptyArray,e.clusteringOrder=De.emptyArray,t=e.columns.length;t--;){if(r=e.columns[t],!r.isStatic&&e.partitionKeys.indexOf(r)===-1){e.columns.splice(t,1),delete e.columnsByName[r.name];continue}r.isStatic=!1}}u(yL,"pruneStaticCompactTableColumns");function mL(e){let t=e.columns.length;for(;t--;){let r=e.columns[t];if(!r.isStatic&&r.type.code===ZD.dataTypes.custom&&r.type.info==="empty"){e.columns.splice(t,1),delete e.columnsByName[r.name];continue}r.isStatic=!1}}u(mL,"pruneDenseTableColumns");function vL(e,t){if(/SimpleStrategy$/.test(e)){let r=parseInt(t.replication_factor,10);if(r>1)return EL(r)}return/NetworkTopologyStrategy$/.test(e)?CL(t):u(function(n,i,s){let o={};for(let a in s)s.hasOwnProperty(a)&&(o[a]=[s[a]]);return o},"noStrategy")}u(vL,"getTokenToReplicaMapper");function EL(e){return u(function(r,n,i){let s=n.length,o=Math.min(e,s),a={};for(let c=0;c<s;c++){let l=n[c],f=[i[l]];for(let h=1;h<s&&f.length<o;h++){let d=c+h;d>=s&&(d=d%s);let g=i[n[d]];f.indexOf(g)===-1&&f.push(g)}a[l]=f}return a},"tokenSimpleStrategy")}u(EL,"getTokenToReplicaSimpleMapper");function CL(e){return u(function(r,n,i,s){let o={},a=n.length;for(let c=0;c<a;c++){let l=n[c],f=[],h={},d={},g=[];for(let p=0;p<a;p++){let y=c+p;y>=a&&(y=y%a);let v=i[n[y]];if(f.indexOf(v)!==-1)continue;let m=v.datacenter,x=parseInt(e[m],10);if(!x)continue;x=Math.min(x,s[m].hostLength);let w=h[m]||0;if(w>=x)continue;let B=d[m];if(B||(B=d[m]=new De.HashSet),v.rack&&B.contains(v.rack)&&B.length<s[m].racks.length){g.length<x-w&&g.push(v);continue}if(h[v.datacenter]=++w,f.push(v),v.rack&&B.add(v.rack)&&B.length===s[m].racks.length&&(h[m]+=SL(x,w,f,g)),E1(e,s,h))break}o[l]=f}return o},"tokenNetworkStrategy")}u(CL,"getTokenToReplicaNetworkMapper");function SL(e,t,r,n){let i;for(i=0;i<e-t&&i<n.length;i++)r.push(n[i]);return i}u(SL,"addSkippedHosts");function E1(e,t,r){let n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],o=t[s];if(!o)continue;let a=Math.min(parseInt(e[s],10),o.hostLength);if(a>0&&(!r[s]||r[s]<a))return!1}return!0}u(E1,"isDoneForToken");function xL(e,t,r,n,i){let s=kn;return n&&n[0]===3?s=wr:n&&n[0]>=4&&(s=Yo),!i||!(i instanceof s)?new s(e,t,r):i}u(xL,"getByVersion");Zh.getByVersion=xL;Zh.isDoneForToken=E1});var Xh=_((P5,T1)=>{"use strict";var TL=require("events"),ni=require("util"),Yh=zE(),ft=se(),ii=Ue(),Ls=Ve(),Du=Li(),x1=C1(),Lu=Vo().TokenRange,_L=Ss().ExecutionOptions,wL="SELECT * FROM system_traces.sessions WHERE session_id=%s",bL="SELECT * FROM system_traces.events WHERE session_id=%s",IL="SELECT schema_version FROM system.peers",AL="SELECT schema_version FROM system.local",S1=5,BL=200;function oe(e,t){if(!e)throw new ii.ArgumentError("Options are not defined");Object.defineProperty(this,"options",{value:e,enumerable:!1,writable:!1}),Object.defineProperty(this,"controlConnection",{value:t,enumerable:!1,writable:!1}),this.keyspaces={},this.initialized=!1,this._isDbaas=!1,this._schemaParser=x1.getByVersion(e,t,this.getUdt.bind(this));let r=this;this._preparedQueries=new si(e.maxPrepared,function(){r.log.apply(r,arguments)})}u(oe,"Metadata");oe.prototype.setCassandraVersion=function(e){this._schemaParser=x1.getByVersion(this.options,this.controlConnection,this.getUdt.bind(this),e,this._schemaParser)};oe.prototype.isDbaas=function(){return this._isDbaas};oe.prototype.setProductTypeAsDbaas=function(){this._isDbaas=!0};oe.prototype.setPartitioner=function(e){return/RandomPartitioner$/.test(e)?this.tokenizer=new Yh.RandomTokenizer:/ByteOrderedPartitioner$/.test(e)?this.tokenizer=new Yh.ByteOrderedTokenizer:this.tokenizer=new Yh.Murmur3Tokenizer};oe.prototype.buildTokens=function(e){if(!this.tokenizer)return this.log("error","Tokenizer could not be determined");let t=[],r={},n=e.values(),i=this.tokenizer.stringify,s={};n.forEach(a=>{if(!a.tokens)return;a.tokens.forEach(l=>{let f=this.tokenizer.parse(l);ft.insertSorted(t,f,(h,d)=>h.compare(d)),r[i(f)]=a});let c=s[a.datacenter];c||(c=s[a.datacenter]={hostLength:0,racks:new ft.HashSet}),c.hostLength++,c.racks.add(a.rack)}),this.primaryReplicas=r,this.ring=t;let o=new Set;if(this.ring.length===1){let a=this.tokenizer.minToken();o.add(new Lu(a,a,this.tokenizer))}else for(let a=0;a<this.ring.length;a++){let c=this.ring[a],l=this.ring[(a+1)%this.ring.length];o.add(new Lu(c,l,this.tokenizer))}this.tokenRanges=o,this.ringTokensAsStrings=new Array(t.length);for(let a=0;a<t.length;a++)this.ringTokensAsStrings[a]=i(t[a]);this.datacenters=s};oe.prototype.refreshKeyspace=function(e,t){return ft.promiseWrapper.call(this,this.options,t,u(function(n){this._refreshKeyspaceCb(e,n)},"handler"))};oe.prototype._refreshKeyspaceCb=function(e,t){if(!this.initialized)return t(this._uninitializedError(),null);this.log("info",ni.format("Retrieving keyspace %s metadata",e));let r=this;this._schemaParser.getKeyspace(e,function(n,i){if(n)return r.log("error","There was an error while trying to retrieve keyspace information",n),t(n);if(!i)return delete r.keyspaces[e],t();r.keyspaces[i.name]=i,t(null,i)})};oe.prototype.refreshKeyspaces=function(e,t){return(typeof e=="function"||typeof e>"u")&&(t=e,e=!0),this._refreshKeyspaces(e,!1,t)};oe.prototype._refreshKeyspaces=function(e,t,r){return ft.promiseWrapper.call(this,this.options,r,u(function(i){this._refreshKeyspacesCb(e,t,i)},"handler"))};oe.prototype._refreshKeyspacesCb=function(e,t,r){if(!t&&!this.initialized)return r(this._uninitializedError(),null);this.log("info","Retrieving keyspaces metadata");let n=this;this._schemaParser.getKeyspaces(e,u(function(s,o){if(s)return n.log("error","There was an error while trying to retrieve keyspaces information",s),r(s);n.keyspaces=o,r(null,o)},"getKeyspacesCallback"))};oe.prototype._getKeyspaceReplicas=function(e){return e.replicas||(e.replicas=e.tokenToReplica(this.tokenizer,this.ringTokensAsStrings,this.primaryReplicas,this.datacenters)),e.replicas};oe.prototype.getReplicas=function(e,t){if(!this.ring)return null;Buffer.isBuffer(t)&&(t=this.tokenizer.hash(t)),t instanceof Lu&&(t=t.end);let r;if(e&&(r=this.keyspaces[e],!r))return null;let n=ft.binarySearch(this.ring,t,(o,a)=>o.compare(a));n<0&&(n=~n),n>=this.ring.length&&(n=n%this.ring.length);let i=this.ringTokensAsStrings[n];return e?this._getKeyspaceReplicas(r)[i]:[this.primaryReplicas[i]]};oe.prototype.getTokenRanges=function(){return this.tokenRanges};oe.prototype.getTokenRangesForHost=function(e,t){if(!this.ring)return null;let r;if(e&&(r=this.keyspaces[e],!r))return null;if(this.ring.length===1)return this.getTokenRanges();let n=this._getKeyspaceReplicas(r),i=new Set;return this.tokenRanges.forEach(s=>{n[this.tokenizer.stringify(s.end)].indexOf(t)!==-1&&i.add(s)}),i};oe.prototype.newToken=function(e){if(!this.tokenizer)throw new Error("Partitioner not established.  This should only happen if metadata was disabled or you have not connected yet.");return ni.isArray(e)?this.tokenizer.hash(Buffer.concat(e)):ni.isString(e)?this.tokenizer.parse(e):this.tokenizer.hash(e)};oe.prototype.newTokenRange=function(e,t){if(!this.tokenizer)throw new Error("Partitioner not established.  This should only happen if metadata was disabled or you have not connected yet.");return new Lu(e,t,this.tokenizer)};oe.prototype.log=ft.log;oe.prototype.getPreparedInfo=function(e,t){return this._preparedQueries.getOrAdd(e,t)};oe.prototype.clearPrepared=function(){this._preparedQueries.clear()};oe.prototype.getPreparedById=function(e){return this._preparedQueries.getById(e)};oe.prototype.setPreparedById=function(e){return this._preparedQueries.setById(e)};oe.prototype.getAllPrepared=function(){return this._preparedQueries.getAll()};oe.prototype._uninitializedError=function(){return new Error("Metadata has not been initialized.  This could only happen if you have not connected yet.")};oe.prototype.getUdt=function(e,t,r){return ft.promiseWrapper.call(this,this.options,r,u(function(i){this._getUdtCb(e,t,i)},"handler"))};oe.prototype._getUdtCb=function(e,t,r){if(!this.initialized)return r(this._uninitializedError(),null);let n;if(this.options.isMetadataSyncEnabled){let i=this.keyspaces[e];if(!i)return r(null,null);n=i.udts}this._schemaParser.getUdt(e,t,n,r)};oe.prototype.getTable=function(e,t,r){return ft.promiseWrapper.call(this,this.options,r,u(function(i){this._getTableCb(e,t,i)},"handler"))};oe.prototype._getTableCb=function(e,t,r){if(!this.initialized)return r(this._uninitializedError(),null);let n,i;if(this.options.isMetadataSyncEnabled){let s=this.keyspaces[e];if(!s)return r(null,null);n=s.tables,i=s.virtual}this._schemaParser.getTable(e,t,n,i,r)};oe.prototype.getFunctions=function(e,t,r){return ft.promiseWrapper.call(this,this.options,r,u(function(i){this._getFunctionsCb(e,t,i)},"handler"))};oe.prototype._getFunctionsCb=function(e,t,r){if(typeof r!="function")throw new ii.ArgumentError("Callback is not a function");if(!e||!t)return r(new ii.ArgumentError("You must provide the keyspace name and cql function name to retrieve the metadata"));this._getFunctions(e,t,!1,function(n,i){if(n)return r(n,null);r(null,ft.objectValues(i))})};oe.prototype.getFunction=function(e,t,r,n){return ft.promiseWrapper.call(this,this.options,n,u(function(s){this._getSingleFunctionCb(e,t,r,!1,s)},"handler"))};oe.prototype.getAggregates=function(e,t,r){return ft.promiseWrapper.call(this,this.options,r,u(function(i){this._getAggregatesCb(e,t,i)},"handler"))};oe.prototype._getAggregatesCb=function(e,t,r){if(typeof r!="function")throw new ii.ArgumentError("Callback is not a function");if(!e||!t)return r(new ii.ArgumentError("You must provide the keyspace name and cql aggregate name to retrieve the metadata"));this._getFunctions(e,t,!0,function(n,i){if(n)return r(n,null);r(null,ft.objectValues(i))})};oe.prototype.getAggregate=function(e,t,r,n){return ft.promiseWrapper.call(this,this.options,n,u(function(s){this._getSingleFunctionCb(e,t,r,!0,s)},"handler"))};oe.prototype.getMaterializedView=function(e,t,r){return ft.promiseWrapper.call(this,this.options,r,u(function(i){this._getMaterializedViewCb(e,t,i)},"handler"))};oe.prototype._getMaterializedViewCb=function(e,t,r){if(!this.initialized)return r(this._uninitializedError(),null);let n;if(this.options.isMetadataSyncEnabled){let i=this.keyspaces[e];if(!i)return r(null,null);n=i.views}this._schemaParser.getMaterializedView(e,t,n,r)};oe.prototype._getFunctions=function(e,t,r,n){if(!this.initialized)return n(this._uninitializedError(),null);let i;if(this.options.isMetadataSyncEnabled){let s=this.keyspaces[e];if(!s)return n(null,null);i=r?s.aggregates:s.functions}this._schemaParser.getFunctions(e,t,r,i,n)};oe.prototype._getSingleFunctionCb=function(e,t,r,n,i){if(typeof i!="function")throw new ii.ArgumentError("Callback is not a function");if(!e||!t)return i(new ii.ArgumentError("You must provide the keyspace name and cql function name to retrieve the metadata"));if(!ni.isArray(r))return i(new ii.ArgumentError("Signature must be an array of types"));try{r=r.map(function(s){return typeof s=="string"?s:Ls.getDataTypeNameByCode(s)})}catch(s){return i(s)}this._getFunctions(e,t,n,function(s,o){if(s)return i(s,null);let a;o&&(a=o["("+r.join(",")+")"]),i(null,a||null)})};oe.prototype.getTrace=function(e,t,r){return!r&&typeof t=="function"&&(r=t,t=null),ft.promiseWrapper.call(this,this.options,r,u(function(i){this._getTraceCb(e,t,i)},"handler"))};oe.prototype._getTraceCb=function(e,t,r){if(!this.initialized)return r(this._uninitializedError(),null);let n,i=0,s=_L.empty();s.getConsistency=()=>t;let o=new Du.QueryRequest(ni.format(wL,e),null,s),a=new Du.QueryRequest(ni.format(bL,e),null,s),c=this;ft.whilst(u(function(){return!n&&i++<S1},"condition"),u(function(f){c.controlConnection.query(o,function(h,d){if(h)return f(h);let g=d.rows[0];if(!g||!g.duration)return setTimeout(f,BL);n={requestType:g.request,coordinator:g.coordinator,parameters:g.parameters,startedAt:g.started_at,duration:g.duration,clientAddress:g.client,events:[]},c.controlConnection.query(a,function(p,y){if(p)return f(p);y.rows.forEach(function(v){n.events.push({id:v.event_id,activity:v.activity,source:v.source,elapsed:v.source_elapsed,thread:v.thread})}),f()})})},"iterator"),u(function(f){!f&&!n&&(f=new Error(ni.format("Trace %s could not fully retrieved after %d attempts",e,S1))),r(f,n)},"getTraceEnded"))};oe.prototype.checkSchemaAgreement=function(e){return ft.promiseWrapper.call(this,this.options,e,u(function(r){let n=this.controlConnection.connection;if(!n)return r(null,!1);this.compareSchemaVersions(n,(i,s)=>{r(null,!i&&s)})},"handler"))};oe.prototype.adaptUserHints=function(e,t,r){if(!ni.isArray(t))return r();let n=[];function i(o){if(o.code===Ls.dataTypes.udt){let a=o.info.split(".");if(o.info={keyspace:a[0],name:a[1]},!o.info.name){if(!e)throw new TypeError("No keyspace specified for udt: "+a.join("."));o.info.name=o.info.keyspace,o.info.keyspace=e}n.push(o);return}if(o.info){if(o.code===Ls.dataTypes.list||o.code===Ls.dataTypes.set)return i(o.info);o.code===Ls.dataTypes.map&&(i(o.info[0]),i(o.info[1]))}}u(i,"checkUdtTypes");for(let o=0;o<t.length;o++){let a=t[o];if(typeof a=="string")try{let c=Ls.dataTypes.getByName(a);i(c),t[o]=c}catch(c){return r(c)}}let s=this;ft.each(n,function(o,a){s.getUdt(o.info.keyspace,o.info.name,function(c,l){if(c)return a(c);if(!l)return a(new TypeError("User defined type not found: "+o.info.keyspace+"."+o.info.name));o.info=l,a()})},r)};oe.prototype.compareSchemaVersions=function(e,t){let r=new Set;ft.series([n=>{let i=new Du.QueryRequest(AL,null,null);e.sendStream(i,null,function(s,o){!s&&o&&o.rows&&o.rows.length===1&&r.add(o.rows[0].schema_version.toString()),n(s)})},n=>{let i=new Du.QueryRequest(IL,null,null);e.sendStream(i,null,function(s,o){if(!s&&o&&o.rows)for(let a of o.rows){let c=a.schema_version;c&&r.add(c.toString())}n(s)})}],n=>{t(n,r.size===1)})};function si(e,t){this.length=0,this._maxPrepared=e,this._mapByKey={},this._mapById={},this._logger=t}u(si,"PreparedQueries");si.prototype._getKey=function(e,t){return(e||"")+t};si.prototype.getOrAdd=function(e,t){let r=this._getKey(e,t),n=this._mapByKey[r];return n||(this._validateOverflow(),n=new TL.EventEmitter,n.setMaxListeners(0),n.query=t,n.keyspace=e,this._mapByKey[r]=n,this.length++,n)};si.prototype._validateOverflow=function(){if(this.length<this._maxPrepared)return;let e=[];this._logger("warning","Prepared statements exceeded maximum. This could be caused by preparing queries that contain parameters");let t=Object.keys(this._mapByKey);for(let r=0;r<t.length&&this.length-e.length>=this._maxPrepared;r++){let n=this._mapByKey[t[r]];n.queryId&&e.push(n)}e.forEach(function(r){delete this._mapByKey[this._getKey(r.keyspace,r.query)],delete this._mapById[r.queryId],this.length--},this)};si.prototype.setById=function(e){this._mapById[e.queryId.toString("hex")]=e};si.prototype.getById=function(e){return this._mapById[e.toString("hex")]};si.prototype.clear=function(){this._mapByKey={},this._mapById={},this.length=0};si.prototype.getAll=function(){return ft.objectValues(this._mapByKey).filter(function(e){return!!e.queryId})};T1.exports=oe});var I1=_((q5,b1)=>{"use strict";var NL=require("util"),w1=se(),_1=1e3;function Ou(e,t){this._delay=e,this._logger=t,this._queue=null,this._timeout=null}u(Ou,"EventDebouncer");Ou.prototype.eventReceived=function(e,t){e.callback=e.callback||w1.noop,this._queue=this._queue||{callbacks:[],keyspaces:{}};let r=t?0:this._delay;if(e.all&&(this._queue.mainEvent=e),this._queue.callbacks.length===_1&&this._logger("warn",NL.format("Event debouncer queue exceeded %d events",_1)),this._queue.callbacks.push(e.callback),this._queue.mainEvent)return this._slideDelay(r);let n=this._queue.keyspaces[e.keyspace];n||(n=this._queue.keyspaces[e.keyspace]={events:[]}),e.cqlObject===void 0&&(n.mainEvent=e),n.events.push(e),this._slideDelay(r)};Ou.prototype._slideDelay=function(e){let t=this;function r(){let i=t._queue;t._queue=null,t._timeout=null,RL(i)}if(u(r,"process"),e===0)return this._timeout&&clearTimeout(this._timeout),r();let n=this._timeout;this._timeout=setTimeout(r,e),n&&clearTimeout(n)};Ou.prototype.shutdown=function(){this._queue&&(this._queue.callbacks.forEach(function(e){e()}),this._queue=null,clearTimeout(this._timeout),this._timeout=null)};function RL(e){if(e.mainEvent)return e.mainEvent.handler(u(function(r){for(let n=0;n<e.callbacks.length;n++)e.callbacks[n](r)},"invokeCallbacks"));w1.each(Object.keys(e.keyspaces),u(function(r,n){let i=e.keyspaces[r];if(i.mainEvent)return i.mainEvent.handler(u(function(o){for(let a=0;a<i.events.length;a++)i.events[a].callback(o);n()},"mainEventCallback"));i.events.forEach(u(function(o){o.handler(),o.callback()},"eachEvent")),n()},"eachKeyspace"))}u(RL,"processQueue");b1.exports=Ou});var L1=_((V5,D1)=>{"use strict";var DL=require("events"),B1=require("util"),A1=require("net"),Fu=require("dns"),dn=Ue(),N1=kh().Host,LL=kh().HostMap,OL=Xh(),FL=I1(),PL=Ih(),Xo=Li(),br=se(),Pu=Ve(),ku=B1.format,kL="SELECT * FROM system.peers",qL="SELECT * FROM system.local WHERE key='local'",R1=1e3,UL=2e3,VL={created:"CREATED",updated:"UPDATED",dropped:"DROPPED"},ML="PRODUCT_TYPE",KL="DATASTAX_APOLLO";function Re(e,t,r){this.protocolVersion=null,this.hosts=new LL,this.setMaxListeners(0),Object.defineProperty(this,"options",{value:e,enumerable:!1,writable:!1}),this.metadata=new OL(this.options,this),this.addressTranslator=this.options.policies.addressResolution,this.reconnectionPolicy=this.options.policies.reconnection,this.reconnectionSchedule=this.reconnectionPolicy.newSchedule(),this.initialized=!1,this.isShuttingDown=!1,this.host=null,this.connection=null,this.encoder=null,this.debouncer=new FL(e.refreshSchemaDelay,this.log.bind(this)),this.profileManager=t,this.topologyChangeTimeout=null,this.nodeStatusChangeTimeout=null,this.reconnectionTimeout=null,this.hostIterator=null,this.triedHosts=null,this._resolvedContactPoints=new Map,this._contactPoints=new Set,r&&r.borrowHostConnection&&(this.borrowHostConnection=r.borrowHostConnection),r&&r.createConnection&&(this.createConnection=r.createConnection)}u(Re,"ControlConnection");B1.inherits(Re,DL.EventEmitter);Re.prototype.addContactPoint=function(e,t,r,n){if(e===null){this._resolvedContactPoints.set(r,br.emptyArray);return}let i=parseInt(t,10)||this.options.protocolOptions.port,s=`${e}:${i}`;this._contactPoints.add(s);let o=n?`[${e}]:${i}`:s,a=this._resolvedContactPoints.get(r);a===void 0&&(a=[],this._resolvedContactPoints.set(r,a)),a.push(o)};Re.prototype.parseEachContactPoint=function(e,t){let r=e,n=null;if(e.indexOf("[")===0&&e.indexOf("]:")>1){let i=e.lastIndexOf("]:");r=e.substr(1,i-1),n=e.substr(i+2)}else if(e.indexOf(":")>0){let i=e.split(":");i.length===2&&(r=i[0],n=i[1])}if(A1.isIP(r))return this.addContactPoint(r,n,e,A1.isIPv6(r)),t();HL(r,(i,s)=>{if(i)return this.log("error",`Host with name ${r} could not be resolved`,i),this.addContactPoint(null,null,e,!1),t();s.forEach(o=>this.addContactPoint(o.address,n,e,o.isIPv6)),t()})};Re.prototype.init=function(e){if(this.initialized)return e();let t=u(r=>{if(!r&&this._contactPoints.size===0&&(r=new dn.NoHostAvailableError({},"No host could be resolved")),r)return e(r);this.refresh(!1,n=>{this.initialized=!n,e(n)})},"contactPointsResolutionCb");if(!this.options.sni)br.each(this.options.contactPoints,(r,n)=>this.parseEachContactPoint(r,n),t);else{this.options.contactPoints.forEach(s=>this._contactPoints.add(s));let r=this.options.sni.address,n=r.lastIndexOf(":");if(n===-1)return e(new dn.DriverInternalError("The SNI endpoint address should contain ip/name and port"));let i=r.substr(0,n);this.options.sni.port=r.substr(n+1),this.options.sni.addressResolver=new br.AddressResolver({nameOrIp:i,dns:Fu}),this.options.sni.addressResolver.init(t)}};Re.prototype.setHealthListeners=function(e,t){let r=this,n=0;function i(){e.removeListener("down",o),e.removeListener("ignore",o),t.removeListener("socketClose",a)}u(i,"removeListeners");function s(c){n++===0&&(i(),!r.isShuttingDown&&(c?r.log("warning",`Host ${e.address} used by the ControlConnection DOWN, connection to ${t.endpointFriendlyName} will not longer by used`):r.log("warning",`Connection to ${t.endpointFriendlyName} used by the ControlConnection was closed`),r.refresh()))}u(s,"startReconnecting");function o(){s(!0)}u(o,"downOrIgnoredHandler");function a(){s(!1)}u(a,"socketClosedHandler"),e.once("down",o),e.once("ignore",o),t.once("socketClose",a)};Re.prototype.borrowAConnection=function(e){let t=this,r,n=null;br.whilst(u(function(){if(n)return!1;let s=t.hostIterator.next();return r=s.value,!s.done},"condition"),u(function(s){if(t.initialized){let o=t.profileManager.getDistance(r);if(!r.isUp()||o===Pu.distance.ignored)return s();t.borrowHostConnection(r,function(a,c){t.triedHosts[r.address]=a,n=c,s()})}else t.createConnection(r,(o,a)=>{t.triedHosts[r]=o,n=a,s()})},"whileIterator"),u(function(){if(!n)return e(new dn.NoHostAvailableError(t.triedHosts));t.initialized||(t.protocolVersion=n.protocolVersion,t.encoder=n.encoder),t.connection=n,e()},"whilstEnded"))};Re.prototype.borrowHostConnection=function(e,t){e.borrowConnection(null,null,t)};Re.prototype.createConnection=function(e,t){let r=new PL(e,null,this.options);r.open(n=>{if(n)return setImmediate(()=>r.close()),t(n);t(null,r)})};Re.prototype.refreshHosts=function(e,t,r){r=r||br.noop;let n=this.connection;if(!n)return r();let i=this;this.log("info","Refreshing local and peers info"),br.series([u(function(o){let a=new Xo.QueryRequest(qL,null,null);n.sendStream(a,null,function(c,l){if(i.setLocalInfo(e,t,n,l),!c&&!i.host)return o(new dn.DriverInternalError("Information from system.local could not be retrieved"));o(c)})},"getLocalInfo"),u(function(o){let a=new Xo.QueryRequest(kL,null,null);n.sendStream(a,null,function(c,l){i.setPeersInfo(e,c,l,o)})},"getPeersInfo"),u(function(o){if(!i.initialized){let a=Pu.protocolVersion.getHighestCommon(n,i.hosts),c=a!==i.protocolVersion;if(i.protocolVersion=a,i.hosts.forEach(l=>l.setProtocolVersion(i.protocolVersion)),c){i.log("info",`Reconnecting since the protocol version changed to 0x${a.toString(16)}`),n.decreaseVersion(i.protocolVersion),n.close(()=>setImmediate(()=>n.open(l=>{l&&n.close(),o(l)})));return}}o()},"resolveAndSetProtocolVersion"),u(function(o){if(i.metadata.setCassandraVersion(i.host.getCassandraVersion()),i.metadata.buildTokens(i.hosts),!i.options.isMetadataSyncEnabled)return i.metadata.initialized=!0,o();i.metadata._refreshKeyspaces(!1,!0,()=>{i.metadata.initialized=!0,o()})},"getKeyspaces")],r)};Re.prototype.refresh=function(e,t){let r=!this.initialized;if(t=t||br.noop,this.isShuttingDown)return this.log("info","The ControlConnection will not be refreshed as the Client is being shutdown"),t(new dn.NoHostAvailableError({},"ControlConnection is shutting down"));this.host=null,this.connection=null;let n=this;br.series([u(function(s){if(e)return s();if(n.triedHosts={},r){n.log("info","Getting first connection");let o=Array.from(n._contactPoints);return br.shuffleArray(o),n.hostIterator=o[Symbol.iterator](),s()}n.log("info","Trying to acquire a connection to a new host"),n.profileManager.getDefaultLoadBalancing().newQueryPlan(null,null,u(function(a,c){if(a)return n.log("error","ControlConnection could not retrieve a query plan to determine which hosts to use",a),s(a);n.hostIterator=c,s()},"onNewPlan"))},"getHostIterator"),u(function(s){n.borrowAConnection(s)},"getConnectionTask"),u(function(s){if(!r)return s();n.getSupportedOptions(s)},"getOptions"),u(function(s){n.log("info",(r?`ControlConnection using protocol version 0x${n.protocolVersion.toString(16)},`:"ControlConnection")+` connected to ${n.connection.endpointFriendlyName}`),n.refreshHosts(r,!0,s)},"getLocalAndPeersInfo"),u(function(s){n.connection.on("nodeTopologyChange",n.nodeTopologyChangeHandler.bind(n)),n.connection.on("nodeStatusChange",n.nodeStatusChangeHandler.bind(n)),n.connection.on("nodeSchemaChange",n.nodeSchemaChangeHandler.bind(n));let o=new Xo.RegisterRequest(["TOPOLOGY_CHANGE","STATUS_CHANGE","SCHEMA_CHANGE"]);n.connection.sendStream(o,null,s)},"subscribeConnectionEvents")],u(function(s){if(!s)return n.connection.connected?(r&&n.host.pool.addExistingConnection(n.connection),n.setHealthListeners(n.host,n.connection),n.reconnectionSchedule=n.reconnectionPolicy.newSchedule(),n.emit("newConnection",null,n.connection,n.host),n.log("info",`ControlConnection connected to ${n.connection.endpointFriendlyName} and up to date`),t()):(n.log("info",ku("Connection to %s was closed before finishing refresh",n.host.address)),n.refresh(!1,t));if(!n.connection)return n.log("error","ControlConnection failed to acquire a connection",s),!r&&!n.isShuttingDown&&(n.noOpenConnectionHandler(),n.emit("newConnection",s)),t(s);n.log("error","ControlConnection failed to retrieve topology and keyspaces information",s),n.triedHosts[n.connection.endpoint]=s,s&&s.isSocketError&&!r&&n.host&&n.host.removeFromPool(n.connection),n.refresh(!0,t)},"refreshSeriesEnd"))};Re.prototype.noOpenConnectionHandler=function(){let e=this.reconnectionSchedule.next().value;this.log("warning",ku("ControlConnection could not reconnect, scheduling reconnection in %dms",e));let t=this;setTimeout(()=>t.refresh(),e)};Re.prototype.getSupportedOptions=function(e){this.connection.sendStream(Xo.options,null,(r,n)=>{if(!r){let i=n.supported&&n.supported[ML];Array.isArray(i)&&i[0]===KL&&this.metadata.setProductTypeAsDbaas()}e(r)})};Re.prototype.log=br.log;Re.prototype.nodeTopologyChangeHandler=function(e){this.log("info","Received topology change",e);let t=this;clearTimeout(this.topologyChangeTimeout),this.topologyChangeTimeout=setTimeout(()=>t.scheduleRefreshHosts(),R1)};Re.prototype.nodeStatusChangeHandler=function(e){let t=this,r=e.inet.address.toString(),n=this.options.protocolOptions.port;this.addressTranslator.translate(r,n,u(function(s){let o=t.hosts.get(s);if(!o){t.log("warning","Received status change event but host was not found: "+r);return}let a=t.profileManager.getDistance(o);if(e.up){if(a===Pu.distance.ignored)return o.setUp(!0);clearTimeout(t.nodeStatusChangeTimeout),t.nodeStatusChangeTimeout=setTimeout(()=>o.checkIsUp(),R1);return}if(a===Pu.distance.ignored)return o.setDown();t.log("warning","Received status change to DOWN for host "+o.address)},"translateCallback"))};Re.prototype.nodeSchemaChangeHandler=function(e){this.log("info","Schema change",e),this.options.isMetadataSyncEnabled&&this.handleSchemaChange(e,!1)};Re.prototype.handleSchemaChange=function(e,t,r){let n=this,i,s;if(e.isKeyspace)return e.schemaChangeType===VL.dropped?(i=u(function(){delete n.metadata.keyspaces[e.keyspace]},"removeKeyspace"),this.scheduleObjectRefresh(i,e.keyspace,null,t,r)):this.scheduleKeyspaceRefresh(e.keyspace,t,r);let o=this.metadata.keyspaces[e.keyspace];o&&(e.table?(s=e.table,i=u(function(){delete o.tables[e.table],delete o.views[e.table]},"clearTableState")):e.udt?(s=e.udt,i=u(function(){delete o.udts[e.udt]},"clearUdtState")):e.functionName?(s=e.functionName,i=u(function(){delete o.functions[e.functionName]},"clearFunctionState")):e.aggregate&&(s=e.aggregate,i=u(function(){delete o.aggregates[e.aggregate]},"clearKeyspaceState")),i&&this.scheduleObjectRefresh(i,e.keyspace,s,t,r))};Re.prototype.scheduleObjectRefresh=function(e,t,r,n,i){this.debouncer.eventReceived({handler:e,keyspace:t,cqlObject:r,callback:i},n)};Re.prototype.scheduleKeyspaceRefresh=function(e,t,r){this.debouncer.eventReceived({handler:n=>this.metadata.refreshKeyspace(e,n),keyspace:e,callback:r},t)};Re.prototype.scheduleRefreshHosts=function(e){this.debouncer.eventReceived({handler:t=>this.refreshHosts(!1,!1,t),all:!0,callback:e},!1)};Re.prototype.setLocalInfo=function(e,t,r,n){if(!n||!n.rows||!n.rows.length){this.log("warning","No local info could be obtained");return}let i=n.rows[0],s,o=this.options.sni?`${i.rpc_address}:${this.options.protocolOptions.port}`:r.endpoint;if(e)s=new N1(o,this.protocolVersion,this.options,this.metadata),this.hosts.set(o,s),this.log("info",`Adding host ${o}`);else if(s=this.hosts.get(o),!s){this.log("error","Localhost could not be found");return}s.datacenter=i.data_center,s.rack=i.rack,s.tokens=i.tokens,s.hostId=i.host_id,s.cassandraVersion=i.release_version,this.metadata.setPartitioner(i.partitioner),this.log("info","Local info retrieved"),t&&(this.host=s)};Re.prototype.setPeersInfo=function(e,t,r,n){if(!r||!r.rows||t)return n(t);let i={},s=this.options.protocolOptions.port,o=new Set;this.host&&this.host.datacenter&&o.add(this.host.datacenter);let a=this;br.eachSeries(r.rows,u(function(l,f){a.getAddressForPeerHost(l,s,u(function(d){if(!d)return f();i[d]=!0;let g=a.hosts.get(d),p=!g;p&&(g=new N1(d,a.protocolVersion,a.options,a.metadata),a.log("info","Adding host "+d),p=!0),g.datacenter=l.data_center,g.rack=l.rack,g.tokens=l.tokens,g.hostId=l.host_id,g.cassandraVersion=l.release_version,g.datacenter&&o.add(g.datacenter),p&&(a.hosts.set(d,g),e||(a.profileManager.getDistance(g),g.setDown())),f()},"getAddressForPeerCallback"))},"eachPeer"),function(c){if(c)return n(c);if(a.hosts.length>r.rows.length+1){a.log("info","Removing nodes from the pool");let l=[];a.hosts.forEach(function(f){!i[f.address]&&f!==a.host&&(a.log("info","Removing host "+f.address),l.push(f.address),f.shutdown(!0))}),a.hosts.removeMultiple(l)}if(e&&a.options.localDataCenter){let l=a.options.localDataCenter;if(!o.has(l))return n(new dn.ArgumentError("localDataCenter was configured as '"+l+"', but only found hosts in data centers: ["+Array.from(o).join(", ")+"]"))}a.log("info","Peers info retrieved"),n()})};Re.prototype.getAddressForPeerHost=function(e,t,r){let n=e.rpc_address,i=e.peer,s="0.0.0.0";if(!n)return this.log("error",ku("No rpc_address found for host %s in %s's peers system table. %s will be ignored.",i,this.host.address,i)),r(null);n.toString()===s&&(this.log("warning",ku("Found host with 0.0.0.0 as rpc_address, using listen_address (%s) to contact it instead. If this is incorrect you should avoid the use of 0.0.0.0 server side.",i)),n=i),this.addressTranslator.translate(n.toString(),t,r)};Re.prototype.waitForReconnection=function(e){let t,r=this;function n(i){clearTimeout(t),e(i)}u(n,"newConnectionListener"),this.once("newConnection",n),t=setTimeout(u(function(){r.removeListener("newConnection",n),e(new dn.OperationTimedOutError("A connection could not be acquired before timeout."))},"waitTimeout"),UL)};Re.prototype.query=function(e,t,r){typeof t=="function"&&(r=t,t=!0);let n=this;function i(){if(!n.connection||n.isShuttingDown)return r(new dn.NoHostAvailableError({},"ControlConnection is not connected at the time"));let s=typeof e=="string"?new Xo.QueryRequest(e,null,null):e;n.connection.sendStream(s,null,r)}if(u(i,"queryOnConnection"),!this.connection&&t)return this.waitForReconnection(u(function(o){if(o)return r(o);i()},"waitCallback"));i()};Re.prototype.getEncoder=function(){if(!this.encoder)throw new dn.DriverInternalError("Encoder is not defined");return this.encoder};Re.prototype.shutdown=function(){this.isShuttingDown=!0,this.debouncer.shutdown(),this.emit("newConnection",new dn.DriverError("ControlConnection is being shutdown")),clearTimeout(this.topologyChangeTimeout),clearTimeout(this.nodeStatusChangeTimeout),clearTimeout(this.reconnectionTimeout)};Re.prototype.reset=function(e){let t=this.hosts.clear();this.isShuttingDown=!0;let r=this;br.each(t,(n,i)=>n.shutdown(!1,()=>i()),u(function(){r.initialized=!1,r.isShuttingDown=!1,e()},"shuttingDownFinished"))};Re.prototype.getResolvedContactPoints=function(){return this._resolvedContactPoints};Re.prototype.getLocalAddress=function(){if(this.connection)return this.connection.getLocalAddress()};Re.prototype.getEndpoint=function(){if(this.connection)return this.connection.endpoint};function HL(e,t){let r=[];br.parallel([u(function(i){Fu.resolve4(e,u(function(o,a){a&&a.forEach(c=>r.push({address:c,isIPv6:!1})),i()},"resolve4Callback"))},"resolve4"),u(function(i){Fu.resolve6(e,u(function(o,a){a&&a.forEach(c=>r.push({address:c,isIPv6:!0})),i()},"resolve6Callback"))},"resolve6")],u(function(){if(r.length===0)return Fu.lookup(e,function(i,s,o){if(i)return t(i);r.push({address:s,isIPv6:o===6}),t(null,r)});t(null,r)},"resolveAllCallback"))}u(HL,"resolveAll");D1.exports=Re});var qu=_(O1=>{O1.require=function(){var e=require("fs");if(process.versions.electron)try{originalFs=require("original-fs"),Object.keys(originalFs).length>0&&(e=originalFs)}catch{}return e}});var Jh=_((H5,F1)=>{F1.exports={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,END64HDR:20,END64SIG:117853008,END64START:4,END64OFF:8,END64NUMDISKS:16,ZIP64SIG:101075792,ZIP64HDR:56,ZIP64LEAD:12,ZIP64SIZE:4,ZIP64VEM:12,ZIP64VER:14,ZIP64DSK:16,ZIP64DSKDIR:20,ZIP64SUB:24,ZIP64TOT:32,ZIP64SIZB:40,ZIP64OFF:48,ZIP64EXTRA:56,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,FLG_ENC:0,FLG_COMP1:1,FLG_COMP2:2,FLG_DESC:4,FLG_ENH:8,FLG_STR:16,FLG_LNG:1024,FLG_MSK:4096,FILE:0,BUFFER:1,NONE:2,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535,EF_ZIP64_SUNCOMP:0,EF_ZIP64_SCOMP:8,EF_ZIP64_RHO:16,EF_ZIP64_DSN:24}});var ep=_(($5,P1)=>{P1.exports={INVALID_LOC:"Invalid LOC header (bad signature)",INVALID_CEN:"Invalid CEN header (bad signature)",INVALID_END:"Invalid END header (bad signature)",NO_DATA:"Nothing to decompress",BAD_CRC:"CRC32 checksum failed",FILE_IN_THE_WAY:"There is a file in the way: %s",UNKNOWN_METHOD:"Invalid/unsupported compression method",AVAIL_DATA:"inflate::Available inflate data did not terminate",INVALID_DISTANCE:"inflate::Invalid literal/length or distance code in fixed or dynamic block",TO_MANY_CODES:"inflate::Dynamic block code description: too many length or distance codes",INVALID_REPEAT_LEN:"inflate::Dynamic block code description: repeat more than specified lengths",INVALID_REPEAT_FIRST:"inflate::Dynamic block code description: repeat lengths with no first length",INCOMPLETE_CODES:"inflate::Dynamic block code description: code lengths codes incomplete",INVALID_DYN_DISTANCE:"inflate::Dynamic block code description: invalid distance code lengths",INVALID_CODES_LEN:"inflate::Dynamic block code description: invalid literal/length code lengths",INVALID_STORE_BLOCK:"inflate::Stored block length did not match one's complement",INVALID_BLOCK_TYPE:"inflate::Invalid block type (type == 3)",CANT_EXTRACT_FILE:"Could not extract the file",CANT_OVERRIDE:"Target file already exists",NO_ZIP:"No zip file was loaded",NO_ENTRY:"Entry doesn't exist",DIRECTORY_CONTENT_ERROR:"A directory cannot have content",FILE_NOT_FOUND:"File not found: %s",NOT_IMPLEMENTED:"Not implemented",INVALID_FILENAME:"Invalid filename",INVALID_FORMAT:"Invalid or unsupported zip format. No END header found"}});var q1=_((G5,k1)=>{var Fe=qu().require(),Os=require("path");Fe.existsSync=Fe.existsSync||Os.existsSync;k1.exports=function(){var e=[],t=Jh(),r=ep(),n=Os.sep;function i(a){var c=a.split(n)[0];a.split(n).forEach(function(l){if(!(!l||l.substr(-1,1)===":")){c+=n+l;var f;try{f=Fe.statSync(c)}catch{Fe.mkdirSync(c)}if(f&&f.isFile())throw r.FILE_IN_THE_WAY.replace("%s",c)}})}u(i,"mkdirSync");function s(a,c,l){typeof c=="boolean"&&(l=c,c=void 0);var f=[];return Fe.readdirSync(a).forEach(function(h){var d=Os.join(a,h);Fe.statSync(d).isDirectory()&&l&&(f=f.concat(s(d,c,l))),(!c||c.test(d))&&f.push(Os.normalize(d)+(Fe.statSync(d).isDirectory()?n:""))}),f}u(s,"findSync");function o(a,c){var l=Buffer.from(a.slice(c,c+8));return l.swap64(),parseInt(`0x${l.toString("hex")}`)}return u(o,"readBigUInt64LE"),{makeDir:function(a){i(a)},crc32:function(a){typeof a=="string"&&(a=Buffer.alloc(a.length,a));var c=Buffer.alloc(4);if(!e.length)for(var l=0;l<256;l++){for(var f=l,h=8;--h>=0;)f&1?f=3988292384^f>>>1:f=f>>>1;f<0&&(c.writeInt32LE(f,0),f=c.readUInt32LE(0)),e[l]=f}for(var d=0,g=0,p=a.length,y=~d;--p>=0;)y=e[(y^a[g++])&255]^y>>>8;return d=~y,c.writeInt32LE(d&4294967295,0),c.readUInt32LE(0)},methodToString:function(a){switch(a){case t.STORED:return"STORED ("+a+")";case t.DEFLATED:return"DEFLATED ("+a+")";default:return"UNSUPPORTED ("+a+")"}},writeFileTo:function(a,c,l,f){if(Fe.existsSync(a)){if(!l)return!1;var h=Fe.statSync(a);if(h.isDirectory())return!1}var d=Os.dirname(a);Fe.existsSync(d)||i(d);var g;try{g=Fe.openSync(a,"w",438)}catch{Fe.chmodSync(a,438),g=Fe.openSync(a,"w",438)}if(g)try{Fe.writeSync(g,c,0,c.length,0)}catch(p){throw p}finally{Fe.closeSync(g)}return Fe.chmodSync(a,f||438),!0},writeFileToAsync:function(a,c,l,f,h){typeof f=="function"&&(h=f,f=void 0),Fe.exists(a,function(d){if(d&&!l)return h(!1);Fe.stat(a,function(g,p){if(d&&p.isDirectory())return h(!1);var y=Os.dirname(a);Fe.exists(y,function(v){v||i(y),Fe.open(a,"w",438,function(m,x){m?Fe.chmod(a,438,function(){Fe.open(a,"w",438,function(w,B){Fe.write(B,c,0,c.length,0,function(){Fe.close(B,function(){Fe.chmod(a,f||438,function(){h(!0)})})})})}):x?Fe.write(x,c,0,c.length,0,function(){Fe.close(x,function(){Fe.chmod(a,f||438,function(){h(!0)})})}):Fe.chmod(a,f||438,function(){h(!0)})})})})})},findFiles:function(a){return s(a,!0)},getAttributes:function(a){},setAttributes:function(a){},toBuffer:function(a){return Buffer.isBuffer(a)?a:a.length===0?Buffer.alloc(0):Buffer.from(a,"utf8")},readBigUInt64LE:o,Constants:t,Errors:r}}()});var M1=_((z5,V1)=>{var Uu=qu().require(),U1=require("path");Uu.existsSync=Uu.existsSync||U1.existsSync;V1.exports=function(e){var t=e||"",r=0,n=s(),i=null;function s(){return{directory:!1,readonly:!1,hidden:!1,executable:!1,mtime:0,atime:0}}return u(s,"newAttr"),t&&Uu.existsSync(t)?(i=Uu.statSync(t),n.directory=i.isDirectory(),n.mtime=i.mtime,n.atime=i.atime,n.executable=!!(1&parseInt((i.mode&parseInt("777",8)).toString(8)[0])),n.readonly=!!(2&parseInt((i.mode&parseInt("777",8)).toString(8)[0])),n.hidden=U1.basename(t)[0]==="."):console.warn("Invalid path: "+t),{get directory(){return n.directory},get readOnly(){return n.readonly},get hidden(){return n.hidden},get mtime(){return n.mtime},get atime(){return n.atime},get executable(){return n.executable},decodeAttributes:function(o){},encodeAttributes:function(o){},toString:function(){return`{
	"path" : "`+t+`,
	"isDirectory" : `+n.directory+`,
	"isReadOnly" : `+n.readonly+`,
	"isHidden" : `+n.hidden+`,
	"isExecutable" : `+n.executable+`,
	"mTime" : `+n.mtime+`
	"aTime" : `+n.atime+`
}`}}}});var Ps=_((Q5,Fs)=>{Fs.exports=q1();Fs.exports.FileSystem=qu();Fs.exports.Constants=Jh();Fs.exports.Errors=ep();Fs.exports.FileAttr=M1()});var H1=_((Z5,K1)=>{var Vu=Ps(),J=Vu.Constants;K1.exports=function(){var e=10,t=10,r=0,n=0,i=0,s=0,o=0,a=0,c=0,l=0,f=0,h=0,d=0,g=0,p=0,y={};function v(m){m=new Date(m),i=(m.getFullYear()-1980&127)<<25|m.getMonth()+1<<21|m.getDate()<<16|m.getHours()<<11|m.getMinutes()<<5|m.getSeconds()>>1}return u(v,"setTime"),v(+new Date),{get made(){return e},set made(m){e=m},get version(){return t},set version(m){t=m},get flags(){return r},set flags(m){r=m},get method(){return n},set method(m){n=m},get time(){return new Date((i>>25&127)+1980,(i>>21&15)-1,i>>16&31,i>>11&31,i>>5&63,(i&31)<<1)},set time(m){v(m)},get crc(){return s},set crc(m){s=m},get compressedSize(){return o},set compressedSize(m){o=m},get size(){return a},set size(m){a=m},get fileNameLength(){return c},set fileNameLength(m){c=m},get extraLength(){return l},set extraLength(m){l=m},get commentLength(){return f},set commentLength(m){f=m},get diskNumStart(){return h},set diskNumStart(m){h=m},get inAttr(){return d},set inAttr(m){d=m},get attr(){return g},set attr(m){g=m},get offset(){return p},set offset(m){p=m},get encripted(){return(r&1)===1},get entryHeaderSize(){return J.CENHDR+c+l+f},get realDataOffset(){return p+J.LOCHDR+y.fnameLen+y.extraLen},get dataHeader(){return y},loadDataHeaderFromBinary:function(m){var x=m.slice(p,p+J.LOCHDR);if(x.readUInt32LE(0)!==J.LOCSIG)throw new Error(Vu.Errors.INVALID_LOC);y={version:x.readUInt16LE(J.LOCVER),flags:x.readUInt16LE(J.LOCFLG),method:x.readUInt16LE(J.LOCHOW),time:x.readUInt32LE(J.LOCTIM),crc:x.readUInt32LE(J.LOCCRC),compressedSize:x.readUInt32LE(J.LOCSIZ),size:x.readUInt32LE(J.LOCLEN),fnameLen:x.readUInt16LE(J.LOCNAM),extraLen:x.readUInt16LE(J.LOCEXT)}},loadFromBinary:function(m){if(m.length!==J.CENHDR||m.readUInt32LE(0)!==J.CENSIG)throw new Error(Vu.Errors.INVALID_CEN);e=m.readUInt16LE(J.CENVEM),t=m.readUInt16LE(J.CENVER),r=m.readUInt16LE(J.CENFLG),n=m.readUInt16LE(J.CENHOW),i=m.readUInt32LE(J.CENTIM),s=m.readUInt32LE(J.CENCRC),o=m.readUInt32LE(J.CENSIZ),a=m.readUInt32LE(J.CENLEN),c=m.readUInt16LE(J.CENNAM),l=m.readUInt16LE(J.CENEXT),f=m.readUInt16LE(J.CENCOM),h=m.readUInt16LE(J.CENDSK),d=m.readUInt16LE(J.CENATT),g=m.readUInt32LE(J.CENATX),p=m.readUInt32LE(J.CENOFF)},dataHeaderToBinary:function(){var m=Buffer.alloc(J.LOCHDR);return m.writeUInt32LE(J.LOCSIG,0),m.writeUInt16LE(t,J.LOCVER),m.writeUInt16LE(r,J.LOCFLG),m.writeUInt16LE(n,J.LOCHOW),m.writeUInt32LE(i,J.LOCTIM),m.writeUInt32LE(s,J.LOCCRC),m.writeUInt32LE(o,J.LOCSIZ),m.writeUInt32LE(a,J.LOCLEN),m.writeUInt16LE(c,J.LOCNAM),m.writeUInt16LE(l,J.LOCEXT),m},entryHeaderToBinary:function(){var m=Buffer.alloc(J.CENHDR+c+l+f);return m.writeUInt32LE(J.CENSIG,0),m.writeUInt16LE(e,J.CENVEM),m.writeUInt16LE(t,J.CENVER),m.writeUInt16LE(r,J.CENFLG),m.writeUInt16LE(n,J.CENHOW),m.writeUInt32LE(i,J.CENTIM),m.writeUInt32LE(s,J.CENCRC),m.writeUInt32LE(o,J.CENSIZ),m.writeUInt32LE(a,J.CENLEN),m.writeUInt16LE(c,J.CENNAM),m.writeUInt16LE(l,J.CENEXT),m.writeUInt16LE(f,J.CENCOM),m.writeUInt16LE(h,J.CENDSK),m.writeUInt16LE(d,J.CENATT),m.writeUInt32LE(g,J.CENATX),m.writeUInt32LE(p,J.CENOFF),m.fill(0,J.CENHDR),m},toString:function(){return`{
	"made" : `+e+`,
	"version" : `+t+`,
	"flags" : `+r+`,
	"method" : `+Vu.methodToString(n)+`,
	"time" : `+this.time+`,
	"crc" : 0x`+s.toString(16).toUpperCase()+`,
	"compressedSize" : `+o+` bytes,
	"size" : `+a+` bytes,
	"fileNameLength" : `+c+`,
	"extraLength" : `+l+` bytes,
	"commentLength" : `+f+` bytes,
	"diskNumStart" : `+h+`,
	"inAttr" : `+d+`,
	"attr" : `+g+`,
	"offset" : `+p+`,
	"entryHeaderSize" : `+(J.CENHDR+c+l+f)+` bytes
}`}}}});var G1=_((X5,$1)=>{var ks=Ps(),it=ks.Constants;$1.exports=function(){var e=0,t=0,r=0,n=0,i=0;return{get diskEntries(){return e},set diskEntries(s){e=t=s},get totalEntries(){return t},set totalEntries(s){t=e=s},get size(){return r},set size(s){r=s},get offset(){return n},set offset(s){n=s},get commentLength(){return i},set commentLength(s){i=s},get mainHeaderSize(){return it.ENDHDR+i},loadFromBinary:function(s){if((s.length!==it.ENDHDR||s.readUInt32LE(0)!==it.ENDSIG)&&(s.length<it.ZIP64HDR||s.readUInt32LE(0)!==it.ZIP64SIG))throw new Error(ks.Errors.INVALID_END);s.readUInt32LE(0)===it.ENDSIG?(e=s.readUInt16LE(it.ENDSUB),t=s.readUInt16LE(it.ENDTOT),r=s.readUInt32LE(it.ENDSIZ),n=s.readUInt32LE(it.ENDOFF),i=s.readUInt16LE(it.ENDCOM)):(e=ks.readBigUInt64LE(s,it.ZIP64SUB),t=ks.readBigUInt64LE(s,it.ZIP64TOT),r=ks.readBigUInt64LE(s,it.ZIP64SIZ),n=ks.readBigUInt64LE(s,it.ZIP64OFF),i=0)},toBinary:function(){var s=Buffer.alloc(it.ENDHDR+i);return s.writeUInt32LE(it.ENDSIG,0),s.writeUInt32LE(0,4),s.writeUInt16LE(e,it.ENDSUB),s.writeUInt16LE(t,it.ENDTOT),s.writeUInt32LE(r,it.ENDSIZ),s.writeUInt32LE(n,it.ENDOFF),s.writeUInt16LE(i,it.ENDCOM),s.fill(" ",it.ENDHDR),s},toString:function(){return`{
	"diskEntries" : `+e+`,
	"totalEntries" : `+t+`,
	"size" : `+r+` bytes,
	"offset" : 0x`+n.toString(16).toUpperCase()+`,
	"commentLength" : 0x`+i+`
}`}}}});var rp=_(tp=>{tp.EntryHeader=H1();tp.MainHeader=G1()});var z1=_((eV,j1)=>{j1.exports=function(e){var t=require("zlib"),r={chunkSize:(parseInt(e.length/1024)+1)*1024};return{deflate:function(){return t.deflateRawSync(e,r)},deflateAsync:function(n){var i=t.createDeflateRaw(r),s=[],o=0;i.on("data",function(a){s.push(a),o+=a.length}),i.on("end",function(){var a=Buffer.alloc(o),c=0;a.fill(0);for(var l=0;l<s.length;l++){var f=s[l];f.copy(a,c),c+=f.length}n&&n(a)}),i.end(e)}}}});var Q1=_((tV,W1)=>{W1.exports=function(e){var t=require("zlib");return{inflate:function(){return t.inflateRawSync(e)},inflateAsync:function(r){var n=t.createInflateRaw(),i=[],s=0;n.on("data",function(o){i.push(o),s+=o.length}),n.on("end",function(){var o=Buffer.alloc(s),a=0;o.fill(0);for(var c=0;c<i.length;c++){var l=i[c];l.copy(o,a),a+=l.length}r&&r(o)}),n.end(e)}}}});var Z1=_(np=>{np.Deflater=z1();np.Inflater=Q1()});var ip=_((nV,X1)=>{var ot=Ps(),$L=rp(),Ir=ot.Constants,Y1=Z1();X1.exports=function(e){var t=new $L.EntryHeader,r=Buffer.alloc(0),n=Buffer.alloc(0),i=!1,s=null,o=Buffer.alloc(0);function a(){return!e||!Buffer.isBuffer(e)?Buffer.alloc(0):(t.loadDataHeaderFromBinary(e),e.slice(t.realDataOffset,t.realDataOffset+t.compressedSize))}u(a,"getCompressedDataFromZip");function c(p){return!((t.flags&8)!==8&&ot.crc32(p)!==t.dataHeader.crc)}u(c,"crc32OK");function l(p,y,v){if(typeof y>"u"&&typeof p=="string"&&(v=p,p=void 0),i)return p&&y&&y(Buffer.alloc(0),ot.Errors.DIRECTORY_CONTENT_ERROR),Buffer.alloc(0);var m=a();if(m.length===0)return p&&y&&y(m),m;var x=Buffer.alloc(t.size);switch(t.method){case ot.Constants.STORED:if(m.copy(x),c(x))return p&&y&&y(x),x;throw p&&y&&y(x,ot.Errors.BAD_CRC),new Error(ot.Errors.BAD_CRC);case ot.Constants.DEFLATED:var w=new Y1.Inflater(m);if(p)w.inflateAsync(function(R){R.copy(x,0),c(x)?y&&y(x):y&&y(x,ot.Errors.BAD_CRC)});else{var B=w.inflate(x);if(B.copy(x,0),!c(x))throw new Error(ot.Errors.BAD_CRC+" "+r.toString());return x}break;default:throw p&&y&&y(Buffer.alloc(0),ot.Errors.UNKNOWN_METHOD),new Error(ot.Errors.UNKNOWN_METHOD)}}u(l,"decompress");function f(p,y){if((!s||!s.length)&&Buffer.isBuffer(e))return p&&y&&y(a()),a();if(s.length&&!i){var v;switch(t.method){case ot.Constants.STORED:return t.compressedSize=t.size,v=Buffer.alloc(s.length),s.copy(v),p&&y&&y(v),v;default:case ot.Constants.DEFLATED:var m=new Y1.Deflater(s);if(p)m.deflateAsync(function(w){v=Buffer.alloc(w.length),t.compressedSize=w.length,w.copy(v),y&&y(v)});else{var x=m.deflate();return t.compressedSize=x.length,x}m=null;break}}else if(p&&y)y(Buffer.alloc(0));else return Buffer.alloc(0)}u(f,"compress");function h(p,y){return(p.readUInt32LE(y+4)<<4)+p.readUInt32LE(y)}u(h,"readUInt64LE");function d(p){for(var y=0,v,m,x;y<p.length;)v=p.readUInt16LE(y),y+=2,m=p.readUInt16LE(y),y+=2,x=p.slice(y,y+m),y+=m,Ir.ID_ZIP64===v&&g(x)}u(d,"parseExtra");function g(p){var y,v,m,x;p.length>=Ir.EF_ZIP64_SCOMP&&(y=h(p,Ir.EF_ZIP64_SUNCOMP),t.size===Ir.EF_ZIP64_OR_32&&(t.size=y)),p.length>=Ir.EF_ZIP64_RHO&&(v=h(p,Ir.EF_ZIP64_SCOMP),t.compressedSize===Ir.EF_ZIP64_OR_32&&(t.compressedSize=v)),p.length>=Ir.EF_ZIP64_DSN&&(m=h(p,Ir.EF_ZIP64_RHO),t.offset===Ir.EF_ZIP64_OR_32&&(t.offset=m)),p.length>=Ir.EF_ZIP64_DSN+4&&(x=p.readUInt32LE(Ir.EF_ZIP64_DSN),t.diskNumStart===Ir.EF_ZIP64_OR_16&&(t.diskNumStart=x))}return u(g,"parseZip64ExtendedInformation"),{get entryName(){return r.toString()},get rawEntryName(){return r},set entryName(p){r=ot.toBuffer(p);var y=r[r.length-1];i=y===47||y===92,t.fileNameLength=r.length},get extra(){return o},set extra(p){o=p,t.extraLength=p.length,d(p)},get comment(){return n.toString()},set comment(p){n=ot.toBuffer(p),t.commentLength=n.length},get name(){var p=r.toString();return i?p.substr(p.length-1).split("/").pop():p.split("/").pop()},get isDirectory(){return i},getCompressedData:function(){return f(!1,null)},getCompressedDataAsync:function(p){f(!0,p)},setData:function(p){s=ot.toBuffer(p),!i&&s.length?(t.size=s.length,t.method=ot.Constants.DEFLATED,t.crc=ot.crc32(p),t.changed=!0):t.method=ot.Constants.STORED},getData:function(p){return t.changed?s:l(!1,null,p)},getDataAsync:function(p,y){t.changed?p(s):l(!0,p,y)},set attr(p){t.attr=p},get attr(){return t.attr},set header(p){t.loadFromBinary(p)},get header(){return t},packHeader:function(){var p=t.entryHeaderToBinary();return r.copy(p,ot.Constants.CENHDR),t.extraLength&&o.copy(p,ot.Constants.CENHDR+r.length),t.commentLength&&n.copy(p,ot.Constants.CENHDR+r.length+t.extraLength,n.length),p},toString:function(){return`{
	"entryName" : "`+r.toString()+`",
	"name" : "`+(i?r.toString().replace(/\/$/,"").split("/").pop():r.toString().split("/").pop())+`",
	"comment" : "`+n.toString()+`",
	"isDirectory" : `+i+`,
	"header" : `+t.toString().replace(/\t/mg,"		").replace(/}/mg,"	}")+`,
	"compressedData" : <`+(e&&e.length+" bytes buffer"||"null")+`>
	"data" : <`+(s&&s.length+" bytes buffer"||"null")+`>
}`}}}});var tC=_((sV,eC)=>{var J1=ip(),GL=rp(),kt=Ps();eC.exports=function(e,t){var r=[],n={},i=Buffer.alloc(0),s="",o=kt.FileSystem.require(),a=null,c=new GL.MainHeader,l=!1;t===kt.Constants.FILE?(s=e,a=o.readFileSync(s),d()):t===kt.Constants.BUFFER?(a=e,d()):l=!0;function f(g){let p=c.diskEntries,y=c.offset;for(let v=0;v<p;v++){let m=y,x=new J1(a);x.header=a.slice(m,m+=kt.Constants.CENHDR),x.entryName=a.slice(m,m+=x.header.fileNameLength),y+=x.header.entryHeaderSize,g(x)}}u(f,"iterateEntries");function h(){l=!0,n={},r=new Array(c.diskEntries);for(var g=c.offset,p=0;p<r.length;p++){var y=g,v=new J1(a);v.header=a.slice(y,y+=kt.Constants.CENHDR),v.entryName=a.slice(y,y+=v.header.fileNameLength),v.header.extraLength&&(v.extra=a.slice(y,y+=v.header.extraLength)),v.header.commentLength&&(v.comment=a.slice(y,y+v.header.commentLength)),g+=v.header.entryHeaderSize,r[p]=v,n[v.entryName]=v}}u(h,"readEntries");function d(){var g=a.length-kt.Constants.ENDHDR,p=Math.max(0,g-65535),y=p,v=a.length,m=-1,x=0;for(g;g>=y;g--)if(a[g]===80){if(a.readUInt32LE(g)===kt.Constants.ENDSIG){m=g,x=g,v=g+kt.Constants.ENDHDR,y=g-kt.Constants.END64HDR;continue}if(a.readUInt32LE(g)===kt.Constants.END64SIG){y=p;continue}if(a.readUInt32LE(g)==kt.Constants.ZIP64SIG){m=g,v=g+kt.readBigUInt64LE(a,g+kt.Constants.ZIP64SIZE)+kt.Constants.ZIP64LEAD;break}}if(!~m)throw new Error(kt.Errors.INVALID_FORMAT);c.loadFromBinary(a.slice(m,v)),c.commentLength&&(i=a.slice(x+kt.Constants.ENDHDR))}return u(d,"readMainHeader"),{get entries(){return l||h(),r},get comment(){return i.toString()},set comment(g){c.commentLength=g.length,i=g},getEntryCount:function(){return l?r.length:c.diskEntries},forEach:function(g){if(!l){f(g);return}r.forEach(g)},getEntry:function(g){return l||h(),n[g]||null},setEntry:function(g){l||h(),r.push(g),n[g.entryName]=g,c.totalEntries=r.length},deleteEntry:function(g){l||h();var p=n[g];if(p&&p.isDirectory){var y=this;this.getEntryChildren(p).forEach(function(v){v.entryName!==g&&y.deleteEntry(v.entryName)})}r.splice(r.indexOf(p),1),delete n[g],c.totalEntries=r.length},getEntryChildren:function(g){if(l||h(),g.isDirectory){var p=[],y=g.entryName,v=y.length;return r.forEach(function(m){m.entryName.substr(0,v)===y&&p.push(m)}),p}return[]},compressToBuffer:function(){l||h(),r.length>1&&r.sort(function(w,B){var R=w.entryName.toLowerCase(),L=B.entryName.toLowerCase();return R<L?-1:R>L?1:0});var g=0,p=[],y=[],v=0;c.size=0,c.offset=0,r.forEach(function(w){var B=w.getCompressedData();w.header.offset=v;var R=w.header.dataHeaderToBinary(),L=w.rawEntryName.length,Y=w.extra.toString(),X=Buffer.alloc(L+Y.length);w.rawEntryName.copy(X,0),X.fill(Y,L);var ne=R.length+X.length+B.length;v+=ne,p.push(R),p.push(X),p.push(B);var le=w.packHeader();y.push(le),c.size+=le.length,g+=ne+le.length}),g+=c.mainHeaderSize,c.offset=v,v=0;var m=Buffer.alloc(g);p.forEach(function(w){w.copy(m,v),v+=w.length}),y.forEach(function(w){w.copy(m,v),v+=w.length});var x=c.toBinary();return i&&Buffer.from(i).copy(x,kt.Constants.ENDHDR),x.copy(m,v),m},toAsyncBuffer:function(g,p,y,v){l||h(),r.length>1&&r.sort(function(L,Y){var X=L.entryName.toLowerCase(),ne=Y.entryName.toLowerCase();return X>ne?-1:X<ne?1:0});var m=0,x=[],w=[],B=0;c.size=0,c.offset=0;var R=u(function(L){var Y=arguments.callee;if(L.length){var X=L.pop(),ne=X.entryName+X.extra.toString();y&&y(ne),X.getCompressedDataAsync(function(le){v&&v(ne),X.header.offset=B;var Ce=X.header.dataHeaderToBinary(),we;try{we=Buffer.alloc(ne.length,ne)}catch{we=new Buffer(ne)}var ht=Ce.length+we.length+le.length;B+=ht,x.push(Ce),x.push(we),x.push(le);var mt=X.packHeader();if(w.push(mt),c.size+=mt.length,m+=ht+mt.length,L.length)Y(L);else{m+=c.mainHeaderSize,c.offset=B,B=0;var be=Buffer.alloc(m);x.forEach(function(Z){Z.copy(be,B),B+=Z.length}),w.forEach(function(Z){Z.copy(be,B),B+=Z.length});var Ze=c.toBinary();i&&i.copy(Ze,kt.Constants.ENDHDR),Ze.copy(be,B),g(be)}})}},"compress");R(r)}}}});var nC=_((uV,rC)=>{var Ke=Ps(),Ar=Ke.FileSystem.require(),nr=require("path");Ar.existsSync=Ar.existsSync||nr.existsSync;var jL=ip(),sp=tC(),aV=/^win/.test(process.platform);rC.exports=function(e){var t=void 0,r="";if(e&&typeof e=="string")if(Ar.existsSync(e))r=e,t=new sp(e,Ke.Constants.FILE);else throw new Error(Ke.Errors.INVALID_FILENAME);else e&&Buffer.isBuffer(e)?t=new sp(e,Ke.Constants.BUFFER):t=new sp(null,Ke.Constants.NONE);function n(s,o){s=nr.resolve(nr.normalize(s));for(var a=o.split("/"),c=0,l=a.length;c<l;c++){var f=nr.normalize(nr.join(s,a.slice(c,l).join(nr.sep)));if(f.indexOf(s)===0)return f}return nr.normalize(nr.join(s,nr.basename(o)))}u(n,"sanitize");function i(s){if(s&&t){var o;if(typeof s=="string"&&(o=t.getEntry(s)),typeof s=="object"&&typeof s.entryName<"u"&&typeof s.header<"u"&&(o=t.getEntry(s.entryName)),o)return o}return null}return u(i,"getEntry"),{readFile:function(s){var o=i(s);return o&&o.getData()||null},readFileAsync:function(s,o){var a=i(s);a?a.getDataAsync(o):o(null,"getEntry failed for:"+s)},readAsText:function(s,o){var a=i(s);if(a){var c=a.getData();if(c&&c.length)return c.toString(o||"utf8")}return""},readAsTextAsync:function(s,o,a){var c=i(s);c?c.getDataAsync(function(l,f){if(f){o(l,f);return}l&&l.length?o(l.toString(a||"utf8")):o("")}):o("")},deleteFile:function(s){var o=i(s);o&&t.deleteEntry(o.entryName)},addZipComment:function(s){t.comment=s},getZipComment:function(){return t.comment||""},addZipEntryComment:function(s,o){var a=i(s);a&&(a.comment=o)},getZipEntryComment:function(s){var o=i(s);return o&&o.comment||""},updateFile:function(s,o){var a=i(s);a&&a.setData(o)},addLocalFile:function(s,o,a){if(Ar.existsSync(s)){o?(o=o.split("\\").join("/"),o.charAt(o.length-1)!=="/"&&(o+="/")):o="";var c=s.split("\\").join("/").split("/").pop();a?this.addFile(o+a,Ar.readFileSync(s),"",0):this.addFile(o+c,Ar.readFileSync(s),"",0)}else throw new Error(Ke.Errors.FILE_NOT_FOUND.replace("%s",s))},addLocalFolder:function(s,o,a){if(a===void 0?a=u(function(){return!0},"filter"):a instanceof RegExp&&(a=function(f){return function(h){return f.test(h)}}(a)),o?(o=o.split("\\").join("/"),o.charAt(o.length-1)!=="/"&&(o+="/")):o="",s=nr.normalize(s),s=s.split("\\").join("/"),s.charAt(s.length-1)!=="/"&&(s+="/"),Ar.existsSync(s)){var c=Ke.findFiles(s),l=this;c.length&&c.forEach(function(f){var h=f.split("\\").join("/").replace(new RegExp(s.replace(/(\(|\)|\$)/g,"\\$1"),"i"),"");a(h)&&(h.charAt(h.length-1)!=="/"?l.addFile(o+h,Ar.readFileSync(f),"",0):l.addFile(o+h,Buffer.alloc(0),"",0))})}else throw new Error(Ke.Errors.FILE_NOT_FOUND.replace("%s",s))},addLocalFolderAsync:function(s,o,a,c){c===void 0?c=u(function(){return!0},"filter"):c instanceof RegExp&&(c=function(f){return function(h){return f.test(h)}}(c)),a?(a=a.split("\\").join("/"),a.charAt(a.length-1)!=="/"&&(a+="/")):a="",s=nr.normalize(s),s=s.split("\\").join("/"),s.charAt(s.length-1)!=="/"&&(s+="/");var l=this;Ar.open(s,"r",function(f,h){if(f&&f.code==="ENOENT")o(void 0,Ke.Errors.FILE_NOT_FOUND.replace("%s",s));else if(f)o(void 0,f);else{var d=Ke.findFiles(s),g=-1,p=u(function(){if(g+=1,g<d.length){var y=d[g].split("\\").join("/").replace(new RegExp(s.replace(/(\(|\))/g,"\\$1"),"i"),"");y=y.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x20-\x7E]/g,""),c(y)?y.charAt(y.length-1)!=="/"?Ar.readFile(d[g],function(v,m){v?o(void 0,v):(l.addFile(a+y,m,"",0),p())}):(l.addFile(a+y,Buffer.alloc(0),"",0),p()):p()}else o(!0,void 0)},"next");p()}})},addFile:function(s,o,a,c){var l=new jL;l.entryName=s,l.comment=a||"",c||(l.isDirectory?c=16877<<16|16:c=420<<16),l.attr=c,l.setData(o),t.setEntry(l)},getEntries:function(){return t?t.entries:[]},getEntry:function(s){return i(s)},getEntryCount:function(){return t.getEntryCount()},forEach:function(s){return t.forEach(s)},extractEntryTo:function(s,o,a,c){c=c||!1,a=typeof a>"u"?!0:a;var l=i(s);if(!l)throw new Error(Ke.Errors.NO_ENTRY);var f=l.entryName,h=n(o,a?f:nr.basename(f));if(l.isDirectory){h=nr.resolve(h,"..");var d=t.getEntryChildren(l);return d.forEach(function(p){if(!p.isDirectory){var y=p.getData();if(!y)throw new Error(Ke.Errors.CANT_EXTRACT_FILE);var v=n(o,a?p.entryName:nr.basename(p.entryName));Ke.writeFileTo(v,y,c)}}),!0}var g=l.getData();if(!g)throw new Error(Ke.Errors.CANT_EXTRACT_FILE);if(Ar.existsSync(h)&&!c)throw new Error(Ke.Errors.CANT_OVERRIDE);return Ke.writeFileTo(h,g,c),!0},test:function(){if(!t)return!1;for(var s in t.entries)try{if(s.isDirectory)continue;var o=t.entries[s].getData();if(!o)return!1}catch{return!1}return!0},extractAllTo:function(s,o){if(o=o||!1,!t)throw new Error(Ke.Errors.NO_ZIP);t.entries.forEach(function(a){var c=n(s,a.entryName.toString());if(a.isDirectory){Ke.makeDir(c);return}var l=a.getData();if(!l)throw new Error(Ke.Errors.CANT_EXTRACT_FILE);Ke.writeFileTo(c,l,o);try{Ar.utimesSync(c,a.header.time,a.header.time)}catch{throw new Error(Ke.Errors.CANT_EXTRACT_FILE)}})},extractAllToAsync:function(s,o,a){if(a||(a=u(function(){},"callback")),o=o||!1,!t){a(new Error(Ke.Errors.NO_ZIP));return}var c=t.entries,l=c.length;c.forEach(function(f){if(!(l<=0)){var h=nr.normalize(f.entryName.toString());if(f.isDirectory){Ke.makeDir(n(s,h)),--l===0&&a(void 0);return}f.getDataAsync(function(d,g){if(!(l<=0)){if(g){a(new Error(g));return}if(!d){l=0,a(new Error(Ke.Errors.CANT_EXTRACT_FILE));return}Ke.writeFileToAsync(n(s,h),d,o,function(p){try{Ar.utimesSync(nr.resolve(s,h),f.header.time,f.header.time)}catch{a(new Error("Unable to set utimes"))}if(!(l<=0)){if(!p){l=0,a(new Error("Unable to write"));return}--l===0&&a(void 0)}})}})}})},writeZip:function(s,o){if(arguments.length===1&&typeof s=="function"&&(o=s,s=""),!s&&r&&(s=r),!!s){var a=t.compressToBuffer();if(a){var c=Ke.writeFileTo(s,a,!0);typeof o=="function"&&o(c?null:new Error("failed"),"")}}},toBuffer:function(s,o,a,c){return this.valueOf=2,typeof s=="function"?(t.toAsyncBuffer(s,o,a,c),null):t.compressToBuffer()}}}});var oC=_(sC=>{"use strict";var zL=require("https"),WL=require("fs"),QL=nC(),ZL=Ue(),iC=se(),YL=cu().PlainTextAuthProvider;function XL(e,t){if(!e.cloud)return t();let r=new ap(e);iC.series([n=>JL(r,n),n=>eO(r,n),n=>{r.clientOptions.sslOptions.checkServerIdentity||(r.clientOptions.sslOptions.checkServerIdentity=()=>{}),n()}],t)}u(XL,"init");var up=class up{constructor(t){this.clientOptions=t,t.cloud.secureConnectBundle?(this.secureConnectBundle=t.cloud.secureConnectBundle,this.serviceUrl=null):this.serviceUrl=t.cloud.endpoint,this.contactPoints=null,this.localDataCenter=null}setSslOptions(t){this.clientOptions.sslOptions=Object.assign({ca:[t.get("ca.crt")],cert:t.get("cert"),key:t.get("key"),rejectUnauthorized:!0},this.clientOptions.sslOptions)}setAuthProvider(t,r){!t||!r||this.clientOptions.authProvider||(this.clientOptions.authProvider=new YL(t,r))}};u(up,"CloudOptions");var ap=up;function JL(e,t){if(e.serviceUrl)return t();if(!e.secureConnectBundle)return t(new TypeError("secureConnectBundle must be provided"));WL.readFile(e.secureConnectBundle,(r,n)=>{if(r)return t(r);try{let i=new QL(n),s=new Map(i.getEntries().map(a=>[a.entryName,a.getData()]));if(!s.get("config.json"))throw new TypeError("Config file must be contained in secure bundle");let o=JSON.parse(s.get("config.json").toString("utf8"));if(!o.host||!o.port)throw new TypeError("Config file must include host and port information");e.serviceUrl=`${o.host}:${o.port}/metadata`,e.setSslOptions(s),e.setAuthProvider(o.username,o.password)}catch(i){return t(i)}t()})}u(JL,"parseZipFile");function eO(e,t){let n=/^(.+?):(\d+)(.*)$/.exec(e.serviceUrl);if(t=iC.callbackOnce(t),!n||n.length!==4)throw new TypeError("url should be composed of host, port number and path, without scheme");let i=Object.assign({hostname:n[1],port:n[2],path:n[3]||void 0,timeout:e.clientOptions.socketOptions.connectTimeout},e.clientOptions.sslOptions),s=zL.get(i,o=>{let a="";o.on("data",c=>a+=c.toString()).on("end",()=>{if(o.statusCode!==200)return t(op(new Error(`Obtained http status ${o.statusCode}`),i));let c;try{if(c=JSON.parse(a),!c||!c.contact_info)throw new TypeError("contact_info should be defined in response")}catch(f){return t(op(f,i,!0))}let l=c.contact_info;e.clientOptions.contactPoints=l.contact_points,e.clientOptions.localDataCenter=l.local_dc,e.clientOptions.sni={address:l.sni_proxy_address},t()})});s.on("error",o=>t(op(o,i))),s.setTimeout(e.clientOptions.socketOptions.connectTimeout,()=>s.abort())}u(eO,"getMetadataServiceInfo");function op(e,t,r){let n=r?"There was an error while parsing the metadata service information":"There was an error fetching the metadata information",i=`${t.hostname}:${t.port}${t.path?t.path:"/"}`;return new ZL.NoHostAvailableError({[i]:e},n)}u(op,"getServiceRequestError");sC.init=XL});var fC=_((hV,lC)=>{"use strict";var aC=require("events"),Ki=require("util"),qt=se(),Mi=Ue(),cp=Ve(),tO=Rf().ProfileManager,Mu=Li(),uC=fu(),rO=oE(),nO=Uo().description,iO=Uo().version,lp=Ss().DefaultExecutionOptions,sO=L1(),fp=Lh(),cC=Fh(),oO=oC(),aO=32;function Je(e){aC.EventEmitter.call(this),this.options=uC.extend({logEmitter:this.emit.bind(this)},e),Object.defineProperty(this,"profileManager",{value:new tO(this.options)}),Object.defineProperty(this,"controlConnection",{value:new sO(this.options,this.profileManager),writable:!0}),this.setMaxListeners(0),this.connected=!1,this.isShuttingDown=!1,this.keyspace=e.keyspace,this.metadata=this.controlConnection.metadata,this.hosts=this.controlConnection.hosts,this.metrics=this.options.metrics}u(Je,"Client");Ki.inherits(Je,aC.EventEmitter);Je.prototype.connect=function(e){return qt.promiseWrapper.call(this,this.options,e,this._connectCb)};Je.prototype._connectCb=function(e){if(this.connected)return e();if(this.isShuttingDown)return e(new Mi.NoHostAvailableError(null,"Connecting after shutdown is not supported"));if(this.once("connected",e),this.connecting)return;this.connecting=!0;let t=this;this.log("info",Ki.format("Connecting to cluster using '%s' version %s",nO,iO)),qt.series([r=>oO.init(this.options,r),u(function(n){t.controlConnection.init(n)},"initControlConnection"),u(function(n){t.hosts=t.controlConnection.hosts,t.profileManager.init(t,t.hosts,n)},"initLoadBalancingPolicy"),u(function(n){if(!t.keyspace)return n();fp.setKeyspace(t,n)},"setKeyspace"),u(function(n){if(uC.setMetadataDependent(t),!t.options.pooling.warmup)return n();t._warmup(n)},"setPoolOptionsAndWarmup")],u(function(n){if(n)return t.controlConnection.reset(function(){t.connected=!1,t.connecting=!1,t.emit("connected",n)});t._setHostListeners(),t.profileManager.getDistance(t.controlConnection.host),t.connected=!0,t.connecting=!1,t.emit("connected")},"connectFinished"))};Je.prototype.execute=function(e,t,r,n){return n=n||r||t,typeof n=="function"&&(t=typeof t!="function"?t:null),qt.promiseWrapper.call(this,this.options,n,u(function(s){let o;try{o=lp.create(r,this)}catch(a){return s(a)}this._innerExecute(e,t,o,s)},"handler"))};Je.prototype.eachRow=function(e,t,r,n,i){!i&&n&&typeof r=="function"?(i=qt.validateFn(n,"rowCallback"),n=r):(i=i||qt.noop,n=qt.validateFn(n||r||t,"rowCallback")),t=typeof t!="function"?t:null;let s;try{s=lp.create(r,this,n)}catch(f){return i(f)}let o=this,a=0;function c(){o._innerExecute(e,t,s,l)}u(c,"nextPage");function l(f,h){if(f)return i(f);if(a+=h.rowLength,h.rawPageState!==void 0){if(s.setPageState(h.rawPageState),s.isAutoPage())return c();h.nextPage=c}h.rowLength=a,i(null,h)}u(l,"pageCallback"),this._innerExecute(e,t,s,l)};Je.prototype.stream=function(e,t,r,n){n=n||qt.noop;let i=new cp.ResultStream({objectMode:1});function s(a,c){if(a&&i.emit("error",a),c&&c.nextPage){i._valve(u(function(){try{c.nextPage()}catch(f){i.emit("error",f)}},"pageValve"));return}i._valve(null),i.add(null),n(a)}u(s,"onFinish");let o=!0;return this.eachRow(e,t,r,u(function(c,l){i.add(l)},"rowCallback"),u(function(c,l){if(o)return setImmediate(u(function(){s(c,l)},"eachRowFinishedImmediate"));s(c,l)},"eachRowFinished")),o=!1,i};Je.prototype.batch=function(e,t,r){return r=r||t,qt.promiseWrapper.call(this,this.options,r,u(function(i){this._batchCb(e,t,i)},"handler"))};Je.prototype._batchCb=function(e,t,r){if(!Array.isArray(e))throw new Mi.ArgumentError("Queries should be an Array");if(e.length===0)return r(new Mi.ArgumentError("Queries array can not be empty"));let n;try{n=lp.create(t,this)}catch(o){return r(o)}let i,s;qt.series([o=>this.connect(o),o=>{if(n.isPrepared())return cC.getPreparedMultiple(this,n.getLoadBalancingPolicy(),e,this.keyspace,function(a,c){i=c,o(a)});i=new Array(e.length);for(let a=0;a<e.length;a++){let c=e[a];if(!c)return o(new Mi.ArgumentError(Ki.format("Invalid query at index %d",a)));let l=typeof c=="string"?c:c.query;if(!l)return o(Mi.ArgumentError(Ki.format("Invalid query at index %d",a)));i[a]={query:l,params:c.params}}o()},o=>this._createBatchRequest(i,n,(a,c)=>{s=c,o(a)}),o=>fp.send(s,n,this,o)],r)};Je.prototype.getReplicas=function(e,t){return this.metadata.getReplicas(e,t)};Je.prototype.getState=function(){return rO.from(this)};Je.prototype.log=qt.log;Je.prototype.shutdown=function(e){return qt.promiseWrapper.call(this,this.options,e,this._shutdownCb)};Je.prototype._shutdownCb=function(e){let t=this;function r(){t.connected=!1,t.isShuttingDown=!0;let n=t.hosts.values();t.controlConnection.shutdown(),t.options.policies.speculativeExecution.shutdown(),t.options.requestTracker&&t.options.requestTracker.shutdown(),qt.each(n,(i,s)=>i.shutdown(!1,s),e)}if(u(r,"doShutdown"),this.log("info","Shutting down"),e=e||qt.noop,!this.hosts||!this.connected)return this.connected=!1,e();if(this.connecting)return this.log("warning","Shutting down while connecting"),this.once("connected",r);r()};Je.prototype._waitForSchemaAgreement=function(e,t){if(this.hosts.length===1)return setImmediate(()=>t(null,!0));let r=process.hrtime(),n=this.options.protocolOptions.maxSchemaAgreementWaitSeconds;this.log("info","Waiting for schema agreement");let i;qt.whilst(()=>!i&&process.hrtime(r)[0]<n,s=>{this.metadata.compareSchemaVersions(e,(o,a)=>{if(o)return s(o);if(i=a,i)return this.log("info","Schema versions match"),s();setTimeout(s,500)})},s=>t(s,i))};Je.prototype.handleSchemaAgreementAndRefresh=function(e,t,r){this._waitForSchemaAgreement(e,(n,i)=>{if(n&&this.log("warning","There was an error while waiting for the schema agreement between nodes",n),!this.options.isMetadataSyncEnabled)return r(i);this.controlConnection.handleSchemaChange(t,!0,s=>{s&&this.log("warning","There was an error while handling schema change",s),r(i)})})};Je.prototype._innerExecute=function(e,t,r,n){let i=this.controlConnection.protocolVersion;if(!r.isPrepared()&&t&&!Ki.isArray(t)&&!cp.protocolVersion.supportsNamedParameters(i))return n(new Mi.ArgumentError("Named parameters for simple statements are not supported, use prepare flag"));let s;qt.series([o=>this.connect(o),o=>{if(!r.isPrepared())return this._createQueryRequest(e,r,t,(c,l)=>{s=l,o(c)});let a=r.getLoadBalancingPolicy();cC.getPrepared(this,a,e,this.keyspace,(c,l,f)=>{if(c)return o(c);this._createExecuteRequest(e,l,r,t,f,(h,d)=>{s=d,o(h)})})},o=>fp.send(s,r,this,o)],n)};Je.prototype._setHostListeners=function(){function e(n,i){return()=>n.emit("hostUp",i)}u(e,"getHostUpListener");function t(n,i){return()=>n.emit("hostDown",i)}u(t,"getHostDownListener");let r=this;this.hosts.on("add",u(function(i){i.on("up",e(r,i)),i.on("down",t(r,i)),r.emit("hostAdd",i)},"hostAddedListener")),this.hosts.on("remove",u(function(i){i.removeAllListeners(),r.emit("hostRemove",i)},"hostRemovedListener")),this.hosts.forEach(function(n){n.on("up",e(r,n)),n.on("down",t(r,n))})};Je.prototype._warmup=function(e){let t=this,r=this.hosts.values();qt.timesLimit(r.length,aO,u(function(i,s){let o=r[i];if(t.profileManager.getDistance(o)!==cp.distance.local)return s();o.warmupPool(function(c){c&&t.log("warning",Ki.format("Connection pool to host %s could not be created: %s",o.address,c)),s()})},"warmupEachCallback"),e)};Je.prototype._getEncoder=function(){let e=this.controlConnection.getEncoder();if(!e)throw new Mi.DriverInternalError("Encoder is not defined");return e};Je.prototype._createBatchRequest=function(e,t,r){let n=e[0];if(!n.meta)return r(null,new Mu.BatchRequest(e,t));this._setRoutingInfo(t,n.params,n.meta,function(i){if(i)return r(i);r(null,new Mu.BatchRequest(e,t))})};Je.prototype._createExecuteRequest=function(e,t,r,n,i,s){try{n=qt.adaptNamedParamsPrepared(n,i.columns)}catch(o){return s(o)}this._setRoutingInfo(r,n,i,o=>{if(o)return s(o);s(null,new Mu.ExecuteRequest(e,t,n,r,i))})};Je.prototype._createQueryRequest=function(e,t,r,n){this.metadata.adaptUserHints(this.keyspace,t.getHints(),i=>{if(i)return n(i);let s;try{s=qt.adaptNamedParamsWithHints(r,t),this._getEncoder().setRoutingKeyFromUser(s.params,t,s.keyIndexes)}catch(o){return n(o)}n(null,new Mu.QueryRequest(e,s.params,t,s.namedParameters))})};Je.prototype._setRoutingInfo=function(e,t,r,n){let i=this;function s(o){let a=i._getEncoder();try{o?a.setRoutingKeyFromUser(t,e):a.setRoutingKeyFromMeta(r,t,e)}catch(c){return n(c)}n()}if(u(s,"encodeRoutingKey"),!e.getKeyspace()&&r.keyspace&&e.setKeyspace(r.keyspace),e.getRoutingKey())return s(!0);if(Array.isArray(r.partitionKeys))return e.setRoutingIndexes(r.partitionKeys),s();this.metadata.getTable(r.keyspace,r.table,(o,a)=>{if(o)return this.log("warning",Ki.format("Table %s.%s metadata could not be retrieved",r.keyspace,r.table)),n();if(!a)return n();e.setRoutingIndexes(a.partitionKeys.map(c=>r.columnsByName[c.name])),r.partitionKeys=e.getRoutingIndexes(),s()})};lC.exports=Je});var gp=_((dV,hC)=>{"use strict";var uO=require("events"),pp=class pp extends uO{constructor(t,r,n){super(),this.key=t,this.value=r,this.edges=n||[]}};u(pp,"Node");var Jo=pp,dp=class dp extends Jo{constructor(){super([],null),this.length=0}getOrCreate(t,r){typeof t.next!="function"&&(t=t[Symbol.iterator]());let n=this,i=!1,s=t.next();for(;;){let o;for(let l=1;l<n.key.length;l++){if(s.done||n.key[l]!==s.value){o=this._createBranch(n,l,s.done,r);break}s=t.next()}if(s.done){i=!0;break}if(o!==void 0)break;let a=n.edges,c;for(let l=0;l<a.length;l++){let f=a[l];if(f.key[0]===s.value){c=f,s=t.next();break}}if(c===void 0)break;n=c}if(!i){let o=r();return n.edges.push(new Jo(cO(s.value,t),o)),this._onItemAdded(),o}return n.value}_createBranch(t,r,n,i){let s=new Jo(t.key.slice(r),t.value,t.edges);return t.key=t.key.slice(0,r),t.edges=[s],n?(t.value=i(),this._onItemAdded()):t.value=null,s}_onItemAdded(){this.length++,this.emit("add",this.length)}};u(dp,"Tree");var hp=dp;function cO(e,t){let r=[e],n=t.next();for(;!n.done;)r.push(n.value),n=t.next();return r}u(cO,"iteratorToArray");hC.exports=hp});var Hu=_(Ku=>{"use strict";var lO=Ue(),yp=class yp{constructor(t,r,n){this.key=t,this.value=r,this.hasChildValues=n}};u(yp,"QueryOperator");var gn=yp,mp=class mp{constructor(t,r,n){this.sign=t,this.value=r,this.inverted=!!n}};u(mp,"QueryAssignment");var oi=mp,fO={in_:u(function(t){if(!Array.isArray(t))throw new lO.ArgumentError("IN operator supports only Array values");return new gn("IN",t)},"in_"),gt:u(function(t){return new gn(">",t)},"gt"),gte:u(function(t){return new gn(">=",t)},"gte"),lt:u(function(t){return new gn("<",t)},"lt"),lte:u(function(t){return new gn("<=",t)},"lte"),notEq:u(function(t){return new gn("!=",t)},"notEq"),and:function(e,t){return new gn("AND",[e,t],!0)},incr:u(function(t){return new oi("+",t)},"incr"),decr:u(function(t){return new oi("-",t)},"decr"),append:u(function(t){return new oi("+",t)},"append"),prepend:u(function(t){return new oi("+",t,!0)},"prepend"),remove:u(function(t){return new oi("-",t)},"remove")};Ku.q=fO;Ku.QueryAssignment=oi;Ku.QueryOperator=gn});var Ep=_((vV,gC)=>{"use strict";var dC=Hu(),pC=dC.QueryOperator,hO=dC.QueryAssignment,Er=class Er{static*getSelectKey(t,r,n){yield*Er._yieldKeyAndOperators(t,r),yield*Er._getSelectDocInfo(n)}static*getSelectAllKey(t){yield"root",yield*Er._getSelectDocInfo(t)}static*_getSelectDocInfo(t){if(t&&(t.fields&&t.fields.length>0&&(yield"|f|",yield*t.fields),typeof t.limit=="number"&&(yield"|l|"),t.orderBy)){yield"|o|";let r=Object.keys(t.orderBy);for(let n=0;n<r.length;n++){let i=r[n];yield i,yield t.orderBy[i]}}}static*getInsertKey(t,r){yield*t,r&&(r.fields&&r.fields.length>0&&(yield"|f|",yield*r.fields),typeof r.ttl=="number"&&(yield"|t|"),r.ifNotExists&&(yield"|e|"))}static*getUpdateKey(t,r,n){yield*Er._yieldKeyAndAllQs(t,r),n&&(n.fields&&n.fields.length>0&&(yield"|f|",yield*n.fields),typeof n.ttl=="number"&&(yield"|t|"),n.ifExists&&(yield"|e|"),n.when&&(yield*Er._yieldKeyAndOperators(Object.keys(n.when),n.when)))}static*getRemoveKey(t,r,n){yield*Er._yieldKeyAndOperators(t,r),n&&(n.fields&&n.fields.length>0&&(yield"|f|",yield*n.fields),n.ifExists&&(yield"|e|"),n.deleteOnlyColumns&&(yield"|dc|"),n.when&&(yield*Er._yieldKeyAndOperators(Object.keys(n.when),n.when)))}static*_yieldKeyAndOperators(t,r){for(let n=0;n<t.length;n++){let i=t[n];yield i,yield*Er._yieldOperators(r[i])}}static*_yieldOperators(t){t!=null&&t instanceof pC&&(yield t.key,t.hasChildValues&&(yield*Er._yieldOperators(t.value[0]),yield"|/|",yield*Er._yieldOperators(t.value[1])))}static*_yieldKeyAndAllQs(t,r){for(let n=0;n<t.length;n++){let i=t[n];yield i;let s=r[i];s!=null&&(s instanceof pC?yield*Er._yieldOperators(s):s instanceof hO&&(yield s.sign,yield s.inverted))}}};u(Er,"Cache");var vp=Er;gC.exports=vp});var $u=_((CV,yC)=>{"use strict";var Tp=Ep(),_p=class _p{constructor(t,r,n,i){this.doc=t,this.docInfo=r,this.handler=n,this.cache=i}getQueries(){let t=Object.keys(this.doc),r=this.cache.getOrCreate(this.getCacheKey(t),()=>({queries:null}));return r.queries===null&&(r.queries=this.createQueries(t)),r.queries}getCacheKey(t){throw new Error("getCacheKey must be implemented")}createQueries(t){throw new Error("getCacheKey must be implemented")}pushQueries(t){let r=!0,n;return this.getQueries().then(i=>(i.forEach(s=>{r=r&&s.isIdempotent,n=s.isCounter,t.push({query:s.query,params:s.paramsGetter(this.doc,this.docInfo)})}),{isIdempotent:r,isCounter:n}))}getMappingInfo(){return this.handler.info}};u(_p,"ModelBatchItem");var qs=_p,wp=class wp extends qs{constructor(t,r,n,i){super(t,r,n,i)}getCacheKey(t){return Tp.getInsertKey(t,this.docInfo)}createQueries(t){return this.handler.createInsertQueries(t,this.doc,this.docInfo)}};u(wp,"InsertModelBatchItem");var Cp=wp,bp=class bp extends qs{constructor(t,r,n,i){super(t,r,n,i)}getCacheKey(t){return Tp.getUpdateKey(t,this.doc,this.docInfo)}createQueries(t){return this.handler.createUpdateQueries(t,this.doc,this.docInfo)}};u(bp,"UpdateModelBatchItem");var Sp=bp,Ip=class Ip extends qs{constructor(t,r,n,i){super(t,r,n,i)}getCacheKey(t){return Tp.getRemoveKey(t,this.doc,this.docInfo)}createQueries(t){return this.handler.createDeleteQueries(t,this.doc,this.docInfo)}};u(Ip,"RemoveModelBatchItem");var xp=Ip;yC.exports={ModelBatchItem:qs,InsertModelBatchItem:Cp,UpdateModelBatchItem:Sp,RemoveModelBatchItem:xp}});var Dp=_((xV,mC)=>{"use strict";var Ap=gp(),Np=$u(),pO=Np.InsertModelBatchItem,dO=Np.UpdateModelBatchItem,gO=Np.RemoveModelBatchItem,Rp=class Rp{constructor(t){this._handler=t,this._cache={insert:new Ap,update:new Ap,remove:new Ap}}insert(t,r){return new pO(t,r,this._handler,this._cache.insert)}update(t,r){return new dO(t,r,this._handler,this._cache.update)}remove(t,r){return new gO(t,r,this._handler,this._cache.update)}};u(Rp,"ModelBatchMapper");var Bp=Rp;mC.exports=Bp});var Fp=_((_V,vC)=>{"use strict";var yO=Dp(),Op=class Op{constructor(t,r){this.name=t,this._handler=r,this.batching=new yO(this._handler)}get(t,r,n){return n===void 0&&typeof r=="string"&&(n=r,r=null),this._handler.getSelectExecutor(t,r,!0).then(i=>i(t,r,n)).then(i=>i.first())}find(t,r,n){return n===void 0&&typeof r=="string"&&(n=r,r=null),this._handler.getSelectExecutor(t,r,!1).then(i=>i(t,r,n))}findAll(t,r){return r===void 0&&typeof t=="string"&&(r=t,t=null),this._handler.getSelectAllExecutor(t)(t,r)}insert(t,r,n){return n===void 0&&typeof r=="string"&&(n=r,r=null),this._handler.getInsertExecutor(t,r).then(i=>i(t,r,n))}update(t,r,n){return n===void 0&&typeof r=="string"&&(n=r,r=null),this._handler.getUpdateExecutor(t,r).then(i=>i(t,r,n))}remove(t,r,n){return n===void 0&&typeof r=="string"&&(n=r,r=null),this._handler.getDeleteExecutor(t,r).then(i=>i(t,r,n))}mapWithQuery(t,r,n){return this._handler.getExecutorFromQuery(t,r,n)}};u(Op,"ModelMapper");var Lp=Op;vC.exports=Lp});var TC=_((bV,xC)=>{"use strict";var Gu=require("vm"),SC=Hu(),EC=SC.QueryOperator,Pp=SC.QueryAssignment,mO=Ve(),CC=mO.dataTypes,ju="gen-param-getter.js",ze=class ze{static getSelect(t,r,n,i,s,o){let a="SELECT ";return a+=i.length>0?i.map(c=>c.columnName).join(", "):"*",a+=` FROM ${r}.${t}`,n.length>0&&(a+=" WHERE ",a+=ze._getConditionWithOperators(n)),s.length>0&&(a+=" ORDER BY ",a+=s.map(c=>c[0]+" "+c[1]).join(", ")),typeof o=="number"&&(a+=" LIMIT ?"),a}static selectParamsGetter(t,r){let n=`(function getParametersSelect(doc, docInfo) {
`;return n+="  return [",n+=ze._valueGetterExpression(t),typeof r=="number"&&(t.length>0&&(n+=", "),n+="docInfo['limit']"),n+=`];
})`,new Gu.Script(n).runInThisContext({filename:ju})}static getInsert(t,r,n,i,s){let o=i&&i.ttl,a=n.filter(c=>t.columnsByName[c.columnName]!==void 0);return{query:ze._getInsertQuery(t.name,r,a,s,o),paramsGetter:ze._insertParamsGetter(a,i),isIdempotent:!s}}static _getInsertQuery(t,r,n,i,s){let o=`INSERT INTO ${r}.${t} (`;return o+=n.map(a=>a.columnName).join(", "),o+=") VALUES (",o+=n.map(()=>"?").join(", "),o+=")",i===!0&&(o+=" IF NOT EXISTS"),typeof s=="number"&&(o+=" USING TTL ?"),o}static _insertParamsGetter(t,r){let n=`(function getParametersInsert(doc, docInfo) {
`;return n+="  return [",n+=ze._valueGetterExpression(t),r&&typeof r.ttl=="number"&&(n+=", docInfo['ttl']"),n+=`];
})`,new Gu.Script(n).runInThisContext({filename:ju})}static getUpdate(t,r,n,i,s,o){let a=i&&i.ttl,c=new Set(t.partitionKeys.concat(t.clusteringKeys).map(d=>d.name)),l=!0,f=!1,h=n.filter(d=>{let g=t.columnsByName[d.columnName];return g===void 0?!1:(g.type.code===CC.list&&d.value instanceof Pp?l=!1:g.type.code===CC.counter&&(l=!1,f=!0),!0)});return{query:ze._getUpdateQuery(t.name,r,c,h,s,o,a),isIdempotent:l&&s.length===0&&!o,paramsGetter:ze._updateParamsGetter(c,h,s,a),isCounter:f}}static _getUpdateQuery(t,r,n,i,s,o,a){let c=`UPDATE ${r}.${t} `;return typeof a=="number"&&(c+="USING TTL ? "),c+="SET ",c+=i.filter(l=>!n.has(l.columnName)).map(l=>l.value instanceof Pp?l.value.inverted?`${l.columnName} = ? ${l.value.sign} ${l.columnName}`:`${l.columnName} = ${l.columnName} ${l.value.sign} ?`:l.columnName+" = ?").join(", "),c+=" WHERE ",c+=i.filter(l=>n.has(l.columnName)).map(l=>l.columnName+" = ?").join(" AND "),o===!0?c+=" IF EXISTS":s.length>0&&(c+=" IF "+ze._getConditionWithOperators(s)),c}static _updateParamsGetter(t,r,n,i){let s=`(function getParametersUpdate(doc, docInfo) {
`;return s+="  return [",typeof i=="number"&&(s+="docInfo['ttl'], "),s+=ze._assignmentGetterExpression(r.filter(a=>!t.has(a.columnName))),s+=", ",s+=ze._valueGetterExpression(r.filter(a=>t.has(a.columnName))),n.length>0&&(s+=", "+ze._valueGetterExpression(n,"docInfo.when")),s+=`];
})`,new Gu.Script(s).runInThisContext({filename:ju})}static getDelete(t,r,n,i,s,o){let a=i&&i.deleteOnlyColumns,c=new Set(t.partitionKeys.concat(t.clusteringKeys).map(f=>f.name)),l=n.filter(f=>t.columnsByName[f.columnName]!==void 0);return{query:ze._getDeleteQuery(t.name,r,c,l,s,o,a),paramsGetter:ze._deleteParamsGetter(c,l,s),isIdempotent:s.length===0&&!o}}static _getDeleteQuery(t,r,n,i,s,o,a){let c="DELETE";if(a){let l=i.filter(f=>!n.has(f.columnName)).map(f=>f.columnName).join(", ");l!==""&&(c+=" "+l)}return c+=` FROM ${r}.${t} WHERE `,c+=i.filter(l=>n.has(l.columnName)).map(l=>l.columnName+" = ?").join(" AND "),o===!0?c+=" IF EXISTS":s.length>0&&(c+=" IF "+ze._getConditionWithOperators(s)),c}static _deleteParamsGetter(t,r,n){let i=`(function getParametersDelete(doc, docInfo) {
`;return i+="  return [",i+=ze._valueGetterExpression(r.filter(o=>t.has(o.columnName))),n.length>0&&(i+=", "+ze._valueGetterExpression(n,"docInfo.when")),i+=`];
})`,new Gu.Script(i).runInThisContext({filename:ju})}static _valueGetterExpression(t,r){return r=r||"doc",t.map(n=>ze._valueGetterSingle(`${r}['${n.propertyName}']`,n.value)).join(", ")}static _valueGetterSingle(t,r){return r instanceof EC?r.hasChildValues?`${ze._valueGetterSingle(`${t}.value[0]`,r.value[0])}, ${ze._valueGetterSingle(`${t}.value[1]`,r.value[1])}`:`${t}.value`:t}static _assignmentGetterExpression(t,r){return r=r||"doc",t.map(n=>`${r}['${n.propertyName}']${n.value instanceof Pp?".value":""}`).join(", ")}static _getConditionWithOperators(t){return t.map(r=>ze._getSingleCondition(r.columnName,r.value)).join(" AND ")}static _getSingleCondition(t,r){return r instanceof EC?r.hasChildValues?`${ze._getSingleCondition(t,r.value[0])} ${r.key} ${ze._getSingleCondition(t,r.value[1])}`:`${t} ${r.key} ?`:`${t} = ?`}};u(ze,"QueryGenerator");var kp=ze;xC.exports=kp});var Vp=_((AV,wC)=>{"use strict";var vO=require("vm"),qp=se(),_C=Ve(),Us=class Us{static getSelectAdapter(t,r){let n=r.columns;if(!n)throw new Error("Expected ROWS result obtained VOID");let i=`(function rowAdapter(row, info) {
  const item = info.newInstance();
`;return i+=n.map(o=>`  item['${t.getPropertyName(o.name)}'] = row['${o.name}'];`).join(`
`),i+=`
  return item;
})`,new vO.Script(i).runInThisContext({filename:"gen-result-mapper.js"})}static getMutationAdapter(t){return t.columns===null||t.columns.length===1&&t.columns[0].name==="[applied]"&&t.columns[0].type.code===_C.dataTypes.boolean?qp.noop:Us._getConditionalRowAdapter(t)}static _getConditionalRowAdapter(t){return u(function(n,i){let s=i.newInstance();for(let o=1;o<t.columns.length;o++){let a=t.columns[o];s[i.getPropertyName(a.name)]=n[a.name]}return s},"conditionalRowAdapter")}static getCustomQueryAdapter(t,r){return r.columns===null||r.columns.length===0?{canCache:!0,fn:qp.noop}:r.columns[0].name==="[applied]"&&r.columns[0].type.code===_C.dataTypes.boolean?{canCache:!1,fn:Us._getConditionalRowAdapter(r)}:{canCache:!0,fn:Us.getSelectAdapter(t,r)}}};u(Us,"ResultMapper");var Up=Us;wC.exports=Up});var zu=_((NV,bC)=>{"use strict";var EO=require("util"),CO=se(),SO=EO.inspect.custom||"inspect",Kp=class Kp{constructor(t,r,n){this._rs=t,this._info=r,this._rowAdapter=n,this._isEmptyLwt=t.columns!==null&&t.columns.length===1&&this._rs.rowLength===1&&t.columns[0].name==="[applied]",this.length=this._isEmptyLwt?0:t.rowLength||0,this.pageState=t.pageState}wasApplied(){return this._rs.wasApplied()}first(){return!this._rs.rowLength||this._isEmptyLwt?null:this._rowAdapter(this._rs.rows[0],this._info)}*[Symbol.iterator](){if(!this._isEmptyLwt)for(let t=0;t<this._rs.rows.length;t++)yield this._rowAdapter(this._rs.rows[t],this._info)}toArray(){return this._isEmptyLwt||!this._rs.rows?CO.emptyArray:this._rs.rows.map(t=>this._rowAdapter(t,this._info))}forEach(t,r){let n=0;r=r||this;for(let i of this)t.call(r,i,n++)}[SO](){return this.toArray()}};u(Kp,"Result");var Mp=Kp;bC.exports=Mp});var NC=_((LV,BC)=>{"use strict";var qr={all:1,none:0,some:-1},Gp=class Gp{static getForSelect(t,r,n,i,s,o){return Promise.all(r.tables.map(a=>a.isView?t.metadata.getMaterializedView(r.keyspace,a.name):t.metadata.getTable(r.keyspace,a.name))).then(a=>{for(let l=0;l<a.length;l++){let f=a[l];if(f===null)throw new Error(`Table "${r.tables[l].name}" could not be retrieved`);if(!(Vs(f.partitionKeys,i)!==qr.all||n&&Vs(f.clusteringKeys,i)!==qr.all||i.length>f.partitionKeys.length&&!i.reduce((p,y)=>p&&($p(f.partitionKeys,v=>v.name===y.columnName)||$p(f.clusteringKeys,v=>v.name===y.columnName)),!0)||!s.reduce((g,p)=>g&&f.columnsByName[p.columnName]!==void 0,!0)||!o.reduce((g,p,y)=>{if(!g)return!1;let v=f.clusteringKeys[y];return v&&v.name===p[0]},!0)))return f.name}let c=`No table matches the filter (${n?"all PKs have to be specified":"PKs"}): [${i.map(l=>l.columnName)}]`;throw s.length>0&&(c+=`; fields: [${s.map(l=>l.columnName)}]`),o.length>0&&(c+=`; orderBy: [${o.map(l=>l[0])}]`),new Error(c)})}static getForSelectAll(t){return t.tables[0].name}static getForInsert(t,r,n){return Promise.all(r.tables.filter(i=>!i.isView).map(i=>t.metadata.getTable(r.keyspace,i.name))).then(i=>{let s=i.filter((o,a)=>{if(o===null)throw new Error(`Table "${r.tables[a].name}" could not be retrieved`);if(Vs(o.partitionKeys,n)!==qr.all)return!1;let c=Vs(o.clusteringKeys,n);if(c===qr.all)return!0;if(c===qr.some)return!1;let l=AC(o);return n.length===o.partitionKeys.length+l&&l>0});if(s.length===0)throw new Error(`No table matches (all PKs have to be specified) fields: [${n.map(o=>o.columnName)}]`);return s})}static getForUpdate(t,r,n,i){return Promise.all(r.tables.filter(s=>!s.isView).map(s=>t.metadata.getTable(r.keyspace,s.name))).then(s=>{let o=s.filter((a,c)=>{if(a===null)throw new Error(`Table "${r.tables[c].name}" could not be retrieved`);if(Vs(a.partitionKeys,n)!==qr.all)return!1;let l=Vs(a.clusteringKeys,n);if(l===qr.some||l===qr.none&&!IC(a))return!1;let f=n.reduce((h,d)=>h+(a.columnsByName[d.columnName]!==void 0?1:0),0);return f<=a.partitionKeys.length+a.clusteringKeys.length&&(!IC(a)||f<=a.partitionKeys.length)?!1:i.reduce((h,d)=>h&&a.columnsByName[d.columnName]!==void 0,!0)});if(o.length===0){let a=`No table matches (all PKs and columns to set have to be specified) fields: [${n.map(c=>c.columnName)}]`;throw i.length>0&&(a+=`; condition: [${i.map(c=>c.columnName)}]`),new Error(a)}return o})}static getForDelete(t,r,n,i){return Promise.all(r.tables.filter(s=>!s.isView).map(s=>t.metadata.getTable(r.keyspace,s.name))).then(s=>{let o=s.filter((a,c)=>{if(a===null)throw new Error(`Table "${r.tables[c].name}" could not be retrieved`);let l=a.partitionKeys.concat(a.clusteringKeys).map(h=>h.name),f=n.map(h=>h.columnName);for(let h=0;h<l.length;h++)if(f.indexOf(l[h])===-1)return!1;return i.reduce((h,d)=>h&&a.columnsByName[d.columnName]!==void 0,!0)});if(o.length===0){let a=`No table matches (all PKs have to be specified) fields: [${n.map(c=>c.columnName)}]`;throw i.length>0&&(a+=`; condition: [${i.map(c=>c.columnName)}]`),new Error(a)}return o})}};u(Gp,"ObjectSelector");var Hp=Gp;function $p(e,t){return e.filter(t).length>0}u($p,"contains");function Vs(e,t){if(e.length===0)return qr.all;let r=t.reduce((n,i)=>n+($p(e,s=>i.columnName===s.name)?1:0),0);return r===0?qr.none:r===e.length?qr.all:qr.some}u(Vs,"keysAreIncluded");function IC(e){return AC(e)>0}u(IC,"hasStaticColumn");function AC(e){return e.columns.reduce((t,r)=>t+(r.isStatic?1:0),0)}u(AC,"staticColumnCount");BC.exports=Hp});var Wp=_((FV,RC)=>{"use strict";var xO=Ue(),TO=se(),zp=class zp{static getPropertiesInfo(t,r,n,i){let s=t;return r&&r.fields&&r.fields.length>0&&(s=r.fields),s.map(o=>({propertyName:o,columnName:i.getColumnName(o),value:n[o]}))}static adaptOrderBy(t,r){return!t||!t.orderBy?TO.emptyArray:Object.keys(t.orderBy).map(n=>{let i=t.orderBy[n],s=typeof i=="string"?i.toUpperCase():i;if(s!=="ASC"&&s!=="DESC")throw new xO.ArgumentError('Order must be either "ASC" or "DESC", obtained: '+i);return[r.getColumnName(n),s]})}static adaptOptions(t,r){let n={prepare:!0,executionProfile:void 0,timestamp:void 0,isIdempotent:r};return typeof t=="string"?n.executionProfile=t:t!=null&&(n.executionProfile=t.executionProfile,n.timestamp=t.timestamp,t.isIdempotent!==void 0&&(n.isIdempotent=t.isIdempotent)),n}static adaptAllOptions(t,r){let n={prepare:!0,executionProfile:void 0,fetchSize:void 0,pageState:void 0,timestamp:void 0,isIdempotent:void 0};return typeof t=="string"?n.executionProfile=t:t!=null&&(n.executionProfile=t.executionProfile,n.fetchSize=t.fetchSize,n.pageState=t.pageState,n.timestamp=t.timestamp,n.isIdempotent=t.isIdempotent),r&&(n.isIdempotent=!0),n}static adaptBatchOptions(t,r,n){let i={prepare:!0,executionProfile:void 0,timestamp:void 0,logged:void 0,isIdempotent:r,counter:n};return typeof t=="string"?i.executionProfile=t:t!=null&&(i.executionProfile=t.executionProfile,i.timestamp=t.timestamp,i.logged=t.logged!==!1,t.isIdempotent!==void 0&&(i.isIdempotent=t.isIdempotent)),i}};u(zp,"DocInfoAdapter");var jp=zp;RC.exports=jp});var LC=_((kV,DC)=>{"use strict";var Hi=se(),$i=TC(),Wu=Vp(),Qu=zu(),ea=Ep(),ta=gp(),ra=NC(),ur=Wp(),Zu=100,Zp=class Zp{constructor(t,r){this._client=t,this._cache={select:new ta().on("add",n=>this._validateCacheLength(n)),selectAll:new ta().on("add",n=>this._validateCacheLength(n)),insert:new ta().on("add",n=>this._validateCacheLength(n)),update:new ta().on("add",n=>this._validateCacheLength(n)),remove:new ta().on("add",n=>this._validateCacheLength(n)),customQueries:new Map},this.info=r}getSelectExecutor(t,r,n){let i=Object.keys(t);if(i.length===0)return Promise.reject(new Error("Expected object with keys"));let s=ea.getSelectKey(i,t,r),o=this._cache.select.getOrCreate(s,()=>({executor:null,resultAdapter:null}));if(o.executor!==null)return Promise.resolve(o.executor);let a=ur.getPropertiesInfo(i,null,t,this.info),c=ur.getPropertiesInfo(Hi.emptyArray,r,t,this.info),l=ur.adaptOrderBy(r,this.info),f=r&&r.limit;return this._client.connect().then(()=>ra.getForSelect(this._client,this.info,n,a,c,l)).then(h=>{let d=$i.getSelect(h,this.info.keyspace,a,c,l,f),g=$i.selectParamsGetter(a,f),p=this;return o.executor=u(function(v,m,x){return p._executeSelect(d,g,v,m,x,o)},"selectExecutor"),o.executor})}getSelectAllExecutor(t){let r=ea.getSelectAllKey(t),n=this._cache.selectAll.getOrCreate(r,()=>({executor:null,resultAdapter:null}));if(n.executor!==null)return n.executor;let i=ur.getPropertiesInfo(Hi.emptyArray,t,Hi.emptyObject,this.info),s=ur.adaptOrderBy(t,this.info),o=t&&t.limit,a=ra.getForSelectAll(this.info),c=$i.getSelect(a,this.info.keyspace,Hi.emptyArray,i,s,o),l=$i.selectParamsGetter(Hi.emptyArray,o),f=this;return n.executor=u(function(d,g){return f._executeSelect(c,l,null,d,g,n)},"selectAllExecutor"),n.executor}_executeSelect(t,r,n,i,s,o){let a=ur.adaptAllOptions(s,!0);return this._client.execute(t,r(n,i),a).then(c=>(o.resultAdapter===null&&(o.resultAdapter=Wu.getSelectAdapter(this.info,c)),new Qu(c,this.info,o.resultAdapter)))}getInsertExecutor(t,r){let n=Object.keys(t);if(n.length===0)return Promise.reject(new Error("Expected object with keys"));let i=ea.getInsertKey(n,r),s=this._cache.insert.getOrCreate(i,()=>({executor:null}));return s.executor!==null?Promise.resolve(s.executor):this.createInsertQueries(n,t,r).then(o=>o.length===1?this._setSingleExecutor(s,o[0]):this._setBatchExecutor(s,o))}createInsertQueries(t,r,n){let i=ur.getPropertiesInfo(t,n,r,this.info),s=n&&n.ifNotExists;return this._client.connect().then(()=>ra.getForInsert(this._client,this.info,i)).then(o=>{if(o.length>1&&s)throw new Error("Batch with ifNotExists conditions cannot span multiple tables");return o.map(a=>$i.getInsert(a,this.info.keyspace,i,n,s))})}getUpdateExecutor(t,r){let n=Object.keys(t);if(n.length===0)return Promise.reject(new Error("Expected object with keys"));let i=ea.getUpdateKey(n,t,r),s=this._cache.update.getOrCreate(i,()=>({executor:null}));return s.executor!==null?Promise.resolve(s.executor):this.createUpdateQueries(n,t,r).then(o=>o.length===1?this._setSingleExecutor(s,o[0]):this._setBatchExecutor(s,o))}createUpdateQueries(t,r,n){let i=ur.getPropertiesInfo(t,n,r,this.info),s=n&&n.ifExists,o=n&&n.when?ur.getPropertiesInfo(Object.keys(n.when),null,n.when,this.info):Hi.emptyArray;if(o.length>0&&s)throw new Error("Both when and ifExists conditions can not be applied to the same statement");return this._client.connect().then(()=>ra.getForUpdate(this._client,this.info,i,o)).then(a=>{if(a.length>1&&(o.length>0||s))throw new Error("Batch with when or ifExists conditions cannot span multiple tables");return a.map(c=>$i.getUpdate(c,this.info.keyspace,i,n,o,s))})}getDeleteExecutor(t,r){let n=Object.keys(t);if(n.length===0)return Promise.reject(new Error("Expected object with keys"));let i=ea.getRemoveKey(n,t,r),s=this._cache.remove.getOrCreate(i,()=>({executor:null}));return s.executor!==null?Promise.resolve(s.executor):this.createDeleteQueries(n,t,r).then(o=>o.length===1?this._setSingleExecutor(s,o[0]):this._setBatchExecutor(s,o))}createDeleteQueries(t,r,n){let i=ur.getPropertiesInfo(t,n,r,this.info),s=n&&n.ifExists,o=n&&n.when?ur.getPropertiesInfo(Object.keys(n.when),null,n.when,this.info):Hi.emptyArray;if(o.length>0&&s)throw new Error("Both when and ifExists conditions can not be applied to the same statement");return this._client.connect().then(()=>ra.getForDelete(this._client,this.info,i,o)).then(a=>{if(a.length>1&&(o.length>0||s))throw new Error("Batch with when or ifExists conditions cannot span multiple tables");return a.map(c=>$i.getDelete(c,this.info.keyspace,i,n,o,s))})}getExecutorFromQuery(t,r,n){let i=this,s=n?ur.adaptAllOptions(n):null;return u(function(a,c){let l=s||ur.adaptAllOptions(c);return i._client.execute(t,r(a),l).then(f=>{let h=i._cache.customQueries.get(t);if(h===void 0){let d=Wu.getCustomQueryAdapter(i.info,f);h=d.fn,d.canCache&&(i._cache.customQueries.set(t,h),i._cache.customQueries.size===Zu&&i._client.log("warning",`Custom queries cache reached ${Zu} items, this could be caused by hard-coding parameter values inside the query, which should be avoided`))}return new Qu(f,i.info,h)})},"queryMappedExecutor")}_setSingleExecutor(t,r){let n=this;return t.executor=u(function(s,o,a){let c=ur.adaptOptions(a,r.isIdempotent);return n._client.execute(r.query,r.paramsGetter(s,o),c).then(l=>new Qu(l,n.info,Wu.getMutationAdapter(l)))},"singleExecutor"),t.executor}_setBatchExecutor(t,r){let n=this,i=r.reduce((s,o)=>s&&o.isIdempotent,!0);return t.executor=u(function(o,a,c){let l=r.map(h=>({query:h.query,params:h.paramsGetter(o,a)})),f=ur.adaptOptions(c,i);return n._client.batch(l,f).then(h=>new Qu(h,n.info,Wu.getMutationAdapter(h)))},"batchExecutor"),t.executor}_validateCacheLength(t){t===Zu&&this._client.log("warning",`ModelMapper cache reached ${Zu} items, this could be caused by building the object to map in different ways (with different shapes) each time. Use the same or few object structures for a model and represent unset values with undefined or types.unset`)}};u(Zp,"MappingHandler");var Qp=Zp;DC.exports=Qp});var rd=_(Yu=>{"use strict";var Jp=class Jp{newObjectInstance(){return{}}getColumnName(t){return t}getPropertyName(t){return t}};u(Jp,"TableMappings");var na=Jp,ed=class ed extends na{constructor(){super()}getColumnName(t){return t.replace(/[a-z][A-Z]/g,(r,n)=>r.charAt(0)+"_"+r.charAt(1)).toLowerCase()}getPropertyName(t){return t.replace(/_[a-z]/g,(r,n)=>n===0?r:r.substr(1).toUpperCase())}};u(ed,"UnderscoreCqlToCamelCaseMappings");var Yp=ed,td=class td extends na{constructor(){super()}getColumnName(t){return super.getColumnName(t)}getPropertyName(t){return super.getPropertyName(t)}newObjectInstance(){return super.newObjectInstance()}};u(td,"DefaultTableMappings");var Xp=td;Yu.TableMappings=na;Yu.UnderscoreCqlToCamelCaseMappings=Yp;Yu.DefaultTableMappings=Xp});var kC=_((MV,PC)=>{"use strict";var FC=rd(),_O=FC.TableMappings,OC=FC.DefaultTableMappings,Gi=class Gi{constructor(t,r,n,i){this.keyspace=t,this.tables=r,this._mappings=n,this._columns=i,this._documentProperties=new Map,i.forEach((s,o)=>this._documentProperties.set(s,o))}getColumnName(t){let r=this._documentProperties.get(t);return r!==void 0?r:this._mappings.getColumnName(t)}getPropertyName(t){let r=this._columns.get(t);return r!==void 0?r:this._mappings.getPropertyName(t)}newInstance(){return this._mappings.newObjectInstance()}static parse(t,r){let n=new Map;return!t||!t.models||Object.keys(t.models).forEach(i=>{let s=t.models[i];n.set(i,Gi._create(i,r,s))}),n}static _create(t,r,n){if(!r&&(!n||!n.keyspace))throw new Error("You should specify the keyspace of the model in the MappingOptions when the Client is not using a keyspace");if(!n)return Gi.createDefault(t,r);let i;if(n.tables&&n.tables.length>0?i=n.tables.map(o=>{let a={name:null,isView:!1};if(typeof o=="string"?a.name=o:o&&(a.name=o.name,a.isView=!!o.isView),!a.name)throw new Error(`Table name not specified for model '${t}'`);return a}):i=[{name:t,isView:!1}],n.mappings&&!(n.mappings instanceof _O))throw new Error("mappings should be an instance of TableMappings");let s=new Map;return n.columns!==null&&typeof n.columns=="object"&&Object.keys(n.columns).forEach(o=>{s.set(o,n.columns[o])}),new Gi(n.keyspace||r,i,n.mappings||new OC,s)}static createDefault(t,r){return new Gi(r,[{name:t,isView:!1}],new OC,new Map)}};u(Gi,"ModelMappingInfo");var nd=Gi;PC.exports=nd});var VC=_((HV,UC)=>{"use strict";var wO=Fp(),bO=LC(),IO=Wp(),AO=Ue(),BO=zu(),NO=Vp(),qC=kC(),RO=$u().ModelBatchItem,sd=class sd{constructor(t,r){if(!t)throw new Error("client must be defined");this.client=t,this._modelMappingInfos=qC.parse(r,t.keyspace),this._modelMappers=new Map}forModel(t){let r=this._modelMappers.get(t);if(r===void 0){let n=this._modelMappingInfos.get(t);if(n===void 0){if(!this.client.keyspace)throw new Error("You must set the Client keyspace or specify the keyspace of the model in the MappingOptions");n=qC.createDefault(t,this.client.keyspace)}r=new wO(t,new bO(this.client,n)),this._modelMappers.set(t,r)}return r}batch(t,r){if(!Array.isArray(t)||!(t.length>0))return Promise.reject(new AO.ArgumentError("First parameter items should be an Array with 1 or more ModelBatchItem instances"));let n=[],i=!0,s;return Promise.all(t.map(o=>o instanceof RO?o.pushQueries(n).then(a=>{i=i&&a.isIdempotent,s=a.isCounter}):Promise.reject(new Error("Batch items must be instances of ModelBatchItem, use modelMapper.batching object to create each item")))).then(()=>this.client.batch(n,IO.adaptBatchOptions(r,i,s))).then(o=>{let a=t[0].getMappingInfo();return new BO(o,a,NO.getMutationAdapter(o))})}};u(sd,"Mapper");var id=sd;UC.exports=id});var MC=_(yn=>{"use strict";yn.Mapper=VC();yn.ModelMapper=Fp();yn.ModelBatchMapper=Dp();yn.ModelBatchItem=$u().ModelBatchItem;yn.Result=zu();var od=rd();yn.TableMappings=od.TableMappings;yn.DefaultTableMappings=od.DefaultTableMappings;yn.UnderscoreCqlToCamelCaseMappings=od.UnderscoreCqlToCamelCaseMappings;yn.q=Hu().q});var HC=_(ud=>{"use strict";var DO=require("stream").Stream,KC=se();function LO(e,t,r,n){if(!e)throw new TypeError("Client instance is not defined");if(typeof t=="string"){if(Array.isArray(r))return new Xu(e,t,r,n).execute();if(r instanceof DO)return new ad(e,t,r,n).execute();throw new TypeError("parameters should be an Array or a Stream instance")}if(Array.isArray(t))return n=r,new Xu(e,null,t,n).execute();throw new TypeError("A string query or query and parameters array should be provided")}u(LO,"executeConcurrent");var cd=class cd{constructor(t,r,n,i){this._client=t,this._query=r,this._parameters=n,i=i||KC.emptyObject,this._raiseOnFirstError=i.raiseOnFirstError!==!1,this._concurrencyLevel=Math.min(i.concurrencyLevel||100,this._parameters.length),this._queryOptions={prepare:!0,executionProfile:i.executionProfile},this._result=new ia(i),this._stop=!1}execute(){let t=new Array(this._concurrencyLevel);for(let r=0;r<this._concurrencyLevel;r++)t[r]=this._executeOneAtATime(r,0);return Promise.all(t).then(()=>this._result)}_executeOneAtATime(t,r){let n=t+this._concurrencyLevel*r;if(n>=this._parameters.length||this._stop)return Promise.resolve();let i=this._parameters[n],s,o;return this._query===null?(s=i.query,o=i.params):(s=this._query,o=i),this._client.execute(s,o,this._queryOptions).then(a=>this._result.setResultItem(n,a)).catch(a=>this._setError(n,a)).then(()=>this._executeOneAtATime(t,r+1))}_setError(t,r){if(this._result.setError(t,r),this._raiseOnFirstError)throw this._stop=!0,r}};u(cd,"ArrayBasedExecutor");var Xu=cd,ld=class ld{constructor(t,r,n,i){this._client=t,this._query=r,this._stream=n,i=i||KC.emptyObject,this._raiseOnFirstError=i.raiseOnFirstError!==!1,this._concurrencyLevel=i.concurrencyLevel||100,this._queryOptions={prepare:!0,executionProfile:i.executionProfile},this._inFlight=0,this._index=0,this._result=new ia(i),this._resolveCallback=null,this._rejectCallback=null,this._readEnded=!1}execute(){return new Promise((t,r)=>{this._resolveCallback=t,this._rejectCallback=r,this._stream.on("data",n=>this._executeOne(n)).on("error",n=>this._setReadEnded(n)).on("end",()=>this._setReadEnded())})}_executeOne(t){if(!Array.isArray(t))return this._setReadEnded(new TypeError("Stream should be in objectMode and should emit Array instances"));if(this._readEnded)return;let r=this._index++;this._inFlight++,this._client.execute(this._query,t,this._queryOptions).then(n=>{this._result.setResultItem(r,n),this._inFlight--}).catch(n=>{this._inFlight--,this._setError(r,n)}).then(()=>{this._stream.isPaused()&&this._stream.resume(),this._readEnded&&this._inFlight===0&&this._resolveCallback(this._result)}),this._inFlight>=this._concurrencyLevel&&this._stream.pause()}_setReadEnded(t){this._readEnded||(this._readEnded=!0,t?this._rejectCallback(t):this._inFlight===0&&this._resolveCallback(this._result))}_setError(t,r){this._result.setError(t,r),this._raiseOnFirstError&&(this._readEnded=!0,this._rejectCallback(r))}};u(ld,"StreamBasedExecutor");var ad=ld,fd=class fd{constructor(t){this._collectResults=t.collectResults,this._maxErrors=t.maxErrors||100,this.totalExecuted=0,this.errors=[],this._collectResults?this.resultItems=[]:Object.defineProperty(this,"resultItems",{enumerable:!1,get:()=>{throw new Error("Property resultItems can not be accessed when collectResults is set to false")}})}setResultItem(t,r){this.totalExecuted++,this._collectResults&&(this.resultItems[t]=r)}setError(t,r){this.totalExecuted++,this.errors.length<this._maxErrors&&this.errors.push(r),this._collectResults&&(this.resultItems[t]=r)}};u(fd,"ResultSetGroup");var ia=fd;ud.executeConcurrent=LO;ud.ResultSetGroup=ia});var Ju=_(Wt=>{"use strict";var OO=fu();Wt.Client=fC();Wt.ExecutionProfile=Rf().ExecutionProfile;Wt.ExecutionOptions=Ss().ExecutionOptions;Wt.types=Ve();Wt.errors=Ue();Wt.policies=hf();Wt.auth=cu();Wt.mapping=MC();Wt.tracker=Ef();Wt.metrics=wf();Wt.concurrent=HC();var $C=Vo();Wt.token={Token:$C.Token,TokenRange:$C.TokenRange};var FO=Xh();Wt.metadata={Metadata:FO};Wt.Encoder=mh();Wt.defaultOptions=function(){return OO.defaultOptions()};Wt.version=Uo().version});var GC=_((QV,PO)=>{PO.exports={model:{modelName:"new_model",dbVersion:"5.x",dbVendor:"ScyllaDB"},container:{name:"new_keyspace",indexes:[],replStrategy:"SimpleStrategy",addToCqlScript:!0},collection:{collectionName:"new_table",collectionUsers:[],collation:{},tableOptions:{}},field:{name:"new_column",subtype:{valueDependencies:[{value:"object",dependency:{key:"type",value:"jsonObject"}},{value:"array",dependency:{key:"type",value:"jsonArray"}}]}},patternField:{name:"^[a-zA-Z0-9_.-]+$"},multipleField:{primaryKey:!1},subschema:{},arrayItem:{},choice:{},relationship:{},user:{},view:{viewOn:""},UDFs:{name:"new_udf",udfID:"",udfDescription:"",udfFunction:"",udfComments:""},UDAs:{name:"new_uda",udfID:"",udfDescription:"",udfFunction:"",udfComments:""},SecIdxs:{name:"new_secondary_index",SecIndxKey:"",SecIndxID:"",SecIndxDescription:"",SecIndxFunction:"",SecIndxComments:""}}});var WC=_((ZV,zC)=>{"use strict";var jC=Ju().types,kO=GC(),qO={numeric:"num",char:"str",timestamp:"ts",reference:"udt"},UO=kO.field.name;zC.exports=e=>{let t=u((v,m,x)=>{let B=jC.getDataTypeNameByCode(v.type||v).split("<")[0];return m&&B==="udt"?(m.push({udt:v,sample:x}),r(v)):n(B,v,x,m)},"getColumnType"),r=u(v=>{let m=e.get(v,"type.info.name",e.get(v,"info.name",v.name));return{type:"reference",$ref:`#/definitions/${m}`,refName:m}},"getRef"),n=u((v,m,x,w)=>{let B=a(v);return v==="map"?i(B,m,x,w):v==="tuple"?s(B,m,x,w):v==="set"||v==="list"?o(B,m,x,w):B},"getType"),i=u((v,m,x,w)=>{let B=(m.info||m.type.info)[0],R=(m.info||m.type.info)[1],L=t(B),Y=l(R,x,w),X=L.mode?{keySubtype:L.mode}:{},ne=L.type,le=y(Y),Ce=c(v.type,le);return Object.assign({},v,X,{keyType:ne,subtype:Ce,properties:Y})},"handleMap"),s=u((v,m,x,w)=>{x=Array.isArray(x)?x:[];let B=(m.info||m.type.info).map(R=>{let L=x.find(X=>d(X,R));return t(R,w,L)});return Object.assign({},v,{items:B})},"handleTuple"),o=u((v,m,x,w)=>{let B=m.info||m.type.info,R=g(B,x,w),L=(R[0]||{type:"text"}).type,Y=c(v.type,L);return Object.assign({},v,{items:e.uniqWith(R,e.isEqual),subtype:Y})},"handleList"),a=u(v=>{switch(v){case"int":return{type:"numeric",mode:"integer"};case"smallint":case"tinyint":case"bigint":case"counter":case"decimal":case"double":case"float":case"varint":return{type:"numeric",mode:v};case"text":case"varchar":case"ascii":case"inet":return{type:"char",mode:v};case"boolean":return{type:"bool"};case"timestamp":case"timeuuid":case"blob":case"date":case"time":case"uuid":return{type:v};case"tuple":case"list":case"set":case"map":return{type:v};default:return{type:"char"}}},"getAppType"),c=u((v,m)=>`${v}<${qO[m]||m}>`,"getSubType"),l=u((v,m,x)=>!m||typeof m!="object"?f(v,x):Object.keys(m).reduce((w,B)=>Object.assign({},w,{[B]:t(v,x,m[B])}),{}),"getProperties"),f=u((v,m)=>{let x=t(v,m);return{[x.refName||UO]:e.omit(x,"refName")}},"getDefaultProperties"),h=u(v=>{switch(v){case"smallint":case"tinyint":case"int":case"bigint":case"counter":case"decimal":case"double":case"float":case"varint":return"number";case"text":case"varchar":case"ascii":case"inet":case"timestamp":case"timeuuid":case"blob":case"date":case"time":case"uuid":return"string";case"boolean":return"boolean";case"tuple":case"list":case"set":return"array";case"map":return"object";default:return"string"}},"getJsonType"),d=u((v,m)=>{let w=jC.getDataTypeNameByCode(m.type||m).split("<")[0],B=h(w);return B==="array"?Array.isArray(v):typeof v===B},"isTypeEqual"),g=u((v,m,x)=>!Array.isArray(m)||m.length===0?p(v,x):m.map(w=>t(v,x,w)),"getItems"),p=u((v,m)=>[t(v,m)],"getDefaultItems"),y=u(v=>{let m=Object.keys(v).pop(),x=(v[m]||{}).type;return x||"text"},"getChildTypeByProperties");return{getColumnType:t}}});var eS=_((XV,JC)=>{"use strict";var QC="compaction",ZC="compression",YC="caching",VO=[YC,QC,ZC],XC=u(e=>String(e||"").replace(/[\"\`]/g,"'"),"changeQuotes"),MO=u((e,t)=>{switch(e){case QC:return HO(t);case YC:return $O(t);case ZC:return KO(t);default:return null}},"handleSpecialOption"),KO=u(e=>{let{compression:t}=e;return XC(JSON.stringify(t))},"handleCompressionOption"),HO=u(e=>{let{compactionClass:t,compactionOptions:r}=e,n=Object.assign({},{class:t},r);return XC(JSON.stringify(n))},"handleCompactionOption"),$O=u(e=>{let t=JSON.parse(e.caching);return{keys:t.keys,rowsPerPartition:t.rows_per_partition}},"handleCashingOption"),GO=u(e=>(t,r)=>{let n=r.propertyKeyword;if(VO.includes(n)){let i=MO(n,e);return Object.assign({},t,{[n]:i})}return e.hasOwnProperty(n)?Object.assign({},t,{[n]:e[n]}):t},"generateTableOptionsReducer");JC.exports={createTableOptionsFromMeta(e,t){return t.reduce(GO(e),{})}}});var nS=_((eM,rS)=>{"use strict";var tS=Ju(),pd=class pd extends tS.policies.retry.RetryPolicy{constructor(t){super(),this.hackoladeLogger=t}onReadTimeout(t,r,n,i,s){let a=t.nbRetry;return this.hackoladeLogger&&this.hackoladeLogger.log("info",{exception:"Read timeout",respondedNodes:n,needNodesForSuccess:i,query:t.query,nbRetry:t.nbRetry,isLastTry:a>2},"Retry policy info"),a>2?this.rethrowResult():this.retryResult(tS.types.consistencies.one)}onUnavailable(t,r,n,i,s){return this.hackoladeLogger&&this.hackoladeLogger.log("info",{exception:"Unavailable",query:t.query,nbRetry:t.nbRetry,isLastTry:t.nbRetry>0},"Retry policy info"),t.nbRetry>0?this.rethrowResult():this.retryResult(void 0,!1)}onRequestError=function(t,r,n){return this.hackoladeLogger&&this.hackoladeLogger.log("info",{exception:"Request error",query:t.query,nbRetry:t.nbRetry,error:{...n}},"Retry policy info"),this.retryResult(void 0,!1)}};u(pd,"CassandraRetryPolicy");var hd=pd;rS.exports=hd});var sS=_((rM,iS)=>{"use strict";iS.exports=e=>{let t=u((o,a,c)=>{if(e.isUndefined(c))return a;if((c==null?void 0:c.type)!=="reference")return Array.isArray(a)&&c.items?((c==null?void 0:c.type)==="tuple"?n:r)(c.items,a):e.isPlainObject(a)?i(c.properties||{},a):a},"handleItem"),r=u((o,a)=>a.map(c=>t(o,c,o==null?void 0:o[0])).filter(c=>!e.isBoolean(c)&&!e.isEmpty(c)),"handleItems"),n=u((o,a)=>{let c=a.map((l,f)=>t(o,l,o==null?void 0:o[f]));return c.some(l=>l===void 0)?[]:c},"handleTuple"),i=u((o,a)=>e.isPlainObject(a)?Object.entries(a).reduce((c,[l,f])=>{let h=o==null?void 0:o[l],d=h==null?void 0:h.type;return(d==="list"||d==="set")&&h.items?{...c,[l]:r(h.items,f)}:d==="tuple"&&h.items?{...c,[l]:n(h.items,f)}:d==="map"&&h.properties?{...c,[l]:i(h.properties,f)}:{...c,[l]:f}},{}):a,"filterUdt");return{filterUdts:u((o,a)=>a.map(c=>i(o,c)),"filterUdts")}}});var aS=_((iM,oS)=>{var jO=require("crypto"),gd=class gd{constructor(t){this.hash=this.getPreKeyedHash(t),this.password=t}update(t){this.hash.update(t)}digest(){return this.hash.digest()}getPreKeyedHash(t){let r=jO.createHash("sha1"),n=Buffer.alloc(t.length*2);for(let i=0,s=0;i<t.length;i++)n[s++]=t[i].charCodeAt()>>8,n[s++]=t[i].charCodeAt();return r.update(n),r.update(Buffer.from("Mighty Aphrodite")),r}};u(gd,"PasswordDigest");var dd=gd;oS.exports=dd});var Ms=_((oM,uS)=>{var zO=u((e,t,r)=>Uint8Array.prototype.slice?Uint8Array.prototype.slice.call(e,t,r):e.slice(t,r),"sliceBuffer");uS.exports=zO});var fS=_((uM,lS)=>{var yd=4294967296,cS=[];for(Ks=0;Ks<256;Ks++)cS[Ks]=(Ks>15?"":"0")+Ks.toString(16);var Ks,sa=lS.exports=function(e,t){e instanceof Buffer?(this.buffer=e,this.offset=t||0):Object.prototype.toString.call(e)=="[object Uint8Array]"?(this.buffer=new Buffer(e),this.offset=t||0):(this.buffer=this.buffer||new Buffer(8),this.offset=0,this.setValue.apply(this,arguments))};sa.MAX_INT=Math.pow(2,53);sa.MIN_INT=-Math.pow(2,53);sa.prototype={constructor:sa,_2scomp:function(){for(var e=this.buffer,t=this.offset,r=1,n=t+7;n>=t;n--){var i=(e[n]^255)+r;e[n]=i&255,r=i>>8}},setValue:function(e,t){var r=!1;if(arguments.length==1)if(typeof e=="number"){if(r=e<0,e=Math.abs(e),t=e%yd,e=e/yd,e>yd)throw new RangeError(e+" is outside Int64 range");e=e|0}else if(typeof e=="string")e=(e+"").replace(/^0x/,""),t=e.substr(-8),e=e.length>8?e.substr(0,e.length-8):"",e=parseInt(e,16),t=parseInt(t,16);else throw new Error(e+" must be a Number or String");for(var n=this.buffer,i=this.offset,s=7;s>=0;s--)n[i+s]=t&255,t=s==4?e:t>>>8;r&&this._2scomp()},toNumber:function(e){for(var t=this.buffer,r=this.offset,n=t[r]&128,i=0,s=1,o=7,a=1;o>=0;o--,a*=256){var c=t[r+o];n&&(c=(c^255)+s,s=c>>8,c=c&255),i+=c*a}return!e&&i>=sa.MAX_INT?n?-1/0:1/0:n?-i:i},valueOf:function(){return this.toNumber(!1)},toString:function(e){return this.valueOf().toString(e||10)},toOctetString:function(e){for(var t=new Array(8),r=this.buffer,n=this.offset,i=0;i<8;i++)t[i]=cS[r[n+i]];return t.join(e||"")},toBuffer:function(e){if(e&&this.offset===0)return this.buffer;var t=new Buffer(8);return this.buffer.copy(t,0,this.offset,this.offset+8),t},copy:function(e,t){this.buffer.copy(e,t||0,this.offset,this.offset+8)},compare:function(e){if((this.buffer[this.offset]&128)!=(e.buffer[e.offset]&128))return e.buffer[e.offset]-this.buffer[this.offset];for(var t=0;t<8;t++)if(this.buffer[this.offset+t]!==e.buffer[e.offset+t])return this.buffer[this.offset+t]-e.buffer[e.offset+t];return 0},equals:function(e){return this.compare(e)===0},inspect:function(){return"[Int64 value:"+this+" octets:"+this.toOctetString(" ")+"]"}}});var ji=_((cM,hS)=>{var WO=fS(),QO=Ms(),vd=class vd{constructor(t){this.buffer=Buffer.from(t),this.offset=0}readInt(){return this.buffer.readUInt32BE(this.shift(4))}readUTF(){let t=this.buffer.readUInt16BE(this.shift(2));return this.read(t).toString()}read(t){return QO(this.buffer,this.offset,this.shift(t)+t)}readLong(){let t=this.read(8);return typeof t.readBigUInt64BE=="function"?t.readBigUInt64BE():+new WO(t).toString()}readByte(){return this.buffer.readUInt8(this.shift(1))}readShort(){return this.read(2).readUInt16BE()}shift(t){let r=this.offset;return this.offset+=t,r}available(){return this.buffer.length-this.offset}};u(vd,"InputStream");var md=vd;hS.exports=md});var dS=_((fM,pS)=>{var ZO=Ms(),YO=ji(),Cd=class Cd extends YO{constructor(t,r){super(t),this.digest=r}readInt(){return this.updateDigest(4),super.readInt()}readUTF(){return this.updateDigest(2),super.readUTF()}read(t){return this.updateDigest(t),super.read(t)}readLong(){return super.readLong()}readByte(){return this.updateDigest(1),super.readByte()}updateDigest(t){this.digest.update(ZO(this.buffer,this.offset,this.offset+t))}};u(Cd,"DigestInputStream");var Ed=Cd;pS.exports=Ed});var yS=_((pM,gS)=>{var xd=class xd{constructor({certType:t,value:r}){this.certType=t,this.value=r}};u(xd,"Certificate");var Sd=xd;gS.exports=Sd});var wd=_((gM,mS)=>{var _d=class _d{constructor({alias:t,date:r,chain:n,protectedPrivateKey:i}){this.certType="X.509",this.alias=t,this.date=r,this.chain=n,this.protectedPrivateKey=i}};u(_d,"KeyEntry");var Td=_d;mS.exports=Td});var Ad=_((mM,vS)=>{var Id=class Id{constructor({alias:t,date:r,cert:n}){this.certType="X.509",this.alias=t,this.date=r,this.cert=n}};u(Id,"TrustedKeyEntry");var bd=Id;vS.exports=bd});var CS=_((EM,ES)=>{var XO=aS(),JO=dS(),e4=ji(),t4=yS(),r4=wd(),n4=Ad(),i4=Ms(),qn=class qn{constructor(t,r){this.keystore=t,this.password=r,r?(this.messageDigest=new XO(r),this.dataInputStream=new JO(t,this.messageDigest)):this.dataInputStream=new e4(t)}assertMagic(t){if(t!==qn.MAGIC)throw new Error("Invalid keystore format")}assertVersion(t){if(t!==qn.VERSION_1&&t!==qn.VERSION_2)throw new Error("Invalid keystore format")}parse(){let t=this.dataInputStream.readInt(),r=this.dataInputStream.readInt();this.assertMagic(t),this.assertVersion(r);let n=this.dataInputStream.readInt(),i=[];for(let s=0;s<n;s++){let o=this.dataInputStream.readInt(),a=this.dataInputStream.readUTF(),c=new Date(+this.dataInputStream.readLong().toString());if(o===qn.PRIVATE_KEY_TAG){let l=this.getPrivateKeyEntry(),f=this.readCertificateChain(r),h=new r4({alias:a,date:c,chain:f,protectedPrivateKey:l});i.push(h)}else if(o===qn.TRUSTED_CERT_TAG){let l=this.readCert(r),f=new n4({alias:a,date:c,cert:l});i.push(f)}else throw new Error("Unrecognized keystore entry")}return this.validateChecksum(),i}validateChecksum(){if(!this.password)return;let t=this.messageDigest.digest(),r=i4(this.dataInputStream.buffer,this.dataInputStream.offset,this.dataInputStream.offset+t.length);if(!t.every((i,s)=>r[s]===i))throw new Error("Password verification failed")}getPrivateKeyEntry(){return this.dataInputStream.read(this.dataInputStream.readInt())}readCert(t){let r="X.509";t===qn.VERSION_2&&(r=this.dataInputStream.readUTF());let n=this.dataInputStream.read(this.dataInputStream.readInt());return new t4({certType:r,value:n})}readCertificateChain(t){let r=this.dataInputStream.readInt(),n=[];for(let i=0;i<r;i++)n.push(this.readCert(t));return n}};u(qn,"JavaKeyStoreParser");var ai=qn;ai.MAGIC=4277010157;ai.VERSION_1=1;ai.VERSION_2=2;ai.PRIVATE_KEY_TAG=1;ai.TRUSTED_CERT_TAG=2;ES.exports=ai});var fe=_((SM,SS)=>{SS.exports={options:{usePureJavaScript:!1}}});var _S=_((xM,TS)=>{var Bd={};TS.exports=Bd;var xS={};Bd.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=s4(e,t);else{var i=0,s=t.length,o=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var c=0,l=e[i];c<a.length;++c)l+=a[c]<<8,a[c]=l%s,l=l/s|0;for(;l>0;)a.push(l%s),l=l/s|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}if(r){var f=new RegExp(".{1,"+r+"}","g");n=n.match(f).join(`\r
`)}return n};Bd.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=xS[t];if(!r){r=xS[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,s=t.charAt(0),o=[0],n=0;n<e.length;n++){var a=r[e.charCodeAt(n)];if(a===void 0)return;for(var c=0,l=a;c<o.length;++c)l+=o[c]*i,o[c]=l&255,l>>=8;for(;l>0;)o.push(l&255),l>>=8}for(var f=0;e[f]===s&&f<e.length-1;++f)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function s4(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=t[s[r]];return c}u(s4,"_encodeWithByteBuffer")});var Ae=_((_M,AS)=>{var wS=fe(),bS=_S(),A=AS.exports=wS.util=wS.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){A.nextTick=process.nextTick,typeof setImmediate=="function"?A.setImmediate=setImmediate:A.setImmediate=A.nextTick;return}if(typeof setImmediate=="function"){A.setImmediate=function(){return setImmediate.apply(void 0,arguments)},A.nextTick=function(a){return setImmediate(a)};return}if(A.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===e){c.stopPropagation();var l=t.slice();t.length=0,l.forEach(function(f){f()})}};var o=a;u(a,"handler");var e="forge.setImmediate",t=[];A.setImmediate=function(c){t.push(c),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var c=t.slice();t.length=0,c.forEach(function(l){l()})}).observe(i,{attributes:!0});var s=A.setImmediate;A.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(t.push(c),t.length===1&&i.setAttribute("a",n=!n))}}A.nextTick=A.setImmediate})();A.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;A.globalScope=function(){return A.isNodejs?global:typeof self>"u"?window:self}();A.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};A.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};A.isArrayBufferView=function(e){return e&&A.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function oa(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}u(oa,"_checkBitsParam");A.ByteBuffer=Nd;function Nd(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(A.isArrayBuffer(e)||A.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof Nd||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}u(Nd,"ByteStringBuffer");A.ByteStringBuffer=Nd;var o4=4096;A.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>o4&&(this.data.substr(0,1),this._constructedStringLength=0)};A.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};A.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};A.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};A.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};A.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};A.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(A.encodeUtf8(e))};A.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};A.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};A.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};A.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};A.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};A.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};A.ByteStringBuffer.prototype.putInt=function(e,t){oa(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};A.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};A.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};A.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};A.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};A.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};A.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};A.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};A.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};A.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};A.ByteStringBuffer.prototype.getInt=function(e){oa(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};A.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};A.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};A.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};A.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};A.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};A.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};A.ByteStringBuffer.prototype.copy=function(){var e=A.createBuffer(this.data);return e.read=this.read,e};A.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};A.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};A.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};A.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};A.ByteStringBuffer.prototype.toString=function(){return A.decodeUtf8(this.bytes())};function a4(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=A.isArrayBuffer(e),n=A.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}u(a4,"DataBuffer");A.DataBuffer=a4;A.DataBuffer.prototype.length=function(){return this.write-this.read};A.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};A.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};A.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};A.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};A.DataBuffer.prototype.putBytes=function(e,t){if(A.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(A.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof A.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&A.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof A.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var s;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=A.binary.hex.decode(e,s,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=A.binary.base64.decode(e,s,this.write),this;if(t==="utf8"&&(e=A.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=A.binary.raw.decode(s),this;if(t==="utf16")return this.accommodate(e.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=A.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};A.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};A.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};A.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};A.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};A.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};A.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};A.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};A.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};A.DataBuffer.prototype.putInt=function(e,t){oa(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};A.DataBuffer.prototype.putSignedInt=function(e,t){return oa(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};A.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};A.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};A.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};A.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};A.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};A.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};A.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};A.DataBuffer.prototype.getInt=function(e){oa(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};A.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};A.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};A.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};A.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};A.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};A.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};A.DataBuffer.prototype.copy=function(){return new A.DataBuffer(this)};A.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};A.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};A.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};A.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};A.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return A.binary.raw.encode(t);if(e==="hex")return A.binary.hex.encode(t);if(e==="base64")return A.binary.base64.encode(t);if(e==="utf8")return A.text.utf8.decode(t);if(e==="utf16")return A.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};A.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=A.encodeUtf8(e)),new A.ByteBuffer(e)};A.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};A.xorBytes=function(e,t,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=e.charCodeAt(o)^t.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};A.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};A.bytesToHex=function(e){return A.createBuffer(e).toHex()};A.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var ui="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ci=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],IS="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";A.encode64=function(e,t){for(var r="",n="",i,s,o,a=0;a<e.length;)i=e.charCodeAt(a++),s=e.charCodeAt(a++),o=e.charCodeAt(a++),r+=ui.charAt(i>>2),r+=ui.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=ui.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":ui.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};A.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,s,o=0;o<e.length;)r=ci[e.charCodeAt(o++)-43],n=ci[e.charCodeAt(o++)-43],i=ci[e.charCodeAt(o++)-43],s=ci[e.charCodeAt(o++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t};A.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};A.decodeUtf8=function(e){return decodeURIComponent(escape(e))};A.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:bS.encode,decode:bS.decode}};A.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};A.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};A.binary.hex.encode=A.bytesToHex;A.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(e.length&1&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n};A.binary.base64.encode=function(e,t){for(var r="",n="",i,s,o,a=0;a<e.byteLength;)i=e[a++],s=e[a++],o=e[a++],r+=ui.charAt(i>>2),r+=ui.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=ui.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":ui.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};A.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,c=0,l=r;c<e.length;)i=ci[e.charCodeAt(c++)-43],s=ci[e.charCodeAt(c++)-43],o=ci[e.charCodeAt(c++)-43],a=ci[e.charCodeAt(c++)-43],n[l++]=i<<2|s>>4,o!==64&&(n[l++]=(s&15)<<4|o>>2,a!==64&&(n[l++]=(o&3)<<6|a));return t?l-r:n.subarray(0,l)};A.binary.base58.encode=function(e,t){return A.binary.baseN.encode(e,IS,t)};A.binary.base58.decode=function(e,t){return A.binary.baseN.decode(e,IS,t)};A.text={utf8:{},utf16:{}};A.text.utf8.encode=function(e,t,r){e=A.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};A.text.utf8.decode=function(e){return A.decodeUtf8(String.fromCharCode.apply(null,e))};A.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<e.length;++a)i[o++]=e.charCodeAt(a),s+=2;return t?s-r:n};A.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};A.deflate=function(e,t,r){if(t=A.decode64(e.deflate(A.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};A.inflate=function(e,t,r){var n=e.inflate(A.encode64(t)).rval;return n===null?null:A.decode64(n)};var Rd=u(function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=A.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},"_setStorageObject"),Dd=u(function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(A.decode64(r))),r},"_getStorageObject"),u4=u(function(e,t,r,n){var i=Dd(e,t);i===null&&(i={}),i[r]=n,Rd(e,t,i)},"_setItem"),c4=u(function(e,t,r){var n=Dd(e,t);return n!==null&&(n=r in n?n[r]:null),n},"_getItem"),l4=u(function(e,t,r){var n=Dd(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Rd(e,t,n)}},"_removeItem"),f4=u(function(e,t){Rd(e,t,null)},"_clearItems"),ec=u(function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),s=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return n},"_callStorageFunction");A.setItem=function(e,t,r,n,i){ec(u4,arguments,i)};A.getItem=function(e,t,r,n){return ec(c4,arguments,n)};A.removeItem=function(e,t,r,n){ec(l4,arguments,n)};A.clearItems=function(e,t,r){ec(f4,arguments,r)};A.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};A.format=function(e){for(var t=/%./g,r,n,i=0,s=[],o=0;r=t.exec(e);){n=e.substring(o,t.lastIndex-2),n.length>0&&s.push(n),o=t.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(e.substring(o)),s.join("")};A.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,o=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",l=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",f=l.length>3?l.length%3:0;return c+(f?l.substr(0,f)+a:"")+l.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-l).toFixed(s).slice(2):"")};A.formatSize=function(e){return e>=1073741824?e=A.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=A.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=A.formatNumber(e/1024,0)+" KiB":e=A.formatNumber(e,0)+" bytes",e};A.bytesFromIP=function(e){return e.indexOf(".")!==-1?A.bytesFromIPv4(e):e.indexOf(":")!==-1?A.bytesFromIPv6(e):null};A.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=A.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};A.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(o){return o.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=A.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=A.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};A.bytesToIP=function(e){return e.length===4?A.bytesToIPv4(e):e.length===16?A.bytesToIPv6(e):null};A.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};A.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=A.bytesToHex(e[i]+e[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=t.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),c.start===0&&t.unshift(""),c.end===7&&t.push(""))}return t.join(":")};A.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in A&&!e.update)return t(null,A.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return A.cores=navigator.hardwareConcurrency,t(null,A.cores);if(typeof Worker>"u")return A.cores=1,t(null,A.cores);if(typeof Blob>"u")return A.cores=2,t(null,A.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var l=Math.floor(o.reduce(function(f,h){return f+h},0)/o.length);return A.cores=Math.max(1,l),URL.revokeObjectURL(r),t(null,A.cores)}i(c,function(f,h){o.push(s(c,h)),n(o,a-1,c)})}u(n,"sample");function i(o,a){for(var c=[],l=[],f=0;f<o;++f){var h=new Worker(r);h.addEventListener("message",function(d){if(l.push(d.data),l.length===o){for(var g=0;g<o;++g)c[g].terminate();a(null,l)}}),c.push(h)}for(var f=0;f<o;++f)c[f].postMessage(f)}u(i,"map");function s(o,a){for(var c=[],l=0;l<o;++l)for(var f=a[l],h=c[l]=[],d=0;d<o;++d)if(l!==d){var g=a[d];(f.st>g.st&&f.st<g.et||g.st>f.st&&g.st<f.et)&&h.push(d)}return c.reduce(function(p,y){return Math.max(p,y.length)},0)}u(s,"reduce")}});var tc=_((bM,BS)=>{var Ut=fe();Ae();BS.exports=Ut.cipher=Ut.cipher||{};Ut.cipher.algorithms=Ut.cipher.algorithms||{};Ut.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Ut.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Ut.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};Ut.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Ut.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Ut.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};Ut.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),Ut.cipher.algorithms[e]=t};Ut.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in Ut.cipher.algorithms?Ut.cipher.algorithms[e]:null};var Ld=Ut.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};Ld.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=Ut.util.createBuffer(),this.output=e.output||Ut.util.createBuffer(),this.mode.start(t)};Ld.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Ld.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var Fd=_((IM,NS)=>{var Vt=fe();Ae();Vt.cipher=Vt.cipher||{};var ge=NS.exports=Vt.cipher.modes=Vt.cipher.modes||{};ge.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};ge.ecb.prototype.start=function(e){};ge.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};ge.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};ge.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};ge.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};ge.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};ge.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=rc(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};ge.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};ge.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};ge.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};ge.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};ge.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Vt.util.createBuffer(),this._partialBytes=0};ge.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=rc(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ge.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};ge.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};ge.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Vt.util.createBuffer(),this._partialBytes=0};ge.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=rc(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ge.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};ge.ofb.prototype.decrypt=ge.ofb.prototype.encrypt;ge.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Vt.util.createBuffer(),this._partialBytes=0};ge.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=rc(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ge.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}nc(this._inBlock)};ge.ctr.prototype.decrypt=ge.ctr.prototype.encrypt;ge.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Vt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};ge.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Vt.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=Vt.util.createBuffer(e.additionalData):r=Vt.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Vt.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Od(n*8)))}this._inBlock=this._j0.slice(0),nc(this._inBlock),this._partialBytes=0,r=Vt.util.createBuffer(r),this._aDataLength=Od(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};ge.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),nc(this._inBlock)};ge.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),nc(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};ge.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Vt.util.createBuffer();var n=this._aDataLength.concat(Od(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};ge.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};ge.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};ge.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t};ge.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};ge.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,l=(n-1-o%n)*t;a[c]=1<<t-1<<l,s[o]=this.generateSubHashTable(this.multiply(a,e),t)}return s};ge.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var l=i[s^n];i[s]=[e[0]^l[0],e[1]^l[1],e[2]^l[2],e[3]^l[3]]}return i};function rc(e,t){if(typeof e=="string"&&(e=Vt.util.createBuffer(e)),Vt.util.isArray(e)&&e.length>4){var r=e;e=Vt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Vt.util.isArray(e)){for(var i=[],s=t/4,n=0;n<s;++n)i.push(e.getInt32());e=i}return e}u(rc,"transformIV");function nc(e){e[e.length-1]=e[e.length-1]+1&4294967295}u(nc,"inc32");function Od(e){return[e/4294967296|0,e&4294967295]}u(Od,"from64To32")});var li=_((BM,OS)=>{var He=fe();tc();Fd();Ae();OS.exports=He.aes=He.aes||{};He.aes.startEncrypting=function(e,t,r,n){var i=ic({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};He.aes.createEncryptionCipher=function(e,t){return ic({key:e,output:null,decrypt:!1,mode:t})};He.aes.startDecrypting=function(e,t,r,n){var i=ic({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};He.aes.createDecryptionCipher=function(e,t){return ic({key:e,output:null,decrypt:!0,mode:t})};He.aes.Algorithm=function(e,t){qd||DS();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return kd(r._w,n,i,!1)},decrypt:function(n,i){return kd(r._w,n,i,!0)}}}),r._init=!1};He.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=He.util.createBuffer(t);else if(He.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=He.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!He.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!He.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=LS(t,e.decrypt&&!o),this._init=!0}};He.aes._expandKey=function(e,t){return qd||DS(),LS(e,t)};He.aes._updateBlock=kd;$s("AES-ECB",He.cipher.modes.ecb);$s("AES-CBC",He.cipher.modes.cbc);$s("AES-CFB",He.cipher.modes.cfb);$s("AES-OFB",He.cipher.modes.ofb);$s("AES-CTR",He.cipher.modes.ctr);$s("AES-GCM",He.cipher.modes.gcm);function $s(e,t){var r=u(function(){return new He.aes.Algorithm(e,t)},"factory");He.cipher.registerAlgorithm(e,r)}u($s,"registerAlgorithm");var qd=!1,Hs=4,cr,Pd,RS,zi,sn;function DS(){qd=!0,RS=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;cr=new Array(256),Pd=new Array(256),zi=new Array(4),sn=new Array(4);for(var t=0;t<4;++t)zi[t]=new Array(256),sn[t]=new Array(256);for(var r=0,n=0,i,s,o,a,c,l,f,t=0;t<256;++t){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,cr[r]=a,Pd[a]=r,c=e[a],i=e[r],s=e[i],o=e[s],l=c<<24^a<<16^a<<8^(a^c),f=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var h=0;h<4;++h)zi[h][r]=l,sn[h][a]=f,l=l<<24|l>>>8,f=f<<24|f>>>8;r===0?r=n=1:(r=i^e[e[e[i^o]]],n^=e[e[n]])}}u(DS,"initialize");function LS(e,t){for(var r=e.slice(0),n,i=1,s=r.length,o=s+6+1,a=Hs*o,c=s;c<a;++c)n=r[c-1],c%s===0?(n=cr[n>>>16&255]<<24^cr[n>>>8&255]<<16^cr[n&255]<<8^cr[n>>>24]^RS[i]<<24,i++):s>6&&c%s===4&&(n=cr[n>>>24]<<24^cr[n>>>16&255]<<16^cr[n>>>8&255]<<8^cr[n&255]),r[c]=r[c-s]^n;if(t){var l,f=sn[0],h=sn[1],d=sn[2],g=sn[3],p=r.slice(0);a=r.length;for(var c=0,y=a-Hs;c<a;c+=Hs,y-=Hs)if(c===0||c===a-Hs)p[c]=r[y],p[c+1]=r[y+3],p[c+2]=r[y+2],p[c+3]=r[y+1];else for(var v=0;v<Hs;++v)l=r[y+v],p[c+(3&-v)]=f[cr[l>>>24]]^h[cr[l>>>16&255]]^d[cr[l>>>8&255]]^g[cr[l&255]];r=p}return r}u(LS,"_expandKey");function kd(e,t,r,n){var i=e.length/4-1,s,o,a,c,l;n?(s=sn[0],o=sn[1],a=sn[2],c=sn[3],l=Pd):(s=zi[0],o=zi[1],a=zi[2],c=zi[3],l=cr);var f,h,d,g,p,y,v;f=t[0]^e[0],h=t[n?3:1]^e[1],d=t[2]^e[2],g=t[n?1:3]^e[3];for(var m=3,x=1;x<i;++x)p=s[f>>>24]^o[h>>>16&255]^a[d>>>8&255]^c[g&255]^e[++m],y=s[h>>>24]^o[d>>>16&255]^a[g>>>8&255]^c[f&255]^e[++m],v=s[d>>>24]^o[g>>>16&255]^a[f>>>8&255]^c[h&255]^e[++m],g=s[g>>>24]^o[f>>>16&255]^a[h>>>8&255]^c[d&255]^e[++m],f=p,h=y,d=v;r[0]=l[f>>>24]<<24^l[h>>>16&255]<<16^l[d>>>8&255]<<8^l[g&255]^e[++m],r[n?3:1]=l[h>>>24]<<24^l[d>>>16&255]<<16^l[g>>>8&255]<<8^l[f&255]^e[++m],r[2]=l[d>>>24]<<24^l[g>>>16&255]<<16^l[f>>>8&255]<<8^l[h&255]^e[++m],r[n?1:3]=l[g>>>24]<<24^l[f>>>16&255]<<16^l[h>>>8&255]<<8^l[d&255]^e[++m]}u(kd,"_updateBlock");function ic(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=He.cipher.createDecipher(r,e.key):n=He.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof He.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}u(ic,"_createCipher")});var fi=_((RM,FS)=>{var aa=fe();aa.pki=aa.pki||{};var Ud=FS.exports=aa.pki.oids=aa.oids=aa.oids||{};function V(e,t){Ud[e]=t,Ud[t]=e}u(V,"_IN");function Le(e,t){Ud[e]=t}u(Le,"_I_");V("1.2.840.113549.1.1.1","rsaEncryption");V("1.2.840.113549.1.1.4","md5WithRSAEncryption");V("1.2.840.113549.1.1.5","sha1WithRSAEncryption");V("1.2.840.113549.1.1.7","RSAES-OAEP");V("1.2.840.113549.1.1.8","mgf1");V("1.2.840.113549.1.1.9","pSpecified");V("1.2.840.113549.1.1.10","RSASSA-PSS");V("1.2.840.113549.1.1.11","sha256WithRSAEncryption");V("1.2.840.113549.1.1.12","sha384WithRSAEncryption");V("1.2.840.113549.1.1.13","sha512WithRSAEncryption");V("1.3.101.112","EdDSA25519");V("1.2.840.10040.4.3","dsa-with-sha1");V("1.3.14.3.2.7","desCBC");V("1.3.14.3.2.26","sha1");V("1.3.14.3.2.29","sha1WithRSASignature");V("2.16.840.1.101.3.4.2.1","sha256");V("2.16.840.1.101.3.4.2.2","sha384");V("2.16.840.1.101.3.4.2.3","sha512");V("2.16.840.1.101.3.4.2.4","sha224");V("2.16.840.1.101.3.4.2.5","sha512-224");V("2.16.840.1.101.3.4.2.6","sha512-256");V("1.2.840.113549.2.2","md2");V("1.2.840.113549.2.5","md5");V("1.2.840.113549.1.7.1","data");V("1.2.840.113549.1.7.2","signedData");V("1.2.840.113549.1.7.3","envelopedData");V("1.2.840.113549.1.7.4","signedAndEnvelopedData");V("1.2.840.113549.1.7.5","digestedData");V("1.2.840.113549.1.7.6","encryptedData");V("1.2.840.113549.1.9.1","emailAddress");V("1.2.840.113549.1.9.2","unstructuredName");V("1.2.840.113549.1.9.3","contentType");V("1.2.840.113549.1.9.4","messageDigest");V("1.2.840.113549.1.9.5","signingTime");V("1.2.840.113549.1.9.6","counterSignature");V("1.2.840.113549.1.9.7","challengePassword");V("1.2.840.113549.1.9.8","unstructuredAddress");V("1.2.840.113549.1.9.14","extensionRequest");V("1.2.840.113549.1.9.20","friendlyName");V("1.2.840.113549.1.9.21","localKeyId");V("1.2.840.113549.1.9.22.1","x509Certificate");V("1.2.840.113549.1.12.10.1.1","keyBag");V("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");V("1.2.840.113549.1.12.10.1.3","certBag");V("1.2.840.113549.1.12.10.1.4","crlBag");V("1.2.840.113549.1.12.10.1.5","secretBag");V("1.2.840.113549.1.12.10.1.6","safeContentsBag");V("1.2.840.113549.1.5.13","pkcs5PBES2");V("1.2.840.113549.1.5.12","pkcs5PBKDF2");V("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");V("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");V("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");V("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");V("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");V("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");V("1.2.840.113549.2.7","hmacWithSHA1");V("1.2.840.113549.2.8","hmacWithSHA224");V("1.2.840.113549.2.9","hmacWithSHA256");V("1.2.840.113549.2.10","hmacWithSHA384");V("1.2.840.113549.2.11","hmacWithSHA512");V("1.2.840.113549.3.7","des-EDE3-CBC");V("2.16.840.1.101.3.4.1.2","aes128-CBC");V("2.16.840.1.101.3.4.1.22","aes192-CBC");V("2.16.840.1.101.3.4.1.42","aes256-CBC");V("2.5.4.3","commonName");V("2.5.4.4","surname");V("2.5.4.5","serialNumber");V("2.5.4.6","countryName");V("2.5.4.7","localityName");V("2.5.4.8","stateOrProvinceName");V("2.5.4.9","streetAddress");V("2.5.4.10","organizationName");V("2.5.4.11","organizationalUnitName");V("2.5.4.12","title");V("2.5.4.13","description");V("2.5.4.15","businessCategory");V("2.5.4.17","postalCode");V("2.5.4.42","givenName");V("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");V("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");V("2.16.840.1.113730.1.1","nsCertType");V("2.16.840.1.113730.1.13","nsComment");Le("2.5.29.1","authorityKeyIdentifier");Le("2.5.29.2","keyAttributes");Le("2.5.29.3","certificatePolicies");Le("2.5.29.4","keyUsageRestriction");Le("2.5.29.5","policyMapping");Le("2.5.29.6","subtreesConstraint");Le("2.5.29.7","subjectAltName");Le("2.5.29.8","issuerAltName");Le("2.5.29.9","subjectDirectoryAttributes");Le("2.5.29.10","basicConstraints");Le("2.5.29.11","nameConstraints");Le("2.5.29.12","policyConstraints");Le("2.5.29.13","basicConstraints");V("2.5.29.14","subjectKeyIdentifier");V("2.5.29.15","keyUsage");Le("2.5.29.16","privateKeyUsagePeriod");V("2.5.29.17","subjectAltName");V("2.5.29.18","issuerAltName");V("2.5.29.19","basicConstraints");Le("2.5.29.20","cRLNumber");Le("2.5.29.21","cRLReason");Le("2.5.29.22","expirationDate");Le("2.5.29.23","instructionCode");Le("2.5.29.24","invalidityDate");Le("2.5.29.25","cRLDistributionPoints");Le("2.5.29.26","issuingDistributionPoint");Le("2.5.29.27","deltaCRLIndicator");Le("2.5.29.28","issuingDistributionPoint");Le("2.5.29.29","certificateIssuer");Le("2.5.29.30","nameConstraints");V("2.5.29.31","cRLDistributionPoints");V("2.5.29.32","certificatePolicies");Le("2.5.29.33","policyMappings");Le("2.5.29.34","policyConstraints");V("2.5.29.35","authorityKeyIdentifier");Le("2.5.29.36","policyConstraints");V("2.5.29.37","extKeyUsage");Le("2.5.29.46","freshestCRL");Le("2.5.29.54","inhibitAnyPolicy");V("1.3.6.1.4.1.11129.2.4.2","timestampList");V("1.3.6.1.5.5.7.1.1","authorityInfoAccess");V("1.3.6.1.5.5.7.3.1","serverAuth");V("1.3.6.1.5.5.7.3.2","clientAuth");V("1.3.6.1.5.5.7.3.3","codeSigning");V("1.3.6.1.5.5.7.3.4","emailProtection");V("1.3.6.1.5.5.7.3.8","timeStamping")});var on=_((LM,kS)=>{var We=fe();Ae();fi();var j=kS.exports=We.asn1=We.asn1||{};j.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};j.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};j.create=function(e,t,r,n,i){if(We.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:e,type:t,constructed:r,composed:r||We.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=j.copy(a)),a};j.copy=function(e,t){var r;if(We.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(j.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:j.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};j.equals=function(e,t,r){if(We.util.isArray(e)){if(!We.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!j.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&j.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};j.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function ua(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}u(ua,"_checkBufferLength");var h4=u(function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;ua(e,t,s),n=e.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}},"_getValueLength");j.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=We.util.createBuffer(e));var r=e.length(),n=sc(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function sc(e,t,r,n){var i;ua(e,t,2);var s=e.getByte();t--;var o=s&192,a=s&31;i=e.length();var c=h4(e,t);if(t-=i-e.length(),c!==void 0&&c>t){if(n.strict){var l=new Error("Too few bytes to read ASN.1 value.");throw l.available=e.length(),l.remaining=t,l.requested=c,l}c=t}var f,h,d=(s&32)===32;if(d)if(f=[],c===void 0)for(;;){if(ua(e,t,2),e.bytes(2)==="\0\0"){e.getBytes(2),t-=2;break}i=e.length(),f.push(sc(e,t,r+1,n)),t-=i-e.length()}else for(;c>0;)i=e.length(),f.push(sc(e,c,r+1,n)),t-=i-e.length(),c-=i-e.length();if(f===void 0&&o===j.Class.UNIVERSAL&&a===j.Type.BITSTRING&&(h=e.bytes(c)),f===void 0&&n.decodeBitStrings&&o===j.Class.UNIVERSAL&&a===j.Type.BITSTRING&&c>1){var g=e.read,p=t,y=0;if(a===j.Type.BITSTRING&&(ua(e,t,1),y=e.getByte(),t--),y===0)try{i=e.length();var v={strict:!0,decodeBitStrings:!0},m=sc(e,t,r+1,v),x=i-e.length();t-=x,a==j.Type.BITSTRING&&x++;var w=m.tagClass;x===c&&(w===j.Class.UNIVERSAL||w===j.Class.CONTEXT_SPECIFIC)&&(f=[m])}catch{}f===void 0&&(e.read=g,t=p)}if(f===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=t}if(a===j.Type.BMPSTRING)for(f="";c>0;c-=2)ua(e,t,2),f+=String.fromCharCode(e.getInt16()),t-=2;else f=e.getBytes(c),t-=c}var B=h===void 0?null:{bitStringContents:h};return j.create(o,a,d,f,B)}u(sc,"_fromDer");j.toDer=function(e){var t=We.util.createBuffer(),r=e.tagClass|e.type,n=We.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=j.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var s=0;s<e.value.length;++s)e.value[s]!==void 0&&n.putBuffer(j.toDer(e.value[s]))}else if(e.type===j.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)n.putInt16(e.value.charCodeAt(s));else e.type===j.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);t.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)t.putByte(a.charCodeAt(s))}return t.putBuffer(n),t};j.oidToDer=function(e){var t=e.split("."),r=We.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,o,a=2;a<t.length;++a){n=!0,i=[],s=parseInt(t[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};j.derToOid=function(e){var t;typeof e=="string"&&(e=We.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};j.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),l=10;c!=="+"&&c!=="-"&&(a=parseInt(e.substr(10,2),10),l+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,0),l&&(c=e.charAt(l),c==="+"||c==="-")){var f=parseInt(e.substr(l+1,2),10),h=parseInt(e.substr(l+4,2),10),d=f*60+h;d*=6e4,c==="+"?t.setTime(+t-d):t.setTime(+t+d)}return t};j.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,l=0,f=!1;e.charAt(e.length-1)==="Z"&&(f=!0);var h=e.length-5,d=e.charAt(h);if(d==="+"||d==="-"){var g=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);l=g*60+p,l*=6e4,d==="+"&&(l*=-1),f=!0}return e.charAt(14)==="."&&(c=parseFloat(e.substr(14),10)*1e3),f?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,c),t.setTime(+t+l)):(t.setFullYear(r,n,i),t.setHours(s,o,a,c)),t};j.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};j.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};j.integerToDer=function(e){var t=We.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};j.derToInteger=function(e){typeof e=="string"&&(e=We.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};j.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&We.util.isArray(t.value))for(var s=0,o=0;i&&o<t.value.length;++o)i=t.value[o].optional||!1,e.value[s]&&(i=j.validate(e.value[s],t.value[o],r,n),i?++s:t.value[o].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var a;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var c=e.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var PS=/[^\\u0000-\\u00ff]/;j.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",s=0;s<t*r;++s)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case j.Class.UNIVERSAL:n+="Universal:";break;case j.Class.APPLICATION:n+="Application:";break;case j.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case j.Class.PRIVATE:n+="Private:";break}if(e.tagClass===j.Class.UNIVERSAL)switch(n+=e.type,e.type){case j.Type.NONE:n+=" (None)";break;case j.Type.BOOLEAN:n+=" (Boolean)";break;case j.Type.INTEGER:n+=" (Integer)";break;case j.Type.BITSTRING:n+=" (Bit string)";break;case j.Type.OCTETSTRING:n+=" (Octet string)";break;case j.Type.NULL:n+=" (Null)";break;case j.Type.OID:n+=" (Object Identifier)";break;case j.Type.ODESC:n+=" (Object Descriptor)";break;case j.Type.EXTERNAL:n+=" (External or Instance of)";break;case j.Type.REAL:n+=" (Real)";break;case j.Type.ENUMERATED:n+=" (Enumerated)";break;case j.Type.EMBEDDED:n+=" (Embedded PDV)";break;case j.Type.UTF8:n+=" (UTF8)";break;case j.Type.ROID:n+=" (Relative Object Identifier)";break;case j.Type.SEQUENCE:n+=" (Sequence)";break;case j.Type.SET:n+=" (Set)";break;case j.Type.PRINTABLESTRING:n+=" (Printable String)";break;case j.Type.IA5String:n+=" (IA5String (ASCII))";break;case j.Type.UTCTIME:n+=" (UTC time)";break;case j.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case j.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var o=0,a="",s=0;s<e.value.length;++s)e.value[s]!==void 0&&(o+=1,a+=j.prettyPrint(e.value[s],t+1,r),s+1<e.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",e.type===j.Type.OID){var c=j.derToOid(e.value);n+=c,We.pki&&We.pki.oids&&c in We.pki.oids&&(n+=" ("+We.pki.oids[c]+") ")}if(e.type===j.Type.INTEGER)try{n+=j.derToInteger(e.value)}catch{n+="0x"+We.util.bytesToHex(e.value)}else if(e.type===j.Type.BITSTRING){if(e.value.length>1?n+="0x"+We.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var l=e.value.charCodeAt(0);l==1?n+=" (1 unused bit shown)":l>1&&(n+=" ("+l+" unused bits shown)")}}else if(e.type===j.Type.OCTETSTRING)PS.test(e.value)||(n+="("+e.value+") "),n+="0x"+We.util.bytesToHex(e.value);else if(e.type===j.Type.UTF8)try{n+=We.util.decodeUtf8(e.value)}catch(f){if(f.message==="URI malformed")n+="0x"+We.util.bytesToHex(e.value)+" (malformed UTF8)";else throw f}else e.type===j.Type.PRINTABLESTRING||e.type===j.Type.IA5String?n+=e.value:PS.test(e.value)?n+="0x"+We.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var mn=_((FM,qS)=>{var oc=fe();qS.exports=oc.md=oc.md||{};oc.md.algorithms=oc.md.algorithms||{}});var Gs=_((PM,US)=>{var Un=fe();mn();Ae();var p4=US.exports=Un.hmac=Un.hmac||{};p4.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Un.md.algorithms)t=Un.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else t=s;if(o===null)o=e;else{if(typeof o=="string")o=Un.util.createBuffer(o);else if(Un.util.isArray(o)){var a=o;o=Un.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var l=o.length();l>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=Un.util.createBuffer(),n=Un.util.createBuffer(),l=o.length();for(var c=0;c<l;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(l<t.blockLength)for(var a=t.blockLength-l,c=0;c<a;++c)r.putByte(54),n.putByte(92);e=o,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(s){t.update(s)},i.getMac=function(){var s=t.digest().bytes();return t.start(),t.update(n),t.update(s),t.digest()},i.digest=i.getMac,i}});var uc=_((kM,HS)=>{var vn=fe();mn();Ae();var MS=HS.exports=vn.md5=vn.md5||{};vn.md.md5=vn.md.algorithms.md5=MS;MS.create=function(){KS||d4();var e=null,t=vn.util.createBuffer(),r=new Array(16),n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=vn.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=vn.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),VS(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=vn.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Vd.substr(0,n.blockLength-o));for(var a,c=0,l=n.fullMessageLength.length-1;l>=0;--l)a=n.fullMessageLength[l]*8+c,c=a/4294967296>>>0,i.putInt32Le(a>>>0);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};VS(f,r,i);var h=vn.util.createBuffer();return h.putInt32Le(f.h0),h.putInt32Le(f.h1),h.putInt32Le(f.h2),h.putInt32Le(f.h3),h},n};var Vd=null,ac=null,ca=null,js=null,KS=!1;function d4(){Vd="\x80",Vd+=vn.util.fillString("\0",64),ac=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],ca=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],js=new Array(64);for(var e=0;e<64;++e)js[e]=Math.floor(Math.abs(Math.sin(e+1))*4294967296);KS=!0}u(d4,"_init");function VS(e,t,r){for(var n,i,s,o,a,c,l,f,h=r.length();h>=64;){for(i=e.h0,s=e.h1,o=e.h2,a=e.h3,f=0;f<16;++f)t[f]=r.getInt32Le(),c=a^s&(o^a),n=i+c+js[f]+t[f],l=ca[f],i=a,a=o,o=s,s+=n<<l|n>>>32-l;for(;f<32;++f)c=o^a&(s^o),n=i+c+js[f]+t[ac[f]],l=ca[f],i=a,a=o,o=s,s+=n<<l|n>>>32-l;for(;f<48;++f)c=s^o^a,n=i+c+js[f]+t[ac[f]],l=ca[f],i=a,a=o,o=s,s+=n<<l|n>>>32-l;for(;f<64;++f)c=o^(s|~a),n=i+c+js[f]+t[ac[f]],l=ca[f],i=a,a=o,o=s,s+=n<<l|n>>>32-l;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,h-=64}}u(VS,"_update")});var Wi=_((UM,GS)=>{var lc=fe();Ae();var $S=GS.exports=lc.pem=lc.pem||{};$S.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=cc(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=cc(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=cc(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=cc(e.headers[i]);return e.procType&&(r+=`\r
`),r+=lc.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};$S.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(e),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:lc.util.decode64(s[3])};if(t.push(a),!!s[2]){for(var c=s[2].split(i),l=0;s&&l<c.length;){for(var f=c[l].replace(/\s+$/,""),h=l+1;h<c.length;++h){var d=c[h];if(!/\s/.test(d[0]))break;f+=d,l=h}if(s=f.match(n),s){for(var g={name:s[1],values:[]},p=s[2].split(","),y=0;y<p.length;++y)g.values.push(g4(p[y]));if(a.procType)if(!a.contentDomain&&g.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(g);else{if(g.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(g.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++l}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function cc(e){for(var t=e.name+": ",r=[],n=u(function(c,l){return" "+l},"insertSpace"),i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<t.length;++i,++s)if(s>65&&o!==-1){var a=t[o];a===","?(++o,t=t.substr(0,o)+`\r
 `+t.substr(o)):t=t.substr(0,o)+`\r
`+a+t.substr(o+1),s=i-o-1,o=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(o=i);return t}u(cc,"foldHeader");function g4(e){return e.replace(/^\s+/,"")}u(g4,"ltrim")});var la=_((MM,zS)=>{var et=fe();tc();Fd();Ae();zS.exports=et.des=et.des||{};et.des.startEncrypting=function(e,t,r,n){var i=fc({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};et.des.createEncryptionCipher=function(e,t){return fc({key:e,output:null,decrypt:!1,mode:t})};et.des.startDecrypting=function(e,t,r,n){var i=fc({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};et.des.createDecryptionCipher=function(e,t){return fc({key:e,output:null,decrypt:!0,mode:t})};et.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return jS(r._keys,n,i,!1)},decrypt:function(n,i){return jS(r._keys,n,i,!0)}}}),r._init=!1};et.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=et.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=_4(t),this._init=!0}};En("DES-ECB",et.cipher.modes.ecb);En("DES-CBC",et.cipher.modes.cbc);En("DES-CFB",et.cipher.modes.cfb);En("DES-OFB",et.cipher.modes.ofb);En("DES-CTR",et.cipher.modes.ctr);En("3DES-ECB",et.cipher.modes.ecb);En("3DES-CBC",et.cipher.modes.cbc);En("3DES-CFB",et.cipher.modes.cfb);En("3DES-OFB",et.cipher.modes.ofb);En("3DES-CTR",et.cipher.modes.ctr);function En(e,t){var r=u(function(){return new et.des.Algorithm(e,t)},"factory");et.cipher.registerAlgorithm(e,r)}u(En,"registerAlgorithm");var y4=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],m4=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],v4=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],E4=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],C4=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],S4=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],x4=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],T4=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function _4(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=e.length()>8?3:1,v=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],x=0,w,B=0;B<y;B++){var R=e.getInt32(),L=e.getInt32();w=(R>>>4^L)&252645135,L^=w,R^=w<<4,w=(L>>>-16^R)&65535,R^=w,L^=w<<-16,w=(R>>>2^L)&858993459,L^=w,R^=w<<2,w=(L>>>-16^R)&65535,R^=w,L^=w<<-16,w=(R>>>1^L)&1431655765,L^=w,R^=w<<1,w=(L>>>8^R)&16711935,R^=w,L^=w<<8,w=(R>>>1^L)&1431655765,L^=w,R^=w<<1,w=R<<8|L>>>20&240,R=L<<24|L<<8&16711680|L>>>8&65280|L>>>24&240,L=w;for(var Y=0;Y<m.length;++Y){m[Y]?(R=R<<2|R>>>26,L=L<<2|L>>>26):(R=R<<1|R>>>27,L=L<<1|L>>>27),R&=-15,L&=-15;var X=t[R>>>28]|r[R>>>24&15]|n[R>>>20&15]|i[R>>>16&15]|s[R>>>12&15]|o[R>>>8&15]|a[R>>>4&15],ne=c[L>>>28]|l[L>>>24&15]|f[L>>>20&15]|h[L>>>16&15]|d[L>>>12&15]|g[L>>>8&15]|p[L>>>4&15];w=(ne>>>16^X)&65535,v[x++]=X^w,v[x++]=ne^w<<16}}return v}u(_4,"_createKeys");function jS(e,t,r,n){var i=e.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=t[0],c=t[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var l=0;l<i;l+=3){for(var f=s[l+1],h=s[l+2],d=s[l];d!=f;d+=h){var g=c^e[d],p=(c>>>4|c<<28)^e[d+1];o=a,a=c,c=o^(m4[g>>>24&63]|E4[g>>>16&63]|S4[g>>>8&63]|T4[g&63]|y4[p>>>24&63]|v4[p>>>16&63]|C4[p>>>8&63]|x4[p&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}u(jS,"_updateBlock");function fc(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=et.cipher.createDecipher(r,e.key):n=et.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof et.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}u(fc,"_createCipher")});var hc=_((HM,WS)=>{var lr=fe();Gs();mn();Ae();var w4=lr.pkcs5=lr.pkcs5||{},Vn;lr.util.isNodejs&&!lr.options.usePureJavaScript&&(Vn=require("crypto"));WS.exports=lr.pbkdf2=w4.pbkdf2=function(e,t,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),lr.util.isNodejs&&!lr.options.usePureJavaScript&&Vn.pbkdf2&&(i===null||typeof i!="object")&&(Vn.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),s?Vn.pbkdf2Sync.length===4?Vn.pbkdf2(e,t,r,n,function(w,B){if(w)return s(w);s(null,B.toString("binary"))}):Vn.pbkdf2(e,t,r,n,i,function(w,B){if(w)return s(w);s(null,B.toString("binary"))}):Vn.pbkdf2Sync.length===4?Vn.pbkdf2Sync(e,t,r,n).toString("binary"):Vn.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in lr.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=lr.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/o),l=n-(c-1)*o,f=lr.hmac.create();f.start(i,e);var h="",d,g,p;if(!s){for(var y=1;y<=c;++y){f.start(null,null),f.update(t),f.update(lr.util.int32ToBytes(y)),d=p=f.digest().getBytes();for(var v=2;v<=r;++v)f.start(null,null),f.update(p),g=f.digest().getBytes(),d=lr.util.xorBytes(d,g,o),p=g;h+=y<c?d:d.substr(0,l)}return h}var y=1,v;function m(){if(y>c)return s(null,h);f.start(null,null),f.update(t),f.update(lr.util.int32ToBytes(y)),d=p=f.digest().getBytes(),v=2,x()}u(m,"outer");function x(){if(v<=r)return f.start(null,null),f.update(p),g=f.digest().getBytes(),d=lr.util.xorBytes(d,g,o),p=g,++v,lr.util.setImmediate(x);h+=y<c?d:d.substr(0,l),++y,m()}u(x,"inner"),m()}});var Kd=_((GM,JS)=>{var Cn=fe();mn();Ae();var ZS=JS.exports=Cn.sha256=Cn.sha256||{};Cn.md.sha256=Cn.md.algorithms.sha256=ZS;ZS.create=function(){YS||b4();var e=null,t=Cn.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=Cn.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Cn.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),QS(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Cn.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Md.substr(0,n.blockLength-o));for(var a,c,l=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)a=n.fullMessageLength[f+1]*8,c=a/4294967296>>>0,l+=c,i.putInt32(l>>>0),l=a>>>0;i.putInt32(l);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};QS(h,r,i);var d=Cn.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d.putInt32(h.h5),d.putInt32(h.h6),d.putInt32(h.h7),d},n};var Md=null,YS=!1,XS=null;function b4(){Md="\x80",Md+=Cn.util.fillString("\0",64),XS=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],YS=!0}u(b4,"_init");function QS(e,t,r){for(var n,i,s,o,a,c,l,f,h,d,g,p,y,v,m,x=r.length();x>=64;){for(l=0;l<16;++l)t[l]=r.getInt32();for(;l<64;++l)n=t[l-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[l-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[l]=n+t[l-7]+i+t[l-16]|0;for(f=e.h0,h=e.h1,d=e.h2,g=e.h3,p=e.h4,y=e.h5,v=e.h6,m=e.h7,l=0;l<64;++l)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=v^p&(y^v),s=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),c=f&h|d&(f^h),n=m+o+a+XS[l]+t[l],i=s+c,m=v,v=y,y=p,p=g+n>>>0,g=d,d=h,h=f,f=n+i>>>0;e.h0=e.h0+f|0,e.h1=e.h1+h|0,e.h2=e.h2+d|0,e.h3=e.h3+g|0,e.h4=e.h4+p|0,e.h5=e.h5+y|0,e.h6=e.h6+v|0,e.h7=e.h7+m|0,x-=64}}u(QS,"_update")});var Hd=_((zM,ex)=>{var Sn=fe();Ae();var pc=null;Sn.util.isNodejs&&!Sn.options.usePureJavaScript&&!process.versions["node-webkit"]&&(pc=require("crypto"));var I4=ex.exports=Sn.prng=Sn.prng||{};I4.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(l,f){if(!f)return t.generateSync(l);var h=t.plugin.cipher,d=t.plugin.increment,g=t.plugin.formatKey,p=t.plugin.formatSeed,y=Sn.util.createBuffer();t.key=null,v();function v(m){if(m)return f(m);if(y.length()>=l)return f(null,y.getBytes(l));if(t.generated>1048575&&(t.key=null),t.key===null)return Sn.util.nextTick(function(){s(v)});var x=h(t.key,t.seed);t.generated+=x.length,y.putBytes(x),t.key=g(h(t.key,d(t.seed))),t.seed=p(h(t.key,t.seed)),Sn.util.setImmediate(v)}u(v,"generate")},t.generateSync=function(l){var f=t.plugin.cipher,h=t.plugin.increment,d=t.plugin.formatKey,g=t.plugin.formatSeed;t.key=null;for(var p=Sn.util.createBuffer();p.length()<l;){t.generated>1048575&&(t.key=null),t.key===null&&o();var y=f(t.key,t.seed);t.generated+=y.length,p.putBytes(y),t.key=d(f(t.key,h(t.seed))),t.seed=g(f(t.key,t.seed))}return p.getBytes(l)};function s(l){if(t.pools[0].messageLength>=32)return a(),l();var f=32-t.pools[0].messageLength<<5;t.seedFile(f,function(h,d){if(h)return l(h);t.collect(d),a(),l()})}u(s,"_reseed");function o(){if(t.pools[0].messageLength>=32)return a();var l=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(l)),a()}u(o,"_reseedSync");function a(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var l=t.plugin.md.create();l.update(t.keyBytes);for(var f=1,h=0;h<32;++h)t.reseeds%f===0&&(l.update(t.pools[h].digest().getBytes()),t.pools[h].start()),f=f<<1;t.keyBytes=l.digest().getBytes(),l.start(),l.update(t.keyBytes);var d=l.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(d),t.generated=0}u(a,"_seed");function c(l){var f=null,h=Sn.util.globalScope,d=h.crypto||h.msCrypto;d&&d.getRandomValues&&(f=u(function(R){return d.getRandomValues(R)},"getRandomValues"));var g=Sn.util.createBuffer();if(f)for(;g.length()<l;){var p=Math.max(1,Math.min(l-g.length(),65536)/4),y=new Uint32Array(Math.floor(p));try{f(y);for(var v=0;v<y.length;++v)g.putInt32(y[v])}catch(R){if(!(typeof QuotaExceededError<"u"&&R instanceof QuotaExceededError))throw R}}if(g.length()<l)for(var m,x,w,B=Math.floor(Math.random()*65536);g.length()<l;){x=16807*(B&65535),m=16807*(B>>16),x+=(m&32767)<<16,x+=m>>15,x=(x&2147483647)+(x>>31),B=x&4294967295;for(var v=0;v<3;++v)w=B>>>(v<<3),w^=Math.floor(Math.random()*256),g.putByte(w&255)}return g.getBytes(l)}return u(c,"defaultSeedFile"),pc?(t.seedFile=function(l,f){pc.randomBytes(l,function(h,d){if(h)return f(h);f(null,d.toString())})},t.seedFileSync=function(l){return pc.randomBytes(l).toString()}):(t.seedFile=function(l,f){try{f(null,c(l))}catch(h){f(h)}},t.seedFileSync=c),t.collect=function(l){for(var f=l.length,h=0;h<f;++h)t.pools[t.pool].update(l.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(l,f){for(var h="",d=0;d<f;d+=8)h+=String.fromCharCode(l>>d&255);t.collect(h)},t.registerWorker=function(l){if(l===self)t.seedFile=function(h,d){function g(p){var y=p.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",g),d(y.forge.prng.err,y.forge.prng.bytes))}u(g,"listener"),self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:h}}})};else{var f=u(function(h){var d=h.data;d.forge&&d.forge.prng&&t.seedFile(d.forge.prng.needed,function(g,p){l.postMessage({forge:{prng:{err:g,bytes:p}}})})},"listener");l.addEventListener("message",f)}},t}});var Ur=_((QM,$d)=>{var Mt=fe();li();Kd();Hd();Ae();(function(){if(Mt.random&&Mt.random.getBytes){$d.exports=Mt.random;return}(function(e){var t={},r=new Array(4),n=Mt.util.createBuffer();t.formatKey=function(h){var d=Mt.util.createBuffer(h);return h=new Array(4),h[0]=d.getInt32(),h[1]=d.getInt32(),h[2]=d.getInt32(),h[3]=d.getInt32(),Mt.aes._expandKey(h,!1)},t.formatSeed=function(h){var d=Mt.util.createBuffer(h);return h=new Array(4),h[0]=d.getInt32(),h[1]=d.getInt32(),h[2]=d.getInt32(),h[3]=d.getInt32(),h},t.cipher=function(h,d){return Mt.aes._updateBlock(h,d,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=Mt.md.sha256;function i(){var h=Mt.prng.create(t);return h.getBytes=function(d,g){return h.generate(d,g)},h.getBytesSync=function(d){return h.generate(d)},h}u(i,"spawnPrng");var s=i(),o=null,a=Mt.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=u(function(h){return c.getRandomValues(h)},"getRandomValues")),Mt.options.usePureJavaScript||!Mt.util.isNodejs&&!o){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var l="";for(var f in navigator)try{typeof navigator[f]=="string"&&(l+=navigator[f])}catch{}s.collect(l),l=null}e&&(e().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),e().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Mt.random)Mt.random=s;else for(var f in s)Mt.random[f]=s[f];Mt.random.createInstance=i,$d.exports=Mt.random})(typeof jQuery<"u"?jQuery:null)})()});var jd=_((YM,nx)=>{var Cr=fe();Ae();var Gd=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],tx=[1,2,3,5],A4=u(function(e,t){return e<<t&65535|(e&65535)>>16-t},"rol"),B4=u(function(e,t){return(e&65535)>>t|e<<16-t&65535},"ror");nx.exports=Cr.rc2=Cr.rc2||{};Cr.rc2.expandKey=function(e,t){typeof e=="string"&&(e=Cr.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Gd[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,Gd[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,Gd[r.at(a+1)^r.at(a+s)]);return r};var rx=u(function(e,t,r){var n=!1,i=null,s=null,o=null,a,c,l,f,h=[];for(e=Cr.rc2.expandKey(e,t),l=0;l<64;l++)h.push(e.getInt16Le());r?(a=u(function(p){for(l=0;l<4;l++)p[l]+=h[f]+(p[(l+3)%4]&p[(l+2)%4])+(~p[(l+3)%4]&p[(l+1)%4]),p[l]=A4(p[l],tx[l]),f++},"mixRound"),c=u(function(p){for(l=0;l<4;l++)p[l]+=h[p[(l+3)%4]&63]},"mashRound")):(a=u(function(p){for(l=3;l>=0;l--)p[l]=B4(p[l],tx[l]),p[l]-=h[f]+(p[(l+3)%4]&p[(l+2)%4])+(~p[(l+3)%4]&p[(l+1)%4]),f--},"mixRound"),c=u(function(p){for(l=3;l>=0;l--)p[l]-=h[p[(l+3)%4]&63]},"mashRound"));var d=u(function(p){var y=[];for(l=0;l<4;l++){var v=i.getInt16Le();o!==null&&(r?v^=o.getInt16Le():o.putInt16Le(v)),y.push(v&65535)}f=r?0:63;for(var m=0;m<p.length;m++)for(var x=0;x<p[m][0];x++)p[m][1](y);for(l=0;l<4;l++)o!==null&&(r?o.putInt16Le(y[l]):y[l]^=o.getInt16Le()),s.putInt16Le(y[l])},"runPlan"),g=null;return g={start:function(p,y){p&&typeof p=="string"&&(p=Cr.util.createBuffer(p)),n=!1,i=Cr.util.createBuffer(),s=y||new Cr.util.createBuffer,o=p,g.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)d([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(p){var y=!0;if(r)if(p)y=p(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(y&&(n=!0,g.update()),!r&&(y=i.length()===0,y))if(p)y=p(8,s,!r);else{var m=s.length(),x=s.at(m-1);x>m?y=!1:s.truncate(x)}return y}},g},"createCipher");Cr.rc2.startEncrypting=function(e,t,r){var n=Cr.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};Cr.rc2.createEncryptionCipher=function(e,t){return rx(e,t,!0)};Cr.rc2.startDecrypting=function(e,t,r){var n=Cr.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};Cr.rc2.createDecryptionCipher=function(e,t){return rx(e,t,!1)}});var ha=_((JM,fx)=>{var zd=fe();fx.exports=zd.jsbn=zd.jsbn||{};var Mn,N4=0xdeadbeefcafe,ix=(N4&16777215)==15715070;function k(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}u(k,"BigInteger");zd.jsbn.BigInteger=k;function Be(){return new k(null)}u(Be,"nbi");function R4(e,t,r,n,i,s){for(;--s>=0;){var o=t*this.data[e++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}u(R4,"am1");function D4(e,t,r,n,i,s){for(var o=t&32767,a=t>>15;--s>=0;){var c=this.data[e]&32767,l=this.data[e++]>>15,f=a*c+l*o;c=o*c+((f&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(f>>>15)+a*l+(i>>>30),r.data[n++]=c&1073741823}return i}u(D4,"am2");function sx(e,t,r,n,i,s){for(var o=t&16383,a=t>>14;--s>=0;){var c=this.data[e]&16383,l=this.data[e++]>>14,f=a*c+l*o;c=o*c+((f&16383)<<14)+r.data[n]+i,i=(c>>28)+(f>>14)+a*l,r.data[n++]=c&268435455}return i}u(sx,"am3");typeof navigator>"u"?(k.prototype.am=sx,Mn=28):ix&&navigator.appName=="Microsoft Internet Explorer"?(k.prototype.am=D4,Mn=30):ix&&navigator.appName!="Netscape"?(k.prototype.am=R4,Mn=26):(k.prototype.am=sx,Mn=28);k.prototype.DB=Mn;k.prototype.DM=(1<<Mn)-1;k.prototype.DV=1<<Mn;var Wd=52;k.prototype.FV=Math.pow(2,Wd);k.prototype.F1=Wd-Mn;k.prototype.F2=2*Mn-Wd;var L4="0123456789abcdefghijklmnopqrstuvwxyz",dc=new Array,zs,Vr;zs=48;for(Vr=0;Vr<=9;++Vr)dc[zs++]=Vr;zs=97;for(Vr=10;Vr<36;++Vr)dc[zs++]=Vr;zs=65;for(Vr=10;Vr<36;++Vr)dc[zs++]=Vr;function ox(e){return L4.charAt(e)}u(ox,"int2char");function ax(e,t){var r=dc[e.charCodeAt(t)];return r??-1}u(ax,"intAt");function O4(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}u(O4,"bnpCopyTo");function F4(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}u(F4,"bnpFromInt");function hi(e){var t=Be();return t.fromInt(e),t}u(hi,"nbv");function P4(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var o=r==8?e[n]&255:ax(e,n);if(o<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&e[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&k.ZERO.subTo(this,this)}u(P4,"bnpFromString");function k4(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}u(k4,"bnpClamp");function q4(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=ox(n));o>=0;)a<t?(n=(this.data[o]&(1<<a)-1)<<t-a,n|=this.data[--o]>>(a+=this.DB-t)):(n=this.data[o]>>(a-=t)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=ox(n));return i?s:"0"}u(q4,"bnToString");function U4(){var e=Be();return k.ZERO.subTo(this,e),e}u(U4,"bnNegate");function V4(){return this.s<0?this.negate():this}u(V4,"bnAbs");function M4(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}u(M4,"bnCompareTo");function gc(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}u(gc,"nbits");function K4(){return this.t<=0?0:this.DB*(this.t-1)+gc(this.data[this.t-1]^this.s&this.DM)}u(K4,"bnBitLength");function H4(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}u(H4,"bnpDLShiftTo");function $4(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}u($4,"bnpDRShiftTo");function G4(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)t.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)t.data[a]=0;t.data[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}u(G4,"bnpLShiftTo");function j4(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&s)<<i,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}u(j4,"bnpRShiftTo");function z4(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}u(z4,"bnpSubTo");function W4(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&k.ZERO.subTo(t,t)}u(W4,"bnpMultiplyTo");function Q4(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}u(Q4,"bnpSquareTo");function Z4(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t!=null&&t.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Be());var s=Be(),o=this.s,a=e.s,c=this.DB-gc(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var l=s.t,f=s.data[l-1];if(f!=0){var h=f*(1<<this.F1)+(l>1?s.data[l-2]>>this.F2:0),d=this.FV/h,g=(1<<this.F1)/h,p=1<<this.F2,y=r.t,v=y-l,m=t??Be();for(s.dlShiftTo(v,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),k.ONE.dlShiftTo(l,m),m.subTo(s,s);s.t<l;)s.data[s.t++]=0;for(;--v>=0;){var x=r.data[--y]==f?this.DM:Math.floor(r.data[y]*d+(r.data[y-1]+p)*g);if((r.data[y]+=s.am(0,x,r,v,0,l))<x)for(s.dlShiftTo(v,m),r.subTo(m,r);r.data[y]<--x;)r.subTo(m,r)}t!=null&&(r.drShiftTo(l,t),o!=a&&k.ZERO.subTo(t,t)),r.t=l,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&k.ZERO.subTo(r,r)}}}u(Z4,"bnpDivRemTo");function Y4(e){var t=Be();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(k.ZERO)>0&&e.subTo(t,t),t}u(Y4,"bnMod");function Qi(e){this.m=e}u(Qi,"Classic");function X4(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}u(X4,"cConvert");function J4(e){return e}u(J4,"cRevert");function eF(e){e.divRemTo(this.m,null,e)}u(eF,"cReduce");function tF(e,t,r){e.multiplyTo(t,r),this.reduce(r)}u(tF,"cMulTo");function rF(e,t){e.squareTo(t),this.reduce(t)}u(rF,"cSqrTo");Qi.prototype.convert=X4;Qi.prototype.revert=J4;Qi.prototype.reduce=eF;Qi.prototype.mulTo=tF;Qi.prototype.sqrTo=rF;function nF(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}u(nF,"bnpInvDigit");function Zi(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}u(Zi,"Montgomery");function iF(e){var t=Be();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(k.ZERO)>0&&this.m.subTo(t,t),t}u(iF,"montConvert");function sF(e){var t=Be();return e.copyTo(t),this.reduce(t),t}u(sF,"montRevert");function oF(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}u(oF,"montReduce");function aF(e,t){e.squareTo(t),this.reduce(t)}u(aF,"montSqrTo");function uF(e,t,r){e.multiplyTo(t,r),this.reduce(r)}u(uF,"montMulTo");Zi.prototype.convert=iF;Zi.prototype.revert=sF;Zi.prototype.reduce=oF;Zi.prototype.mulTo=uF;Zi.prototype.sqrTo=aF;function cF(){return(this.t>0?this.data[0]&1:this.s)==0}u(cF,"bnpIsEven");function lF(e,t){if(e>4294967295||e<1)return k.ONE;var r=Be(),n=Be(),i=t.convert(this),s=gc(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var o=r;r=n,n=o}return t.revert(r)}u(lF,"bnpExp");function fF(e,t){var r;return e<256||t.isEven()?r=new Qi(t):r=new Zi(t),this.exp(e,r)}u(fF,"bnModPowInt");k.prototype.copyTo=O4;k.prototype.fromInt=F4;k.prototype.fromString=P4;k.prototype.clamp=k4;k.prototype.dlShiftTo=H4;k.prototype.drShiftTo=$4;k.prototype.lShiftTo=G4;k.prototype.rShiftTo=j4;k.prototype.subTo=z4;k.prototype.multiplyTo=W4;k.prototype.squareTo=Q4;k.prototype.divRemTo=Z4;k.prototype.invDigit=nF;k.prototype.isEven=cF;k.prototype.exp=lF;k.prototype.toString=q4;k.prototype.negate=U4;k.prototype.abs=V4;k.prototype.compareTo=M4;k.prototype.bitLength=K4;k.prototype.mod=Y4;k.prototype.modPowInt=fF;k.ZERO=hi(0);k.ONE=hi(1);function hF(){var e=Be();return this.copyTo(e),e}u(hF,"bnClone");function pF(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}u(pF,"bnIntValue");function dF(){return this.t==0?this.s:this.data[0]<<24>>24}u(dF,"bnByteValue");function gF(){return this.t==0?this.s:this.data[0]<<16>>16}u(gF,"bnShortValue");function yF(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}u(yF,"bnpChunkSize");function mF(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}u(mF,"bnSigNum");function vF(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=hi(r),i=Be(),s=Be(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(e)+o}u(vF,"bnpToRadix");function EF(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,a=0;a<e.length;++a){var c=ax(e,a);if(c<0){e.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=t*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&k.ZERO.subTo(this,this)}u(EF,"bnpFromRadix");function CF(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(k.ONE.shiftLeft(e-1),Qd,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(k.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}u(CF,"bnpFromNumber");function SF(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}u(SF,"bnToByteArray");function xF(e){return this.compareTo(e)==0}u(xF,"bnEquals");function TF(e){return this.compareTo(e)<0?this:e}u(TF,"bnMin");function _F(e){return this.compareTo(e)>0?this:e}u(_F,"bnMax");function wF(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}u(wF,"bnpBitwiseTo");function bF(e,t){return e&t}u(bF,"op_and");function IF(e){var t=Be();return this.bitwiseTo(e,bF,t),t}u(IF,"bnAnd");function Qd(e,t){return e|t}u(Qd,"op_or");function AF(e){var t=Be();return this.bitwiseTo(e,Qd,t),t}u(AF,"bnOr");function ux(e,t){return e^t}u(ux,"op_xor");function BF(e){var t=Be();return this.bitwiseTo(e,ux,t),t}u(BF,"bnXor");function cx(e,t){return e&~t}u(cx,"op_andnot");function NF(e){var t=Be();return this.bitwiseTo(e,cx,t),t}u(NF,"bnAndNot");function RF(){for(var e=Be(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}u(RF,"bnNot");function DF(e){var t=Be();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}u(DF,"bnShiftLeft");function LF(e){var t=Be();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}u(LF,"bnShiftRight");function OF(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}u(OF,"lbit");function FF(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+OF(this.data[e]);return this.s<0?this.t*this.DB:-1}u(FF,"bnGetLowestSetBit");function PF(e){for(var t=0;e!=0;)e&=e-1,++t;return t}u(PF,"cbit");function kF(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=PF(this.data[r]^t);return e}u(kF,"bnBitCount");function qF(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}u(qF,"bnTestBit");function UF(e,t){var r=k.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}u(UF,"bnpChangeBit");function VF(e){return this.changeBit(e,Qd)}u(VF,"bnSetBit");function MF(e){return this.changeBit(e,cx)}u(MF,"bnClearBit");function KF(e){return this.changeBit(e,ux)}u(KF,"bnFlipBit");function HF(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}u(HF,"bnpAddTo");function $F(e){var t=Be();return this.addTo(e,t),t}u($F,"bnAdd");function GF(e){var t=Be();return this.subTo(e,t),t}u(GF,"bnSubtract");function jF(e){var t=Be();return this.multiplyTo(e,t),t}u(jF,"bnMultiply");function zF(e){var t=Be();return this.divRemTo(e,t,null),t}u(zF,"bnDivide");function WF(e){var t=Be();return this.divRemTo(e,null,t),t}u(WF,"bnRemainder");function QF(e){var t=Be(),r=Be();return this.divRemTo(e,t,r),new Array(t,r)}u(QF,"bnDivideAndRemainder");function ZF(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}u(ZF,"bnpDMultiply");function YF(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}u(YF,"bnpDAddOffset");function fa(){}u(fa,"NullExp");function lx(e){return e}u(lx,"nNop");function XF(e,t,r){e.multiplyTo(t,r)}u(XF,"nMulTo");function JF(e,t){e.squareTo(t)}u(JF,"nSqrTo");fa.prototype.convert=lx;fa.prototype.revert=lx;fa.prototype.mulTo=XF;fa.prototype.sqrTo=JF;function eP(e){return this.exp(e,new fa)}u(eP,"bnPow");function tP(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}u(tP,"bnpMultiplyLowerTo");function rP(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}u(rP,"bnpMultiplyUpperTo");function Ws(e){this.r2=Be(),this.q3=Be(),k.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}u(Ws,"Barrett");function nP(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=Be();return e.copyTo(t),this.reduce(t),t}u(nP,"barrettConvert");function iP(e){return e}u(iP,"barrettRevert");function sP(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}u(sP,"barrettReduce");function oP(e,t){e.squareTo(t),this.reduce(t)}u(oP,"barrettSqrTo");function aP(e,t,r){e.multiplyTo(t,r),this.reduce(r)}u(aP,"barrettMulTo");Ws.prototype.convert=nP;Ws.prototype.revert=iP;Ws.prototype.reduce=sP;Ws.prototype.mulTo=aP;Ws.prototype.sqrTo=oP;function uP(e,t){var r=e.bitLength(),n,i=hi(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Qi(t):t.isEven()?s=new Ws(t):s=new Zi(t);var o=new Array,a=3,c=n-1,l=(1<<n)-1;if(o[1]=s.convert(this),n>1){var f=Be();for(s.sqrTo(o[1],f);a<=l;)o[a]=Be(),s.mulTo(f,o[a-2],o[a]),a+=2}var h=e.t-1,d,g=!0,p=Be(),y;for(r=gc(e.data[h])-1;h>=0;){for(r>=c?d=e.data[h]>>r-c&l:(d=(e.data[h]&(1<<r+1)-1)<<c-r,h>0&&(d|=e.data[h-1]>>this.DB+r-c)),a=n;!(d&1);)d>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),g)o[d].copyTo(i),g=!1;else{for(;a>1;)s.sqrTo(i,p),s.sqrTo(p,i),a-=2;a>0?s.sqrTo(i,p):(y=i,i=p,p=y),s.mulTo(p,o[d],i)}for(;h>=0&&!(e.data[h]&1<<r);)s.sqrTo(i,p),y=i,i=p,p=y,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}u(uP,"bnModPow");function cP(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}u(cP,"bnGCD");function lP(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}u(lP,"bnpModInt");function fP(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return k.ZERO;for(var r=e.clone(),n=this.clone(),i=hi(1),s=hi(0),o=hi(0),a=hi(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),t&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(k.ONE)!=0)return k.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}u(fP,"bnModInverse");var an=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],hP=(1<<26)/an[an.length-1];function pP(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=an[an.length-1]){for(t=0;t<an.length;++t)if(r.data[0]==an[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<an.length;){for(var n=an[t],i=t+1;i<an.length&&n<hP;)n*=an[i++];for(n=r.modInt(n);t<i;)if(n%an[t++]==0)return!1}return r.millerRabin(e)}u(pP,"bnIsProbablePrime");function dP(e){var t=this.subtract(k.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=gP(),s,o=0;o<e;++o){do s=new k(this.bitLength(),i);while(s.compareTo(k.ONE)<=0||s.compareTo(t)>=0);var a=s.modPow(n,this);if(a.compareTo(k.ONE)!=0&&a.compareTo(t)!=0){for(var c=1;c++<r&&a.compareTo(t)!=0;)if(a=a.modPowInt(2,this),a.compareTo(k.ONE)==0)return!1;if(a.compareTo(t)!=0)return!1}}return!0}u(dP,"bnpMillerRabin");function gP(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}u(gP,"bnGetPrng");k.prototype.chunkSize=yF;k.prototype.toRadix=vF;k.prototype.fromRadix=EF;k.prototype.fromNumber=CF;k.prototype.bitwiseTo=wF;k.prototype.changeBit=UF;k.prototype.addTo=HF;k.prototype.dMultiply=ZF;k.prototype.dAddOffset=YF;k.prototype.multiplyLowerTo=tP;k.prototype.multiplyUpperTo=rP;k.prototype.modInt=lP;k.prototype.millerRabin=dP;k.prototype.clone=hF;k.prototype.intValue=pF;k.prototype.byteValue=dF;k.prototype.shortValue=gF;k.prototype.signum=mF;k.prototype.toByteArray=SF;k.prototype.equals=xF;k.prototype.min=TF;k.prototype.max=_F;k.prototype.and=IF;k.prototype.or=AF;k.prototype.xor=BF;k.prototype.andNot=NF;k.prototype.not=RF;k.prototype.shiftLeft=DF;k.prototype.shiftRight=LF;k.prototype.getLowestSetBit=FF;k.prototype.bitCount=kF;k.prototype.testBit=qF;k.prototype.setBit=VF;k.prototype.clearBit=MF;k.prototype.flipBit=KF;k.prototype.add=$F;k.prototype.subtract=GF;k.prototype.multiply=jF;k.prototype.divide=zF;k.prototype.remainder=WF;k.prototype.divideAndRemainder=QF;k.prototype.modPow=uP;k.prototype.modInverse=fP;k.prototype.pow=eP;k.prototype.gcd=cP;k.prototype.isProbablePrime=pP});var Qs=_((tK,gx)=>{var xn=fe();mn();Ae();var px=gx.exports=xn.sha1=xn.sha1||{};xn.md.sha1=xn.md.algorithms.sha1=px;px.create=function(){dx||yP();var e=null,t=xn.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=xn.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=xn.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),hx(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=xn.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Zd.substr(0,n.blockLength-o));for(var a,c,l=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)a=n.fullMessageLength[f+1]*8,c=a/4294967296>>>0,l+=c,i.putInt32(l>>>0),l=a>>>0;i.putInt32(l);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};hx(h,r,i);var d=xn.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d},n};var Zd=null,dx=!1;function yP(){Zd="\x80",Zd+=xn.util.fillString("\0",64),dx=!0}u(yP,"_init");function hx(e,t,r){for(var n,i,s,o,a,c,l,f,h=r.length();h>=64;){for(i=e.h0,s=e.h1,o=e.h2,a=e.h3,c=e.h4,f=0;f<16;++f)n=r.getInt32(),t[f]=n,l=a^s&(o^a),n=(i<<5|i>>>27)+l+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<20;++f)n=t[f-3]^t[f-8]^t[f-14]^t[f-16],n=n<<1|n>>>31,t[f]=n,l=a^s&(o^a),n=(i<<5|i>>>27)+l+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<32;++f)n=t[f-3]^t[f-8]^t[f-14]^t[f-16],n=n<<1|n>>>31,t[f]=n,l=s^o^a,n=(i<<5|i>>>27)+l+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<40;++f)n=t[f-6]^t[f-16]^t[f-28]^t[f-32],n=n<<2|n>>>30,t[f]=n,l=s^o^a,n=(i<<5|i>>>27)+l+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<60;++f)n=t[f-6]^t[f-16]^t[f-28]^t[f-32],n=n<<2|n>>>30,t[f]=n,l=s&o|a&(s^o),n=(i<<5|i>>>27)+l+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<80;++f)n=t[f-6]^t[f-16]^t[f-28]^t[f-32],n=n<<2|n>>>30,t[f]=n,l=s^o^a,n=(i<<5|i>>>27)+l+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,h-=64}}u(hx,"_update")});var Yd=_((nK,mx)=>{var Tn=fe();Ae();Ur();Qs();var yx=mx.exports=Tn.pkcs1=Tn.pkcs1||{};yx.encode_rsa_oaep=function(e,t,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=Tn.md.sha1.create(),o||(o=s);var a=Math.ceil(e.n.bitLength()/8),c=a-2*s.digestLength-2;if(t.length>c){var l=new Error("RSAES-OAEP input message length is too long.");throw l.length=t.length,l.maxLength=c,l}n||(n=""),s.update(n,"raw");for(var f=s.digest(),h="",d=c-t.length,g=0;g<d;g++)h+="\0";var p=f.getBytes()+h+""+t;if(!i)i=Tn.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var l=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=i.length,l.digestLength=s.digestLength,l}var y=yc(i,a-s.digestLength-1,o),v=Tn.util.xorBytes(p,y,p.length),m=yc(v,s.digestLength,o),x=Tn.util.xorBytes(i,m,i.length);return"\0"+x+v};yx.decode_rsa_oaep=function(e,t,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=t.length,v.expectedLength=o,v}if(i===void 0?i=Tn.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=t.charAt(0),l=t.substring(1,i.digestLength+1),f=t.substring(1+i.digestLength),h=yc(f,i.digestLength,s),d=Tn.util.xorBytes(l,h,l.length),g=yc(d,o-i.digestLength-1,s),p=Tn.util.xorBytes(f,g,f.length),y=p.substring(0,i.digestLength),v=c!=="\0",m=0;m<i.digestLength;++m)v|=a.charAt(m)!==y.charAt(m);for(var x=1,w=i.digestLength,B=i.digestLength;B<p.length;B++){var R=p.charCodeAt(B),L=R&1^1,Y=x?65534:0;v|=R&Y,x=x&L,w+=x}if(v||p.charCodeAt(w)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(w+1)};function yc(e,t,r){r||(r=Tn.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(e+o),n+=r.digest().getBytes()}return n.substring(0,t)}u(yc,"rsa_mgf1")});var Jd=_((sK,Xd)=>{var pi=fe();Ae();ha();Ur();(function(){if(pi.prime){Xd.exports=pi.prime;return}var e=Xd.exports=pi.prime=pi.prime||{},t=pi.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=u(function(h,d){return h|d},"op_or");e.generateProbablePrime=function(h,d,g){typeof d=="function"&&(g=d,d={}),d=d||{};var p=d.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var y=d.prng||pi.random,v={nextBytes:function(m){for(var x=y.getBytesSync(m.length),w=0;w<m.length;++w)m[w]=x.charCodeAt(w)}};if(p.name==="PRIMEINC")return s(h,v,p.options,g);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,d,g,p){return"workers"in g?c(h,d,g,p):o(h,d,g,p)}u(s,"primeincFindPrime");function o(h,d,g,p){var y=l(h,d),v=0,m=f(y.bitLength());"millerRabinTests"in g&&(m=g.millerRabinTests);var x=10;"maxBlockTime"in g&&(x=g.maxBlockTime),a(y,h,d,v,m,x,p)}u(o,"primeincFindPrimeWithoutWorkers");function a(h,d,g,p,y,v,m){var x=+new Date;do{if(h.bitLength()>d&&(h=l(d,g)),h.isProbablePrime(y))return m(null,h);h.dAddOffset(r[p++%8],0)}while(v<0||+new Date-x<v);pi.util.setImmediate(function(){a(h,d,g,p,y,v,m)})}u(a,"_primeinc");function c(h,d,g,p){if(typeof Worker>"u")return o(h,d,g,p);var y=l(h,d),v=g.workers,m=g.workLoad||100,x=m*30/8,w=g.workerScript||"forge/prime.worker.js";if(v===-1)return pi.util.estimateCores(function(R,L){R&&(L=2),v=L-1,B()});B();function B(){v=Math.max(1,v);for(var R=[],L=0;L<v;++L)R[L]=new Worker(w);for(var Y=v,L=0;L<v;++L)R[L].addEventListener("message",ne);var X=!1;function ne(le){if(!X){--Y;var Ce=le.data;if(Ce.found){for(var we=0;we<R.length;++we)R[we].terminate();return X=!0,p(null,new t(Ce.prime,16))}y.bitLength()>h&&(y=l(h,d));var ht=y.toString(16);le.target.postMessage({hex:ht,workLoad:m}),y.dAddOffset(x,0)}}u(ne,"workerMessage")}u(B,"generate")}u(c,"primeincFindPrimeWithWorkers");function l(h,d){var g=new t(h,d),p=h-1;return g.testBit(p)||g.bitwiseTo(t.ONE.shiftLeft(p),i,g),g.dAddOffset(31-g.mod(n).byteValue(),0),g}u(l,"generateRandom");function f(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}u(f,"getMillerRabinTests")})()});var pa=_((aK,_x)=>{var ee=fe();on();ha();fi();Yd();Jd();Ur();Ae();typeof Te>"u"&&(Te=ee.jsbn.BigInteger);var Te,e0=ee.util.isNodejs?require("crypto"):null,N=ee.asn1,Mr=ee.util;ee.pki=ee.pki||{};_x.exports=ee.pki.rsa=ee.rsa=ee.rsa||{};var ae=ee.pki,mP=[6,4,2,4,2,4,6,2],vP={name:"PrivateKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},EP={name:"RSAPrivateKey",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},CP={name:"RSAPublicKey",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},SP=ee.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:N.Class.UNIVERSAL,type:N.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},xP={name:"DigestInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:N.Class.UNIVERSAL,type:N.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:N.Class.UNIVERSAL,type:N.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},TP=u(function(e){var t;if(e.algorithm in ae.oids)t=ae.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=N.oidToDer(t).getBytes(),i=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]),s=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]);s.value.push(N.create(N.Class.UNIVERSAL,N.Type.OID,!1,n)),s.value.push(N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,""));var o=N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(o),N.toDer(i).getBytes()},"emsaPkcs1v15encode"),xx=u(function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(Te.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(Te.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new Te(ee.util.bytesToHex(ee.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(Te.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);var o=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return o=o.multiply(n.modInverse(t.n)).mod(t.n),o},"_modPow");ae.rsa.encrypt=function(e,t,r){var n=r,i,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Tx(e,t,r)):(i=ee.util.createBuffer(),i.putBytes(e));for(var o=new Te(i.toHex(),16),a=xx(o,t,n),c=a.toString(16),l=ee.util.createBuffer(),f=s-Math.ceil(c.length/2);f>0;)l.putByte(0),--f;return l.putBytes(ee.util.hexToBytes(c)),l.getBytes()};ae.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=i,s}var o=new Te(ee.util.createBuffer(e).toHex(),16);if(o.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=xx(o,t,r),c=a.toString(16),l=ee.util.createBuffer(),f=i-Math.ceil(c.length/2);f>0;)l.putByte(0),--f;return l.putBytes(ee.util.hexToBytes(c)),n!==!1?mc(l.getBytes(),t,r):l.getBytes()};ae.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||ee.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),l=0;l<a.length;++l)a[l]=c.charCodeAt(l)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new Te(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};ae.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new Te(null);r.fromInt(30);for(var n=0,i=u(function(h,d){return h|d},"op_or"),s=+new Date,o,a=0;e.keys===null&&(t<=0||a<t);){if(e.state===0){var c=e.p===null?e.pBits:e.qBits,l=c-1;e.pqState===0?(e.num=new Te(c,e.rng),e.num.testBit(l)||e.num.bitwiseTo(Te.ONE.shiftLeft(l),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>c?e.pqState=0:e.num.isProbablePrime(wP(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(mP[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(Te.ONE).gcd(e.e).compareTo(Te.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(Te.ONE),e.q1=e.q.subtract(Te.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(Te.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var f=e.e.modInverse(e.phi);e.keys={privateKey:ae.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:ae.rsa.setPublicKey(e.n,e.e)}}o=+new Date,a+=o-s,s=o}return e.keys!==null};ae.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!ee.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(vx("generateKeyPair"))return e0.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,l){if(a)return n(a);n(null,{privateKey:ae.privateKeyFromPem(l),publicKey:ae.publicKeyFromPem(c)})});if(Ex("generateKey")&&Ex("exportKey"))return Mr.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Sx(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Mr.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=ae.privateKeyFromAsn1(N.fromDer(ee.util.createBuffer(a)));n(null,{privateKey:c,publicKey:ae.setRsaPublicKey(c.n,c.e)})}});if(Cx("generateKey")&&Cx("exportKey")){var i=Mr.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Sx(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,l=Mr.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);l.oncomplete=function(f){var h=f.target.result,d=ae.privateKeyFromAsn1(N.fromDer(ee.util.createBuffer(h)));n(null,{privateKey:d,publicKey:ae.setRsaPublicKey(d.n,d.e)})},l.onerror=function(f){n(f)}},i.onerror=function(a){n(a)};return}}else if(vx("generateKeyPairSync")){var s=e0.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:ae.privateKeyFromPem(s.privateKey),publicKey:ae.publicKeyFromPem(s.publicKey)}}}var o=ae.rsa.createKeyPairGenerationState(e,t,r);if(!n)return ae.rsa.stepKeyPairGenerationState(o,0),o.keys;_P(o,r,n)};ae.setRsaPublicKey=ae.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,l){return Tx(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return ee.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return ae.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,l){l=mc(l,r,!0);var f=N.fromDer(l,{parseAllBytes:o._parseAllDigestBytes}),h={},d=[];if(!N.validate(f,xP,h,d)){var g=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw g.errors=d,g}var p=N.derToOid(h.algorithmIdentifier);if(!(p===ee.oids.md2||p===ee.oids.md5||p===ee.oids.sha1||p===ee.oids.sha224||p===ee.oids.sha256||p===ee.oids.sha384||p===ee.oids.sha512||p===ee.oids["sha512-224"]||p===ee.oids["sha512-256"])){var g=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw g.oid=p,g}if((p===ee.oids.md2||p===ee.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,l){return l=mc(l,r,!0),c===l}});var a=ae.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};ae.setRsaPrivateKey=ae.rsa.setPrivateKey=function(e,t,r,n,i,s,o,a){var c={n:e,e:t,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return c.decrypt=function(l,f,h){typeof f=="string"?f=f.toUpperCase():f===void 0&&(f="RSAES-PKCS1-V1_5");var d=ae.rsa.decrypt(l,c,!1,!1);if(f==="RSAES-PKCS1-V1_5")f={decode:mc};else if(f==="RSA-OAEP"||f==="RSAES-OAEP")f={decode:function(g,p){return ee.pkcs1.decode_rsa_oaep(p,g,h)}};else if(["RAW","NONE","NULL",null].indexOf(f)!==-1)f={decode:function(g){return g}};else throw new Error('Unsupported encryption scheme: "'+f+'".');return f.decode(d,c,!1)},c.sign=function(l,f){var h=!1;typeof f=="string"&&(f=f.toUpperCase()),f===void 0||f==="RSASSA-PKCS1-V1_5"?(f={encode:TP},h=1):(f==="NONE"||f==="NULL"||f===null)&&(f={encode:function(){return l}},h=1);var d=f.encode(l,c.n.bitLength());return ae.rsa.encrypt(d,c,h)},c};ae.wrapRsaPrivateKey=function(e){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(0).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(ae.oids.rsaEncryption).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")]),N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,N.toDer(e).getBytes())])};ae.privateKeyFromAsn1=function(e){var t={},r=[];if(N.validate(e,vP,t,r)&&(e=N.fromDer(ee.util.createBuffer(t.privateKey))),t={},r=[],!N.validate(e,EP,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,c,l,f,h;return i=ee.util.createBuffer(t.privateKeyModulus).toHex(),s=ee.util.createBuffer(t.privateKeyPublicExponent).toHex(),o=ee.util.createBuffer(t.privateKeyPrivateExponent).toHex(),a=ee.util.createBuffer(t.privateKeyPrime1).toHex(),c=ee.util.createBuffer(t.privateKeyPrime2).toHex(),l=ee.util.createBuffer(t.privateKeyExponent1).toHex(),f=ee.util.createBuffer(t.privateKeyExponent2).toHex(),h=ee.util.createBuffer(t.privateKeyCoefficient).toHex(),ae.setRsaPrivateKey(new Te(i,16),new Te(s,16),new Te(o,16),new Te(a,16),new Te(c,16),new Te(l,16),new Te(f,16),new Te(h,16))};ae.privateKeyToAsn1=ae.privateKeyToRSAPrivateKey=function(e){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(0).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,_n(e.n)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,_n(e.e)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,_n(e.d)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,_n(e.p)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,_n(e.q)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,_n(e.dP)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,_n(e.dQ)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,_n(e.qInv))])};ae.publicKeyFromAsn1=function(e){var t={},r=[];if(N.validate(e,SP,t,r)){var n=N.derToOid(t.publicKeyOid);if(n!==ae.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!N.validate(e,CP,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=ee.util.createBuffer(t.publicKeyModulus).toHex(),o=ee.util.createBuffer(t.publicKeyExponent).toHex();return ae.setRsaPublicKey(new Te(s,16),new Te(o,16))};ae.publicKeyToAsn1=ae.publicKeyToSubjectPublicKeyInfo=function(e){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(ae.oids.rsaEncryption).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")]),N.create(N.Class.UNIVERSAL,N.Type.BITSTRING,!1,[ae.publicKeyToRSAPublicKey(e)])])};ae.publicKeyToRSAPublicKey=function(e){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,_n(e.n)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,_n(e.e))])};function Tx(e,t,r){var n=ee.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-e.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var l=0,f=ee.random.getBytes(o),c=0;c<o;++c)a=f.charCodeAt(c),a===0?++l:n.putByte(a);o=l}return n.putByte(0),n.putBytes(e),n}u(Tx,"_encodePkcs1_v1_5");function mc(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),s=ee.util.createBuffer(e),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var l=0;l<c;++l)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var f=s.getByte();if(f!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}u(mc,"_decodePkcs1_v1_5");function _P(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){s(e.pBits,function(a,c){if(a)return r(a);if(e.p=c,e.q!==null)return o(a,e.q);s(e.qBits,o)})}u(i,"generate");function s(a,c){ee.prime.generateProbablePrime(a,n,c)}u(s,"getPrime");function o(a,c){if(a)return r(a);if(e.q=c,e.p.compareTo(e.q)<0){var l=e.p;e.p=e.q,e.q=l}if(e.p.subtract(Te.ONE).gcd(e.e).compareTo(Te.ONE)!==0){e.p=null,i();return}if(e.q.subtract(Te.ONE).gcd(e.e).compareTo(Te.ONE)!==0){e.q=null,s(e.qBits,o);return}if(e.p1=e.p.subtract(Te.ONE),e.q1=e.q.subtract(Te.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(Te.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,s(e.qBits,o);return}var f=e.e.modInverse(e.phi);e.keys={privateKey:ae.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:ae.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}u(o,"finish")}u(_P,"_generateKeyPair");function _n(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=ee.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}u(_n,"_bnToBytes");function wP(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}u(wP,"_getMillerRabinTests");function vx(e){return ee.util.isNodejs&&typeof e0[e]=="function"}u(vx,"_detectNodeCrypto");function Ex(e){return typeof Mr.globalScope<"u"&&typeof Mr.globalScope.crypto=="object"&&typeof Mr.globalScope.crypto.subtle=="object"&&typeof Mr.globalScope.crypto.subtle[e]=="function"}u(Ex,"_detectSubtleCrypto");function Cx(e){return typeof Mr.globalScope<"u"&&typeof Mr.globalScope.msCrypto=="object"&&typeof Mr.globalScope.msCrypto.subtle=="object"&&typeof Mr.globalScope.msCrypto.subtle[e]=="function"}u(Cx,"_detectSubtleMsCrypto");function Sx(e){for(var t=ee.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}u(Sx,"_intToUint8Array")});var t0=_((cK,Bx)=>{var W=fe();li();on();la();mn();fi();hc();Wi();Ur();jd();pa();Ae();typeof wx>"u"&&(wx=W.jsbn.BigInteger);var wx,F=W.asn1,ce=W.pki=W.pki||{};Bx.exports=ce.pbe=W.pbe=W.pbe||{};var Yi=ce.oids,bP={name:"EncryptedPrivateKeyInfo",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},IP={name:"PBES2Algorithms",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:F.Class.UNIVERSAL,type:F.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:F.Class.UNIVERSAL,type:F.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},AP={name:"pkcs-12PbeParams",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:F.Class.UNIVERSAL,type:F.Type.INTEGER,constructed:!1,capture:"iterations"}]};ce.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=W.random.getBytesSync(r.saltSize),i=r.count,s=F.integerToDer(i),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var l,f,h;switch(r.algorithm){case"aes128":o=16,l=16,f=Yi["aes128-CBC"],h=W.aes.createEncryptionCipher;break;case"aes192":o=24,l=16,f=Yi["aes192-CBC"],h=W.aes.createEncryptionCipher;break;case"aes256":o=32,l=16,f=Yi["aes256-CBC"],h=W.aes.createEncryptionCipher;break;case"des":o=8,l=8,f=Yi.desCBC,h=W.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var g="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Ax(g),y=W.pkcs5.pbkdf2(t,n,i,o,p),v=W.random.getBytesSync(l),m=h(y);m.start(v),m.update(F.toDer(e)),m.finish(),c=m.output.getBytes();var x=BP(n,s,o,g);a=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(Yi.pkcs5PBES2).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(Yi.pkcs5PBKDF2).getBytes()),x]),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(f).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){o=24;var w=new W.util.ByteBuffer(n),y=ce.pbe.generatePkcs12Key(t,w,1,i,o),v=ce.pbe.generatePkcs12Key(t,w,2,i,o),m=W.des.createEncryptionCipher(y);m.start(v),m.update(F.toDer(e)),m.finish(),c=m.output.getBytes(),a=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(Yi["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,n),F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,s.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var B=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[a,F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,c)]);return B};ce.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!F.validate(e,bP,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=F.derToOid(n.encryptionOid),a=ce.pbe.getCipher(o,n.encryptionParams,t),c=W.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=F.fromDer(a.output)),r};ce.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:F.toDer(e).getBytes()};return W.pem.encode(r,{maxline:t})};ce.encryptedPrivateKeyFromPem=function(e){var t=W.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return F.fromDer(t.body)};ce.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=ce.wrapRsaPrivateKey(ce.privateKeyToAsn1(e));return n=ce.encryptPrivateKeyInfo(n,t,r),ce.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=W.random.getBytesSync(16),a=W.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=W.random.getBytesSync(16),a=W.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=W.random.getBytesSync(16),a=W.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=W.random.getBytesSync(8),a=W.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=W.random.getBytesSync(8),a=W.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var l=W.pbe.opensslDeriveBytes(t,s.substr(0,8),o),f=a(l);f.start(s),f.update(F.toDer(ce.privateKeyToAsn1(e))),f.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:W.util.bytesToHex(s).toUpperCase()},body:f.output.getBytes()};return W.pem.encode(h)};ce.decryptRsaPrivateKey=function(e,t){var r=null,n=W.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=W.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=W.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=W.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=W.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=W.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=u(function(h){return W.rc2.createDecryptionCipher(h,40)},"cipherFn");break;case"RC2-64-CBC":s=8,o=u(function(h){return W.rc2.createDecryptionCipher(h,64)},"cipherFn");break;case"RC2-128-CBC":s=16,o=u(function(h){return W.rc2.createDecryptionCipher(h,128)},"cipherFn");break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=W.util.hexToBytes(n.dekInfo.parameters),c=W.pbe.opensslDeriveBytes(t,a.substr(0,8),s),l=o(c);if(l.start(a),l.update(W.util.createBuffer(n.body)),l.finish())r=l.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=ce.decryptPrivateKeyInfo(F.fromDer(r),t):r=F.fromDer(r),r!==null&&(r=ce.privateKeyFromAsn1(r)),r};ce.pbe.generatePkcs12Key=function(e,t,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in W.md))throw new Error('"sha1" hash algorithm unavailable.');s=W.md.sha1.create()}var c=s.digestLength,l=s.blockLength,f=new W.util.ByteBuffer,h=new W.util.ByteBuffer;if(e!=null){for(a=0;a<e.length;a++)h.putInt16(e.charCodeAt(a));h.putInt16(0)}var d=h.length(),g=t.length(),p=new W.util.ByteBuffer;p.fillWithByte(r,l);var y=l*Math.ceil(g/l),v=new W.util.ByteBuffer;for(a=0;a<y;a++)v.putByte(t.at(a%g));var m=l*Math.ceil(d/l),x=new W.util.ByteBuffer;for(a=0;a<m;a++)x.putByte(h.at(a%d));var w=v;w.putBuffer(x);for(var B=Math.ceil(i/c),R=1;R<=B;R++){var L=new W.util.ByteBuffer;L.putBytes(p.bytes()),L.putBytes(w.bytes());for(var Y=0;Y<n;Y++)s.start(),s.update(L.getBytes()),L=s.digest();var X=new W.util.ByteBuffer;for(a=0;a<l;a++)X.putByte(L.at(a%c));var ne=Math.ceil(g/l)+Math.ceil(d/l),le=new W.util.ByteBuffer;for(o=0;o<ne;o++){var Ce=new W.util.ByteBuffer(w.getBytes(l)),we=511;for(a=X.length()-1;a>=0;a--)we=we>>8,we+=X.at(a)+Ce.at(a),Ce.setAt(a,we&255);le.putBuffer(Ce)}w=le,f.putBuffer(L)}return f.truncate(f.length()-i),f};ce.pbe.getCipher=function(e,t,r){switch(e){case ce.oids.pkcs5PBES2:return ce.pbe.getCipherForPBES2(e,t,r);case ce.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case ce.oids["pbewithSHAAnd40BitRC2-CBC"]:return ce.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};ce.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!F.validate(t,IP,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(e=F.derToOid(n.kdfOid),e!==ce.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=e,s.supportedOids=["pkcs5PBKDF2"],s}if(e=F.derToOid(n.encOid),e!==ce.oids["aes128-CBC"]&&e!==ce.oids["aes192-CBC"]&&e!==ce.oids["aes256-CBC"]&&e!==ce.oids["des-EDE3-CBC"]&&e!==ce.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=W.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,l;switch(ce.oids[e]){case"aes128-CBC":c=16,l=W.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,l=W.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,l=W.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,l=W.des.createDecryptionCipher;break;case"desCBC":c=8,l=W.des.createDecryptionCipher;break}var f=Ix(n.prfOid),h=W.pkcs5.pbkdf2(r,o,a,c,f),d=n.encIv,g=l(h);return g.start(d),g};ce.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!F.validate(t,AP,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=W.util.createBuffer(n.salt),a=W.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,l,f;switch(e){case ce.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,l=8,f=W.des.startDecrypting;break;case ce.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,l=8,f=u(function(y,v){var m=W.rc2.createDecryptionCipher(y,40);return m.start(v,null),m},"cipherFn");break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=e,s}var h=Ix(n.prfOid),d=ce.pbe.generatePkcs12Key(r,o,1,a,c,h);h.start();var g=ce.pbe.generatePkcs12Key(r,o,2,a,l,h);return f(d,g)};ce.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in W.md))throw new Error('"md5" hash algorithm unavailable.');n=W.md.md5.create()}t===null&&(t="");for(var i=[bx(n,e+t)],s=16,o=1;s<r;++o,s+=16)i.push(bx(n,i[o-1]+e+t));return i.join("").substr(0,r)};function bx(e,t){return e.start().update(t).digest().getBytes()}u(bx,"hash");function Ix(e){var t;if(!e)t="hmacWithSHA1";else if(t=ce.oids[F.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Ax(t)}u(Ix,"prfOidToMessageDigest");function Ax(e){var t=W.md;switch(e){case"hmacWithSHA224":t=W.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}u(Ax,"prfAlgorithmToMessageDigest");function BP(e,t,r,n){var i=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,e),F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,W.util.hexToBytes(r.toString(16))),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(ce.oids[n]).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.NULL,!1,"")])),i}u(BP,"createPbkdf2Params")});var r0=_((fK,Dx)=>{var Zs=fe();on();Ae();var z=Zs.asn1,Ys=Dx.exports=Zs.pkcs7asn1=Zs.pkcs7asn1||{};Zs.pkcs7=Zs.pkcs7||{};Zs.pkcs7.asn1=Ys;var Nx={name:"ContentInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:z.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};Ys.contentInfoValidator=Nx;var Rx={name:"EncryptedContentInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:z.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:z.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};Ys.envelopedDataValidator={name:"EnvelopedData",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:z.Class.UNIVERSAL,type:z.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(Rx)};Ys.encryptedDataValidator={name:"EncryptedData",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"version"}].concat(Rx)};var NP={name:"SignerInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:z.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:z.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:z.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};Ys.signedDataValidator={name:"SignedData",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:z.Class.UNIVERSAL,type:z.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},Nx,{name:"SignedData.Certificates",tagClass:z.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:z.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:z.Class.UNIVERSAL,type:z.Type.SET,capture:"signerInfos",optional:!0,value:[NP]}]};Ys.recipientInfoValidator={name:"RecipientInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:z.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var n0=_((hK,Lx)=>{var Xi=fe();Ae();Xi.mgf=Xi.mgf||{};var RP=Lx.exports=Xi.mgf.mgf1=Xi.mgf1=Xi.mgf1||{};RP.create=function(e){var t={generate:function(r,n){for(var i=new Xi.util.ByteBuffer,s=Math.ceil(n/e.digestLength),o=0;o<s;o++){var a=new Xi.util.ByteBuffer;a.putInt32(o),e.start(),e.update(r+a.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-n),i.getBytes()}};return t}});var Fx=_((pK,Ox)=>{var vc=fe();n0();Ox.exports=vc.mgf=vc.mgf||{};vc.mgf.mgf1=vc.mgf1});var Ec=_((dK,Px)=>{var Ji=fe();Ur();Ae();var DP=Px.exports=Ji.pss=Ji.pss||{};DP.create=function(e){arguments.length===3&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t=e.md,r=e.mgf,n=t.digestLength,i=e.salt||null;typeof i=="string"&&(i=Ji.util.createBuffer(i));var s;if("saltLength"in e)s=e.saltLength;else if(i!==null)s=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=e.prng||Ji.random,a={};return a.encode=function(c,l){var f,h=l-1,d=Math.ceil(h/8),g=c.digest().getBytes();if(d<n+s+2)throw new Error("Message is too long to encrypt.");var p;i===null?p=o.getBytesSync(s):p=i.bytes();var y=new Ji.util.ByteBuffer;y.fillWithByte(0,8),y.putBytes(g),y.putBytes(p),t.start(),t.update(y.getBytes());var v=t.digest().getBytes(),m=new Ji.util.ByteBuffer;m.fillWithByte(0,d-s-n-2),m.putByte(1),m.putBytes(p);var x=m.getBytes(),w=d-n-1,B=r.generate(v,w),R="";for(f=0;f<w;f++)R+=String.fromCharCode(x.charCodeAt(f)^B.charCodeAt(f));var L=65280>>8*d-h&255;return R=String.fromCharCode(R.charCodeAt(0)&~L)+R.substr(1),R+v+"\xBC"},a.verify=function(c,l,f){var h,d=f-1,g=Math.ceil(d/8);if(l=l.substr(-g),g<n+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(l.charCodeAt(g-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var p=g-n-1,y=l.substr(0,p),v=l.substr(p,n),m=65280>>8*g-d&255;if(y.charCodeAt(0)&m)throw new Error("Bits beyond keysize not zero as expected.");var x=r.generate(v,p),w="";for(h=0;h<p;h++)w+=String.fromCharCode(y.charCodeAt(h)^x.charCodeAt(h));w=String.fromCharCode(w.charCodeAt(0)&~m)+w.substr(1);var B=g-n-s-2;for(h=0;h<B;h++)if(w.charCodeAt(h)!==0)throw new Error("Leftmost octets not zero as expected");if(w.charCodeAt(B)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var R=w.substr(-s),L=new Ji.util.ByteBuffer;L.fillWithByte(0,8),L.putBytes(c),L.putBytes(R),t.start(),t.update(L.getBytes());var Y=t.digest().getBytes();return v===Y},a}});var xc=_((gK,Mx)=>{var te=fe();li();on();la();mn();Fx();fi();Wi();Ec();pa();Ae();var E=te.asn1,$=Mx.exports=te.pki=te.pki||{},_e=$.oids,at={};at.CN=_e.commonName;at.commonName="CN";at.C=_e.countryName;at.countryName="C";at.L=_e.localityName;at.localityName="L";at.ST=_e.stateOrProvinceName;at.stateOrProvinceName="ST";at.O=_e.organizationName;at.organizationName="O";at.OU=_e.organizationalUnitName;at.organizationalUnitName="OU";at.E=_e.emailAddress;at.emailAddress="E";var qx=te.pki.rsa.publicKeyValidator,LP={name:"Certificate",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:E.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:E.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:E.Class.UNIVERSAL,type:E.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:E.Class.UNIVERSAL,type:E.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:E.Class.UNIVERSAL,type:E.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:E.Class.UNIVERSAL,type:E.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},qx,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:E.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:E.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:E.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:E.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},OP={name:"rsapss",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:E.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:E.Class.UNIVERSAL,type:E.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:E.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:E.Class.UNIVERSAL,type:E.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:E.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:E.Class.UNIVERSAL,type:E.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:E.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:E.Class.UNIVERSAL,type:E.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},FP={name:"CertificationRequestInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},qx,{name:"CertificationRequestInfo.attributes",tagClass:E.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:E.Class.UNIVERSAL,type:E.Type.SET,constructed:!0}]}]}]},PP={name:"CertificationRequest",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[FP,{name:"CertificationRequest.signatureAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:E.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};$.RDNAttributesAsArray=function(e,t){for(var r=[],n,i,s,o=0;o<e.value.length;++o){n=e.value[o];for(var a=0;a<n.value.length;++a)s={},i=n.value[a],s.type=E.derToOid(i.value[0].value),s.value=i.value[1].value,s.valueTagClass=i.value[1].type,s.type in _e&&(s.name=_e[s.type],s.name in at&&(s.shortName=at[s.name])),t&&(t.update(s.type),t.update(s.value)),r.push(s)}return r};$.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],i=E.derToOid(n.value[0].value),s=n.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=i,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in _e&&(a.name=_e[a.type],a.name in at&&(a.shortName=at[a.name])),a.type===_e.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push($.certificateExtensionFromAsn1(a.value[c]))}t.push(a)}return t};function di(e,t){typeof t=="string"&&(t={shortName:t});for(var r=null,n,i=0;r===null&&i<e.attributes.length;++i)n=e.attributes[i],(t.type&&t.type===n.type||t.name&&t.name===n.name||t.shortName&&t.shortName===n.shortName)&&(r=n);return r}u(di,"_getAttribute");var Cc=u(function(e,t,r){var n={};if(e!==_e["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:_e.sha1},mgf:{algorithmOid:_e.mgf1,hash:{algorithmOid:_e.sha1}},saltLength:20});var i={},s=[];if(!E.validate(t,OP,i,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return i.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=E.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=E.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=E.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(n.saltLength=i.saltLength.charCodeAt(0)),n},"_readSignatureParameters"),Sc=u(function(e){switch(_e[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return te.md.sha1.create();case"md5WithRSAEncryption":return te.md.md5.create();case"sha256WithRSAEncryption":return te.md.sha256.create();case"sha384WithRSAEncryption":return te.md.sha384.create();case"sha512WithRSAEncryption":return te.md.sha512.create();case"RSASSA-PSS":return te.md.sha256.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},"_createSignatureDigest"),Ux=u(function(e){var t=e.certificate,r;switch(t.signatureOid){case _e.sha1WithRSAEncryption:case _e.sha1WithRSASignature:break;case _e["RSASSA-PSS"]:var n,i;if(n=_e[t.signatureParameters.mgf.hash.algorithmOid],n===void 0||te.md[n]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=t.signatureParameters.mgf.hash.algorithmOid,s.name=n,s}if(i=_e[t.signatureParameters.mgf.algorithmOid],i===void 0||te.mgf[i]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=t.signatureParameters.mgf.algorithmOid,s.name=i,s}if(i=te.mgf[i].create(te.md[n].create()),n=_e[t.signatureParameters.hash.algorithmOid],n===void 0||te.md[n]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=t.signatureParameters.hash.algorithmOid,s.name=n,s}r=te.pss.create(te.md[n].create(),i,t.signatureParameters.saltLength);break}return t.publicKey.verify(e.md.digest().getBytes(),e.signature,r)},"_verifySignature");$.certificateFromPem=function(e,t,r){var n=te.pem.decode(e)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=E.fromDer(n.body,r);return $.certificateFromAsn1(s,t)};$.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:E.toDer($.certificateToAsn1(e)).getBytes()};return te.pem.encode(r,{maxline:t})};$.publicKeyFromPem=function(e){var t=te.pem.decode(e)[0];if(t.type!=="PUBLIC KEY"&&t.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=E.fromDer(t.body);return $.publicKeyFromAsn1(n)};$.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:E.toDer($.publicKeyToAsn1(e)).getBytes()};return te.pem.encode(r,{maxline:t})};$.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:E.toDer($.publicKeyToRSAPublicKey(e)).getBytes()};return te.pem.encode(r,{maxline:t})};$.getPublicKeyFingerprint=function(e,t){t=t||{};var r=t.md||te.md.sha1.create(),n=t.type||"RSAPublicKey",i;switch(n){case"RSAPublicKey":i=E.toDer($.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":i=E.toDer($.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}r.start(),r.update(i);var s=r.digest();if(t.encoding==="hex"){var o=s.toHex();return t.delimiter?o.match(/.{2}/g).join(t.delimiter):o}else{if(t.encoding==="binary")return s.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return s};$.certificationRequestFromPem=function(e,t,r){var n=te.pem.decode(e)[0];if(n.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=E.fromDer(n.body,r);return $.certificationRequestFromAsn1(s,t)};$.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:E.toDer($.certificationRequestToAsn1(e)).getBytes()};return te.pem.encode(r,{maxline:t})};$.createCertificate=function(){var e={};return e.version=2,e.serialNumber="00",e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return di(e.issuer,t)},e.issuer.addField=function(t){Kr([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return di(e.subject,t)},e.subject.addField=function(t){Kr([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){Kr(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){Kr(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)Vx(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){typeof t=="string"&&(t={name:t});for(var r=null,n,i=0;r===null&&i<e.extensions.length;++i)n=e.extensions[i],(t.id&&n.id===t.id||t.name&&n.name===t.name)&&(r=n);return r},e.sign=function(t,r){e.md=r||te.md.sha1.create();var n=_e[e.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=e.md.algorithm,i}e.signatureOid=e.siginfo.algorithmOid=n,e.tbsCertificate=$.getTBSCertificate(e);var s=E.toDer(e.tbsCertificate);e.md.update(s.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var n=t.issuer,i=e.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var o=t.md;if(o===null){o=Sc({signatureOid:t.signatureOid,type:"certificate"});var a=t.tbsCertificate||$.getTBSCertificate(t),c=E.toDer(a);o.update(c.getBytes())}return o!==null&&(r=Ux({certificate:e,md:o,signature:t.signature})),r},e.isIssuer=function(t){var r=!1,n=e.issuer,i=t.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){r=!0;for(var s,o,a=0;r&&a<n.attributes.length;++a)s=n.attributes[a],o=i.attributes[a],(s.type!==o.type||s.value!==o.value)&&(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return $.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=_e.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var n=e.extensions[r];if(n.id===t){var i=e.generateSubjectKeyIdentifier().getBytes();return te.util.hexToBytes(n.subjectKeyIdentifier)===i}}return!1},e};$.certificateFromAsn1=function(e,t){var r={},n=[];if(!E.validate(e,LP,r,n)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=n,i}var s=E.derToOid(r.publicKeyOid);if(s!==$.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=$.createCertificate();o.version=r.certVersion?r.certVersion.charCodeAt(0):0;var a=te.util.createBuffer(r.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=te.asn1.derToOid(r.certSignatureOid),o.signatureParameters=Cc(o.signatureOid,r.certSignatureParams,!0),o.siginfo.algorithmOid=te.asn1.derToOid(r.certinfoSignatureOid),o.siginfo.parameters=Cc(o.siginfo.algorithmOid,r.certinfoSignatureParams,!1),o.signature=r.certSignature;var c=[];if(r.certValidity1UTCTime!==void 0&&c.push(E.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&c.push(E.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&c.push(E.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&c.push(E.generalizedTimeToDate(r.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=r.tbsCertificate,t){o.md=Sc({signatureOid:o.signatureOid,type:"certificate"});var l=E.toDer(o.tbsCertificate);o.md.update(l.getBytes())}var f=te.md.sha1.create(),h=E.toDer(r.certIssuer);f.update(h.getBytes()),o.issuer.getField=function(p){return di(o.issuer,p)},o.issuer.addField=function(p){Kr([p]),o.issuer.attributes.push(p)},o.issuer.attributes=$.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(o.issuer.uniqueId=r.certIssuerUniqueId),o.issuer.hash=f.digest().toHex();var d=te.md.sha1.create(),g=E.toDer(r.certSubject);return d.update(g.getBytes()),o.subject.getField=function(p){return di(o.subject,p)},o.subject.addField=function(p){Kr([p]),o.subject.attributes.push(p)},o.subject.attributes=$.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(o.subject.uniqueId=r.certSubjectUniqueId),o.subject.hash=d.digest().toHex(),r.certExtensions?o.extensions=$.certificateExtensionsFromAsn1(r.certExtensions):o.extensions=[],o.publicKey=$.publicKeyFromAsn1(r.subjectPublicKeyInfo),o};$.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],i=0;i<n.value.length;++i)t.push($.certificateExtensionFromAsn1(n.value[i]));return t};$.certificateExtensionFromAsn1=function(e){var t={};if(t.id=E.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===E.Type.BOOLEAN?(t.critical=e.value[1].value.charCodeAt(0)!==0,t.value=e.value[2].value):t.value=e.value[1].value,t.id in _e){if(t.name=_e[t.id],t.name==="keyUsage"){var r=E.fromDer(t.value),n=0,i=0;r.value.length>1&&(n=r.value.charCodeAt(1),i=r.value.length>2?r.value.charCodeAt(2):0),t.digitalSignature=(n&128)===128,t.nonRepudiation=(n&64)===64,t.keyEncipherment=(n&32)===32,t.dataEncipherment=(n&16)===16,t.keyAgreement=(n&8)===8,t.keyCertSign=(n&4)===4,t.cRLSign=(n&2)===2,t.encipherOnly=(n&1)===1,t.decipherOnly=(i&128)===128}else if(t.name==="basicConstraints"){var r=E.fromDer(t.value);r.value.length>0&&r.value[0].type===E.Type.BOOLEAN?t.cA=r.value[0].value.charCodeAt(0)!==0:t.cA=!1;var s=null;r.value.length>0&&r.value[0].type===E.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(t.pathLenConstraint=E.derToInteger(s))}else if(t.name==="extKeyUsage")for(var r=E.fromDer(t.value),o=0;o<r.value.length;++o){var a=E.derToOid(r.value[o].value);a in _e?t[_e[a]]=!0:t[a]=!0}else if(t.name==="nsCertType"){var r=E.fromDer(t.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),t.client=(n&128)===128,t.server=(n&64)===64,t.email=(n&32)===32,t.objsign=(n&16)===16,t.reserved=(n&8)===8,t.sslCA=(n&4)===4,t.emailCA=(n&2)===2,t.objCA=(n&1)===1}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.altNames=[];for(var c,r=E.fromDer(t.value),l=0;l<r.value.length;++l){c=r.value[l];var f={type:c.type,value:c.value};switch(t.altNames.push(f),c.type){case 1:case 2:case 6:break;case 7:f.ip=te.util.bytesToIP(c.value);break;case 8:f.oid=E.derToOid(c.value);break;default:}}}else if(t.name==="subjectKeyIdentifier"){var r=E.fromDer(t.value);t.subjectKeyIdentifier=te.util.bytesToHex(r.value)}}return t};$.certificationRequestFromAsn1=function(e,t){var r={},n=[];if(!E.validate(e,PP,r,n)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=n,i}var s=E.derToOid(r.publicKeyOid);if(s!==$.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=$.createCertificationRequest();if(o.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,o.signatureOid=te.asn1.derToOid(r.csrSignatureOid),o.signatureParameters=Cc(o.signatureOid,r.csrSignatureParams,!0),o.siginfo.algorithmOid=te.asn1.derToOid(r.csrSignatureOid),o.siginfo.parameters=Cc(o.siginfo.algorithmOid,r.csrSignatureParams,!1),o.signature=r.csrSignature,o.certificationRequestInfo=r.certificationRequestInfo,t){o.md=Sc({signatureOid:o.signatureOid,type:"certification request"});var a=E.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=te.md.sha1.create();return o.subject.getField=function(l){return di(o.subject,l)},o.subject.addField=function(l){Kr([l]),o.subject.attributes.push(l)},o.subject.attributes=$.RDNAttributesAsArray(r.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=$.publicKeyFromAsn1(r.subjectPublicKeyInfo),o.getAttribute=function(l){return di(o,l)},o.addAttribute=function(l){Kr([l]),o.attributes.push(l)},o.attributes=$.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),o};$.createCertificationRequest=function(){var e={};return e.version=0,e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return di(e.subject,t)},e.subject.addField=function(t){Kr([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return di(e,t)},e.addAttribute=function(t){Kr([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){Kr(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){Kr(t),e.attributes=t},e.sign=function(t,r){e.md=r||te.md.sha1.create();var n=_e[e.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=e.md.algorithm,i}e.signatureOid=e.siginfo.algorithmOid=n,e.certificationRequestInfo=$.getCertificationRequestInfo(e);var s=E.toDer(e.certificationRequestInfo);e.md.update(s.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(r===null){r=Sc({signatureOid:e.signatureOid,type:"certification request"});var n=e.certificationRequestInfo||$.getCertificationRequestInfo(e),i=E.toDer(n);r.update(i.getBytes())}return r!==null&&(t=Ux({certificate:e,md:r,signature:e.signature})),t},e};function Xs(e){for(var t=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),r,n,i=e.attributes,s=0;s<i.length;++s){r=i[s];var o=r.value,a=E.Type.PRINTABLESTRING;"valueTagClass"in r&&(a=r.valueTagClass,a===E.Type.UTF8&&(o=te.util.encodeUtf8(o))),n=E.create(E.Class.UNIVERSAL,E.Type.SET,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(r.type).getBytes()),E.create(E.Class.UNIVERSAL,a,!1,o)])]),t.value.push(n)}return t}u(Xs,"_dnToAsn1");function Kr(e){for(var t,r=0;r<e.length;++r){if(t=e[r],typeof t.name>"u"&&(t.type&&t.type in $.oids?t.name=$.oids[t.type]:t.shortName&&t.shortName in at&&(t.name=$.oids[at[t.shortName]])),typeof t.type>"u")if(t.name&&t.name in $.oids)t.type=$.oids[t.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=t,n}if(typeof t.shortName>"u"&&t.name&&t.name in at&&(t.shortName=at[t.name]),t.type===_e.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=E.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var i=0;i<t.extensions.length;++i)t.value.push($.certificateExtensionToAsn1(Vx(t.extensions[i])))}if(typeof t.value>"u"){var n=new Error("Attribute value not specified.");throw n.attribute=t,n}}}u(Kr,"_fillMissingFields");function Vx(e,t){if(t=t||{},typeof e.name>"u"&&e.id&&e.id in $.oids&&(e.name=$.oids[e.id]),typeof e.id>"u")if(e.name&&e.name in $.oids)e.id=$.oids[e.name];else{var r=new Error("Extension ID not specified.");throw r.extension=e,r}if(typeof e.value<"u")return e;if(e.name==="keyUsage"){var n=0,i=0,s=0;e.digitalSignature&&(i|=128,n=7),e.nonRepudiation&&(i|=64,n=6),e.keyEncipherment&&(i|=32,n=5),e.dataEncipherment&&(i|=16,n=4),e.keyAgreement&&(i|=8,n=3),e.keyCertSign&&(i|=4,n=2),e.cRLSign&&(i|=2,n=1),e.encipherOnly&&(i|=1,n=0),e.decipherOnly&&(s|=128,n=7);var o=String.fromCharCode(n);s!==0?o+=String.fromCharCode(i)+String.fromCharCode(s):i!==0&&(o+=String.fromCharCode(i)),e.value=E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,o)}else if(e.name==="basicConstraints")e.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(E.create(E.Class.UNIVERSAL,E.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in e&&e.value.value.push(E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(e.pathLenConstraint).getBytes()));else if(e.name==="extKeyUsage"){e.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);var a=e.value.value;for(var c in e)e[c]===!0&&(c in _e?a.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(_e[c]).getBytes())):c.indexOf(".")!==-1&&a.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(c).getBytes())))}else if(e.name==="nsCertType"){var n=0,i=0;e.client&&(i|=128,n=7),e.server&&(i|=64,n=6),e.email&&(i|=32,n=5),e.objsign&&(i|=16,n=4),e.reserved&&(i|=8,n=3),e.sslCA&&(i|=4,n=2),e.emailCA&&(i|=2,n=1),e.objCA&&(i|=1,n=0);var o=String.fromCharCode(n);i!==0&&(o+=String.fromCharCode(i)),e.value=E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,o)}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);for(var l,f=0;f<e.altNames.length;++f){l=e.altNames[f];var o=l.value;if(l.type===7&&l.ip){if(o=te.util.bytesFromIP(l.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=e,r}}else l.type===8&&(l.oid?o=E.oidToDer(E.oidToDer(l.oid)):o=E.oidToDer(o));e.value.value.push(E.create(E.Class.CONTEXT_SPECIFIC,l.type,!1,o))}}else if(e.name==="nsComment"&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=E.create(E.Class.UNIVERSAL,E.Type.IA5STRING,!1,e.comment)}else if(e.name==="subjectKeyIdentifier"&&t.cert){var h=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=h.toHex(),e.value=E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,h.getBytes())}else if(e.name==="authorityKeyIdentifier"&&t.cert){e.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);var a=e.value.value;if(e.keyIdentifier){var d=e.keyIdentifier===!0?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;a.push(E.create(E.Class.CONTEXT_SPECIFIC,0,!1,d))}if(e.authorityCertIssuer){var g=[E.create(E.Class.CONTEXT_SPECIFIC,4,!0,[Xs(e.authorityCertIssuer===!0?t.cert.issuer:e.authorityCertIssuer)])];a.push(E.create(E.Class.CONTEXT_SPECIFIC,1,!0,g))}if(e.serialNumber){var p=te.util.hexToBytes(e.serialNumber===!0?t.cert.serialNumber:e.serialNumber);a.push(E.create(E.Class.CONTEXT_SPECIFIC,2,!1,p))}}else if(e.name==="cRLDistributionPoints"){e.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);for(var a=e.value.value,y=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),v=E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[]),l,f=0;f<e.altNames.length;++f){l=e.altNames[f];var o=l.value;if(l.type===7&&l.ip){if(o=te.util.bytesFromIP(l.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=e,r}}else l.type===8&&(l.oid?o=E.oidToDer(E.oidToDer(l.oid)):o=E.oidToDer(o));v.value.push(E.create(E.Class.CONTEXT_SPECIFIC,l.type,!1,o))}y.value.push(E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[v])),a.push(y)}if(typeof e.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=e,r}return e}u(Vx,"_fillMissingExtensionFields");function i0(e,t){switch(e){case _e["RSASSA-PSS"]:var r=[];return t.hash.algorithmOid!==void 0&&r.push(E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(t.hash.algorithmOid).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])])),t.mgf.algorithmOid!==void 0&&r.push(E.create(E.Class.CONTEXT_SPECIFIC,1,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(t.mgf.algorithmOid).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(t.mgf.hash.algorithmOid).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])])])),t.saltLength!==void 0&&r.push(E.create(E.Class.CONTEXT_SPECIFIC,2,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(t.saltLength).getBytes())])),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,r);default:return E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")}}u(i0,"_signatureParametersToAsn1");function kP(e){var t=E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[]);if(e.attributes.length===0)return t;for(var r=e.attributes,n=0;n<r.length;++n){var i=r[n],s=i.value,o=E.Type.UTF8;"valueTagClass"in i&&(o=i.valueTagClass),o===E.Type.UTF8&&(s=te.util.encodeUtf8(s));var a=!1;"valueConstructed"in i&&(a=i.valueConstructed);var c=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(i.type).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SET,!0,[E.create(E.Class.UNIVERSAL,o,a,s)])]);t.value.push(c)}return t}u(kP,"_CRIAttributesToAsn1");var qP=new Date("1950-01-01T00:00:00Z"),UP=new Date("2050-01-01T00:00:00Z");function kx(e){return e>=qP&&e<UP?E.create(E.Class.UNIVERSAL,E.Type.UTCTIME,!1,E.dateToUtcTime(e)):E.create(E.Class.UNIVERSAL,E.Type.GENERALIZEDTIME,!1,E.dateToGeneralizedTime(e))}u(kx,"_dateToAsn1");$.getTBSCertificate=function(e){var t=kx(e.validity.notBefore),r=kx(e.validity.notAfter),n=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(e.version).getBytes())]),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,te.util.hexToBytes(e.serialNumber)),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.siginfo.algorithmOid).getBytes()),i0(e.siginfo.algorithmOid,e.siginfo.parameters)]),Xs(e.issuer),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[t,r]),Xs(e.subject),$.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&n.value.push(E.create(E.Class.CONTEXT_SPECIFIC,1,!0,[E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,"\0"+e.issuer.uniqueId)])),e.subject.uniqueId&&n.value.push(E.create(E.Class.CONTEXT_SPECIFIC,2,!0,[E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,"\0"+e.subject.uniqueId)])),e.extensions.length>0&&n.value.push($.certificateExtensionsToAsn1(e.extensions)),n};$.getCertificationRequestInfo=function(e){var t=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(e.version).getBytes()),Xs(e.subject),$.publicKeyToAsn1(e.publicKey),kP(e)]);return t};$.distinguishedNameToAsn1=function(e){return Xs(e)};$.certificateToAsn1=function(e){var t=e.tbsCertificate||$.getTBSCertificate(e);return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[t,E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.signatureOid).getBytes()),i0(e.signatureOid,e.signatureParameters)]),E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,"\0"+e.signature)])};$.certificateExtensionsToAsn1=function(e){var t=E.create(E.Class.CONTEXT_SPECIFIC,3,!0,[]),r=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push($.certificateExtensionToAsn1(e[n]));return t};$.certificateExtensionToAsn1=function(e){var t=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);t.value.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.id).getBytes())),e.critical&&t.value.push(E.create(E.Class.UNIVERSAL,E.Type.BOOLEAN,!1,"\xFF"));var r=e.value;return typeof e.value!="string"&&(r=E.toDer(r).getBytes()),t.value.push(E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,r)),t};$.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||$.getCertificationRequestInfo(e);return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[t,E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.signatureOid).getBytes()),i0(e.signatureOid,e.signatureParameters)]),E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,"\0"+e.signature)])};$.createCaStore=function(e){var t={certs:{}};t.getIssuer=function(o){var a=r(o.issuer);return a},t.addCertificate=function(o){if(typeof o=="string"&&(o=te.pki.certificateFromPem(o)),n(o.subject),!t.hasCertificate(o))if(o.subject.hash in t.certs){var a=t.certs[o.subject.hash];te.util.isArray(a)||(a=[a]),a.push(o),t.certs[o.subject.hash]=a}else t.certs[o.subject.hash]=o},t.hasCertificate=function(o){typeof o=="string"&&(o=te.pki.certificateFromPem(o));var a=r(o.subject);if(!a)return!1;te.util.isArray(a)||(a=[a]);for(var c=E.toDer($.certificateToAsn1(o)).getBytes(),l=0;l<a.length;++l){var f=E.toDer($.certificateToAsn1(a[l])).getBytes();if(c===f)return!0}return!1},t.listAllCertificates=function(){var o=[];for(var a in t.certs)if(t.certs.hasOwnProperty(a)){var c=t.certs[a];if(!te.util.isArray(c))o.push(c);else for(var l=0;l<c.length;++l)o.push(c[l])}return o},t.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=te.pki.certificateFromPem(o)),n(o.subject),!t.hasCertificate(o))return null;var c=r(o.subject);if(!te.util.isArray(c))return a=t.certs[o.subject.hash],delete t.certs[o.subject.hash],a;for(var l=E.toDer($.certificateToAsn1(o)).getBytes(),f=0;f<c.length;++f){var h=E.toDer($.certificateToAsn1(c[f])).getBytes();l===h&&(a=c[f],c.splice(f,1))}return c.length===0&&delete t.certs[o.subject.hash],a};function r(o){return n(o),t.certs[o.hash]||null}u(r,"getBySubject");function n(o){if(!o.hash){var a=te.md.sha1.create();o.attributes=$.RDNAttributesAsArray(Xs(o),a),o.hash=a.digest().toHex()}}if(u(n,"ensureSubjectHasHash"),e)for(var i=0;i<e.length;++i){var s=e[i];t.addCertificate(s)}return t};$.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};$.verifyCertificateChain=function(e,t,r){typeof r=="function"&&(r={verify:r}),r=r||{},t=t.slice(0);var n=t.slice(0),i=r.validityCheckDate;typeof i>"u"&&(i=new Date);var s=!0,o=null,a=0;do{var c=t.shift(),l=null,f=!1;if(i&&(i<c.validity.notBefore||i>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:$.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:i}),o===null){if(l=t[0]||e.getIssuer(c),l===null&&c.isIssuer(c)&&(f=!0,l=c),l){var h=l;te.util.isArray(h)||(h=[h]);for(var d=!1;!d&&h.length>0;){l=h.shift();try{d=l.verify(c)}catch{}}d||(o={message:"Certificate signature is invalid.",error:$.certificateError.bad_certificate})}o===null&&(!l||f)&&!e.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:$.certificateError.unknown_ca})}if(o===null&&l&&!c.isIssuer(l)&&(o={message:"Certificate issuer is invalid.",error:$.certificateError.bad_certificate}),o===null)for(var g={keyUsage:!0,basicConstraints:!0},p=0;o===null&&p<c.extensions.length;++p){var y=c.extensions[p];y.critical&&!(y.name in g)&&(o={message:"Certificate has an unsupported critical extension.",error:$.certificateError.unsupported_certificate})}if(o===null&&(!s||t.length===0&&(!l||f))){var v=c.getExtension("basicConstraints"),m=c.getExtension("keyUsage");if(m!==null&&(!m.keyCertSign||v===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:$.certificateError.bad_certificate}),o===null&&v!==null&&!v.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:$.certificateError.bad_certificate}),o===null&&m!==null&&"pathLenConstraint"in v){var x=a-1;x>v.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:$.certificateError.bad_certificate})}}var w=o===null?!0:o.error,B=r.verify?r.verify(w,a,n):w;if(B===!0)o=null;else throw w===!0&&(o={message:"The application rejected the certificate.",error:$.certificateError.bad_certificate}),(B||B===0)&&(typeof B=="object"&&!te.util.isArray(B)?(B.message&&(o.message=B.message),B.error&&(o.error=B.error)):typeof B=="string"&&(o.error=B)),o;s=!1,++a}while(t.length>0);return!0}});var o0=_((mK,Hx)=>{var $e=fe();on();Gs();fi();r0();t0();Ur();pa();Qs();Ae();xc();var T=$e.asn1,ye=$e.pki,ga=Hx.exports=$e.pkcs12=$e.pkcs12||{},Kx={name:"ContentInfo",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:T.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},VP={name:"PFX",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"version"},Kx,{name:"PFX.macData",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:T.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:T.Class.UNIVERSAL,type:T.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:T.Class.UNIVERSAL,type:T.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},MP={name:"SafeBag",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:T.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:T.Class.UNIVERSAL,type:T.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},KP={name:"Attribute",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:T.Class.UNIVERSAL,type:T.Type.SET,constructed:!0,capture:"values"}]},HP={name:"CertBag",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:T.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:T.Class.UNIVERSAL,type:T.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function da(e,t,r,n){for(var i=[],s=0;s<e.length;s++)for(var o=0;o<e[s].safeBags.length;o++){var a=e[s].safeBags[o];if(!(n!==void 0&&a.type!==n)){if(t===null){i.push(a);continue}a.attributes[t]!==void 0&&a.attributes[t].indexOf(r)>=0&&i.push(a)}}return i}u(da,"_getBagsByAttribute");ga.pkcs12FromAsn1=function(e,t,r){typeof t=="string"?(r=t,t=!0):t===void 0&&(t=!0);var n={},i=[];if(!T.validate(e,VP,n,i)){var s=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw s.errors=s,s}var o={version:n.version.charCodeAt(0),safeContents:[],getBags:function(v){var m={},x;return"localKeyId"in v?x=v.localKeyId:"localKeyIdHex"in v&&(x=$e.util.hexToBytes(v.localKeyIdHex)),x===void 0&&!("friendlyName"in v)&&"bagType"in v&&(m[v.bagType]=da(o.safeContents,null,null,v.bagType)),x!==void 0&&(m.localKeyId=da(o.safeContents,"localKeyId",x,v.bagType)),"friendlyName"in v&&(m.friendlyName=da(o.safeContents,"friendlyName",v.friendlyName,v.bagType)),m},getBagsByFriendlyName:function(v,m){return da(o.safeContents,"friendlyName",v,m)},getBagsByLocalKeyId:function(v,m){return da(o.safeContents,"localKeyId",v,m)}};if(n.version.charCodeAt(0)!==3){var s=new Error("PKCS#12 PFX of version other than 3 not supported.");throw s.version=n.version.charCodeAt(0),s}if(T.derToOid(n.contentType)!==ye.oids.data){var s=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw s.oid=T.derToOid(n.contentType),s}var a=n.content.value[0];if(a.tagClass!==T.Class.UNIVERSAL||a.type!==T.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(a=s0(a),n.mac){var c=null,l=0,f=T.derToOid(n.macAlgorithm);switch(f){case ye.oids.sha1:c=$e.md.sha1.create(),l=20;break;case ye.oids.sha256:c=$e.md.sha256.create(),l=32;break;case ye.oids.sha384:c=$e.md.sha384.create(),l=48;break;case ye.oids.sha512:c=$e.md.sha512.create(),l=64;break;case ye.oids.md5:c=$e.md.md5.create(),l=16;break}if(c===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+f);var h=new $e.util.ByteBuffer(n.macSalt),d="macIterations"in n?parseInt($e.util.bytesToHex(n.macIterations),16):1,g=ga.generateKey(r,h,3,d,l,c),p=$e.hmac.create();p.start(c,g),p.update(a.value);var y=p.getMac();if(y.getBytes()!==n.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return $P(o,a.value,t,r),o};function s0(e){if(e.composed||e.constructed){for(var t=$e.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}u(s0,"_decodePkcs7Data");function $P(e,t,r,n){if(t=T.fromDer(t,r),t.tagClass!==T.Class.UNIVERSAL||t.type!==T.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var i=0;i<t.value.length;i++){var s=t.value[i],o={},a=[];if(!T.validate(s,Kx,o,a)){var c=new Error("Cannot read ContentInfo.");throw c.errors=a,c}var l={encrypted:!1},f=null,h=o.content.value[0];switch(T.derToOid(o.contentType)){case ye.oids.data:if(h.tagClass!==T.Class.UNIVERSAL||h.type!==T.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");f=s0(h).value;break;case ye.oids.encryptedData:f=GP(h,n),l.encrypted=!0;break;default:var c=new Error("Unsupported PKCS#12 contentType.");throw c.contentType=T.derToOid(o.contentType),c}l.safeBags=jP(f,r,n),e.safeContents.push(l)}}u($P,"_decodeAuthenticatedSafe");function GP(e,t){var r={},n=[];if(!T.validate(e,$e.pkcs7.asn1.encryptedDataValidator,r,n)){var i=new Error("Cannot read EncryptedContentInfo.");throw i.errors=n,i}var s=T.derToOid(r.contentType);if(s!==ye.oids.data){var i=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw i.oid=s,i}s=T.derToOid(r.encAlgorithm);var o=ye.pbe.getCipher(s,r.encParameter,t),a=s0(r.encryptedContentAsn1),c=$e.util.createBuffer(a.value);if(o.update(c),!o.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return o.output.getBytes()}u(GP,"_decryptSafeContents");function jP(e,t,r){if(!t&&e.length===0)return[];if(e=T.fromDer(e,t),e.tagClass!==T.Class.UNIVERSAL||e.type!==T.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],i=0;i<e.value.length;i++){var s=e.value[i],o={},a=[];if(!T.validate(s,MP,o,a)){var c=new Error("Cannot read SafeBag.");throw c.errors=a,c}var l={type:T.derToOid(o.bagId),attributes:zP(o.bagAttributes)};n.push(l);var f,h,d=o.bagValue.value[0];switch(l.type){case ye.oids.pkcs8ShroudedKeyBag:if(d=ye.decryptPrivateKeyInfo(d,r),d===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case ye.oids.keyBag:try{l.key=ye.privateKeyFromAsn1(d)}catch{l.key=null,l.asn1=d}continue;case ye.oids.certBag:f=HP,h=u(function(){if(T.derToOid(o.certId)!==ye.oids.x509Certificate){var p=new Error("Unsupported certificate type, only X.509 supported.");throw p.oid=T.derToOid(o.certId),p}var y=T.fromDer(o.cert,t);try{l.cert=ye.certificateFromAsn1(y,!0)}catch{l.cert=null,l.asn1=y}},"decoder");break;default:var c=new Error("Unsupported PKCS#12 SafeBag type.");throw c.oid=l.type,c}if(f!==void 0&&!T.validate(d,f,o,a)){var c=new Error("Cannot read PKCS#12 "+f.name);throw c.errors=a,c}h()}return n}u(jP,"_decodeSafeContents");function zP(e){var t={};if(e!==void 0)for(var r=0;r<e.length;++r){var n={},i=[];if(!T.validate(e[r],KP,n,i)){var s=new Error("Cannot read PKCS#12 BagAttribute.");throw s.errors=i,s}var o=T.derToOid(n.oid);if(ye.oids[o]!==void 0){t[ye.oids[o]]=[];for(var a=0;a<n.values.length;++a)t[ye.oids[o]].push(n.values[a].value)}}return t}u(zP,"_decodeBagAttributes");ga.toPkcs12Asn1=function(e,t,r,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var i=n.localKeyId,s;if(i!==null)i=$e.util.hexToBytes(i);else if(n.generateLocalKeyId)if(t){var o=$e.util.isArray(t)?t[0]:t;typeof o=="string"&&(o=ye.certificateFromPem(o));var a=$e.md.sha1.create();a.update(T.toDer(ye.certificateToAsn1(o)).getBytes()),i=a.digest().getBytes()}else i=$e.random.getBytes(20);var c=[];i!==null&&c.push(T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(ye.oids.localKeyId).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,i)])])),"friendlyName"in n&&c.push(T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(ye.oids.friendlyName).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,[T.create(T.Class.UNIVERSAL,T.Type.BMPSTRING,!1,n.friendlyName)])])),c.length>0&&(s=T.create(T.Class.UNIVERSAL,T.Type.SET,!0,c));var l=[],f=[];t!==null&&($e.util.isArray(t)?f=t:f=[t]);for(var h=[],d=0;d<f.length;++d){t=f[d],typeof t=="string"&&(t=ye.certificateFromPem(t));var g=d===0?s:void 0,p=ye.certificateToAsn1(t),y=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(ye.oids.certBag).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(ye.oids.x509Certificate).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(p).getBytes())])])]),g]);h.push(y)}if(h.length>0){var v=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,h),m=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(ye.oids.data).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(v).getBytes())])]);l.push(m)}var x=null;if(e!==null){var w=ye.wrapRsaPrivateKey(ye.privateKeyToAsn1(e));r===null?x=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(ye.oids.keyBag).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[w]),s]):x=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(ye.oids.pkcs8ShroudedKeyBag).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[ye.encryptPrivateKeyInfo(w,r,n)]),s]);var B=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[x]),R=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(ye.oids.data).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(B).getBytes())])]);l.push(R)}var L=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,l),Y;if(n.useMac){var a=$e.md.sha1.create(),X=new $e.util.ByteBuffer($e.random.getBytes(n.saltSize)),ne=n.count,e=ga.generateKey(r,X,3,ne,20),le=$e.hmac.create();le.start(a,e),le.update(T.toDer(L).getBytes());var Ce=le.getMac();Y=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(ye.oids.sha1).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")]),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,Ce.getBytes())]),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,X.getBytes()),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(ne).getBytes())])}return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(3).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(ye.oids.data).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(L).getBytes())])]),Y])};ga.generateKey=$e.pbe.generatePkcs12Key});var u0=_((EK,$x)=>{var gi=fe();on();fi();t0();Wi();hc();o0();Ec();pa();Ae();xc();var a0=gi.asn1,Js=$x.exports=gi.pki=gi.pki||{};Js.pemToDer=function(e){var t=gi.pem.decode(e)[0];if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return gi.util.createBuffer(t.body)};Js.privateKeyFromPem=function(e){var t=gi.pem.decode(e)[0];if(t.type!=="PRIVATE KEY"&&t.type!=="RSA PRIVATE KEY"){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var n=a0.fromDer(t.body);return Js.privateKeyFromAsn1(n)};Js.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:a0.toDer(Js.privateKeyToAsn1(e)).getBytes()};return gi.pem.encode(r,{maxline:t})};Js.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:a0.toDer(e).getBytes()};return gi.pem.encode(r,{maxline:t})}});var d0=_((CK,Xx)=>{var q=fe();on();Gs();uc();Wi();u0();Ur();Qs();Ae();var bc=u(function(e,t,r,n){var i=q.util.createBuffer(),s=e.length>>1,o=s+(e.length&1),a=e.substr(0,o),c=e.substr(s,o),l=q.util.createBuffer(),f=q.hmac.create();r=t+r;var h=Math.ceil(n/16),d=Math.ceil(n/20);f.start("MD5",a);var g=q.util.createBuffer();l.putBytes(r);for(var p=0;p<h;++p)f.start(null,null),f.update(l.getBytes()),l.putBuffer(f.digest()),f.start(null,null),f.update(l.bytes()+r),g.putBuffer(f.digest());f.start("SHA1",c);var y=q.util.createBuffer();l.clear(),l.putBytes(r);for(var p=0;p<d;++p)f.start(null,null),f.update(l.getBytes()),l.putBuffer(f.digest()),f.start(null,null),f.update(l.bytes()+r),y.putBuffer(f.digest());return i.putBytes(q.util.xorBytes(g.getBytes(),y.getBytes(),n)),i},"prf_TLS1"),WP=u(function(e,t,r){var n=q.hmac.create();n.start("SHA1",e);var i=q.util.createBuffer();return i.putInt32(t[0]),i.putInt32(t[1]),i.putByte(r.type),i.putByte(r.version.major),i.putByte(r.version.minor),i.putInt16(r.length),i.putBytes(r.fragment.bytes()),n.update(i.getBytes()),n.digest().getBytes()},"hmac_sha1"),QP=u(function(e,t,r){var n=!1;try{var i=e.deflate(t.fragment.getBytes());t.fragment=q.util.createBuffer(i),t.length=i.length,n=!0}catch{}return n},"deflate"),ZP=u(function(e,t,r){var n=!1;try{var i=e.inflate(t.fragment.getBytes());t.fragment=q.util.createBuffer(i),t.length=i.length,n=!0}catch{}return n},"inflate"),Br=u(function(e,t){var r=0;switch(t){case 1:r=e.getByte();break;case 2:r=e.getInt16();break;case 3:r=e.getInt24();break;case 4:r=e.getInt32();break}return q.util.createBuffer(e.getBytes(r))},"readVector"),Hr=u(function(e,t,r){e.putInt(r.length(),t<<3),e.putBuffer(r)},"writeVector"),S={};S.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};S.SupportedVersions=[S.Versions.TLS_1_1,S.Versions.TLS_1_0];S.Version=S.SupportedVersions[0];S.MaxFragment=15360;S.ConnectionEnd={server:0,client:1};S.PRFAlgorithm={tls_prf_sha256:0};S.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};S.CipherType={stream:0,block:1,aead:2};S.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};S.CompressionMethod={none:0,deflate:1};S.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};S.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};S.Alert={};S.Alert.Level={warning:1,fatal:2};S.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};S.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};S.CipherSuites={};S.getCipherSuite=function(e){var t=null;for(var r in S.CipherSuites){var n=S.CipherSuites[r];if(n.id[0]===e.charCodeAt(0)&&n.id[1]===e.charCodeAt(1)){t=n;break}}return t};S.handleUnexpected=function(e,t){var r=!e.open&&e.entity===S.ConnectionEnd.client;r||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.unexpected_message}})};S.handleHelloRequest=function(e,t,r){!e.handshaking&&e.handshakes>0&&(S.queue(e,S.createAlert(e,{level:S.Alert.Level.warning,description:S.Alert.Description.no_renegotiation})),S.flush(e)),e.process()};S.parseHelloMessage=function(e,t,r){var n=null,i=e.entity===S.ConnectionEnd.client;if(r<38)e.error(e,{message:i?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}});else{var s=t.fragment,o=s.length();if(n={version:{major:s.getByte(),minor:s.getByte()},random:q.util.createBuffer(s.getBytes(32)),session_id:Br(s,1),extensions:[]},i?(n.cipher_suite=s.getBytes(2),n.compression_method=s.getByte()):(n.cipher_suites=Br(s,2),n.compression_methods=Br(s,1)),o=r-(o-s.length()),o>0){for(var a=Br(s,2);a.length()>0;)n.extensions.push({type:[a.getByte(),a.getByte()],data:Br(a,2)});if(!i)for(var c=0;c<n.extensions.length;++c){var l=n.extensions[c];if(l.type[0]===0&&l.type[1]===0)for(var f=Br(l.data,2);f.length()>0;){var h=f.getByte();if(h!==0)break;e.session.extensions.server_name.serverNameList.push(Br(f,2).getBytes())}}}if(e.session.version&&(n.version.major!==e.session.version.major||n.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.protocol_version}});if(i)e.session.cipherSuite=S.getCipherSuite(n.cipher_suite);else for(var d=q.util.createBuffer(n.cipher_suites.bytes());d.length()>0&&(e.session.cipherSuite=S.getCipherSuite(d.getBytes(2)),e.session.cipherSuite===null););if(e.session.cipherSuite===null)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.handshake_failure},cipherSuite:q.util.bytesToHex(n.cipher_suite)});i?e.session.compressionMethod=n.compression_method:e.session.compressionMethod=S.CompressionMethod.none}return n};S.createSecurityParameters=function(e,t){var r=e.entity===S.ConnectionEnd.client,n=t.random.bytes(),i=r?e.session.sp.client_random:n,s=r?n:S.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:S.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:i,server_random:s}};S.handleServerHello=function(e,t,r){var n=S.parseHelloMessage(e,t,r);if(!e.fail){if(n.version.minor<=e.version.minor)e.version.minor=n.version.minor;else return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.protocol_version}});e.session.version=e.version;var i=n.session_id.bytes();i.length>0&&i===e.session.id?(e.expect=zx,e.session.resuming=!0,e.session.sp.server_random=n.random.bytes()):(e.expect=XP,e.session.resuming=!1,S.createSecurityParameters(e,n)),e.session.id=i,e.process()}};S.handleClientHello=function(e,t,r){var n=S.parseHelloMessage(e,t,r);if(!e.fail){var i=n.session_id.bytes(),s=null;if(e.sessionCache&&(s=e.sessionCache.getSession(i),s===null?i="":(s.version.major!==n.version.major||s.version.minor>n.version.minor)&&(s=null,i="")),i.length===0&&(i=q.random.getBytes(32)),e.session.id=i,e.session.clientHelloVersion=n.version,e.session.sp={},s)e.version=e.session.version=s.version,e.session.sp=s.sp;else{for(var o,a=1;a<S.SupportedVersions.length&&(o=S.SupportedVersions[a],!(o.minor<=n.version.minor));++a);e.version={major:o.major,minor:o.minor},e.session.version=e.version}s!==null?(e.expect=h0,e.session.resuming=!0,e.session.sp.client_random=n.random.bytes()):(e.expect=e.verifyClient!==!1?s3:f0,e.session.resuming=!1,S.createSecurityParameters(e,n)),e.open=!0,S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createServerHello(e)})),e.session.resuming?(S.queue(e,S.createRecord(e,{type:S.ContentType.change_cipher_spec,data:S.createChangeCipherSpec()})),e.state.pending=S.createConnectionState(e),e.state.current.write=e.state.pending.write,S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createFinished(e)}))):(S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createCertificate(e)})),e.fail||(S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createServerKeyExchange(e)})),e.verifyClient!==!1&&S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createCertificateRequest(e)})),S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createServerHelloDone(e)})))),S.flush(e),e.process()}};S.handleCertificate=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}});var n=t.fragment,i={certificate_list:Br(n,3)},s,o,a=[];try{for(;i.certificate_list.length()>0;)s=Br(i.certificate_list,3),o=q.asn1.fromDer(s),s=q.pki.certificateFromAsn1(o,!0),a.push(s)}catch(l){return e.error(e,{message:"Could not parse certificate list.",cause:l,send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.bad_certificate}})}var c=e.entity===S.ConnectionEnd.client;(c||e.verifyClient===!0)&&a.length===0?e.error(e,{message:c?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}}):a.length===0?e.expect=c?Gx:f0:(c?e.session.serverCertificate=a[0]:e.session.clientCertificate=a[0],S.verifyCertificateChain(e,a)&&(e.expect=c?Gx:f0)),e.process()};S.handleServerKeyExchange=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.unsupported_certificate}});e.expect=JP,e.process()};S.handleClientKeyExchange=function(e,t,r){if(r<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.unsupported_certificate}});var n=t.fragment,i={enc_pre_master_secret:Br(n,2).getBytes()},s=null;if(e.getPrivateKey)try{s=e.getPrivateKey(e,e.session.serverCertificate),s=q.pki.privateKeyFromPem(s)}catch(c){e.error(e,{message:"Could not get private key.",cause:c,send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}})}if(s===null)return e.error(e,{message:"No private key set.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}});try{var o=e.session.sp;o.pre_master_secret=s.decrypt(i.enc_pre_master_secret);var a=e.session.clientHelloVersion;if(a.major!==o.pre_master_secret.charCodeAt(0)||a.minor!==o.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{o.pre_master_secret=q.random.getBytes(48)}e.expect=h0,e.session.clientCertificate!==null&&(e.expect=o3),e.process()};S.handleCertificateRequest=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}});var n=t.fragment,i={certificate_types:Br(n,1),certificate_authorities:Br(n,2)};e.session.certificateRequest=i,e.expect=e3,e.process()};S.handleCertificateVerify=function(e,t,r){if(r<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}});var n=t.fragment;n.read-=4;var i=n.bytes();n.read+=4;var s={signature:Br(n,2).getBytes()},o=q.util.createBuffer();o.putBuffer(e.session.md5.digest()),o.putBuffer(e.session.sha1.digest()),o=o.getBytes();try{var a=e.session.clientCertificate;if(!a.publicKey.verify(o,s.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(i),e.session.sha1.update(i)}catch{return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.handshake_failure}})}e.expect=h0,e.process()};S.handleServerHelloDone=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.record_overflow}});if(e.serverCertificate===null){var n={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.insufficient_security}},i=0,s=e.verify(e,n.alert.description,i,[]);if(s!==!0)return(s||s===0)&&(typeof s=="object"&&!q.util.isArray(s)?(s.message&&(n.message=s.message),s.alert&&(n.alert.description=s.alert)):typeof s=="number"&&(n.alert.description=s)),e.error(e,n)}e.session.certificateRequest!==null&&(t=S.createRecord(e,{type:S.ContentType.handshake,data:S.createCertificate(e)}),S.queue(e,t)),t=S.createRecord(e,{type:S.ContentType.handshake,data:S.createClientKeyExchange(e)}),S.queue(e,t),e.expect=n3;var o=u(function(a,c){a.session.certificateRequest!==null&&a.session.clientCertificate!==null&&S.queue(a,S.createRecord(a,{type:S.ContentType.handshake,data:S.createCertificateVerify(a,c)})),S.queue(a,S.createRecord(a,{type:S.ContentType.change_cipher_spec,data:S.createChangeCipherSpec()})),a.state.pending=S.createConnectionState(a),a.state.current.write=a.state.pending.write,S.queue(a,S.createRecord(a,{type:S.ContentType.handshake,data:S.createFinished(a)})),a.expect=zx,S.flush(a),a.process()},"callback");if(e.session.certificateRequest===null||e.session.clientCertificate===null)return o(e,null);S.getClientSignature(e,o)};S.handleChangeCipherSpec=function(e,t){if(t.fragment.getByte()!==1)return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}});var r=e.entity===S.ConnectionEnd.client;(e.session.resuming&&r||!e.session.resuming&&!r)&&(e.state.pending=S.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&r||e.session.resuming&&!r)&&(e.state.pending=null),e.expect=r?t3:a3,e.process()};S.handleFinished=function(e,t,r){var n=t.fragment;n.read-=4;var i=n.bytes();n.read+=4;var s=t.fragment.getBytes();n=q.util.createBuffer(),n.putBuffer(e.session.md5.digest()),n.putBuffer(e.session.sha1.digest());var o=e.entity===S.ConnectionEnd.client,a=o?"server finished":"client finished",c=e.session.sp,l=12,f=bc;if(n=f(c.master_secret,a,n.getBytes(),l),n.getBytes()!==s)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.decrypt_error}});e.session.md5.update(i),e.session.sha1.update(i),(e.session.resuming&&o||!e.session.resuming&&!o)&&(S.queue(e,S.createRecord(e,{type:S.ContentType.change_cipher_spec,data:S.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createFinished(e)}))),e.expect=o?r3:u3,e.handshaking=!1,++e.handshakes,e.peerCertificate=o?e.session.serverCertificate:e.session.clientCertificate,S.flush(e),e.isConnected=!0,e.connected(e),e.process()};S.handleAlert=function(e,t){var r=t.fragment,n={level:r.getByte(),description:r.getByte()},i;switch(n.description){case S.Alert.Description.close_notify:i="Connection closed.";break;case S.Alert.Description.unexpected_message:i="Unexpected message.";break;case S.Alert.Description.bad_record_mac:i="Bad record MAC.";break;case S.Alert.Description.decryption_failed:i="Decryption failed.";break;case S.Alert.Description.record_overflow:i="Record overflow.";break;case S.Alert.Description.decompression_failure:i="Decompression failed.";break;case S.Alert.Description.handshake_failure:i="Handshake failure.";break;case S.Alert.Description.bad_certificate:i="Bad certificate.";break;case S.Alert.Description.unsupported_certificate:i="Unsupported certificate.";break;case S.Alert.Description.certificate_revoked:i="Certificate revoked.";break;case S.Alert.Description.certificate_expired:i="Certificate expired.";break;case S.Alert.Description.certificate_unknown:i="Certificate unknown.";break;case S.Alert.Description.illegal_parameter:i="Illegal parameter.";break;case S.Alert.Description.unknown_ca:i="Unknown certificate authority.";break;case S.Alert.Description.access_denied:i="Access denied.";break;case S.Alert.Description.decode_error:i="Decode error.";break;case S.Alert.Description.decrypt_error:i="Decrypt error.";break;case S.Alert.Description.export_restriction:i="Export restriction.";break;case S.Alert.Description.protocol_version:i="Unsupported protocol version.";break;case S.Alert.Description.insufficient_security:i="Insufficient security.";break;case S.Alert.Description.internal_error:i="Internal error.";break;case S.Alert.Description.user_canceled:i="User canceled.";break;case S.Alert.Description.no_renegotiation:i="Renegotiation not supported.";break;default:i="Unknown error.";break}if(n.description===S.Alert.Description.close_notify)return e.close();e.error(e,{message:i,send:!1,origin:e.entity===S.ConnectionEnd.client?"server":"client",alert:n}),e.process()};S.handleHandshake=function(e,t){var r=t.fragment,n=r.getByte(),i=r.getInt24();if(i>r.length())return e.fragmented=t,t.fragment=q.util.createBuffer(),r.read-=4,e.process();e.fragmented=null,r.read-=4;var s=r.bytes(i+4);r.read+=4,n in wc[e.entity][e.expect]?(e.entity===S.ConnectionEnd.server&&!e.open&&!e.fail&&(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:q.md.md5.create(),sha1:q.md.sha1.create()}),n!==S.HandshakeType.hello_request&&n!==S.HandshakeType.certificate_verify&&n!==S.HandshakeType.finished&&(e.session.md5.update(s),e.session.sha1.update(s)),wc[e.entity][e.expect][n](e,t,i)):S.handleUnexpected(e,t)};S.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()};S.handleHeartbeat=function(e,t){var r=t.fragment,n=r.getByte(),i=r.getInt16(),s=r.getBytes(i);if(n===S.HeartbeatMessageType.heartbeat_request){if(e.handshaking||i>s.length)return e.process();S.queue(e,S.createRecord(e,{type:S.ContentType.heartbeat,data:S.createHeartbeat(S.HeartbeatMessageType.heartbeat_response,s)})),S.flush(e)}else if(n===S.HeartbeatMessageType.heartbeat_response){if(s!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,q.util.createBuffer(s))}e.process()};var YP=0,XP=1,Gx=2,JP=3,e3=4,zx=5,t3=6,r3=7,n3=8,i3=0,s3=1,f0=2,o3=3,h0=4,a3=5,u3=6,C=S.handleUnexpected,Wx=S.handleChangeCipherSpec,Qt=S.handleAlert,fr=S.handleHandshake,Qx=S.handleApplicationData,Zt=S.handleHeartbeat,p0=[];p0[S.ConnectionEnd.client]=[[C,Qt,fr,C,Zt],[C,Qt,fr,C,Zt],[C,Qt,fr,C,Zt],[C,Qt,fr,C,Zt],[C,Qt,fr,C,Zt],[Wx,Qt,C,C,Zt],[C,Qt,fr,C,Zt],[C,Qt,fr,Qx,Zt],[C,Qt,fr,C,Zt]];p0[S.ConnectionEnd.server]=[[C,Qt,fr,C,Zt],[C,Qt,fr,C,Zt],[C,Qt,fr,C,Zt],[C,Qt,fr,C,Zt],[Wx,Qt,C,C,Zt],[C,Qt,fr,C,Zt],[C,Qt,fr,Qx,Zt],[C,Qt,fr,C,Zt]];var yi=S.handleHelloRequest,c3=S.handleServerHello,Zx=S.handleCertificate,jx=S.handleServerKeyExchange,c0=S.handleCertificateRequest,Tc=S.handleServerHelloDone,Yx=S.handleFinished,wc=[];wc[S.ConnectionEnd.client]=[[C,C,c3,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[yi,C,C,C,C,C,C,C,C,C,C,Zx,jx,c0,Tc,C,C,C,C,C,C],[yi,C,C,C,C,C,C,C,C,C,C,C,jx,c0,Tc,C,C,C,C,C,C],[yi,C,C,C,C,C,C,C,C,C,C,C,C,c0,Tc,C,C,C,C,C,C],[yi,C,C,C,C,C,C,C,C,C,C,C,C,C,Tc,C,C,C,C,C,C],[yi,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[yi,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,Yx],[yi,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[yi,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]];var l3=S.handleClientHello,f3=S.handleClientKeyExchange,h3=S.handleCertificateVerify;wc[S.ConnectionEnd.server]=[[C,l3,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,Zx,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,f3,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,h3,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,Yx],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]];S.generateKeys=function(e,t){var r=bc,n=t.client_random+t.server_random;e.session.resuming||(t.master_secret=r(t.pre_master_secret,"master secret",n,48).bytes(),t.pre_master_secret=null),n=t.server_random+t.client_random;var i=2*t.mac_key_length+2*t.enc_key_length,s=e.version.major===S.Versions.TLS_1_0.major&&e.version.minor===S.Versions.TLS_1_0.minor;s&&(i+=2*t.fixed_iv_length);var o=r(t.master_secret,"key expansion",n,i),a={client_write_MAC_key:o.getBytes(t.mac_key_length),server_write_MAC_key:o.getBytes(t.mac_key_length),client_write_key:o.getBytes(t.enc_key_length),server_write_key:o.getBytes(t.enc_key_length)};return s&&(a.client_write_IV=o.getBytes(t.fixed_iv_length),a.server_write_IV=o.getBytes(t.fixed_iv_length)),a};S.createConnectionState=function(e){var t=e.entity===S.ConnectionEnd.client,r=u(function(){var s={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(o){return!0},compressionState:null,compressFunction:function(o){return!0},updateSequenceNumber:function(){s.sequenceNumber[1]===4294967295?(s.sequenceNumber[1]=0,++s.sequenceNumber[0]):++s.sequenceNumber[1]}};return s},"createMode"),n={read:r(),write:r()};if(n.read.update=function(s,o){return n.read.cipherFunction(o,n.read)?n.read.compressFunction(s,o,n.read)||s.error(s,{message:"Could not decompress record.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.decompression_failure}}):s.error(s,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.bad_record_mac}}),!s.fail},n.write.update=function(s,o){return n.write.compressFunction(s,o,n.write)?n.write.cipherFunction(o,n.write)||s.error(s,{message:"Could not encrypt record.",send:!1,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}}):s.error(s,{message:"Could not compress record.",send:!1,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}}),!s.fail},e.session){var i=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(i),i.keys=S.generateKeys(e,i),n.read.macKey=t?i.keys.server_write_MAC_key:i.keys.client_write_MAC_key,n.write.macKey=t?i.keys.client_write_MAC_key:i.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(n,e,i),i.compression_algorithm){case S.CompressionMethod.none:break;case S.CompressionMethod.deflate:n.read.compressFunction=ZP,n.write.compressFunction=QP;break;default:throw new Error("Unsupported compression algorithm.")}}return n};S.createRandom=function(){var e=new Date,t=+e+e.getTimezoneOffset()*6e4,r=q.util.createBuffer();return r.putInt32(t),r.putBytes(q.random.getBytes(28)),r};S.createRecord=function(e,t){if(!t.data)return null;var r={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return r};S.createAlert=function(e,t){var r=q.util.createBuffer();return r.putByte(t.level),r.putByte(t.description),S.createRecord(e,{type:S.ContentType.alert,data:r})};S.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=q.util.createBuffer(),r=0;r<e.cipherSuites.length;++r){var n=e.cipherSuites[r];t.putByte(n.id[0]),t.putByte(n.id[1])}var i=t.length(),s=q.util.createBuffer();s.putByte(S.CompressionMethod.none);var o=s.length(),a=q.util.createBuffer();if(e.virtualHost){var c=q.util.createBuffer();c.putByte(0),c.putByte(0);var l=q.util.createBuffer();l.putByte(0),Hr(l,2,q.util.createBuffer(e.virtualHost));var f=q.util.createBuffer();Hr(f,2,l),Hr(c,2,f),a.putBuffer(c)}var h=a.length();h>0&&(h+=2);var d=e.session.id,g=d.length+1+2+4+28+2+i+1+o+h,p=q.util.createBuffer();return p.putByte(S.HandshakeType.client_hello),p.putInt24(g),p.putByte(e.version.major),p.putByte(e.version.minor),p.putBytes(e.session.sp.client_random),Hr(p,1,q.util.createBuffer(d)),Hr(p,2,t),Hr(p,1,s),h>0&&Hr(p,2,a),p};S.createServerHello=function(e){var t=e.session.id,r=t.length+1+2+4+28+2+1,n=q.util.createBuffer();return n.putByte(S.HandshakeType.server_hello),n.putInt24(r),n.putByte(e.version.major),n.putByte(e.version.minor),n.putBytes(e.session.sp.server_random),Hr(n,1,q.util.createBuffer(t)),n.putByte(e.session.cipherSuite.id[0]),n.putByte(e.session.cipherSuite.id[1]),n.putByte(e.session.compressionMethod),n};S.createCertificate=function(e){var t=e.entity===S.ConnectionEnd.client,r=null;if(e.getCertificate){var n;t?n=e.session.certificateRequest:n=e.session.extensions.server_name.serverNameList,r=e.getCertificate(e,n)}var i=q.util.createBuffer();if(r!==null)try{q.util.isArray(r)||(r=[r]);for(var s=null,o=0;o<r.length;++o){var a=q.pem.decode(r[o])[0];if(a.type!=="CERTIFICATE"&&a.type!=="X509 CERTIFICATE"&&a.type!=="TRUSTED CERTIFICATE"){var c=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw c.headerType=a.type,c}if(a.procType&&a.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var l=q.util.createBuffer(a.body);s===null&&(s=q.asn1.fromDer(l.bytes(),!1));var f=q.util.createBuffer();Hr(f,3,l),i.putBuffer(f)}r=q.pki.certificateFromAsn1(s),t?e.session.clientCertificate=r:e.session.serverCertificate=r}catch(g){return e.error(e,{message:"Could not send certificate list.",cause:g,send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.bad_certificate}})}var h=3+i.length(),d=q.util.createBuffer();return d.putByte(S.HandshakeType.certificate),d.putInt24(h),Hr(d,3,i),d};S.createClientKeyExchange=function(e){var t=q.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(q.random.getBytes(46));var r=e.session.sp;r.pre_master_secret=t.getBytes();var n=e.session.serverCertificate.publicKey;t=n.encrypt(r.pre_master_secret);var i=t.length+2,s=q.util.createBuffer();return s.putByte(S.HandshakeType.client_key_exchange),s.putInt24(i),s.putInt16(t.length),s.putBytes(t),s};S.createServerKeyExchange=function(e){var t=0,r=q.util.createBuffer();return t>0&&(r.putByte(S.HandshakeType.server_key_exchange),r.putInt24(t)),r};S.getClientSignature=function(e,t){var r=q.util.createBuffer();r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest()),r=r.getBytes(),e.getSignature=e.getSignature||function(n,i,s){var o=null;if(n.getPrivateKey)try{o=n.getPrivateKey(n,n.session.clientCertificate),o=q.pki.privateKeyFromPem(o)}catch(a){n.error(n,{message:"Could not get private key.",cause:a,send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}})}o===null?n.error(n,{message:"No private key set.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}}):i=o.sign(i,null),s(n,i)},e.getSignature(e,r,t)};S.createCertificateVerify=function(e,t){var r=t.length+2,n=q.util.createBuffer();return n.putByte(S.HandshakeType.certificate_verify),n.putInt24(r),n.putInt16(t.length),n.putBytes(t),n};S.createCertificateRequest=function(e){var t=q.util.createBuffer();t.putByte(1);var r=q.util.createBuffer();for(var n in e.caStore.certs){var i=e.caStore.certs[n],s=q.pki.distinguishedNameToAsn1(i.subject),o=q.asn1.toDer(s);r.putInt16(o.length()),r.putBuffer(o)}var a=1+t.length()+2+r.length(),c=q.util.createBuffer();return c.putByte(S.HandshakeType.certificate_request),c.putInt24(a),Hr(c,1,t),Hr(c,2,r),c};S.createServerHelloDone=function(e){var t=q.util.createBuffer();return t.putByte(S.HandshakeType.server_hello_done),t.putInt24(0),t};S.createChangeCipherSpec=function(){var e=q.util.createBuffer();return e.putByte(1),e};S.createFinished=function(e){var t=q.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var r=e.entity===S.ConnectionEnd.client,n=e.session.sp,i=12,s=bc,o=r?"client finished":"server finished";t=s(n.master_secret,o,t.getBytes(),i);var a=q.util.createBuffer();return a.putByte(S.HandshakeType.finished),a.putInt24(t.length()),a.putBuffer(t),a};S.createHeartbeat=function(e,t,r){typeof r>"u"&&(r=t.length);var n=q.util.createBuffer();n.putByte(e),n.putInt16(r),n.putBytes(t);var i=n.length(),s=Math.max(16,i-r-3);return n.putBytes(q.random.getBytes(s)),n};S.queue=function(e,t){if(t&&!(t.fragment.length()===0&&(t.type===S.ContentType.handshake||t.type===S.ContentType.alert||t.type===S.ContentType.change_cipher_spec))){if(t.type===S.ContentType.handshake){var r=t.fragment.bytes();e.session.md5.update(r),e.session.sha1.update(r),r=null}var n;if(t.fragment.length()<=S.MaxFragment)n=[t];else{n=[];for(var i=t.fragment.bytes();i.length>S.MaxFragment;)n.push(S.createRecord(e,{type:t.type,data:q.util.createBuffer(i.slice(0,S.MaxFragment))})),i=i.slice(S.MaxFragment);i.length>0&&n.push(S.createRecord(e,{type:t.type,data:q.util.createBuffer(i)}))}for(var s=0;s<n.length&&!e.fail;++s){var o=n[s],a=e.state.current.write;a.update(e,o)&&e.records.push(o)}}};S.flush=function(e){for(var t=0;t<e.records.length;++t){var r=e.records[t];e.tlsData.putByte(r.type),e.tlsData.putByte(r.version.major),e.tlsData.putByte(r.version.minor),e.tlsData.putInt16(r.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var l0=u(function(e){switch(e){case!0:return!0;case q.pki.certificateError.bad_certificate:return S.Alert.Description.bad_certificate;case q.pki.certificateError.unsupported_certificate:return S.Alert.Description.unsupported_certificate;case q.pki.certificateError.certificate_revoked:return S.Alert.Description.certificate_revoked;case q.pki.certificateError.certificate_expired:return S.Alert.Description.certificate_expired;case q.pki.certificateError.certificate_unknown:return S.Alert.Description.certificate_unknown;case q.pki.certificateError.unknown_ca:return S.Alert.Description.unknown_ca;default:return S.Alert.Description.bad_certificate}},"_certErrorToAlertDesc"),p3=u(function(e){switch(e){case!0:return!0;case S.Alert.Description.bad_certificate:return q.pki.certificateError.bad_certificate;case S.Alert.Description.unsupported_certificate:return q.pki.certificateError.unsupported_certificate;case S.Alert.Description.certificate_revoked:return q.pki.certificateError.certificate_revoked;case S.Alert.Description.certificate_expired:return q.pki.certificateError.certificate_expired;case S.Alert.Description.certificate_unknown:return q.pki.certificateError.certificate_unknown;case S.Alert.Description.unknown_ca:return q.pki.certificateError.unknown_ca;default:return q.pki.certificateError.bad_certificate}},"_alertDescToCertError");S.verifyCertificateChain=function(e,t){try{var r={};for(var n in e.verifyOptions)r[n]=e.verifyOptions[n];r.verify=function(s,o,a){var c=l0(s),l=e.verify(e,s,o,a);if(l!==!0){if(typeof l=="object"&&!q.util.isArray(l)){var f=new Error("The application rejected the certificate.");throw f.send=!0,f.alert={level:S.Alert.Level.fatal,description:S.Alert.Description.bad_certificate},l.message&&(f.message=l.message),l.alert&&(f.alert.description=l.alert),f}l!==s&&(l=p3(l))}return l},q.pki.verifyCertificateChain(e.caStore,t,r)}catch(s){var i=s;(typeof i!="object"||q.util.isArray(i))&&(i={send:!0,alert:{level:S.Alert.Level.fatal,description:l0(s)}}),"send"in i||(i.send=!0),"alert"in i||(i.alert={level:S.Alert.Level.fatal,description:l0(i.error)}),e.error(e,i)}return!e.fail};S.createSessionCache=function(e,t){var r=null;if(e&&e.getSession&&e.setSession&&e.order)r=e;else{r={},r.cache=e||{},r.capacity=Math.max(t||100,1),r.order=[];for(var n in e)r.order.length<=t?r.order.push(n):delete e[n];r.getSession=function(i){var s=null,o=null;if(i?o=q.util.bytesToHex(i):r.order.length>0&&(o=r.order[0]),o!==null&&o in r.cache){s=r.cache[o],delete r.cache[o];for(var a in r.order)if(r.order[a]===o){r.order.splice(a,1);break}}return s},r.setSession=function(i,s){if(r.order.length===r.capacity){var o=r.order.shift();delete r.cache[o]}var o=q.util.bytesToHex(i);r.order.push(o),r.cache[o]=s}}return r};S.createConnection=function(e){var t=null;e.caStore?q.util.isArray(e.caStore)?t=q.pki.createCaStore(e.caStore):t=e.caStore:t=q.pki.createCaStore();var r=e.cipherSuites||null;if(r===null){r=[];for(var n in S.CipherSuites)r.push(S.CipherSuites[n])}var i=e.server?S.ConnectionEnd.server:S.ConnectionEnd.client,s=e.sessionCache?S.createSessionCache(e.sessionCache):null,o={version:{major:S.Version.major,minor:S.Version.minor},entity:i,sessionId:e.sessionId,caStore:t,sessionCache:s,cipherSuites:r,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(f,h,d,g){return h},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:q.util.createBuffer(),tlsData:q.util.createBuffer(),data:q.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(f,h){h.origin=h.origin||(f.entity===S.ConnectionEnd.client?"client":"server"),h.send&&(S.queue(f,S.createAlert(f,h.alert)),S.flush(f));var d=h.fatal!==!1;d&&(f.fail=!0),e.error(f,h),d&&f.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null};o.reset=function(f){o.version={major:S.Version.major,minor:S.Version.minor},o.record=null,o.session=null,o.peerCertificate=null,o.state={pending:null,current:null},o.expect=o.entity===S.ConnectionEnd.client?YP:i3,o.fragmented=null,o.records=[],o.open=!1,o.handshakes=0,o.handshaking=!1,o.isConnected=!1,o.fail=!(f||typeof f>"u"),o.input.clear(),o.tlsData.clear(),o.data.clear(),o.state.current=S.createConnectionState(o)},o.reset();var a=u(function(f,h){var d=h.type-S.ContentType.change_cipher_spec,g=p0[f.entity][f.expect];d in g?g[d](f,h):S.handleUnexpected(f,h)},"_update"),c=u(function(f){var h=0,d=f.input,g=d.length();if(g<5)h=5-g;else{f.record={type:d.getByte(),version:{major:d.getByte(),minor:d.getByte()},length:d.getInt16(),fragment:q.util.createBuffer(),ready:!1};var p=f.record.version.major===f.version.major;p&&f.session&&f.session.version&&(p=f.record.version.minor===f.version.minor),p||f.error(f,{message:"Incompatible TLS version.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.protocol_version}})}return h},"_readRecordHeader"),l=u(function(f){var h=0,d=f.input,g=d.length();if(g<f.record.length)h=f.record.length-g;else{f.record.fragment.putBytes(d.getBytes(f.record.length)),d.compact();var p=f.state.current.read;p.update(f,f.record)&&(f.fragmented!==null&&(f.fragmented.type===f.record.type?(f.fragmented.fragment.putBuffer(f.record.fragment),f.record=f.fragmented):f.error(f,{message:"Invalid fragmented record.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.unexpected_message}})),f.record.ready=!0)}return h},"_readRecord");return o.handshake=function(f){if(o.entity!==S.ConnectionEnd.client)o.error(o,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(o.handshaking)o.error(o,{message:"Handshake already in progress.",fatal:!1});else{o.fail&&!o.open&&o.handshakes===0&&(o.fail=!1),o.handshaking=!0,f=f||"";var h=null;f.length>0&&(o.sessionCache&&(h=o.sessionCache.getSession(f)),h===null&&(f="")),f.length===0&&o.sessionCache&&(h=o.sessionCache.getSession(),h!==null&&(f=h.id)),o.session={id:f,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:q.md.md5.create(),sha1:q.md.sha1.create()},h&&(o.version=h.version,o.session.sp=h.sp),o.session.sp.client_random=S.createRandom().getBytes(),o.open=!0,S.queue(o,S.createRecord(o,{type:S.ContentType.handshake,data:S.createClientHello(o)})),S.flush(o)}},o.process=function(f){var h=0;return f&&o.input.putBytes(f),o.fail||(o.record!==null&&o.record.ready&&o.record.fragment.isEmpty()&&(o.record=null),o.record===null&&(h=c(o)),!o.fail&&o.record!==null&&!o.record.ready&&(h=l(o)),!o.fail&&o.record!==null&&o.record.ready&&a(o,o.record)),h},o.prepare=function(f){return S.queue(o,S.createRecord(o,{type:S.ContentType.application_data,data:q.util.createBuffer(f)})),S.flush(o)},o.prepareHeartbeatRequest=function(f,h){return f instanceof q.util.ByteBuffer&&(f=f.bytes()),typeof h>"u"&&(h=f.length),o.expectedHeartbeatPayload=f,S.queue(o,S.createRecord(o,{type:S.ContentType.heartbeat,data:S.createHeartbeat(S.HeartbeatMessageType.heartbeat_request,f,h)})),S.flush(o)},o.close=function(f){if(!o.fail&&o.sessionCache&&o.session){var h={id:o.session.id,version:o.session.version,sp:o.session.sp};h.sp.keys=null,o.sessionCache.setSession(h.id,h)}o.open&&(o.open=!1,o.input.clear(),(o.isConnected||o.handshaking)&&(o.isConnected=o.handshaking=!1,S.queue(o,S.createAlert(o,{level:S.Alert.Level.warning,description:S.Alert.Description.close_notify})),S.flush(o)),o.closed(o)),o.reset(f)},o};Xx.exports=q.tls=q.tls||{};for(_c in S)typeof S[_c]!="function"&&(q.tls[_c]=S[_c]);var _c;q.tls.prf_tls1=bc;q.tls.hmac_sha1=WP;q.tls.createSessionCache=S.createSessionCache;q.tls.createConnection=S.createConnection});var tT=_((xK,eT)=>{var mi=fe();li();d0();var $r=eT.exports=mi.tls;$r.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=$r.BulkCipherAlgorithm.aes,e.cipher_type=$r.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=$r.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Jx};$r.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=$r.BulkCipherAlgorithm.aes,e.cipher_type=$r.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=$r.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Jx};function Jx(e,t,r){var n=t.entity===mi.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:mi.cipher.createDecipher("AES-CBC",n?r.keys.server_write_key:r.keys.client_write_key),iv:n?r.keys.server_write_IV:r.keys.client_write_IV},e.write.cipherState={init:!1,cipher:mi.cipher.createCipher("AES-CBC",n?r.keys.client_write_key:r.keys.server_write_key),iv:n?r.keys.client_write_IV:r.keys.server_write_IV},e.read.cipherFunction=m3,e.write.cipherFunction=d3,e.read.macLength=e.write.macLength=r.mac_length,e.read.macFunction=e.write.macFunction=$r.hmac_sha1}u(Jx,"initConnectionState");function d3(e,t){var r=!1,n=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(n),t.updateSequenceNumber();var i;e.version.minor===$r.Versions.TLS_1_0.minor?i=t.cipherState.init?null:t.cipherState.iv:i=mi.random.getBytesSync(16),t.cipherState.init=!0;var s=t.cipherState.cipher;return s.start({iv:i}),e.version.minor>=$r.Versions.TLS_1_1.minor&&s.output.putBytes(i),s.update(e.fragment),s.finish(g3)&&(e.fragment=s.output,e.length=e.fragment.length(),r=!0),r}u(d3,"encrypt_aes_cbc_sha1");function g3(e,t,r){if(!r){var n=e-t.length()%e;t.fillWithByte(n-1,n)}return!0}u(g3,"encrypt_aes_cbc_sha1_padding");function y3(e,t,r){var n=!0;if(r){for(var i=t.length(),s=t.last(),o=i-1-s;o<i-1;++o)n=n&&t.at(o)==s;n&&t.truncate(s+1)}return n}u(y3,"decrypt_aes_cbc_sha1_padding");function m3(e,t){var r=!1,n;e.version.minor===$r.Versions.TLS_1_0.minor?n=t.cipherState.init?null:t.cipherState.iv:n=e.fragment.getBytes(16),t.cipherState.init=!0;var i=t.cipherState.cipher;i.start({iv:n}),i.update(e.fragment),r=i.finish(y3);var s=t.macLength,o=mi.random.getBytesSync(s),a=i.output.length();a>=s?(e.fragment=i.output.getBytes(a-s),o=i.output.getBytes(s)):e.fragment=i.output.getBytes(),e.fragment=mi.util.createBuffer(e.fragment),e.length=e.fragment.length();var c=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),r=v3(t.macKey,o,c)&&r,r}u(m3,"decrypt_aes_cbc_sha1");function v3(e,t,r){var n=mi.hmac.create();return n.start("SHA1",e),n.update(t),t=n.digest().getBytes(),n.start(null,null),n.update(r),r=n.digest().getBytes(),t===r}u(v3,"compareMacs")});var m0=_((_K,sT)=>{var Qe=fe();mn();Ae();var ya=sT.exports=Qe.sha512=Qe.sha512||{};Qe.md.sha512=Qe.md.algorithms.sha512=ya;var nT=Qe.sha384=Qe.sha512.sha384=Qe.sha512.sha384||{};nT.create=function(){return ya.create("SHA-384")};Qe.md.sha384=Qe.md.algorithms.sha384=nT;Qe.sha512.sha256=Qe.sha512.sha256||{create:function(){return ya.create("SHA-512/256")}};Qe.md["sha512/256"]=Qe.md.algorithms["sha512/256"]=Qe.sha512.sha256;Qe.sha512.sha224=Qe.sha512.sha224||{create:function(){return ya.create("SHA-512/224")}};Qe.md["sha512/224"]=Qe.md.algorithms["sha512/224"]=Qe.sha512.sha224;ya.create=function(e){if(iT||E3(),typeof e>"u"&&(e="SHA-512"),!(e in es))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=es[e],r=null,n=Qe.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(e){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,l=0;l<c;++l)a.fullMessageLength.push(0);n=Qe.util.createBuffer(),r=new Array(t.length);for(var l=0;l<t.length;++l)r[l]=t[l].slice(0);return a},a.start(),a.update=function(c,l){l==="utf8"&&(c=Qe.util.encodeUtf8(c));var f=c.length;a.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=f[1],f[1]=f[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,f[0]=f[1]/4294967296>>>0;return n.putBytes(c),rT(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=Qe.util.createBuffer();c.putBytes(n.bytes());var l=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,f=l&a.blockLength-1;c.putBytes(g0.substr(0,a.blockLength-f));for(var h,d,g=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,d=h/4294967296>>>0,g+=d,c.putInt32(g>>>0),g=h>>>0;c.putInt32(g);for(var y=new Array(r.length),p=0;p<r.length;++p)y[p]=r[p].slice(0);rT(y,i,c);var v=Qe.util.createBuffer(),m;e==="SHA-512"?m=y.length:e==="SHA-384"?m=y.length-2:m=y.length-4;for(var p=0;p<m;++p)v.putInt32(y[p][0]),(p!==m-1||e!=="SHA-512/224")&&v.putInt32(y[p][1]);return v},a};var g0=null,iT=!1,y0=null,es=null;function E3(){g0="\x80",g0+=Qe.util.fillString("\0",128),y0=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],es={},es["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],es["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],es["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],es["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],iT=!0}u(E3,"_init");function rT(e,t,r){for(var n,i,s,o,a,c,l,f,h,d,g,p,y,v,m,x,w,B,R,L,Y,X,ne,le,Ce,we,ht,mt,be,Ze,Z,ln,Hn,tt,rt,ut=r.length();ut>=128;){for(be=0;be<16;++be)t[be][0]=r.getInt32()>>>0,t[be][1]=r.getInt32()>>>0;for(;be<80;++be)ln=t[be-2],Ze=ln[0],Z=ln[1],n=((Ze>>>19|Z<<13)^(Z>>>29|Ze<<3)^Ze>>>6)>>>0,i=((Ze<<13|Z>>>19)^(Z<<3|Ze>>>29)^(Ze<<26|Z>>>6))>>>0,tt=t[be-15],Ze=tt[0],Z=tt[1],s=((Ze>>>1|Z<<31)^(Ze>>>8|Z<<24)^Ze>>>7)>>>0,o=((Ze<<31|Z>>>1)^(Ze<<24|Z>>>8)^(Ze<<25|Z>>>7))>>>0,Hn=t[be-7],rt=t[be-16],Z=i+Hn[1]+o+rt[1],t[be][0]=n+Hn[0]+s+rt[0]+(Z/4294967296>>>0)>>>0,t[be][1]=Z>>>0;for(y=e[0][0],v=e[0][1],m=e[1][0],x=e[1][1],w=e[2][0],B=e[2][1],R=e[3][0],L=e[3][1],Y=e[4][0],X=e[4][1],ne=e[5][0],le=e[5][1],Ce=e[6][0],we=e[6][1],ht=e[7][0],mt=e[7][1],be=0;be<80;++be)l=((Y>>>14|X<<18)^(Y>>>18|X<<14)^(X>>>9|Y<<23))>>>0,f=((Y<<18|X>>>14)^(Y<<14|X>>>18)^(X<<23|Y>>>9))>>>0,h=(Ce^Y&(ne^Ce))>>>0,d=(we^X&(le^we))>>>0,a=((y>>>28|v<<4)^(v>>>2|y<<30)^(v>>>7|y<<25))>>>0,c=((y<<4|v>>>28)^(v<<30|y>>>2)^(v<<25|y>>>7))>>>0,g=(y&m|w&(y^m))>>>0,p=(v&x|B&(v^x))>>>0,Z=mt+f+d+y0[be][1]+t[be][1],n=ht+l+h+y0[be][0]+t[be][0]+(Z/4294967296>>>0)>>>0,i=Z>>>0,Z=c+p,s=a+g+(Z/4294967296>>>0)>>>0,o=Z>>>0,ht=Ce,mt=we,Ce=ne,we=le,ne=Y,le=X,Z=L+i,Y=R+n+(Z/4294967296>>>0)>>>0,X=Z>>>0,R=w,L=B,w=m,B=x,m=y,x=v,Z=i+o,y=n+s+(Z/4294967296>>>0)>>>0,v=Z>>>0;Z=e[0][1]+v,e[0][0]=e[0][0]+y+(Z/4294967296>>>0)>>>0,e[0][1]=Z>>>0,Z=e[1][1]+x,e[1][0]=e[1][0]+m+(Z/4294967296>>>0)>>>0,e[1][1]=Z>>>0,Z=e[2][1]+B,e[2][0]=e[2][0]+w+(Z/4294967296>>>0)>>>0,e[2][1]=Z>>>0,Z=e[3][1]+L,e[3][0]=e[3][0]+R+(Z/4294967296>>>0)>>>0,e[3][1]=Z>>>0,Z=e[4][1]+X,e[4][0]=e[4][0]+Y+(Z/4294967296>>>0)>>>0,e[4][1]=Z>>>0,Z=e[5][1]+le,e[5][0]=e[5][0]+ne+(Z/4294967296>>>0)>>>0,e[5][1]=Z>>>0,Z=e[6][1]+we,e[6][0]=e[6][0]+Ce+(Z/4294967296>>>0)>>>0,e[6][1]=Z>>>0,Z=e[7][1]+mt,e[7][0]=e[7][0]+ht+(Z/4294967296>>>0)>>>0,e[7][1]=Z>>>0,ut-=128}}u(rT,"_update")});var oT=_(v0=>{var C3=fe();on();var Kt=C3.asn1;v0.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};v0.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var ET=_((IK,vT)=>{var Yt=fe();ha();Ur();m0();Ae();var hT=oT(),S3=hT.publicKeyValidator,x3=hT.privateKeyValidator;typeof aT>"u"&&(aT=Yt.jsbn.BigInteger);var aT,S0=Yt.util.ByteBuffer,Sr=typeof Buffer>"u"?Uint8Array:Buffer;Yt.pki=Yt.pki||{};vT.exports=Yt.pki.ed25519=Yt.ed25519=Yt.ed25519||{};var me=Yt.ed25519;me.constants={};me.constants.PUBLIC_KEY_BYTE_LENGTH=32;me.constants.PRIVATE_KEY_BYTE_LENGTH=64;me.constants.SEED_BYTE_LENGTH=32;me.constants.SIGN_BYTE_LENGTH=64;me.constants.HASH_BYTE_LENGTH=64;me.generateKeyPair=function(e){e=e||{};var t=e.seed;if(t===void 0)t=Yt.random.getBytesSync(me.constants.SEED_BYTE_LENGTH);else if(typeof t=="string"){if(t.length!==me.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+me.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');t=Kn({message:t,encoding:"binary"});for(var r=new Sr(me.constants.PUBLIC_KEY_BYTE_LENGTH),n=new Sr(me.constants.PRIVATE_KEY_BYTE_LENGTH),i=0;i<32;++i)n[i]=t[i];return b3(r,n),{publicKey:r,privateKey:n}};me.privateKeyFromAsn1=function(e){var t={},r=[],n=Yt.asn1.validate(e,x3,t,r);if(!n){var i=new Error("Invalid Key.");throw i.errors=r,i}var s=Yt.asn1.derToOid(t.privateKeyOid),o=Yt.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=t.privateKey,c=Kn({message:Yt.asn1.fromDer(a).value,encoding:"binary"});return{privateKeyBytes:c}};me.publicKeyFromAsn1=function(e){var t={},r=[],n=Yt.asn1.validate(e,S3,t,r);if(!n){var i=new Error("Invalid Key.");throw i.errors=r,i}var s=Yt.asn1.derToOid(t.publicKeyOid),o=Yt.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=t.ed25519PublicKey;if(a.length!==me.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Kn({message:a,encoding:"binary"})};me.publicKeyFromPrivateKey=function(e){e=e||{};var t=Kn({message:e.privateKey,encoding:"binary"});if(t.length!==me.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+me.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new Sr(me.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=t[32+n];return r};me.sign=function(e){e=e||{};var t=Kn(e),r=Kn({message:e.privateKey,encoding:"binary"});if(r.length===me.constants.SEED_BYTE_LENGTH){var n=me.generateKeyPair({seed:r});r=n.privateKey}else if(r.length!==me.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+me.constants.SEED_BYTE_LENGTH+" or "+me.constants.PRIVATE_KEY_BYTE_LENGTH);var i=new Sr(me.constants.SIGN_BYTE_LENGTH+t.length);I3(i,t,t.length,r);for(var s=new Sr(me.constants.SIGN_BYTE_LENGTH),o=0;o<s.length;++o)s[o]=i[o];return s};me.verify=function(e){e=e||{};var t=Kn(e);if(e.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=Kn({message:e.signature,encoding:"binary"});if(r.length!==me.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+me.constants.SIGN_BYTE_LENGTH);var n=Kn({message:e.publicKey,encoding:"binary"});if(n.length!==me.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+me.constants.PUBLIC_KEY_BYTE_LENGTH);var i=new Sr(me.constants.SIGN_BYTE_LENGTH+t.length),s=new Sr(me.constants.SIGN_BYTE_LENGTH+t.length),o;for(o=0;o<me.constants.SIGN_BYTE_LENGTH;++o)i[o]=r[o];for(o=0;o<t.length;++o)i[o+me.constants.SIGN_BYTE_LENGTH]=t[o];return A3(s,i,i.length,n)>=0};function Kn(e){var t=e.message;if(t instanceof Uint8Array||t instanceof Sr)return t;var r=e.encoding;if(t===void 0)if(e.md)t=e.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof t=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof t=="string"){if(typeof Buffer<"u")return Buffer.from(t,r);t=new S0(t,r)}else if(!(t instanceof S0))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var n=new Sr(t.length()),i=0;i<n.length;++i)n[i]=t.at(i);return n}u(Kn,"messageToNativeBuffer");var x0=re(),Ic=re([1]),T3=re([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),_3=re([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),uT=re([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),cT=re([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),E0=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),w3=re([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ma(e,t){var r=Yt.md.sha512.create(),n=new S0(e);r.update(n.getBytes(t),"binary");var i=r.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(i,"binary");for(var s=new Sr(me.constants.HASH_BYTE_LENGTH),o=0;o<64;++o)s[o]=i.charCodeAt(o);return s}u(ma,"sha512");function b3(e,t){var r=[re(),re(),re(),re()],n,i=ma(t,32);for(i[0]&=248,i[31]&=127,i[31]|=64,b0(r,i),w0(e,r),n=0;n<32;++n)t[n+32]=e[n];return 0}u(b3,"crypto_sign_keypair");function I3(e,t,r,n){var i,s,o=new Float64Array(64),a=[re(),re(),re(),re()],c=ma(n,32);c[0]&=248,c[31]&=127,c[31]|=64;var l=r+64;for(i=0;i<r;++i)e[64+i]=t[i];for(i=0;i<32;++i)e[32+i]=c[32+i];var f=ma(e.subarray(32),r+32);for(T0(f),b0(a,f),w0(e,a),i=32;i<64;++i)e[i]=n[i];var h=ma(e,r+64);for(T0(h),i=32;i<64;++i)o[i]=0;for(i=0;i<32;++i)o[i]=f[i];for(i=0;i<32;++i)for(s=0;s<32;s++)o[i+s]+=h[i]*c[s];return pT(e.subarray(32),o),l}u(I3,"crypto_sign");function A3(e,t,r,n){var i,s,o=new Sr(32),a=[re(),re(),re(),re()],c=[re(),re(),re(),re()];if(s=-1,r<64||B3(c,n))return-1;for(i=0;i<r;++i)e[i]=t[i];for(i=0;i<32;++i)e[i+32]=n[i];var l=ma(e,r);if(T0(l),yT(a,c,l),b0(c,t.subarray(32)),_0(a,c),w0(o,a),r-=64,dT(t,0,o,0)){for(i=0;i<r;++i)e[i]=0;return-1}for(i=0;i<r;++i)e[i]=t[i+64];return s=r,s}u(A3,"crypto_sign_open");function pT(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*E0[i-(n-32)],r=t[i]+128>>8,t[i]-=r*256;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;++i)t[i]+=r-(t[31]>>4)*E0[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;++i)t[i]-=r*E0[i];for(n=0;n<32;++n)t[n+1]+=t[n]>>8,e[n]=t[n]&255}u(pT,"modL");function T0(e){for(var t=new Float64Array(64),r=0;r<64;++r)t[r]=e[r],e[r]=0;pT(e,t)}u(T0,"reduce");function _0(e,t){var r=re(),n=re(),i=re(),s=re(),o=re(),a=re(),c=re(),l=re(),f=re();to(r,e[1],e[0]),to(f,t[1],t[0]),qe(r,r,f),eo(n,e[0],e[1]),eo(f,t[0],t[1]),qe(n,n,f),qe(i,e[3],t[3]),qe(i,i,_3),qe(s,e[2],t[2]),eo(s,s,s),to(o,n,r),to(a,s,i),eo(c,s,i),eo(l,n,r),qe(e[0],o,a),qe(e[1],l,c),qe(e[2],c,a),qe(e[3],o,l)}u(_0,"add");function lT(e,t,r){for(var n=0;n<4;++n)mT(e[n],t[n],r)}u(lT,"cswap");function w0(e,t){var r=re(),n=re(),i=re();L3(i,t[2]),qe(r,t[0],i),qe(n,t[1],i),Ac(e,n),e[31]^=gT(r)<<7}u(w0,"pack");function Ac(e,t){var r,n,i,s=re(),o=re();for(r=0;r<16;++r)o[r]=t[r];for(C0(o),C0(o),C0(o),n=0;n<2;++n){for(s[0]=o[0]-65517,r=1;r<15;++r)s[r]=o[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=o[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,mT(o,s,1-i)}for(r=0;r<16;r++)e[2*r]=o[r]&255,e[2*r+1]=o[r]>>8}u(Ac,"pack25519");function B3(e,t){var r=re(),n=re(),i=re(),s=re(),o=re(),a=re(),c=re();return vi(e[2],Ic),N3(e[1],t),ts(i,e[1]),qe(s,i,T3),to(i,i,e[2]),eo(s,e[2],s),ts(o,s),ts(a,o),qe(c,a,o),qe(r,c,i),qe(r,r,s),R3(r,r),qe(r,r,i),qe(r,r,s),qe(r,r,s),qe(e[0],r,s),ts(n,e[0]),qe(n,n,s),fT(n,i)&&qe(e[0],e[0],w3),ts(n,e[0]),qe(n,n,s),fT(n,i)?-1:(gT(e[0])===t[31]>>7&&to(e[0],x0,e[0]),qe(e[3],e[0],e[1]),0)}u(B3,"unpackneg");function N3(e,t){var r;for(r=0;r<16;++r)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}u(N3,"unpack25519");function R3(e,t){var r=re(),n;for(n=0;n<16;++n)r[n]=t[n];for(n=250;n>=0;--n)ts(r,r),n!==1&&qe(r,r,t);for(n=0;n<16;++n)e[n]=r[n]}u(R3,"pow2523");function fT(e,t){var r=new Sr(32),n=new Sr(32);return Ac(r,e),Ac(n,t),dT(r,0,n,0)}u(fT,"neq25519");function dT(e,t,r,n){return D3(e,t,r,n,32)}u(dT,"crypto_verify_32");function D3(e,t,r,n,i){var s,o=0;for(s=0;s<i;++s)o|=e[t+s]^r[n+s];return(1&o-1>>>8)-1}u(D3,"vn");function gT(e){var t=new Sr(32);return Ac(t,e),t[0]&1}u(gT,"par25519");function yT(e,t,r){var n,i;for(vi(e[0],x0),vi(e[1],Ic),vi(e[2],Ic),vi(e[3],x0),i=255;i>=0;--i)n=r[i/8|0]>>(i&7)&1,lT(e,t,n),_0(t,e),_0(e,e),lT(e,t,n)}u(yT,"scalarmult");function b0(e,t){var r=[re(),re(),re(),re()];vi(r[0],uT),vi(r[1],cT),vi(r[2],Ic),qe(r[3],uT,cT),yT(e,r,t)}u(b0,"scalarbase");function vi(e,t){var r;for(r=0;r<16;r++)e[r]=t[r]|0}u(vi,"set25519");function L3(e,t){var r=re(),n;for(n=0;n<16;++n)r[n]=t[n];for(n=253;n>=0;--n)ts(r,r),n!==2&&n!==4&&qe(r,r,t);for(n=0;n<16;++n)e[n]=r[n]}u(L3,"inv25519");function C0(e){var t,r,n=1;for(t=0;t<16;++t)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-n*65536;e[0]+=n-1+37*(n-1)}u(C0,"car25519");function mT(e,t,r){for(var n,i=~(r-1),s=0;s<16;++s)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}u(mT,"sel25519");function re(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;++t)r[t]=e[t];return r}u(re,"gf");function eo(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]+r[n]}u(eo,"A");function to(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]-r[n]}u(to,"Z");function ts(e,t){qe(e,t,t)}u(ts,"S");function qe(e,t,r){var n,i,s=0,o=0,a=0,c=0,l=0,f=0,h=0,d=0,g=0,p=0,y=0,v=0,m=0,x=0,w=0,B=0,R=0,L=0,Y=0,X=0,ne=0,le=0,Ce=0,we=0,ht=0,mt=0,be=0,Ze=0,Z=0,ln=0,Hn=0,tt=r[0],rt=r[1],ut=r[2],Tt=r[3],pt=r[4],Ht=r[5],_t=r[6],wt=r[7],ct=r[8],bt=r[9],It=r[10],At=r[11],Bt=r[12],Nt=r[13],Rt=r[14],vt=r[15];n=t[0],s+=n*tt,o+=n*rt,a+=n*ut,c+=n*Tt,l+=n*pt,f+=n*Ht,h+=n*_t,d+=n*wt,g+=n*ct,p+=n*bt,y+=n*It,v+=n*At,m+=n*Bt,x+=n*Nt,w+=n*Rt,B+=n*vt,n=t[1],o+=n*tt,a+=n*rt,c+=n*ut,l+=n*Tt,f+=n*pt,h+=n*Ht,d+=n*_t,g+=n*wt,p+=n*ct,y+=n*bt,v+=n*It,m+=n*At,x+=n*Bt,w+=n*Nt,B+=n*Rt,R+=n*vt,n=t[2],a+=n*tt,c+=n*rt,l+=n*ut,f+=n*Tt,h+=n*pt,d+=n*Ht,g+=n*_t,p+=n*wt,y+=n*ct,v+=n*bt,m+=n*It,x+=n*At,w+=n*Bt,B+=n*Nt,R+=n*Rt,L+=n*vt,n=t[3],c+=n*tt,l+=n*rt,f+=n*ut,h+=n*Tt,d+=n*pt,g+=n*Ht,p+=n*_t,y+=n*wt,v+=n*ct,m+=n*bt,x+=n*It,w+=n*At,B+=n*Bt,R+=n*Nt,L+=n*Rt,Y+=n*vt,n=t[4],l+=n*tt,f+=n*rt,h+=n*ut,d+=n*Tt,g+=n*pt,p+=n*Ht,y+=n*_t,v+=n*wt,m+=n*ct,x+=n*bt,w+=n*It,B+=n*At,R+=n*Bt,L+=n*Nt,Y+=n*Rt,X+=n*vt,n=t[5],f+=n*tt,h+=n*rt,d+=n*ut,g+=n*Tt,p+=n*pt,y+=n*Ht,v+=n*_t,m+=n*wt,x+=n*ct,w+=n*bt,B+=n*It,R+=n*At,L+=n*Bt,Y+=n*Nt,X+=n*Rt,ne+=n*vt,n=t[6],h+=n*tt,d+=n*rt,g+=n*ut,p+=n*Tt,y+=n*pt,v+=n*Ht,m+=n*_t,x+=n*wt,w+=n*ct,B+=n*bt,R+=n*It,L+=n*At,Y+=n*Bt,X+=n*Nt,ne+=n*Rt,le+=n*vt,n=t[7],d+=n*tt,g+=n*rt,p+=n*ut,y+=n*Tt,v+=n*pt,m+=n*Ht,x+=n*_t,w+=n*wt,B+=n*ct,R+=n*bt,L+=n*It,Y+=n*At,X+=n*Bt,ne+=n*Nt,le+=n*Rt,Ce+=n*vt,n=t[8],g+=n*tt,p+=n*rt,y+=n*ut,v+=n*Tt,m+=n*pt,x+=n*Ht,w+=n*_t,B+=n*wt,R+=n*ct,L+=n*bt,Y+=n*It,X+=n*At,ne+=n*Bt,le+=n*Nt,Ce+=n*Rt,we+=n*vt,n=t[9],p+=n*tt,y+=n*rt,v+=n*ut,m+=n*Tt,x+=n*pt,w+=n*Ht,B+=n*_t,R+=n*wt,L+=n*ct,Y+=n*bt,X+=n*It,ne+=n*At,le+=n*Bt,Ce+=n*Nt,we+=n*Rt,ht+=n*vt,n=t[10],y+=n*tt,v+=n*rt,m+=n*ut,x+=n*Tt,w+=n*pt,B+=n*Ht,R+=n*_t,L+=n*wt,Y+=n*ct,X+=n*bt,ne+=n*It,le+=n*At,Ce+=n*Bt,we+=n*Nt,ht+=n*Rt,mt+=n*vt,n=t[11],v+=n*tt,m+=n*rt,x+=n*ut,w+=n*Tt,B+=n*pt,R+=n*Ht,L+=n*_t,Y+=n*wt,X+=n*ct,ne+=n*bt,le+=n*It,Ce+=n*At,we+=n*Bt,ht+=n*Nt,mt+=n*Rt,be+=n*vt,n=t[12],m+=n*tt,x+=n*rt,w+=n*ut,B+=n*Tt,R+=n*pt,L+=n*Ht,Y+=n*_t,X+=n*wt,ne+=n*ct,le+=n*bt,Ce+=n*It,we+=n*At,ht+=n*Bt,mt+=n*Nt,be+=n*Rt,Ze+=n*vt,n=t[13],x+=n*tt,w+=n*rt,B+=n*ut,R+=n*Tt,L+=n*pt,Y+=n*Ht,X+=n*_t,ne+=n*wt,le+=n*ct,Ce+=n*bt,we+=n*It,ht+=n*At,mt+=n*Bt,be+=n*Nt,Ze+=n*Rt,Z+=n*vt,n=t[14],w+=n*tt,B+=n*rt,R+=n*ut,L+=n*Tt,Y+=n*pt,X+=n*Ht,ne+=n*_t,le+=n*wt,Ce+=n*ct,we+=n*bt,ht+=n*It,mt+=n*At,be+=n*Bt,Ze+=n*Nt,Z+=n*Rt,ln+=n*vt,n=t[15],B+=n*tt,R+=n*rt,L+=n*ut,Y+=n*Tt,X+=n*pt,ne+=n*Ht,le+=n*_t,Ce+=n*wt,we+=n*ct,ht+=n*bt,mt+=n*It,be+=n*At,Ze+=n*Bt,Z+=n*Nt,ln+=n*Rt,Hn+=n*vt,s+=38*R,o+=38*L,a+=38*Y,c+=38*X,l+=38*ne,f+=38*le,h+=38*Ce,d+=38*we,g+=38*ht,p+=38*mt,y+=38*be,v+=38*Ze,m+=38*Z,x+=38*ln,w+=38*Hn,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=v+i+65535,i=Math.floor(n/65536),v=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=x+i+65535,i=Math.floor(n/65536),x=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=B+i+65535,i=Math.floor(n/65536),B=n-i*65536,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=v+i+65535,i=Math.floor(n/65536),v=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=x+i+65535,i=Math.floor(n/65536),x=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=B+i+65535,i=Math.floor(n/65536),B=n-i*65536,s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=c,e[4]=l,e[5]=f,e[6]=h,e[7]=d,e[8]=g,e[9]=p,e[10]=y,e[11]=v,e[12]=m,e[13]=x,e[14]=w,e[15]=B}u(qe,"M")});var TT=_((BK,xT)=>{var Nr=fe();Ae();Ur();ha();xT.exports=Nr.kem=Nr.kem||{};var CT=Nr.jsbn.BigInteger;Nr.kem.rsa={};Nr.kem.rsa.create=function(e,t){t=t||{};var r=t.prng||Nr.random,n={};return n.encrypt=function(i,s){var o=Math.ceil(i.n.bitLength()/8),a;do a=new CT(Nr.util.bytesToHex(r.getBytesSync(o)),16).mod(i.n);while(a.compareTo(CT.ONE)<=0);a=Nr.util.hexToBytes(a.toString(16));var c=o-a.length;c>0&&(a=Nr.util.fillString("\0",c)+a);var l=i.encrypt(a,"NONE"),f=e.generate(a,s);return{encapsulation:l,key:f}},n.decrypt=function(i,s,o){var a=i.decrypt(s,"NONE");return e.generate(a,o)},n};Nr.kem.kdf1=function(e,t){ST(this,e,0,t||e.digestLength)};Nr.kem.kdf2=function(e,t){ST(this,e,1,t||e.digestLength)};function ST(e,t,r,n){e.generate=function(i,s){for(var o=new Nr.util.ByteBuffer,a=Math.ceil(s/n)+r,c=new Nr.util.ByteBuffer,l=r;l<a;++l){c.putInt32(l),t.start(),t.update(i+c.getBytes());var f=t.digest();o.putBytes(f.getBytes(n))}return o.truncate(o.length()-s),o.getBytes()}}u(ST,"_createKDF")});var IT=_((RK,bT)=>{var Ee=fe();Ae();bT.exports=Ee.log=Ee.log||{};Ee.log.levels=["none","error","warning","info","debug","verbose","max"];var Bc={},B0=[],Ea=null;Ee.log.LEVEL_LOCKED=2;Ee.log.NO_LEVEL_CHECK=4;Ee.log.INTERPOLATE=8;for(wn=0;wn<Ee.log.levels.length;++wn)I0=Ee.log.levels[wn],Bc[I0]={index:wn,name:I0.toUpperCase()};var I0,wn;Ee.log.logMessage=function(e){for(var t=Bc[e.level].index,r=0;r<B0.length;++r){var n=B0[r];if(n.flags&Ee.log.NO_LEVEL_CHECK)n.f(e);else{var i=Bc[n.level].index;t<=i&&n.f(n,e)}}};Ee.log.prepareStandard=function(e){"standard"in e||(e.standard=Bc[e.level].name+" ["+e.category+"] "+e.message)};Ee.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]),e.full=Ee.util.format.apply(this,t)}};Ee.log.prepareStandardFull=function(e){"standardFull"in e||(Ee.log.prepareStandard(e),e.standardFull=e.standard)};for(A0=["error","warning","info","debug","verbose"],wn=0;wn<A0.length;++wn)(function(t){Ee.log[t]=function(r,n){var i=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:t,category:r,message:n,arguments:i};Ee.log.logMessage(s)}})(A0[wn]);var A0,wn;Ee.log.makeLogger=function(e){var t={flags:0,f:e};return Ee.log.setLevel(t,"none"),t};Ee.log.setLevel=function(e,t){var r=!1;if(e&&!(e.flags&Ee.log.LEVEL_LOCKED))for(var n=0;n<Ee.log.levels.length;++n){var i=Ee.log.levels[n];if(t==i){e.level=t,r=!0;break}}return r};Ee.log.lock=function(e,t){typeof t>"u"||t?e.flags|=Ee.log.LEVEL_LOCKED:e.flags&=~Ee.log.LEVEL_LOCKED};Ee.log.addLogger=function(e){B0.push(e)};typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(_T={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},Ca=u(function(e,t){Ee.log.prepareStandard(t);var r=_T[t.level],n=[t.standard];n=n.concat(t.arguments.slice()),r.apply(console,n)},"f"),ro=Ee.log.makeLogger(Ca)):(Ca=u(function(t,r){Ee.log.prepareStandardFull(r),console.log(r.standardFull)},"f"),ro=Ee.log.makeLogger(Ca)),Ee.log.setLevel(ro,"debug"),Ee.log.addLogger(ro),Ea=ro):console={log:function(){}};var ro,_T,Ca;Ea!==null&&typeof window<"u"&&window.location&&(va=new URL(window.location.href).searchParams,va.has("console.level")&&Ee.log.setLevel(Ea,va.get("console.level").slice(-1)[0]),va.has("console.lock")&&(wT=va.get("console.lock").slice(-1)[0],wT=="true"&&Ee.log.lock(Ea)));var va,wT;Ee.log.consoleLogger=Ea});var BT=_((LK,AT)=>{AT.exports=mn();uc();Qs();Kd();m0()});var DT=_((OK,RT)=>{var G=fe();li();on();la();fi();Wi();r0();Ur();Ae();xc();var I=G.asn1,hr=RT.exports=G.pkcs7=G.pkcs7||{};hr.messageFromPem=function(e){var t=G.pem.decode(e)[0];if(t.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=I.fromDer(t.body);return hr.messageFromAsn1(n)};hr.messageToPem=function(e,t){var r={type:"PKCS7",body:I.toDer(e.toAsn1()).getBytes()};return G.pem.encode(r,{maxline:t})};hr.messageFromAsn1=function(e){var t={},r=[];if(!I.validate(e,hr.asn1.contentInfoValidator,t,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var i=I.derToOid(t.contentType),s;switch(i){case G.pki.oids.envelopedData:s=hr.createEnvelopedData();break;case G.pki.oids.encryptedData:s=hr.createEncryptedData();break;case G.pki.oids.signedData:s=hr.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return s.fromAsn1(t.content.value[0]),s};hr.createSignedData=function(){var e=null;return e={type:G.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(R0(e,n,hr.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var i=e.rawCapture.certificates.value,s=0;s<i.length;++s)e.certificates.push(G.pki.certificateFromAsn1(i[s]))},toAsn1:function(){e.contentInfo||e.sign();for(var n=[],i=0;i<e.certificates.length;++i)n.push(G.pki.certificateToAsn1(e.certificates[i]));var s=[],o=I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return n.length>0&&o.value[0].value.push(I.create(I.Class.CONTEXT_SPECIFIC,0,!0,n)),s.length>0&&o.value[0].value.push(I.create(I.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(I.create(I.Class.UNIVERSAL,I.Type.SET,!0,e.signerInfos)),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.type).getBytes()),o])},addSigner:function(n){var i=n.issuer,s=n.serialNumber;if(n.certificate){var o=n.certificate;typeof o=="string"&&(o=G.pki.certificateFromPem(o)),i=o.issuer.attributes,s=o.serialNumber}var a=n.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=G.pki.privateKeyFromPem(a));var c=n.digestAlgorithm||G.pki.oids.sha1;switch(c){case G.pki.oids.sha1:case G.pki.oids.sha256:case G.pki.oids.sha384:case G.pki.oids.sha512:case G.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var l=n.authenticatedAttributes||[];if(l.length>0){for(var f=!1,h=!1,d=0;d<l.length;++d){var g=l[d];if(!f&&g.type===G.pki.oids.contentType){if(f=!0,h)break;continue}if(!h&&g.type===G.pki.oids.messageDigest){if(h=!0,f)break;continue}}if(!f||!h)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:a,version:1,issuer:i,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:G.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:l,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof e.content!="object"||e.contentInfo===null)&&(e.contentInfo=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(G.pki.oids.data).getBytes())]),"content"in e)){var i;e.content instanceof G.util.ByteBuffer?i=e.content.bytes():typeof e.content=="string"&&(i=G.util.encodeUtf8(e.content)),n.detached?e.detachedContent=I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,i):e.contentInfo.value.push(I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,i)]))}if(e.signers.length!==0){var s=t();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=G.pki.certificateFromPem(n)),e.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},e;function t(){for(var n={},i=0;i<e.signers.length;++i){var s=e.signers[i],o=s.digestAlgorithm;o in n||(n[o]=G.md[G.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=n[o]:s.md=G.md[G.pki.oids[o]].create()}e.digestAlgorithmIdentifiers=[];for(var o in n)e.digestAlgorithmIdentifiers.push(I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(o).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]));return n}u(t,"addDigestAlgorithmIds");function r(n){var i;if(e.detachedContent?i=e.detachedContent:(i=e.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=I.derToOid(e.contentInfo.value[0].value),o=I.toDer(i);o.getByte(),I.getBerValueLength(o),o=o.getBytes();for(var a in n)n[a].start().update(o);for(var c=new Date,l=0;l<e.signers.length;++l){var f=e.signers[l];if(f.authenticatedAttributes.length===0){if(s!==G.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{f.authenticatedAttributesAsn1=I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var h=I.create(I.Class.UNIVERSAL,I.Type.SET,!0,[]),d=0;d<f.authenticatedAttributes.length;++d){var g=f.authenticatedAttributes[d];g.type===G.pki.oids.messageDigest?g.value=n[f.digestAlgorithm].digest():g.type===G.pki.oids.signingTime&&(g.value||(g.value=c)),h.value.push(N0(g)),f.authenticatedAttributesAsn1.value.push(N0(g))}o=I.toDer(h).getBytes(),f.md.start().update(o)}f.signature=f.key.sign(f.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=U3(e.signers)}u(r,"addSignerInfos")};hr.createEncryptedData=function(){var e=null;return e={type:G.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:G.pki.oids["aes256-CBC"]},fromAsn1:function(t){R0(e,t,hr.asn1.encryptedDataValidator)},decrypt:function(t){t!==void 0&&(e.encryptedContent.key=t),NT(e)}},e};hr.createEnvelopedData=function(){var e=null;return e={type:G.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:G.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=R0(e,t,hr.asn1.envelopedDataValidator);e.recipients=P3(r.recipientInfos.value)},toAsn1:function(){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.type).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,k3(e.recipients)),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,V3(e.encryptedContent))])])])},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var i=e.recipients[n],s=i.issuer;if(i.serialNumber===t.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return i}}return null},decrypt:function(t,r){if(e.encryptedContent.key===void 0&&t!==void 0&&r!==void 0)switch(t.encryptedContent.algorithm){case G.pki.oids.rsaEncryption:case G.pki.oids.desCBC:var n=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=G.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}NT(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:G.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(e.encryptedContent.content===void 0){r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key;var n,i,s;switch(r){case G.pki.oids["aes128-CBC"]:n=16,i=16,s=G.aes.createEncryptionCipher;break;case G.pki.oids["aes192-CBC"]:n=24,i=16,s=G.aes.createEncryptionCipher;break;case G.pki.oids["aes256-CBC"]:n=32,i=16,s=G.aes.createEncryptionCipher;break;case G.pki.oids["des-EDE3-CBC"]:n=24,i=8,s=G.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(t===void 0)t=G.util.createBuffer(G.random.getBytes(n));else if(t.length()!=n)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+n+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=G.util.createBuffer(G.random.getBytes(i));var o=s(t);if(o.start(e.encryptedContent.parameter.copy()),o.update(e.content),!o.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=o.output}for(var a=0;a<e.recipients.length;++a){var c=e.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case G.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},e};function O3(e){var t={},r=[];if(!I.validate(e,hr.asn1.recipientInfoValidator,t,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:t.version.charCodeAt(0),issuer:G.pki.RDNAttributesAsArray(t.issuer),serialNumber:G.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:I.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}u(O3,"_recipientFromAsn1");function F3(e){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[G.pki.distinguishedNameToAsn1({attributes:e.issuer}),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,G.util.hexToBytes(e.serialNumber))]),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.encryptedContent.algorithm).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.encryptedContent.content)])}u(F3,"_recipientToAsn1");function P3(e){for(var t=[],r=0;r<e.length;++r)t.push(O3(e[r]));return t}u(P3,"_recipientsFromAsn1");function k3(e){for(var t=[],r=0;r<e.length;++r)t.push(F3(e[r]));return t}u(k3,"_recipientsToAsn1");function q3(e){var t=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[G.pki.distinguishedNameToAsn1({attributes:e.issuer}),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,G.util.hexToBytes(e.serialNumber))]),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.digestAlgorithm).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.signatureAlgorithm).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")])),t.value.push(I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=I.create(I.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<e.unauthenticatedAttributes.length;++n){var i=e.unauthenticatedAttributes[n];r.values.push(N0(i))}t.value.push(r)}return t}u(q3,"_signerToAsn1");function U3(e){for(var t=[],r=0;r<e.length;++r)t.push(q3(e[r]));return t}u(U3,"_signersToAsn1");function N0(e){var t;if(e.type===G.pki.oids.contentType)t=I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.value).getBytes());else if(e.type===G.pki.oids.messageDigest)t=I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===G.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=e.value;if(typeof i=="string"){var s=Date.parse(i);isNaN(s)?i.length===13?i=I.utcTimeToDate(i):i=I.generalizedTimeToDate(i):i=new Date(s)}i>=r&&i<n?t=I.create(I.Class.UNIVERSAL,I.Type.UTCTIME,!1,I.dateToUtcTime(i)):t=I.create(I.Class.UNIVERSAL,I.Type.GENERALIZEDTIME,!1,I.dateToGeneralizedTime(i))}return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.type).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,[t])])}u(N0,"_attributeToAsn1");function V3(e){return[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(G.pki.oids.data).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.algorithm).getBytes()),e.parameter?I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.parameter.getBytes()):void 0]),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.content.getBytes())])]}u(V3,"_encryptedContentToAsn1");function R0(e,t,r){var n={},i=[];if(!I.validate(t,r,n,i)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=I.derToOid(n.contentType);if(o!==G.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var a="";if(G.util.isArray(n.encryptedContent))for(var c=0;c<n.encryptedContent.length;++c){if(n.encryptedContent[c].type!==I.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=n.encryptedContent[c].value}else a=n.encryptedContent;e.encryptedContent={algorithm:I.derToOid(n.encAlgorithm),parameter:G.util.createBuffer(n.encParameter.value),content:G.util.createBuffer(a)}}if(n.content){var a="";if(G.util.isArray(n.content))for(var c=0;c<n.content.length;++c){if(n.content[c].type!==I.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=n.content[c].value}else a=n.content;e.content=G.util.createBuffer(a)}return e.version=n.version.charCodeAt(0),e.rawCapture=n,n}u(R0,"_fromAsn1");function NT(e){if(e.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(e.content===void 0){var t;switch(e.encryptedContent.algorithm){case G.pki.oids["aes128-CBC"]:case G.pki.oids["aes192-CBC"]:case G.pki.oids["aes256-CBC"]:t=G.aes.createDecryptionCipher(e.encryptedContent.key);break;case G.pki.oids.desCBC:case G.pki.oids["des-EDE3-CBC"]:t=G.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}u(NT,"_decryptContent")});var OT=_((PK,LT)=>{var yt=fe();li();Gs();uc();Qs();Ae();var Rc=LT.exports=yt.ssh=yt.ssh||{};Rc.privateKeyToPutty=function(e,t,r){r=r||"",t=t||"";var n="ssh-rsa",i=t===""?"none":"aes256-cbc",s="PuTTY-User-Key-File-2: "+n+`\r
`;s+="Encryption: "+i+`\r
`,s+="Comment: "+r+`\r
`;var o=yt.util.createBuffer();no(o,n),bn(o,e.e),bn(o,e.n);var a=yt.util.encode64(o.bytes(),64),c=Math.floor(a.length/66)+1;s+="Public-Lines: "+c+`\r
`,s+=a;var l=yt.util.createBuffer();bn(l,e.d),bn(l,e.p),bn(l,e.q),bn(l,e.qInv);var f;if(!t)f=yt.util.encode64(l.bytes(),64);else{var h=l.length()+16-1;h-=h%16;var d=Nc(l.bytes());d.truncate(d.length()-h+l.length()),l.putBuffer(d);var g=yt.util.createBuffer();g.putBuffer(Nc("\0\0\0\0",t)),g.putBuffer(Nc("\0\0\0",t));var p=yt.aes.createEncryptionCipher(g.truncate(8),"CBC");p.start(yt.util.createBuffer().fillWithByte(0,16)),p.update(l.copy()),p.finish();var y=p.output;y.truncate(16),f=yt.util.encode64(y.bytes(),64)}c=Math.floor(f.length/66)+1,s+=`\r
Private-Lines: `+c+`\r
`,s+=f;var v=Nc("putty-private-key-file-mac-key",t),m=yt.util.createBuffer();no(m,n),no(m,i),no(m,r),m.putInt32(o.length()),m.putBuffer(o),m.putInt32(l.length()),m.putBuffer(l);var x=yt.hmac.create();return x.start("sha1",v),x.update(m.bytes()),s+=`\r
Private-MAC: `+x.digest().toHex()+`\r
`,s};Rc.publicKeyToOpenSSH=function(e,t){var r="ssh-rsa";t=t||"";var n=yt.util.createBuffer();return no(n,r),bn(n,e.e),bn(n,e.n),r+" "+yt.util.encode64(n.bytes())+" "+t};Rc.privateKeyToOpenSSH=function(e,t){return t?yt.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):yt.pki.privateKeyToPem(e)};Rc.getPublicKeyFingerprint=function(e,t){t=t||{};var r=t.md||yt.md.md5.create(),n="ssh-rsa",i=yt.util.createBuffer();no(i,n),bn(i,e.e),bn(i,e.n),r.start(),r.update(i.getBytes());var s=r.digest();if(t.encoding==="hex"){var o=s.toHex();return t.delimiter?o.match(/.{2}/g).join(t.delimiter):o}else{if(t.encoding==="binary")return s.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return s};function bn(e,t){var r=t.toString(16);r[0]>="8"&&(r="00"+r);var n=yt.util.hexToBytes(r);e.putInt32(n.length),e.putBytes(n)}u(bn,"_addBigIntegerToBuffer");function no(e,t){e.putInt32(t.length),e.putString(t)}u(no,"_addStringToBuffer");function Nc(){for(var e=yt.md.sha1.create(),t=arguments.length,r=0;r<t;++r)e.update(arguments[r]);return e.digest()}u(Nc,"_sha1")});var PT=_((qK,FT)=>{FT.exports=fe();li();tT();on();tc();la();ET();Gs();TT();IT();BT();n0();hc();Wi();Yd();o0();DT();u0();Jd();Hd();Ec();Ur();jd();OT();d0();Ae()});var MT=_((UK,VT)=>{var kT=ji(),In=PT(),qT=[[813826048,33620784,2181038086,153781832,2264337665,117547136],[805306881,53477382,153781832,2264337665,117547008,67108864],[813760514,16986241,395562,2252900087,218171137,2692808708],[813826048,33620784,2164262409,713443462,4144824583,27296e3],[813891584,131331,813826048,101264006,1216804621,17236384],[813891584,131331,813891584,395562,2252900087,218171137],[813957120,513,53510912,1545,713443462,4144824583],[813957120,513,53511168,6,153781832,2264337665]],M3=[[4294901760,4294967295,4278190335,4294967295,4294967295,4294967280],[4278255615,4294902015,4294967295,4294967295,4294967040,4278190080],[4294902015,4294967295,16777215,4294967295,4294967295,4294902015],[4294901760,4294967295,4278255615,4294967295,4294967295,4294967040],[4294901760,16777215,4294901760,4294967295,4294967295,4294967295],[4294901760,16777215,4294901760,16777215,4294967295,4294967295],[4294901760,65535,4294967040,65535,4294967295,4294967295],[4294901760,65535,4294967040,255,4294967295,4294967295]],L0=class L0{constructor(t,r){this.keystore=t,this.password=r}static probe(t){let n=new kT(t).read(24);for(let i=0;i<qT.length;i++){let s=new kT(n),o=qT[i];if(M3[i].map(l=>(s.readInt()&l)>>>0).every((l,f)=>l===o[f]))return!0}return!1}parse(){let t=this.keystore.toString("base64"),r=In.util.decode64(t),n=In.asn1.fromDer(r);return In.pkcs12.pkcs12FromAsn1(n,this.password||"").safeContents.reduce((s,o)=>Array.isArray(o.safeBags)?s.concat(o.safeBags):s,[])}toPem(t){return t.reduce((r,n)=>{let i=n.attributes.friendlyName[0],s=!!n.attributes.localKeyId,o=r[i]||{};if(n.type===In.pki.oids.certBag){let a=s?"cert":"ca";n.cert?o={...o,[a]:In.pki.certificateToPem(n.cert).replace(/\r\n/g,`
`)}:n.asn1&&(o={...o,[a]:UT(n.asn1,"CERTIFICATE").replace(/\r\n/g,`
`)})}return n.key?o={...o,key:K3(n.key).replace(/\r\n/g,`
`)}:n.asn1&&n.hasOwnProperty("key")&&(o={...o,key:UT(n.asn1,"PRIVATE KEY").replace(/\r\n/g,`
`)}),{...r,[i]:o}},{})}};u(L0,"PKCS12Parser");var D0=L0,K3=u((e,t)=>In.pki.privateKeyInfoToPem(In.pki.wrapRsaPrivateKey(In.pki.privateKeyToAsn1(e))),"privateKeyToPem"),UT=u((e,t)=>{let r={type:t,body:In.asn1.toDer(e).getBytes()};return In.pem.encode(r)},"derToPem");VT.exports=D0});var Sa=_((MK,HT)=>{var KT=ji(),H3=Ms(),un=class un{constructor(t){this.tag=null,this.length=0,this.data=null,this.buffer=null,this.buffer=H3(t.buffer,t.offset),this.init(t)}init(t){this.tag=t.readByte();let r=t.buffer.readUInt8(t.offset);if(this.length=un.getLength(t),this.length===-1){let n=t.available(),i=2,s=new OutputStream(Buffer.alloc(n+i));throw s.write(this.tag),s.write(r),s.write(t.read(n)),new Error("Length is not defined. The DerIndefLenConverter.convert() has not been implemented yet")}this.data=new KT(t.read(this.length))}isConstructed(t){return(this.tag&32)==32?t?(tag&31)==t:!0:!1}static getLength(t){let r=t.readByte();if(!(r&128))return r;let n=r&127;if(n===0)return-1;if(n<0)throw new Error("Incorrect DER encodding");if(n>4)throw new Error("DER length too big");let i;for(i=0;n>0;n--)i<<=8,i+=255&t.readByte();if(i<0)throw new Error("Invalid length byte");return i}getBigInteger(){let t=this.data;if(t.readByte()!=un.tag_Integer)throw new Error("DER input, Integer tag error");let r=un.getLength(t);return r<=1?t.readByte():r===2?t.readShort():r<=4?t.readInt():t.readLong()}getOctetString(){if(this.tag!==un.tag_OctetString&&!this.isConstructed(un.tag_OctetString))throw new Error("DerValue.getOctetString, not an Octet String: "+derValue.tag);let t=new KT(this.buffer),r=Buffer.from([]);for(;t.available();){let n=t.readByte();if(n!==un.tag_OctetString)throw new Error("DER input not an octet string: "+n);let i=un.getLength(t),s=t.read(i);r=Buffer.concat([r,s])}return r}getDerValue(){return new un(this.data)}};u(un,"DerValue");var rs=un;rs.tag_ObjectId=6;rs.tag_Sequence=48;rs.tag_OctetString=4;rs.tag_Integer=2;HT.exports=rs});var P0=_((HK,GT)=>{var $T=Sa(),F0=class F0{constructor(t){let r=t.readByte();if(r!==$T.tag_ObjectId)throw new Error("data isn't an object ID ( tag = "+r+")");let n=$T.getLength(t);this.encoding=t.read(n)}toString(){let t=this.encoding.length,r="",n=0;for(let i=0;i<t;i++)if(!(this.encoding[i]&128)){n!==0&&(r+=".");let s=0;for(let o=n;o<=i;o++){s<<=7;let a=this.encoding[o];s|=a&127}n===0?s<80?(r+=Math.floor(s/40),r+=".",r+=s%40):(r+="2.",r+=s-80):r+=s,n=i+1}return r}};u(F0,"ObjectIdentifier");var O0=F0;GT.exports=O0});var zT=_((GK,jT)=>{var $3=ji(),G3=P0(),k0=Sa(),U0=class U0{constructor(t){let r=new k0(new $3(t)),n=new k0(r.data),i=new k0(r.data);this.alghorithmId=this.createAlghorithmId(n),this.octetString=i.getOctetString()}createAlghorithmId(t){return new G3(t.data).toString()}getAlgorithm(){return this.alghorithmId}getEncryptedData(){return this.octetString}};u(U0,"EncryptedPrivateKeyInfo");var q0=U0;jT.exports=q0});var pr=_((WK,io)=>{var zK=require("crypto");io.exports.linebrk=function(e,t){for(var r="",n=0;n+t<e.length;)r+=e.substring(n,n+t)+`
`,n+=t;return r+e.substring(n,e.length)};io.exports.detectEnvironment=function(){return typeof window<"u"&&window&&!(process&&process.title==="node")?"browser":"node"};io.exports.get32IntFromBuffer=function(e,t){t=t||0;var r=0;if((r=e.length-t)>0){if(r>=4)return e.readUIntBE(t,r);for(var n=0,i=t+r,s=0;i>t;i--,s+=2)n+=e[i-1]*Math.pow(16,s);return n}else return NaN};io.exports._={isObject:function(e){var t=typeof e;return!!e&&(t=="object"||t=="function")},isString:function(e){return typeof e=="string"||e instanceof String},isNumber:function(e){return typeof e=="number"||!isNaN(parseFloat(e))&&isFinite(e)},omit:function(e,t){var r={};for(var n in e)!e.hasOwnProperty(n)||n===t||(r[n]=e[n]);return r}};io.exports.trimSurroundingText=function(e,t,r){var n=0,i=e.length,s=e.indexOf(t);s>=0&&(n=s+t.length);var o=e.indexOf(r,s);return o>=0&&(i=o),e.substring(n,i)}});var ss=_((ZK,XT)=>{var j3=require("crypto"),z3=pr()._,so,W3=0xdeadbeefcafe,QK=(W3&16777215)==15715070;function U(e,t){e!=null&&(typeof e=="number"?this.fromNumber(e,t):Buffer.isBuffer(e)?this.fromBuffer(e):t==null&&typeof e!="string"?this.fromByteArray(e):this.fromString(e,t))}u(U,"BigInteger");function Se(){return new U(null)}u(Se,"nbi");function Q3(e,t,r,n,i,s){for(var o=t&16383,a=t>>14;--s>=0;){var c=this[e]&16383,l=this[e++]>>14,f=a*c+l*o;c=o*c+((f&16383)<<14)+r[n]+i,i=(c>>28)+(f>>14)+a*l,r[n++]=c&268435455}return i}u(Q3,"am3");U.prototype.am=Q3;so=28;U.prototype.DB=so;U.prototype.DM=(1<<so)-1;U.prototype.DV=1<<so;var M0=52;U.prototype.FV=Math.pow(2,M0);U.prototype.F1=M0-so;U.prototype.F2=2*so-M0;var Z3="0123456789abcdefghijklmnopqrstuvwxyz",Dc=new Array,oo,Gr;oo=48;for(Gr=0;Gr<=9;++Gr)Dc[oo++]=Gr;oo=97;for(Gr=10;Gr<36;++Gr)Dc[oo++]=Gr;oo=65;for(Gr=10;Gr<36;++Gr)Dc[oo++]=Gr;function V0(e){return Z3.charAt(e)}u(V0,"int2char");function WT(e,t){var r=Dc[e.charCodeAt(t)];return r??-1}u(WT,"intAt");function Y3(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}u(Y3,"bnpCopyTo");function X3(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+DV:this.t=0}u(X3,"bnpFromInt");function Ei(e){var t=Se();return t.fromInt(e),t}u(Ei,"nbv");function J3(e,t,r){var n;switch(t){case 2:n=1;break;case 4:n=2;break;case 8:n=3;break;case 16:n=4;break;case 32:n=5;break;case 256:n=8;break;default:this.fromRadix(e,t);return}this.t=0,this.s=0;for(var i=e.length,s=!1,o=0;--i>=0;){var a=n==8?e[i]&255:WT(e,i);if(a<0){e.charAt(i)=="-"&&(s=!0);continue}s=!1,o===0?this[this.t++]=a:o+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,o+=n,o>=this.DB&&(o-=this.DB)}!r&&n==8&&e[0]&128&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),s&&U.ZERO.subTo(this,this)}u(J3,"bnpFromString");function ek(e,t){this.fromString(e,256,t)}u(ek,"bnpFromByteArray");function tk(e){this.fromString(e,256,!0)}u(tk,"bnpFromBuffer");function rk(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}u(rk,"bnpClamp");function nk(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(n=this[o]>>a)>0&&(i=!0,s=V0(n));o>=0;)a<t?(n=(this[o]&(1<<a)-1)<<t-a,n|=this[--o]>>(a+=this.DB-t)):(n=this[o]>>(a-=t)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=V0(n));return i?s:"0"}u(nk,"bnToString");function ik(){var e=Se();return U.ZERO.subTo(this,e),e}u(ik,"bnNegate");function sk(){return this.s<0?this.negate():this}u(sk,"bnAbs");function ok(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this[r]-e[r])!=0)return t;return 0}u(ok,"bnCompareTo");function Lc(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}u(Lc,"nbits");function ak(){return this.t<=0?0:this.DB*(this.t-1)+Lc(this[this.t-1]^this.s&this.DM)}u(ak,"bnBitLength");function uk(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s}u(uk,"bnpDLShiftTo");function ck(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s}u(ck,"bnpDRShiftTo");function lk(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+s+1]=this[a]>>n|o,o=(this[a]&i)<<r;for(a=s-1;a>=0;--a)t[a]=0;t[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}u(lk,"bnpLShiftTo");function fk(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t[0]=this[r]>>n;for(var o=r+1;o<this.t;++o)t[o-r-1]|=(this[o]&s)<<i,t[o-r]=this[o]>>n;n>0&&(t[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}u(fk,"bnpRShiftTo");function hk(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()}u(hk,"bnpSubTo");function pk(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t[i]=0;for(i=0;i<n.t;++i)t[i+r.t]=r.am(0,n[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&U.ZERO.subTo(t,t)}u(pk,"bnpMultiplyTo");function dk(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()}u(dk,"bnpSquareTo");function gk(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t!=null&&t.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Se());var s=Se(),o=this.s,a=e.s,c=this.DB-Lc(n[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var l=s.t,f=s[l-1];if(f!==0){var h=f*(1<<this.F1)+(l>1?s[l-2]>>this.F2:0),d=this.FV/h,g=(1<<this.F1)/h,p=1<<this.F2,y=r.t,v=y-l,m=t??Se();for(s.dlShiftTo(v,m),r.compareTo(m)>=0&&(r[r.t++]=1,r.subTo(m,r)),U.ONE.dlShiftTo(l,m),m.subTo(s,s);s.t<l;)s[s.t++]=0;for(;--v>=0;){var x=r[--y]==f?this.DM:Math.floor(r[y]*d+(r[y-1]+p)*g);if((r[y]+=s.am(0,x,r,v,0,l))<x)for(s.dlShiftTo(v,m),r.subTo(m,r);r[y]<--x;)r.subTo(m,r)}t!=null&&(r.drShiftTo(l,t),o!=a&&U.ZERO.subTo(t,t)),r.t=l,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&U.ZERO.subTo(r,r)}}}u(gk,"bnpDivRemTo");function yk(e){var t=Se();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(U.ZERO)>0&&e.subTo(t,t),t}u(yk,"bnMod");function ns(e){this.m=e}u(ns,"Classic");function mk(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}u(mk,"cConvert");function vk(e){return e}u(vk,"cRevert");function Ek(e){e.divRemTo(this.m,null,e)}u(Ek,"cReduce");function Ck(e,t,r){e.multiplyTo(t,r),this.reduce(r)}u(Ck,"cMulTo");function Sk(e,t){e.squareTo(t),this.reduce(t)}u(Sk,"cSqrTo");ns.prototype.convert=mk;ns.prototype.revert=vk;ns.prototype.reduce=Ek;ns.prototype.mulTo=Ck;ns.prototype.sqrTo=Sk;function xk(){if(this.t<1)return 0;var e=this[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}u(xk,"bnpInvDigit");function is(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}u(is,"Montgomery");function Tk(e){var t=Se();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(U.ZERO)>0&&this.m.subTo(t,t),t}u(Tk,"montConvert");function _k(e){var t=Se();return e.copyTo(t),this.reduce(t),t}u(_k,"montRevert");function wk(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e[t]&32767,n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e[r]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}u(wk,"montReduce");function bk(e,t){e.squareTo(t),this.reduce(t)}u(bk,"montSqrTo");function Ik(e,t,r){e.multiplyTo(t,r),this.reduce(r)}u(Ik,"montMulTo");is.prototype.convert=Tk;is.prototype.revert=_k;is.prototype.reduce=wk;is.prototype.mulTo=Ik;is.prototype.sqrTo=bk;function Ak(){return(this.t>0?this[0]&1:this.s)===0}u(Ak,"bnpIsEven");function Bk(e,t){if(e>4294967295||e<1)return U.ONE;var r=Se(),n=Se(),i=t.convert(this),s=Lc(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var o=r;r=n,n=o}return t.revert(r)}u(Bk,"bnpExp");function Nk(e,t){var r;return e<256||t.isEven()?r=new ns(t):r=new is(t),this.exp(e,r)}u(Nk,"bnModPowInt");function Rk(){var e=Se();return this.copyTo(e),e}u(Rk,"bnClone");function Dk(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t===0)return-1}else{if(this.t==1)return this[0];if(this.t===0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}u(Dk,"bnIntValue");function Lk(){return this.t==0?this.s:this[0]<<24>>24}u(Lk,"bnByteValue");function Ok(){return this.t==0?this.s:this[0]<<16>>16}u(Ok,"bnShortValue");function Fk(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}u(Fk,"bnpChunkSize");function Pk(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}u(Pk,"bnSigNum");function kk(e){if(e==null&&(e=10),this.signum()===0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=Ei(r),i=Se(),s=Se(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(e)+o}u(kk,"bnpToRadix");function qk(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,a=0;a<e.length;++a){var c=WT(e,a);if(c<0){e.charAt(a)=="-"&&this.signum()===0&&(i=!0);continue}o=t*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&U.ZERO.subTo(this,this)}u(qk,"bnpFromRadix");function Uk(e,t){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e),this.testBit(e-1)||this.bitwiseTo(U.ONE.shiftLeft(e-1),K0,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(U.ONE.shiftLeft(e-1),this);else{var r=j3.randomBytes((e>>3)+1),n=e&7;n>0?r[0]&=(1<<n)-1:r[0]=0,this.fromByteArray(r)}}u(Uk,"bnpFromNumber");function Vk(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),i===0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}u(Vk,"bnToByteArray");function Mk(e){var t=Buffer.from(this.toByteArray());if(e===!0&&t[0]===0)t=t.slice(1);else if(z3.isNumber(e)){if(t.length>e){for(var r=0;r<t.length-e;r++)if(t[r]!==0)return null;return t.slice(t.length-e)}else if(t.length<e){var n=Buffer.alloc(e);return n.fill(0,0,e-t.length),t.copy(n,e-t.length),n}}return t}u(Mk,"bnToBuffer");function Kk(e){return this.compareTo(e)==0}u(Kk,"bnEquals");function Hk(e){return this.compareTo(e)<0?this:e}u(Hk,"bnMin");function $k(e){return this.compareTo(e)>0?this:e}u($k,"bnMax");function Gk(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}u(Gk,"bnpBitwiseTo");function jk(e,t){return e&t}u(jk,"op_and");function zk(e){var t=Se();return this.bitwiseTo(e,jk,t),t}u(zk,"bnAnd");function K0(e,t){return e|t}u(K0,"op_or");function Wk(e){var t=Se();return this.bitwiseTo(e,K0,t),t}u(Wk,"bnOr");function QT(e,t){return e^t}u(QT,"op_xor");function Qk(e){var t=Se();return this.bitwiseTo(e,QT,t),t}u(Qk,"bnXor");function ZT(e,t){return e&~t}u(ZT,"op_andnot");function Zk(e){var t=Se();return this.bitwiseTo(e,ZT,t),t}u(Zk,"bnAndNot");function Yk(){for(var e=Se(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}u(Yk,"bnNot");function Xk(e){var t=Se();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}u(Xk,"bnShiftLeft");function Jk(e){var t=Se();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}u(Jk,"bnShiftRight");function e6(e){if(e===0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}u(e6,"lbit");function t6(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+e6(this[e]);return this.s<0?this.t*this.DB:-1}u(t6,"bnGetLowestSetBit");function r6(e){for(var t=0;e!=0;)e&=e-1,++t;return t}u(r6,"cbit");function n6(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=r6(this[r]^t);return e}u(n6,"bnBitCount");function i6(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this[t]&1<<e%this.DB)!=0}u(i6,"bnTestBit");function s6(e,t){var r=U.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}u(s6,"bnpChangeBit");function o6(e){return this.changeBit(e,K0)}u(o6,"bnSetBit");function a6(e){return this.changeBit(e,ZT)}u(a6,"bnClearBit");function u6(e){return this.changeBit(e,QT)}u(u6,"bnFlipBit");function c6(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()}u(c6,"bnpAddTo");function l6(e){var t=Se();return this.addTo(e,t),t}u(l6,"bnAdd");function f6(e){var t=Se();return this.subTo(e,t),t}u(f6,"bnSubtract");function h6(e){var t=Se();return this.multiplyTo(e,t),t}u(h6,"bnMultiply");function p6(){var e=Se();return this.squareTo(e),e}u(p6,"bnSquare");function d6(e){var t=Se();return this.divRemTo(e,t,null),t}u(d6,"bnDivide");function g6(e){var t=Se();return this.divRemTo(e,null,t),t}u(g6,"bnRemainder");function y6(e){var t=Se(),r=Se();return this.divRemTo(e,t,r),new Array(t,r)}u(y6,"bnDivideAndRemainder");function m6(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}u(m6,"bnpDMultiply");function v6(e,t){if(e!==0){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}u(v6,"bnpDAddOffset");function xa(){}u(xa,"NullExp");function YT(e){return e}u(YT,"nNop");function E6(e,t,r){e.multiplyTo(t,r)}u(E6,"nMulTo");function C6(e,t){e.squareTo(t)}u(C6,"nSqrTo");xa.prototype.convert=YT;xa.prototype.revert=YT;xa.prototype.mulTo=E6;xa.prototype.sqrTo=C6;function S6(e){return this.exp(e,new xa)}u(S6,"bnPow");function x6(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()}u(x6,"bnpMultiplyLowerTo");function T6(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}u(T6,"bnpMultiplyUpperTo");function ao(e){this.r2=Se(),this.q3=Se(),U.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}u(ao,"Barrett");function _6(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=Se();return e.copyTo(t),this.reduce(t),t}u(_6,"barrettConvert");function w6(e){return e}u(w6,"barrettRevert");function b6(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}u(b6,"barrettReduce");function I6(e,t){e.squareTo(t),this.reduce(t)}u(I6,"barrettSqrTo");function A6(e,t,r){e.multiplyTo(t,r),this.reduce(r)}u(A6,"barrettMulTo");ao.prototype.convert=_6;ao.prototype.revert=w6;ao.prototype.reduce=b6;ao.prototype.mulTo=A6;ao.prototype.sqrTo=I6;function B6(e,t){var r=e.bitLength(),n,i=Ei(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new ns(t):t.isEven()?s=new ao(t):s=new is(t);var o=new Array,a=3,c=n-1,l=(1<<n)-1;if(o[1]=s.convert(this),n>1){var f=Se();for(s.sqrTo(o[1],f);a<=l;)o[a]=Se(),s.mulTo(f,o[a-2],o[a]),a+=2}var h=e.t-1,d,g=!0,p=Se(),y;for(r=Lc(e[h])-1;h>=0;){for(r>=c?d=e[h]>>r-c&l:(d=(e[h]&(1<<r+1)-1)<<c-r,h>0&&(d|=e[h-1]>>this.DB+r-c)),a=n;!(d&1);)d>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),g)o[d].copyTo(i),g=!1;else{for(;a>1;)s.sqrTo(i,p),s.sqrTo(p,i),a-=2;a>0?s.sqrTo(i,p):(y=i,i=p,p=y),s.mulTo(p,o[d],i)}for(;h>=0&&!(e[h]&1<<r);)s.sqrTo(i,p),y=i,i=p,p=y,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}u(B6,"bnModPow");function N6(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}u(N6,"bnGCD");function R6(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t===0)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r}u(R6,"bnpModInt");function D6(e){var t=e.isEven();if(this.isEven()&&t||e.signum()===0)return U.ZERO;for(var r=e.clone(),n=this.clone(),i=Ei(1),s=Ei(0),o=Ei(0),a=Ei(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),t&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(U.ONE)!=0)return U.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}u(D6,"bnModInverse");var dr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],L6=(1<<26)/dr[dr.length-1];function O6(e){var t,r=this.abs();if(r.t==1&&r[0]<=dr[dr.length-1]){for(t=0;t<dr.length;++t)if(r[0]==dr[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<dr.length;){for(var n=dr[t],i=t+1;i<dr.length&&n<L6;)n*=dr[i++];for(n=r.modInt(n);t<i;)if(n%dr[t++]===0)return!1}return r.millerRabin(e)}u(O6,"bnIsProbablePrime");function F6(e){var t=this.subtract(U.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);e=e+1>>1,e>dr.length&&(e=dr.length);for(var i=Se(),s=0;s<e;++s){i.fromInt(dr[Math.floor(Math.random()*dr.length)]);var o=i.modPow(n,this);if(o.compareTo(U.ONE)!=0&&o.compareTo(t)!=0){for(var a=1;a++<r&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(U.ONE)===0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}u(F6,"bnpMillerRabin");U.prototype.copyTo=Y3;U.prototype.fromInt=X3;U.prototype.fromString=J3;U.prototype.fromByteArray=ek;U.prototype.fromBuffer=tk;U.prototype.clamp=rk;U.prototype.dlShiftTo=uk;U.prototype.drShiftTo=ck;U.prototype.lShiftTo=lk;U.prototype.rShiftTo=fk;U.prototype.subTo=hk;U.prototype.multiplyTo=pk;U.prototype.squareTo=dk;U.prototype.divRemTo=gk;U.prototype.invDigit=xk;U.prototype.isEven=Ak;U.prototype.exp=Bk;U.prototype.chunkSize=Fk;U.prototype.toRadix=kk;U.prototype.fromRadix=qk;U.prototype.fromNumber=Uk;U.prototype.bitwiseTo=Gk;U.prototype.changeBit=s6;U.prototype.addTo=c6;U.prototype.dMultiply=m6;U.prototype.dAddOffset=v6;U.prototype.multiplyLowerTo=x6;U.prototype.multiplyUpperTo=T6;U.prototype.modInt=R6;U.prototype.millerRabin=F6;U.prototype.toString=nk;U.prototype.negate=ik;U.prototype.abs=sk;U.prototype.compareTo=ok;U.prototype.bitLength=ak;U.prototype.mod=yk;U.prototype.modPowInt=Nk;U.prototype.clone=Rk;U.prototype.intValue=Dk;U.prototype.byteValue=Lk;U.prototype.shortValue=Ok;U.prototype.signum=Pk;U.prototype.toByteArray=Vk;U.prototype.toBuffer=Mk;U.prototype.equals=Kk;U.prototype.min=Hk;U.prototype.max=$k;U.prototype.and=zk;U.prototype.or=Wk;U.prototype.xor=Qk;U.prototype.andNot=Zk;U.prototype.not=Yk;U.prototype.shiftLeft=Xk;U.prototype.shiftRight=Jk;U.prototype.getLowestSetBit=t6;U.prototype.bitCount=n6;U.prototype.testBit=i6;U.prototype.setBit=o6;U.prototype.clearBit=a6;U.prototype.flipBit=u6;U.prototype.add=l6;U.prototype.subtract=f6;U.prototype.multiply=h6;U.prototype.divide=d6;U.prototype.remainder=g6;U.prototype.divideAndRemainder=y6;U.prototype.modPow=B6;U.prototype.modInverse=D6;U.prototype.pow=S6;U.prototype.gcd=N6;U.prototype.isProbablePrime=O6;U.int2char=V0;U.ZERO=Ei(0);U.ONE=Ei(1);U.prototype.square=p6;XT.exports=U});var r_=_((XK,H0)=>{var JT=ss(),uo=require("crypto"),Oc=require("constants"),P6={md2:Buffer.from("3020300c06082a864886f70d020205000410","hex"),md5:Buffer.from("3020300c06082a864886f70d020505000410","hex"),sha1:Buffer.from("3021300906052b0e03021a05000414","hex"),sha224:Buffer.from("302d300d06096086480165030402040500041c","hex"),sha256:Buffer.from("3031300d060960864801650304020105000420","hex"),sha384:Buffer.from("3041300d060960864801650304020205000430","hex"),sha512:Buffer.from("3051300d060960864801650304020305000440","hex"),ripemd160:Buffer.from("3021300906052b2403020105000414","hex"),rmd160:Buffer.from("3021300906052b2403020105000414","hex")},e_={ripemd160:"rmd160"},t_="sha256";H0.exports={isEncryption:!0,isSignature:!0};H0.exports.makeScheme=function(e,t){function r(n,i){this.key=n,this.options=i}return u(r,"Scheme"),r.prototype.maxMessageLength=function(){return this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==Oc.RSA_NO_PADDING?this.key.encryptedDataLength:this.key.encryptedDataLength-11},r.prototype.encPad=function(n,i){i=i||{};var s;if(n.length>this.key.maxMessageLength)throw new Error("Message too long for RSA (n="+this.key.encryptedDataLength+", l="+n.length+")");if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==Oc.RSA_NO_PADDING)return s=Buffer.alloc(this.key.maxMessageLength-n.length),s.fill(0),Buffer.concat([s,n]);if(i.type===1)return s=Buffer.alloc(this.key.encryptedDataLength-n.length-1),s.fill(255,0,s.length-1),s[0]=1,s[s.length-1]=0,Buffer.concat([s,n]);s=Buffer.alloc(this.key.encryptedDataLength-n.length),s[0]=0,s[1]=2;for(var o=uo.randomBytes(s.length-3),a=0;a<o.length;a++){for(var c=o[a];c===0;)c=uo.randomBytes(1)[0];s[a+2]=c}return s[s.length-1]=0,Buffer.concat([s,n])},r.prototype.encUnPad=function(n,i){i=i||{};var s=0;if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==Oc.RSA_NO_PADDING){var o;return typeof n.lastIndexOf=="function"?o=n.slice(n.lastIndexOf("\0")+1,n.length):o=n.slice(String.prototype.lastIndexOf.call(n,"\0")+1,n.length),o}if(n.length<4)return null;if(i.type===1){if(n[0]!==0||n[1]!==1)return null;for(s=3;n[s]!==0;)if(n[s]!=255||++s>=n.length)return null}else{if(n[0]!==0||n[1]!==2)return null;for(s=3;n[s]!==0;)if(++s>=n.length)return null}return n.slice(s+1,n.length)},r.prototype.sign=function(n){var i=this.options.signingSchemeOptions.hash||t_;if(this.options.environment==="browser"){i=e_[i]||i;var s=uo.createHash(i);s.update(n);var o=this.pkcs1pad(s.digest(),i),a=this.key.$doPrivate(new JT(o)).toBuffer(this.key.encryptedDataLength);return a}else{var c=uo.createSign("RSA-"+i.toUpperCase());return c.update(n),c.sign(this.options.rsaUtils.exportKey("private"))}},r.prototype.verify=function(n,i,s){if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==Oc.RSA_NO_PADDING)return!1;var o=this.options.signingSchemeOptions.hash||t_;if(this.options.environment==="browser"){o=e_[o]||o,s&&(i=Buffer.from(i,s));var a=uo.createHash(o);a.update(n);var c=this.pkcs1pad(a.digest(),o),l=this.key.$doPublic(new JT(i));return l.toBuffer().toString("hex")==c.toString("hex")}else{var f=uo.createVerify("RSA-"+o.toUpperCase());return f.update(n),f.verify(this.options.rsaUtils.exportKey("public"),i,s)}},r.prototype.pkcs0pad=function(n){var i=Buffer.alloc(this.key.maxMessageLength-n.length);return i.fill(0),Buffer.concat([i,n])},r.prototype.pkcs0unpad=function(n){var i;return typeof n.lastIndexOf=="function"?i=n.slice(n.lastIndexOf("\0")+1,n.length):i=n.slice(String.prototype.lastIndexOf.call(n,"\0")+1,n.length),i},r.prototype.pkcs1pad=function(n,i){var s=P6[i];if(!s)throw Error("Unsupported hash algorithm");var o=Buffer.concat([s,n]);if(o.length+10>this.key.encryptedDataLength)throw Error("Key is too short for signing algorithm ("+i+")");var a=Buffer.alloc(this.key.encryptedDataLength-o.length-1);a.fill(255,0,a.length-1),a[0]=1,a[a.length-1]=0;var c=Buffer.concat([a,o]);return c},new r(e,t)}});var n_=_((t7,cn)=>{var e7=ss(),Fc=require("crypto");cn.exports={isEncryption:!0,isSignature:!1};cn.exports.digestLength={md4:16,md5:16,ripemd160:20,rmd160:20,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64};var Pc="sha1";cn.exports.eme_oaep_mgf1=function(e,t,r){r=r||Pc;for(var n=cn.exports.digestLength[r],i=Math.ceil(t/n),s=Buffer.alloc(n*i),o=Buffer.alloc(4),a=0;a<i;++a){var c=Fc.createHash(r);c.update(e),o.writeUInt32BE(a,0),c.update(o),c.digest().copy(s,a*n)}return s.slice(0,t)};cn.exports.makeScheme=function(e,t){function r(n,i){this.key=n,this.options=i}return u(r,"Scheme"),r.prototype.maxMessageLength=function(){return this.key.encryptedDataLength-2*cn.exports.digestLength[this.options.encryptionSchemeOptions.hash||Pc]-2},r.prototype.encPad=function(n){var i=this.options.encryptionSchemeOptions.hash||Pc,s=this.options.encryptionSchemeOptions.mgf||cn.exports.eme_oaep_mgf1,o=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),a=this.key.encryptedDataLength,c=cn.exports.digestLength[i];if(n.length>a-2*c-2)throw new Error("Message is too long to encode into an encoded message with a length of "+a+" bytes, increaseemLen to fix this error (minimum value for given parameters and options: "+(a-2*c-2)+")");var l=Fc.createHash(i);l.update(o),l=l.digest();var f=Buffer.alloc(a-n.length-2*c-1);f.fill(0),f[f.length-1]=1;for(var h=Buffer.concat([l,f,n]),d=Fc.randomBytes(c),g=s(d,h.length,i),p=0;p<h.length;p++)h[p]^=g[p];for(g=s(h,c,i),p=0;p<d.length;p++)d[p]^=g[p];var y=Buffer.alloc(1+d.length+h.length);return y[0]=0,d.copy(y,1),h.copy(y,1+d.length),y},r.prototype.encUnPad=function(n){var i=this.options.encryptionSchemeOptions.hash||Pc,s=this.options.encryptionSchemeOptions.mgf||cn.exports.eme_oaep_mgf1,o=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),a=cn.exports.digestLength[i];if(n.length<2*a+2)throw new Error("Error decoding message, the supplied message is not long enough to be a valid OAEP encoded message");for(var c=n.slice(1,a+1),l=n.slice(1+a),f=s(l,a,i),h=0;h<c.length;h++)c[h]^=f[h];for(f=s(c,l.length,i),h=0;h<l.length;h++)l[h]^=f[h];var d=Fc.createHash(i);d.update(o),d=d.digest();var g=l.slice(0,a);if(g.toString("hex")!=d.toString("hex"))throw new Error("Error decoding message, the lHash calculated from the label provided and the lHash in the encrypted data do not match.");for(h=a;l[h++]===0&&h<l.length;);if(l[h-1]!=1)throw new Error("Error decoding message, there is no padding message separator byte");return l.slice(h)},new r(e,t)}});var o_=_((n7,$0)=>{var i_=ss(),Ta=require("crypto");$0.exports={isEncryption:!1,isSignature:!0};var kc="sha1",s_=20;$0.exports.makeScheme=function(e,t){var r=os().pkcs1_oaep;function n(i,s){this.key=i,this.options=s}return u(n,"Scheme"),n.prototype.sign=function(i){var s=Ta.createHash(this.options.signingSchemeOptions.hash||kc);s.update(i);var o=this.emsa_pss_encode(s.digest(),this.key.keySize-1);return this.key.$doPrivate(new i_(o)).toBuffer(this.key.encryptedDataLength)},n.prototype.verify=function(i,s,o){o&&(s=Buffer.from(s,o)),s=new i_(s);var a=Math.ceil((this.key.keySize-1)/8),c=this.key.$doPublic(s).toBuffer(a),l=Ta.createHash(this.options.signingSchemeOptions.hash||kc);return l.update(i),this.emsa_pss_verify(l.digest(),c,this.key.keySize-1)},n.prototype.emsa_pss_encode=function(i,s){var o=this.options.signingSchemeOptions.hash||kc,a=this.options.signingSchemeOptions.mgf||r.eme_oaep_mgf1,c=this.options.signingSchemeOptions.saltLength||s_,l=r.digestLength[o],f=Math.ceil(s/8);if(f<l+c+2)throw new Error("Output length passed to emBits("+s+") is too small for the options specified("+o+", "+c+"). To fix this issue increase the value of emBits. (minimum size: "+(8*l+8*c+9)+")");var h=Ta.randomBytes(c),d=Buffer.alloc(8+l+c);d.fill(0,0,8),i.copy(d,8),h.copy(d,8+i.length);var g=Ta.createHash(o);g.update(d),g=g.digest();var p=Buffer.alloc(f-h.length-l-2);p.fill(0);var y=Buffer.alloc(p.length+1+h.length);p.copy(y),y[p.length]=1,h.copy(y,p.length+1);for(var v=a(g,y.length,o),m=Buffer.alloc(y.length),x=0;x<v.length;x++)m[x]=y[x]^v[x];var w=8*f-s,B=255^255>>8-w<<8-w;m[0]=m[0]&B;var R=Buffer.alloc(m.length+g.length+1);return m.copy(R,0),g.copy(R,m.length),R[R.length-1]=188,R},n.prototype.emsa_pss_verify=function(i,s,o){var a=this.options.signingSchemeOptions.hash||kc,c=this.options.signingSchemeOptions.mgf||r.eme_oaep_mgf1,l=this.options.signingSchemeOptions.saltLength||s_,f=r.digestLength[a],h=Math.ceil(o/8);if(h<f+l+2||s[s.length-1]!=188)return!1;var d=Buffer.alloc(h-f-1);s.copy(d,0,0,h-f-1);for(var g=0,p=0,y=8*h-o;p<y;p++)g|=1<<7-p;if(d[0]&g)return!1;var v=s.slice(h-f-1,h-1),m=c(v,d.length,a);for(p=0;p<d.length;p++)d[p]^=m[p];for(y=8*h-o,g=255^255>>8-y<<8-y,d[0]=d[0]&g,p=0;d[p]===0&&p<d.length;p++);if(d[p]!=1)return!1;var x=d.slice(d.length-l),w=Buffer.alloc(8+f+l);w.fill(0,0,8),i.copy(w,8),x.copy(w,8+i.length);var B=Ta.createHash(a);return B.update(w),B=B.digest(),v.toString("hex")===B.toString("hex")},new n(e,t)}});var os=_((s7,co)=>{co.exports={pkcs1:r_(),pkcs1_oaep:n_(),pss:o_(),isEncryption:function(e){return co.exports[e]&&co.exports[e].isEncryption},isSignature:function(e){return co.exports[e]&&co.exports[e].isSignature}}});var j0=_((o7,a_)=>{var G0=ss(),k6=os();a_.exports=function(e,t){var r=k6.pkcs1.makeScheme(e,t);return{encrypt:function(n,i){var s,o;return i?(s=new G0(r.encPad(n,{type:1})),o=e.$doPrivate(s)):(s=new G0(e.encryptionScheme.encPad(n)),o=e.$doPublic(s)),o.toBuffer(e.encryptedDataLength)},decrypt:function(n,i){var s,o=new G0(n);return i?(s=e.$doPublic(o),r.encUnPad(s.toBuffer(e.encryptedDataLength),{type:1})):(s=e.$doPrivate(o),e.encryptionScheme.encUnPad(s.toBuffer(e.encryptedDataLength)))}}}});var c_=_((a7,u_)=>{var qc=require("crypto"),Ci=require("constants"),q6=os();u_.exports=function(e,t){var r=q6.pkcs1.makeScheme(e,t);return{encrypt:function(n,i){var s;if(i)return s=Ci.RSA_PKCS1_PADDING,t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(s=t.encryptionSchemeOptions.padding),qc.privateEncrypt({key:t.rsaUtils.exportKey("private"),padding:s},n);s=Ci.RSA_PKCS1_OAEP_PADDING,t.encryptionScheme==="pkcs1"&&(s=Ci.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(s=t.encryptionSchemeOptions.padding);var o=n;return s===Ci.RSA_NO_PADDING&&(o=r.pkcs0pad(n)),qc.publicEncrypt({key:t.rsaUtils.exportKey("public"),padding:s},o)},decrypt:function(n,i){var s;if(i)return s=Ci.RSA_PKCS1_PADDING,t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(s=t.encryptionSchemeOptions.padding),qc.publicDecrypt({key:t.rsaUtils.exportKey("public"),padding:s},n);s=Ci.RSA_PKCS1_OAEP_PADDING,t.encryptionScheme==="pkcs1"&&(s=Ci.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(s=t.encryptionSchemeOptions.padding);var o=qc.privateDecrypt({key:t.rsaUtils.exportKey("private"),padding:s},n);return s===Ci.RSA_NO_PADDING?r.pkcs0unpad(o):o}}}});var h_=_((u7,f_)=>{var l_=require("crypto"),lo=require("constants"),U6=os();f_.exports=function(e,t){var r=j0()(e,t),n=U6.pkcs1.makeScheme(e,t);return{encrypt:function(i,s){if(s)return r.encrypt(i,s);var o=lo.RSA_PKCS1_OAEP_PADDING;t.encryptionScheme==="pkcs1"&&(o=lo.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(o=t.encryptionSchemeOptions.padding);var a=i;return o===lo.RSA_NO_PADDING&&(a=n.pkcs0pad(i)),l_.publicEncrypt({key:t.rsaUtils.exportKey("public"),padding:o},a)},decrypt:function(i,s){if(s)return r.decrypt(i,s);var o=lo.RSA_PKCS1_OAEP_PADDING;t.encryptionScheme==="pkcs1"&&(o=lo.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(o=t.encryptionSchemeOptions.padding);var a=l_.privateDecrypt({key:t.rsaUtils.exportKey("private"),padding:o},i);return o===lo.RSA_NO_PADDING?n.pkcs0unpad(a):a}}}});var d_=_((c7,p_)=>{var Uc=require("crypto");p_.exports={getEngine:function(e,t){var r=j0();return t.environment==="node"&&typeof Uc.publicEncrypt=="function"&&typeof Uc.privateDecrypt=="function"&&(typeof Uc.privateEncrypt=="function"&&typeof Uc.publicDecrypt=="function"?r=c_():r=h_()),r(e,t)}}});var E_=_((m_,v_)=>{var Vc=pr()._,l7=require("crypto"),Ct=ss(),g_=pr(),y_=os(),V6=d_();m_.BigInteger=Ct;v_.exports.Key=function(){function e(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return u(e,"RSAKey"),e.prototype.setOptions=function(t){var r=y_[t.signingScheme],n=y_[t.encryptionScheme];r===n?this.signingScheme=this.encryptionScheme=n.makeScheme(this,t):(this.encryptionScheme=n.makeScheme(this,t),this.signingScheme=r.makeScheme(this,t)),this.encryptEngine=V6.getEngine(this,t)},e.prototype.generate=function(t,r){var n=t>>1;this.e=parseInt(r,16);for(var i=new Ct(r,16);;){for(;this.p=new Ct(t-n,1),!(this.p.subtract(Ct.ONE).gcd(i).compareTo(Ct.ONE)===0&&this.p.isProbablePrime(10)););for(;this.q=new Ct(n,1),!(this.q.subtract(Ct.ONE).gcd(i).compareTo(Ct.ONE)===0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var o=this.p.subtract(Ct.ONE),a=this.q.subtract(Ct.ONE),c=o.multiply(a);if(c.gcd(i).compareTo(Ct.ONE)===0){if(this.n=this.p.multiply(this.q),this.n.bitLength()<t)continue;this.d=i.modInverse(c),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}this.$$recalculateCache()},e.prototype.setPrivate=function(t,r,n,i,s,o,a,c){if(t&&r&&n&&t.length>0&&(Vc.isNumber(r)||r.length>0)&&n.length>0)this.n=new Ct(t),this.e=Vc.isNumber(r)?r:g_.get32IntFromBuffer(r,0),this.d=new Ct(n),i&&s&&o&&a&&c&&(this.p=new Ct(i),this.q=new Ct(s),this.dmp1=new Ct(o),this.dmq1=new Ct(a),this.coeff=new Ct(c)),this.$$recalculateCache();else throw Error("Invalid RSA private key")},e.prototype.setPublic=function(t,r){if(t&&r&&t.length>0&&(Vc.isNumber(r)||r.length>0))this.n=new Ct(t),this.e=Vc.isNumber(r)?r:g_.get32IntFromBuffer(r,0),this.$$recalculateCache();else throw Error("Invalid RSA public key")},e.prototype.$doPrivate=function(t){if(this.p||this.q)return t.modPow(this.d,this.n);for(var r=t.mod(this.p).modPow(this.dmp1,this.p),n=t.mod(this.q).modPow(this.dmq1,this.q);r.compareTo(n)<0;)r=r.add(this.p);return r.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},e.prototype.$doPublic=function(t){return t.modPowInt(this.e,this.n)},e.prototype.encrypt=function(t,r){var n=[],i=[],s=t.length,o=Math.ceil(s/this.maxMessageLength)||1,a=Math.ceil(s/o||1);if(o==1)n.push(t);else for(var c=0;c<o;c++)n.push(t.slice(c*a,(c+1)*a));for(var l=0;l<n.length;l++)i.push(this.encryptEngine.encrypt(n[l],r));return Buffer.concat(i)},e.prototype.decrypt=function(t,r){if(t.length%this.encryptedDataLength>0)throw Error("Incorrect data or key");for(var n=[],i=0,s=0,o=t.length/this.encryptedDataLength,a=0;a<o;a++)i=a*this.encryptedDataLength,s=i+this.encryptedDataLength,n.push(this.encryptEngine.decrypt(t.slice(i,Math.min(s,t.length)),r));return Buffer.concat(n)},e.prototype.sign=function(t){return this.signingScheme.sign.apply(this.signingScheme,arguments)},e.prototype.verify=function(t,r,n){return this.signingScheme.verify.apply(this.signingScheme,arguments)},e.prototype.isPrivate=function(){return this.n&&this.e&&this.d&&!0||!1},e.prototype.isPublic=function(t){return this.n&&this.e&&!(t&&this.d)||!1},Object.defineProperty(e.prototype,"keySize",{get:function(){return this.cache.keyBitLength}}),Object.defineProperty(e.prototype,"encryptedDataLength",{get:function(){return this.cache.keyByteLength}}),Object.defineProperty(e.prototype,"maxMessageLength",{get:function(){return this.encryptionScheme.maxMessageLength()}}),e.prototype.$$recalculateCache=function(){this.cache=this.cache||{},this.cache.keyBitLength=this.n.bitLength(),this.cache.keyByteLength=this.cache.keyBitLength+6>>3},e}()});var Mc=_((h7,C_)=>{C_.exports={newInvalidAsn1Error:function(e){var t=new Error;return t.name="InvalidAsn1Error",t.message=e||"",t}}});var Kc=_((p7,S_)=>{S_.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}});var z0=_((d7,x_)=>{"use strict";var Hc=require("buffer"),fo=Hc.Buffer,jr={},zr;for(zr in Hc)Hc.hasOwnProperty(zr)&&(zr==="SlowBuffer"||zr==="Buffer"||(jr[zr]=Hc[zr]));var ho=jr.Buffer={};for(zr in fo)fo.hasOwnProperty(zr)&&(zr==="allocUnsafe"||zr==="allocUnsafeSlow"||(ho[zr]=fo[zr]));jr.Buffer.prototype=fo.prototype;(!ho.from||ho.from===Uint8Array.from)&&(ho.from=function(e,t,r){if(typeof e=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&typeof e.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return fo(e,t,r)});ho.alloc||(ho.alloc=function(e,t,r){if(typeof e!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var n=fo(e);return!t||t.length===0?n.fill(0):typeof r=="string"?n.fill(t,r):n.fill(t),n});if(!jr.kStringMaxLength)try{jr.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch{}jr.constants||(jr.constants={MAX_LENGTH:jr.kMaxLength},jr.kStringMaxLength&&(jr.constants.MAX_STRING_LENGTH=jr.kStringMaxLength));x_.exports=jr});var w_=_((g7,__)=>{var M6=require("assert"),T_=z0().Buffer,_a=Kc(),K6=Mc(),po=K6.newInvalidAsn1Error;function gr(e){if(!e||!T_.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e,this._size=e.length,this._len=0,this._offset=0}u(gr,"Reader");Object.defineProperty(gr.prototype,"length",{enumerable:!0,get:function(){return this._len}});Object.defineProperty(gr.prototype,"offset",{enumerable:!0,get:function(){return this._offset}});Object.defineProperty(gr.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(gr.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});gr.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=this._buf[this._offset]&255;return e||(this._offset+=1),t};gr.prototype.peek=function(){return this.readByte(!0)};gr.prototype.readLength=function(e){if(e===void 0&&(e=this._offset),e>=this._size)return null;var t=this._buf[e++]&255;if(t===null)return null;if((t&128)===128){if(t&=127,t===0)throw po("Indefinite length not supported");if(t>4)throw po("encoding too long");if(this._size-e<t)return null;this._len=0;for(var r=0;r<t;r++)this._len=(this._len<<8)+(this._buf[e++]&255)}else this._len=t;return e};gr.prototype.readSequence=function(e){var t=this.peek();if(t===null)return null;if(e!==void 0&&e!==t)throw po("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);return r===null?null:(this._offset=r,t)};gr.prototype.readInt=function(){return this._readTag(_a.Integer)};gr.prototype.readBoolean=function(){return this._readTag(_a.Boolean)!==0};gr.prototype.readEnumeration=function(){return this._readTag(_a.Enumeration)};gr.prototype.readString=function(e,t){e||(e=_a.OctetString);var r=this.peek();if(r===null)return null;if(r!==e)throw po("Expected 0x"+e.toString(16)+": got 0x"+r.toString(16));var n=this.readLength(this._offset+1);if(n===null||this.length>this._size-n)return null;if(this._offset=n,this.length===0)return t?T_.alloc(0):"";var i=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?i:i.toString("utf8")};gr.prototype.readOID=function(e){e||(e=_a.OID);var t=this.readString(e,!0);if(t===null)return null;for(var r=[],n=0,i=0;i<t.length;i++){var s=t[i]&255;n<<=7,n+=s&127,s&128||(r.push(n),n=0)}return n=r.shift(),r.unshift(n%40),r.unshift(n/40>>0),r.join(".")};gr.prototype._readTag=function(e){M6.ok(e!==void 0);var t=this.peek();if(t===null)return null;if(t!==e)throw po("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);if(r===null)return null;if(this.length>4)throw po("Integer too long: "+this.length);if(this.length>this._size-r)return null;this._offset=r;for(var n=this._buf[this._offset],i=0,s=0;s<this.length;s++)i<<=8,i|=this._buf[this._offset++]&255;return(n&128)===128&&s!==4&&(i-=1<<s*8),i>>0};__.exports=gr});var I_=_((m7,b_)=>{var Si=require("assert"),$c=z0().Buffer,xi=Kc(),H6=Mc(),Gc=H6.newInvalidAsn1Error,$6={size:1024,growthFactor:8};function G6(e,t){Si.ok(e),Si.equal(typeof e,"object"),Si.ok(t),Si.equal(typeof t,"object");var r=Object.getOwnPropertyNames(e);return r.forEach(function(n){if(!t[n]){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i)}}),t}u(G6,"merge");function ir(e){e=G6($6,e||{}),this._buf=$c.alloc(e.size||1024),this._size=this._buf.length,this._offset=0,this._options=e,this._seq=[]}u(ir,"Writer");Object.defineProperty(ir.prototype,"buffer",{get:function(){if(this._seq.length)throw Gc(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});ir.prototype.writeByte=function(e){if(typeof e!="number")throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=e};ir.prototype.writeInt=function(e,t){if(typeof e!="number")throw new TypeError("argument must be a Number");typeof t!="number"&&(t=xi.Integer);for(var r=4;(!(e&4286578688)||(e&4286578688)===-8388608)&&r>1;)r--,e<<=8;if(r>4)throw Gc("BER ints cannot be > 0xffffffff");for(this._ensure(2+r),this._buf[this._offset++]=t,this._buf[this._offset++]=r;r-- >0;)this._buf[this._offset++]=(e&4278190080)>>>24,e<<=8};ir.prototype.writeNull=function(){this.writeByte(xi.Null),this.writeByte(0)};ir.prototype.writeEnumeration=function(e,t){if(typeof e!="number")throw new TypeError("argument must be a Number");return typeof t!="number"&&(t=xi.Enumeration),this.writeInt(e,t)};ir.prototype.writeBoolean=function(e,t){if(typeof e!="boolean")throw new TypeError("argument must be a Boolean");typeof t!="number"&&(t=xi.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=e?255:0};ir.prototype.writeString=function(e,t){if(typeof e!="string")throw new TypeError("argument must be a string (was: "+typeof e+")");typeof t!="number"&&(t=xi.OctetString);var r=$c.byteLength(e);this.writeByte(t),this.writeLength(r),r&&(this._ensure(r),this._buf.write(e,this._offset),this._offset+=r)};ir.prototype.writeBuffer=function(e,t){if(typeof t!="number")throw new TypeError("tag must be a number");if(!$c.isBuffer(e))throw new TypeError("argument must be a buffer");this.writeByte(t),this.writeLength(e.length),this._ensure(e.length),e.copy(this._buf,this._offset,0,e.length),this._offset+=e.length};ir.prototype.writeStringArray=function(e){if(!e instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;e.forEach(function(r){t.writeString(r)})};ir.prototype.writeOID=function(e,t){if(typeof e!="string")throw new TypeError("argument must be a string");if(typeof t!="number"&&(t=xi.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");function r(o,a){a<128?o.push(a):a<16384?(o.push(a>>>7|128),o.push(a&127)):a<2097152?(o.push(a>>>14|128),o.push((a>>>7|128)&255),o.push(a&127)):a<268435456?(o.push(a>>>21|128),o.push((a>>>14|128)&255),o.push((a>>>7|128)&255),o.push(a&127)):(o.push((a>>>28|128)&255),o.push((a>>>21|128)&255),o.push((a>>>14|128)&255),o.push((a>>>7|128)&255),o.push(a&127))}u(r,"encodeOctet");var n=e.split("."),i=[];i.push(parseInt(n[0],10)*40+parseInt(n[1],10)),n.slice(2).forEach(function(o){r(i,parseInt(o,10))});var s=this;this._ensure(2+i.length),this.writeByte(t),this.writeLength(i.length),i.forEach(function(o){s.writeByte(o)})};ir.prototype.writeLength=function(e){if(typeof e!="number")throw new TypeError("argument must be a Number");if(this._ensure(4),e<=127)this._buf[this._offset++]=e;else if(e<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=e;else if(e<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e;else if(e<=16777215)this._buf[this._offset++]=131,this._buf[this._offset++]=e>>16,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e;else throw Gc("Length too long (> 4 bytes)")};ir.prototype.startSequence=function(e){typeof e!="number"&&(e=xi.Sequence|xi.Constructor),this.writeByte(e),this._seq.push(this._offset),this._ensure(3),this._offset+=3};ir.prototype.endSequence=function(){var e=this._seq.pop(),t=e+3,r=this._offset-t;if(r<=127)this._shift(t,r,-2),this._buf[e]=r;else if(r<=255)this._shift(t,r,-1),this._buf[e]=129,this._buf[e+1]=r;else if(r<=65535)this._buf[e]=130,this._buf[e+1]=r>>8,this._buf[e+2]=r;else if(r<=16777215)this._shift(t,r,1),this._buf[e]=131,this._buf[e+1]=r>>16,this._buf[e+2]=r>>8,this._buf[e+3]=r;else throw Gc("Sequence too long")};ir.prototype._shift=function(e,t,r){Si.ok(e!==void 0),Si.ok(t!==void 0),Si.ok(r),this._buf.copy(this._buf,e+r,e,e+t),this._offset+=r};ir.prototype._ensure=function(e){if(Si.ok(e),this._size-this._offset<e){var t=this._size*this._options.growthFactor;t-this._offset<e&&(t+=e);var r=$c.alloc(t);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=t}};b_.exports=ir});var A_=_((E7,Wc)=>{var W0=Mc(),Q0=Kc(),j6=w_(),z6=I_();Wc.exports={Reader:j6,Writer:z6};for(jc in Q0)Q0.hasOwnProperty(jc)&&(Wc.exports[jc]=Q0[jc]);var jc;for(zc in W0)W0.hasOwnProperty(zc)&&(Wc.exports[zc]=W0[zc]);var zc});var Qc=_((C7,B_)=>{var Z0=A_();B_.exports={Ber:Z0,BerReader:Z0.Reader,BerWriter:Z0.Writer}});var F_=_((S7,Xc)=>{var Zc=Qc().Ber,N_=pr()._,Yc=pr(),R_="-----BEGIN RSA PRIVATE KEY-----",D_="-----END RSA PRIVATE KEY-----",L_="-----BEGIN RSA PUBLIC KEY-----",O_="-----END RSA PUBLIC KEY-----";Xc.exports={privateExport:function(e,t){t=t||{};var r=e.n.toBuffer(),n=e.d.toBuffer(),i=e.p.toBuffer(),s=e.q.toBuffer(),o=e.dmp1.toBuffer(),a=e.dmq1.toBuffer(),c=e.coeff.toBuffer(),l=r.length+n.length+i.length+s.length+o.length+a.length+c.length+512,f=new Zc.Writer({size:l});return f.startSequence(),f.writeInt(0),f.writeBuffer(r,2),f.writeInt(e.e),f.writeBuffer(n,2),f.writeBuffer(i,2),f.writeBuffer(s,2),f.writeBuffer(o,2),f.writeBuffer(a,2),f.writeBuffer(c,2),f.endSequence(),t.type==="der"?f.buffer:R_+`
`+Yc.linebrk(f.buffer.toString("base64"),64)+`
`+D_},privateImport:function(e,t,r){r=r||{};var n;if(r.type!=="der")if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),N_.isString(t)){var i=Yc.trimSurroundingText(t,R_,D_).replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(i,"base64")}else throw Error("Unsupported key format");else if(Buffer.isBuffer(t))n=t;else throw Error("Unsupported key format");var s=new Zc.Reader(n);s.readSequence(),s.readString(2,!0),e.setPrivate(s.readString(2,!0),s.readString(2,!0),s.readString(2,!0),s.readString(2,!0),s.readString(2,!0),s.readString(2,!0),s.readString(2,!0),s.readString(2,!0))},publicExport:function(e,t){t=t||{};var r=e.n.toBuffer(),n=r.length+512,i=new Zc.Writer({size:n});return i.startSequence(),i.writeBuffer(r,2),i.writeInt(e.e),i.endSequence(),t.type==="der"?i.buffer:L_+`
`+Yc.linebrk(i.buffer.toString("base64"),64)+`
`+O_},publicImport:function(e,t,r){r=r||{};var n;if(r.type!=="der"){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),N_.isString(t)){var i=Yc.trimSurroundingText(t,L_,O_).replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(i,"base64")}}else if(Buffer.isBuffer(t))n=t;else throw Error("Unsupported key format");var s=new Zc.Reader(n);s.readSequence(),e.setPublic(s.readString(2,!0),s.readString(2,!0))},autoImport:function(e,t){return/^[\S\s]*-----BEGIN RSA PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PRIVATE KEY-----[\S\s]*$/g.test(t)?(Xc.exports.privateImport(e,t),!0):/^[\S\s]*-----BEGIN RSA PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PUBLIC KEY-----[\S\s]*$/g.test(t)?(Xc.exports.publicImport(e,t),!0):!1}}});var M_=_((x7,tl)=>{var An=Qc().Ber,P_=pr()._,Jc="1.2.840.113549.1.1.1",el=pr(),k_="-----BEGIN PRIVATE KEY-----",q_="-----END PRIVATE KEY-----",U_="-----BEGIN PUBLIC KEY-----",V_="-----END PUBLIC KEY-----";tl.exports={privateExport:function(e,t){t=t||{};var r=e.n.toBuffer(),n=e.d.toBuffer(),i=e.p.toBuffer(),s=e.q.toBuffer(),o=e.dmp1.toBuffer(),a=e.dmq1.toBuffer(),c=e.coeff.toBuffer(),l=r.length+n.length+i.length+s.length+o.length+a.length+c.length+512,f=new An.Writer({size:l});f.startSequence(),f.writeInt(0),f.writeBuffer(r,2),f.writeInt(e.e),f.writeBuffer(n,2),f.writeBuffer(i,2),f.writeBuffer(s,2),f.writeBuffer(o,2),f.writeBuffer(a,2),f.writeBuffer(c,2),f.endSequence();var h=new An.Writer({size:l});return h.startSequence(),h.writeInt(0),h.startSequence(),h.writeOID(Jc),h.writeNull(),h.endSequence(),h.writeBuffer(f.buffer,4),h.endSequence(),t.type==="der"?h.buffer:k_+`
`+el.linebrk(h.buffer.toString("base64"),64)+`
`+q_},privateImport:function(e,t,r){r=r||{};var n;if(r.type!=="der")if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),P_.isString(t)){var i=el.trimSurroundingText(t,k_,q_).replace("-----END PRIVATE KEY-----","").replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(i,"base64")}else throw Error("Unsupported key format");else if(Buffer.isBuffer(t))n=t;else throw Error("Unsupported key format");var s=new An.Reader(n);s.readSequence(),s.readInt(0);var o=new An.Reader(s.readString(48,!0));if(o.readOID(6,!0)!==Jc)throw Error("Invalid Public key format");var a=new An.Reader(s.readString(4,!0));a.readSequence(),a.readString(2,!0),e.setPrivate(a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0))},publicExport:function(e,t){t=t||{};var r=e.n.toBuffer(),n=r.length+512,i=new An.Writer({size:n});i.writeByte(0),i.startSequence(),i.writeBuffer(r,2),i.writeInt(e.e),i.endSequence();var s=new An.Writer({size:n});return s.startSequence(),s.startSequence(),s.writeOID(Jc),s.writeNull(),s.endSequence(),s.writeBuffer(i.buffer,3),s.endSequence(),t.type==="der"?s.buffer:U_+`
`+el.linebrk(s.buffer.toString("base64"),64)+`
`+V_},publicImport:function(e,t,r){r=r||{};var n;if(r.type!=="der"){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),P_.isString(t)){var i=el.trimSurroundingText(t,U_,V_).replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(i,"base64")}}else if(Buffer.isBuffer(t))n=t;else throw Error("Unsupported key format");var s=new An.Reader(n);s.readSequence();var o=new An.Reader(s.readString(48,!0));if(o.readOID(6,!0)!==Jc)throw Error("Invalid Public key format");var a=new An.Reader(s.readString(3,!0));a.readByte(),a.readSequence(),e.setPublic(a.readString(2,!0),a.readString(2,!0))},autoImport:function(e,t){return/^[\S\s]*-----BEGIN PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PRIVATE KEY-----[\S\s]*$/g.test(t)?(tl.exports.privateImport(e,t),!0):/^[\S\s]*-----BEGIN PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PUBLIC KEY-----[\S\s]*$/g.test(t)?(tl.exports.publicImport(e,t),!0):!1}}});var K_=_((w7,rl)=>{var T7=pr()._,_7=pr();rl.exports={privateExport:function(e,t){return{n:e.n.toBuffer(),e:e.e,d:e.d.toBuffer(),p:e.p.toBuffer(),q:e.q.toBuffer(),dmp1:e.dmp1.toBuffer(),dmq1:e.dmq1.toBuffer(),coeff:e.coeff.toBuffer()}},privateImport:function(e,t,r){if(t.n&&t.e&&t.d&&t.p&&t.q&&t.dmp1&&t.dmq1&&t.coeff)e.setPrivate(t.n,t.e,t.d,t.p,t.q,t.dmp1,t.dmq1,t.coeff);else throw Error("Invalid key data")},publicExport:function(e,t){return{n:e.n.toBuffer(),e:e.e}},publicImport:function(e,t,r){if(t.n&&t.e)e.setPublic(t.n,t.e);else throw Error("Invalid key data")},autoImport:function(e,t){return t.n&&t.e?t.d&&t.p&&t.q&&t.dmp1&&t.dmq1&&t.coeff?(rl.exports.privateImport(e,t),!0):(rl.exports.publicImport(e,t),!0):!1}}});var z_=_((b7,nl)=>{var H_=pr()._,$_=pr(),wa=ss(),G_="-----BEGIN OPENSSH PRIVATE KEY-----",j_="-----END OPENSSH PRIVATE KEY-----";nl.exports={privateExport:function(e,t){let r=e.n.toBuffer(),n=Buffer.alloc(4);for(n.writeUInt32BE(e.e,0);n[0]===0;)n=n.slice(1);let i=e.d.toBuffer(),s=e.coeff.toBuffer(),o=e.p.toBuffer(),a=e.q.toBuffer(),c;typeof e.sshcomment<"u"?c=Buffer.from(e.sshcomment):c=Buffer.from([]);let l=15+n.byteLength+4+r.byteLength,f=23+r.byteLength+4+n.byteLength+4+i.byteLength+4+s.byteLength+4+o.byteLength+4+a.byteLength+4+c.byteLength,h=43+l+4+f,d=Math.ceil(f/8)*8-f;h+=d;let g=Buffer.alloc(h),p={buf:g,off:0};g.write("openssh-key-v1","utf8"),g.writeUInt8(0,14),p.off+=15,Jt(p,Buffer.from("none")),Jt(p,Buffer.from("none")),Jt(p,Buffer.from("")),p.off=p.buf.writeUInt32BE(1,p.off),p.off=p.buf.writeUInt32BE(l,p.off),Jt(p,Buffer.from("ssh-rsa")),Jt(p,n),Jt(p,r),p.off=p.buf.writeUInt32BE(h-47-l,p.off),p.off+=8,Jt(p,Buffer.from("ssh-rsa")),Jt(p,r),Jt(p,n),Jt(p,i),Jt(p,s),Jt(p,o),Jt(p,a),Jt(p,c);let y=1;for(;p.off<h;)p.off=p.buf.writeUInt8(y++,p.off);return t.type==="der"?p.buf:G_+`
`+$_.linebrk(g.toString("base64"),70)+`
`+j_+`
`},privateImport:function(e,t,r){r=r||{};var n;if(r.type!=="der")if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),H_.isString(t)){var i=$_.trimSurroundingText(t,G_,j_).replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(i,"base64")}else throw Error("Unsupported key format");else if(Buffer.isBuffer(t))n=t;else throw Error("Unsupported key format");let s={buf:n,off:0};if(n.slice(0,14).toString("ascii")!=="openssh-key-v1")throw"Invalid file format.";if(s.off+=15,Xt(s).toString("ascii")!=="none"||Xt(s).toString("ascii")!=="none"||Xt(s).toString("ascii")!==""||(s.off+=4,s.off+=4,Xt(s).toString("ascii")!=="ssh-rsa")||(Xt(s),Xt(s),s.off+=12,Xt(s).toString("ascii")!=="ssh-rsa"))throw Error("Unsupported key type");let o=Xt(s),a=Xt(s),c=Xt(s),l=Xt(s),f=Xt(s),h=Xt(s),d=new wa(c),g=new wa(h),p=new wa(f),y=d.mod(p.subtract(wa.ONE)),v=d.mod(g.subtract(wa.ONE));e.setPrivate(o,a,c,f,h,y.toBuffer(),v.toBuffer(),l),e.sshcomment=Xt(s).toString("ascii")},publicExport:function(e,t){let r=Buffer.alloc(4);for(r.writeUInt32BE(e.e,0);r[0]===0;)r=r.slice(1);let n=e.n.toBuffer(),i=Buffer.alloc(r.byteLength+4+n.byteLength+4+7+4),s={buf:i,off:0};Jt(s,Buffer.from("ssh-rsa")),Jt(s,r),Jt(s,n);let o=e.sshcomment||"";return t.type==="der"?s.buf:"ssh-rsa "+i.toString("base64")+" "+o+`
`},publicImport:function(e,t,r){r=r||{};var n;if(r.type!=="der")if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),H_.isString(t)){if(t.substring(0,8)!=="ssh-rsa ")throw Error("Unsupported key format");let c=t.indexOf(" ",8);c===-1?c=t.length:e.sshcomment=t.substring(c+1).replace(/\s+|\n\r|\n|\r$/gm,"");let l=t.substring(8,c).replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(l,"base64")}else throw Error("Unsupported key format");else if(Buffer.isBuffer(t))n=t;else throw Error("Unsupported key format");let i={buf:n,off:0},s=Xt(i).toString("ascii");if(s!=="ssh-rsa")throw Error("Invalid key type: "+s);let o=Xt(i),a=Xt(i);e.setPublic(a,o)},autoImport:function(e,t){return/^[\S\s]*-----BEGIN OPENSSH PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END OPENSSH PRIVATE KEY-----[\S\s]*$/g.test(t)?(nl.exports.privateImport(e,t),!0):/^[\S\s]*ssh-rsa \s*(?=(([A-Za-z0-9+/=]+\s*)+))\1[\S\s]*$/g.test(t)?(nl.exports.publicImport(e,t),!0):!1}};function Xt(e){let t=e.buf.readInt32BE(e.off);e.off+=4;let r=e.buf.slice(e.off,e.off+t);return e.off+=t,r}u(Xt,"readOpenSSHKeyString");function Jt(e,t){e.buf.writeInt32BE(t.byteLength,e.off),e.off+=4,e.off+=t.copy(e.buf,e.off)}u(Jt,"writeOpenSSHKeyString")});var Q_=_((B7,St)=>{var A7=pr()._;function W_(e){e=e.split("-");for(var t="private",r={type:"default"},n=1;n<e.length;n++)if(e[n])switch(e[n]){case"public":t=e[n];break;case"private":t=e[n];break;case"pem":r.type=e[n];break;case"der":r.type=e[n];break}return{scheme:e[0],keyType:t,keyOpt:r}}u(W_,"formatParse");St.exports={pkcs1:F_(),pkcs8:M_(),components:K_(),openssh:z_(),isPrivateExport:function(e){return St.exports[e]&&typeof St.exports[e].privateExport=="function"},isPrivateImport:function(e){return St.exports[e]&&typeof St.exports[e].privateImport=="function"},isPublicExport:function(e){return St.exports[e]&&typeof St.exports[e].publicExport=="function"},isPublicImport:function(e){return St.exports[e]&&typeof St.exports[e].publicImport=="function"},detectAndImport:function(e,t,r){if(r===void 0){for(var n in St.exports)if(typeof St.exports[n].autoImport=="function"&&St.exports[n].autoImport(e,t))return!0}else if(r){var i=W_(r);if(St.exports[i.scheme])i.keyType==="private"?St.exports[i.scheme].privateImport(e,t,i.keyOpt):St.exports[i.scheme].publicImport(e,t,i.keyOpt);else throw Error("Unsupported key format")}return!1},detectAndExport:function(e,t){if(t){var r=W_(t);if(St.exports[r.scheme])if(r.keyType==="private"){if(!e.isPrivate())throw Error("This is not private key");return St.exports[r.scheme].privateExport(e,r.keyOpt)}else{if(!e.isPublic())throw Error("This is not public key");return St.exports[r.scheme].publicExport(e,r.keyOpt)}else throw Error("Unsupported key format")}}}});var ew=_((L7,J_)=>{var Z_=require("constants"),W6=E_(),R7=require("crypto"),D7=Qc().Ber,Rr=pr()._,Q6=pr(),Y_=os(),X_=Q_();typeof Z_.RSA_NO_PADDING>"u"&&(Z_.RSA_NO_PADDING=3);J_.exports=function(){var e={node10:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],node:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],iojs:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],browser:["md5","ripemd160","sha1","sha256","sha512"]},t="pkcs1_oaep",r="pkcs1",n="private",i={private:"pkcs1-private-pem","private-der":"pkcs1-private-der",public:"pkcs8-public-pem","public-der":"pkcs8-public-der"};function s(o,a,c){if(!(this instanceof s))return new s(o,a,c);Rr.isObject(a)&&(c=a,a=void 0),this.$options={signingScheme:r,signingSchemeOptions:{hash:"sha256",saltLength:null},encryptionScheme:t,encryptionSchemeOptions:{hash:"sha1",label:null},environment:Q6.detectEnvironment(),rsaUtils:this},this.keyPair=new W6.Key,this.$cache={},Buffer.isBuffer(o)||Rr.isString(o)?this.importKey(o,a):Rr.isObject(o)&&this.generateKeyPair(o.b,o.e),this.setOptions(c)}return u(s,"NodeRSA"),s.prototype.setOptions=function(o){if(o=o||{},o.environment&&(this.$options.environment=o.environment),o.signingScheme){if(Rr.isString(o.signingScheme)){var a=o.signingScheme.toLowerCase().split("-");a.length==1?e.node.indexOf(a[0])>-1?(this.$options.signingSchemeOptions={hash:a[0]},this.$options.signingScheme=r):(this.$options.signingScheme=a[0],this.$options.signingSchemeOptions={hash:null}):(this.$options.signingSchemeOptions={hash:a[1]},this.$options.signingScheme=a[0])}else Rr.isObject(o.signingScheme)&&(this.$options.signingScheme=o.signingScheme.scheme||r,this.$options.signingSchemeOptions=Rr.omit(o.signingScheme,"scheme"));if(!Y_.isSignature(this.$options.signingScheme))throw Error("Unsupported signing scheme");if(this.$options.signingSchemeOptions.hash&&e[this.$options.environment].indexOf(this.$options.signingSchemeOptions.hash)===-1)throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}if(o.encryptionScheme){if(Rr.isString(o.encryptionScheme)?(this.$options.encryptionScheme=o.encryptionScheme.toLowerCase(),this.$options.encryptionSchemeOptions={}):Rr.isObject(o.encryptionScheme)&&(this.$options.encryptionScheme=o.encryptionScheme.scheme||t,this.$options.encryptionSchemeOptions=Rr.omit(o.encryptionScheme,"scheme")),!Y_.isEncryption(this.$options.encryptionScheme))throw Error("Unsupported encryption scheme");if(this.$options.encryptionSchemeOptions.hash&&e[this.$options.environment].indexOf(this.$options.encryptionSchemeOptions.hash)===-1)throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}this.keyPair.setOptions(this.$options)},s.prototype.generateKeyPair=function(o,a){if(o=o||2048,a=a||65537,o%8!==0)throw Error("Key size must be a multiple of 8.");return this.keyPair.generate(o,a.toString(16)),this.$cache={},this},s.prototype.importKey=function(o,a){if(!o)throw Error("Empty key given");if(a&&(a=i[a]||a),!X_.detectAndImport(this.keyPair,o,a)&&a===void 0)throw Error("Key format must be specified");return this.$cache={},this},s.prototype.exportKey=function(o){return o=o||n,o=i[o]||o,this.$cache[o]||(this.$cache[o]=X_.detectAndExport(this.keyPair,o)),this.$cache[o]},s.prototype.isPrivate=function(){return this.keyPair.isPrivate()},s.prototype.isPublic=function(o){return this.keyPair.isPublic(o)},s.prototype.isEmpty=function(o){return!(this.keyPair.n||this.keyPair.e||this.keyPair.d)},s.prototype.encrypt=function(o,a,c){return this.$$encryptKey(!1,o,a,c)},s.prototype.decrypt=function(o,a){return this.$$decryptKey(!1,o,a)},s.prototype.encryptPrivate=function(o,a,c){return this.$$encryptKey(!0,o,a,c)},s.prototype.decryptPublic=function(o,a){return this.$$decryptKey(!0,o,a)},s.prototype.$$encryptKey=function(o,a,c,l){try{var f=this.keyPair.encrypt(this.$getDataForEncrypt(a,l),o);return c=="buffer"||!c?f:f.toString(c)}catch(h){throw Error("Error during encryption. Original error: "+h)}},s.prototype.$$decryptKey=function(o,a,c){try{a=Rr.isString(a)?Buffer.from(a,"base64"):a;var l=this.keyPair.decrypt(a,o);if(l===null)throw Error("Key decrypt method returns null.");return this.$getDecryptedData(l,c)}catch(f){throw Error("Error during decryption (probably incorrect key). Original error: "+f)}},s.prototype.sign=function(o,a,c){if(!this.isPrivate())throw Error("This is not private key");var l=this.keyPair.sign(this.$getDataForEncrypt(o,c));return a&&a!="buffer"&&(l=l.toString(a)),l},s.prototype.verify=function(o,a,c,l){if(!this.isPublic())throw Error("This is not public key");return l=!l||l=="buffer"?null:l,this.keyPair.verify(this.$getDataForEncrypt(o,c),a,l)},s.prototype.getKeySize=function(){return this.keyPair.keySize},s.prototype.getMaxMessageSize=function(){return this.keyPair.maxMessageLength},s.prototype.$getDataForEncrypt=function(o,a){if(Rr.isString(o)||Rr.isNumber(o))return Buffer.from(""+o,a||"utf8");if(Buffer.isBuffer(o))return o;if(Rr.isObject(o))return Buffer.from(JSON.stringify(o));throw Error("Unexpected data type")},s.prototype.$getDecryptedData=function(o,a){return a=a||"buffer",a=="buffer"?o:a=="json"?JSON.parse(o.toString()):o.toString(a)},s}()});var nw=_((F7,rw)=>{var tw=require("crypto"),Z6=P0(),Y6=Sa(),Ti=class Ti{static parseKey(t){if(t.tag!==Y6.tag_Sequence)throw new Error("corrupt private key");let r=t.getBigInteger();if(r!==Ti.version)throw new Error("version mismatch: (supported "+this.version+", parsed: "+r);let n=t.getDerValue(),i=t.getDerValue(),s=new Z6(n.data);if(Ti.supportedTypes.dsa===s.toString()||Ti.supportedTypes.ec===s.toString())return Ti.format(t.buffer);try{let o=i.getOctetString();return Ti.export(o)}catch(o){let a=new Error("Something went wrong with algorithm "+s.toString()+". For more details see 'error.context'");throw a.context=o,a}}static export(t){if(typeof tw.createPrivateKey=="function")return tw.createPrivateKey({key:t,format:"der",type:"pkcs1"}).export({format:"pem",type:"pkcs8"});{let r=ew();return new r(t,"pkcs1-der").exportKey("pkcs8-pem")+`
`}}static format(t){return`-----BEGIN PRIVATE KEY-----
`+t.toString("base64").match(/.{1,64}/g).join(`
`)+`
-----END PRIVATE KEY-----
`}};u(Ti,"PKCS8Key");var ba=Ti;ba.supportedTypes={rsa:"1.2.840.113549.1.1.1","rsa-pss":"1.2.840.113549.1.1.10",dsa:"1.2.840.10040.4.1",ec:"1.2.840.10045.2.1",x25519:"1.3.101.110",x448:"1.3.101.111",ed25519:"1.3.101.112",ed448:"1.3.101.113",dh:"1.2.840.113549.1.3.1"};ba.version=0;rw.exports=ba});var ow=_((k7,sw)=>{var iw=require("crypto"),X6=nw(),J6=Sa(),e8=ji(),Ia=Ms(),yr=class yr{constructor(t){this.messageDigest=iw.createHash(yr.DIGEST_ALG),this.passwdBytes=Buffer.alloc(t.length*2);for(let r=0,n=0;r<t.length;r++)this.passwdBytes[n++]=t[r].charCodeAt()>>8,this.passwdBytes[n++]=t[r].charCodeAt()}resetDigest(){this.messageDigest=iw.createHash(yr.DIGEST_ALG)}recover(t){let r,n,i;if(t.getAlgorithm()!==yr.KEY_PROTECTOR_OID)throw new Error("Unsupported key protection alghorithm");let o=t.getEncryptedData(),a=Ia(o,0,yr.SALT_LEN);i=o.length-yr.SALT_LEN-yr.DIGEST_LEN,n=Math.floor(i/yr.DIGEST_LEN),i%yr.DIGEST_LEN!==0&&n++;let c=Ia(o,yr.SALT_LEN,i+yr.SALT_LEN),l=Buffer.alloc(c.length);for(let h=0,d=0,g=a;h<n;h++,d+=yr.DIGEST_LEN)this.messageDigest.update(this.passwdBytes),this.messageDigest.update(g),g=this.messageDigest.digest(),this.resetDigest(),h<n-1?l=Buffer.concat([Ia(l,0,d),g]):l=Buffer.concat([Ia(l,0,d),Ia(g,0,c.length-d)]);let f=Buffer.alloc(c.length);for(let h=0;h<f.length;h++)f[h]=c[h]^l[h];this.messageDigest.update(this.passwdBytes),this.messageDigest.update(f),r=this.messageDigest.digest(),this.resetDigest();for(let h=0;h<r.length;h++)if(r[h]!=o[yr.SALT_LEN+i+h])throw new Error("Cannot recover key");return X6.parseKey(new J6(new e8(f)))}};u(yr,"KeyProtector");var as=yr;as.SALT_LEN=20;as.DIGEST_ALG="sha1";as.DIGEST_LEN=20;as.KEY_PROTECTOR_OID="1.3.6.1.4.1.42.2.17.1.1";sw.exports=as});var uw=_((U7,aw)=>{var X0=class X0{generate(t){return`-----BEGIN CERTIFICATE-----
`+t.toString("base64").match(/.{1,64}/g).join(`
`)+`
-----END CERTIFICATE-----
`}};u(X0,"X509Cert");var Y0=X0;aw.exports=Y0});var fw=_((M7,lw)=>{var cw=uw(),eg=class eg{constructor(){this.algorithms={X509:cw,"X.509":cw}}get(t){if(!this.algorithms[t])throw new Error("The certificate type "+t+" is not supported");return new this.algorithms[t]}};u(eg,"CertificateRegistry");var J0=eg;lw.exports=J0});var yw=_((H7,gw)=>{var t8=CS(),tg=MT(),r8=wd(),n8=Ad(),i8=zT(),s8=ow(),o8=fw(),hw=u(e=>new o8().get(e.certType).generate(e.value),"serializeCert"),pw=u((e,t="")=>{let r=new i8(e);return new s8(t).recover(r)},"decrypt"),dw=u((e,t)=>new t8(e,t).parse(),"parseJks"),a8=u((e,t)=>new tg(e,t).parse(),"parsePkcs12"),u8=u((e,t)=>{let r=new tg(e,t),n=r.parse();return r.toPem(n)},"pkcs12ToPem"),c8=u((e,t,r)=>(r===void 0&&(r=t),dw(e,t).reduce((i,s)=>{if(s instanceof n8)return Object.assign({},i,{[s.alias]:{ca:hw(s.cert)}});if(s instanceof r8)return Object.assign({},i,{[s.alias]:{cert:s.chain.map(hw).join(`
`),key:pw(s.protectedPrivateKey,r)}})},{})),"jksToPem"),l8=u(function(e,t,r){return tg.probe(e)?u8(e,t,r):c8(e,t,r)},"toPem");gw.exports={toPem:l8,parseJks:dw,decrypt:pw,parsePkcs12:a8}});var vw=_((G7,mw)=>{"use strict";var il=Ju(),f8=WC(),Aa=require("fs"),{createTableOptionsFromMeta:h8}=eS(),{getEntityLevelConfig:p8}=Ba(),rg=nS(),d8=sS(),xt={client:null,isSshTunnel:!1};mw.exports=e=>{let t=u(b=>new Promise((O,D)=>b.require("java-ssl",(M,H)=>{M?D(M):O(H)})),"requireKeyStore"),r=u(b=>{let O=u(D=>D?Aa.readFileSync(D):"","readFile");try{let D=O(b.sslCaFile),M=O(b.sslCertFile),H=O(b.sslKeyFile);return Promise.resolve({ca:D,cert:M,key:H})}catch(D){return Promise.reject(D)}},"getCertificatesFromFiles"),n=u((b,O,D)=>t(O).then(M=>{try{let H=M(b.keystore,b.keystorepass),Q=(H.getCert(b.alias)||"").replace(/\s*-----END CERTIFICATE-----$/,`
-----END CERTIFICATE-----`),Ie=H.getPrivateKey(b.alias),xe=Q;return D.log("info",{message:"[info] certificates successfully retrieved from keystore",certLength:Q.length,keyLength:Ie.length,pemCertValidity:Q.startsWith(`-----BEGIN CERTIFICATE-----
MII`),pemKeyValidity:Ie.startsWith(`-----BEGIN PRIVATE KEY-----
MII`),countOfCerts:(Q.match(/-----BEGIN CERTIFICATE-----/gi)||[]).length},"Keystore Info"),b.truststore&&(xe=(M(b.truststore,b.truststorePass||"").getCert(b.truststoreAlias||b.alias)||"").replace(/\s*-----END CERTIFICATE-----$/,`
-----END CERTIFICATE-----`),D.log("info",{message:"[info] certificates successfully retrieved from truststore",certLength:xe.length,pemCertValidity:xe.startsWith(`-----BEGIN CERTIFICATE-----
MII`),countOfCerts:(xe.match(/-----BEGIN CERTIFICATE-----/gi)||[]).length},"Keystore Info")),{cert:Q,key:Ie,ca:xe,...i(b,D)}}catch(H){return H.message.includes("java.lang.NullPointerException")?Promise.reject({message:"Please, check the alias name of the provided JKS certificates. Error message: "+H.message,error:H.message,stack:H.stack}):Promise.reject(H)}}).catch(M=>{D.log("error",{message:M.message,stack:M.stack},"Initialization java-ssl failed");let H=i(b,D);return Object.keys(H).length===0?Promise.reject(M):H}),"getCertificatesFromKeystore"),i=u((b,O)=>{try{let D=yw(),M;Aa.existsSync(b.keystore)?(M=D.toPem(Aa.readFileSync(b.keystore),b.keystorepass),Object.keys(M).forEach(Q=>{O.log("info",{type:"keystore",certLength:e.get(M,`[${Q}].cert.length`),keyLength:e.get(M,`[${Q}].key.length`),countOfCerts:(e.get(M,`[${Q}].cert`,"").match(/-----BEGIN CERTIFICATE-----/gi)||[]).length,alias:Q},"jks analyze")})):O.log("info",`[info] keystore file not found ${b.keystore}`,"jks analyze");let H;return Aa.existsSync(b.truststore)?(H=D.toPem(Aa.readFileSync(b.truststore),b.truststorePass),Object.keys(H).forEach(Q=>{O.log("info",{type:"truststore",certLength:e.get(H,`[${Q}].ca.length`),countOfCerts:(e.get(H,`[${Q}].ca`,"").match(/-----BEGIN CERTIFICATE-----/gi)||[]).length,alias:Q},"jks analyze")})):O.log("info",`[info] truststore file not found ${b.truststore}`,"jks analyze"),{cert:e.get(M,`[${b.alias}].cert`),key:e.get(M,`[${b.alias}].key`),ca:e.get(H,`[${b.truststoreAlias||b.alias}].ca`)||e.get(M,`[${b.alias}].cert`)}}catch(D){return O.log("info",`[info] issue with jks-js. Message: ${D.message}`,"jks analyze"),{}}},"analyzeJks"),s=u(b=>b&&b!=="false","isSsl"),o=u((b,O,D)=>{let M=u((Ie,xe,ue)=>xe?Object.assign({},ue,{[Ie]:xe}):ue,"add");if(!s(b.ssl))return Promise.resolve({});let H=e.get(b,"hosts[0].host",""),Q;return b.ssl==="jks"?Q=n(b,O,D):Q=r(b),Q.then(Ie=>({sslOptions:e.flow([M.bind(null,"ca",Ie.ca),M.bind(null,"cert",Ie.cert),M.bind(null,"key",Ie.key),M.bind(null,"host",H)])({rejectUnauthorized:!b.disableStrictSsl,host:H})}))},"getSslOptions"),a=u((b,O)=>b.localDataCenter?{localDataCenter:b.localDataCenter,policies:{retry:new rg(O)}}:{policies:{loadBalancing:new il.policies.loadBalancing.RoundRobinPolicy,retry:new rg(O)}},"getPolicy"),c=u((b,O)=>{let M=Number(b),H=Number(O),Q=isNaN(M)?H:M;return isNaN(Q)||Q<=0?6e4:Q},"validateRequestTimeout"),l=u((b,O,D)=>{if(!Array.isArray(O.hosts))throw new Error("Hosts were not defined");let M=O.user,H=O.password,Q=new il.auth.PlainTextAuthProvider(M,H),Ie=O.hosts.map(ue=>`${ue.host}:${ue.port}`),xe=c(O.requestTimeout,O.queryRequestTimeout);return o(O,b,D).then(ue=>new il.Client(Object.assign({contactPoints:Ie,authProvider:Q,socketOptions:{readTimeout:xe}},a(O,D),ue)))},"getDistributedClient"),f=u(b=>{let O=c(b.requestTimeout,b.queryRequestTimeout),D=new il.Client(Object.assign({cloud:{secureConnectBundle:b.secureConnectBundle},credentials:{username:b.user,password:b.password},socketOptions:{readTimeout:O}}));return Promise.resolve(D)},"getCloudClient"),h=u((b,O,D)=>O.clusterType==="apolloCloud"?f(O):l(b,O,D),"getClient"),d=u((b,O)=>async D=>{if(xt.client)return xt.client.connect();if(D.ssh){let M=b.require("@hackolade/ssh-service"),H=D.hosts[0],{options:Q}=await M.openTunnel({sshAuthMethod:D.ssh_method==="privateKey"?"IDENTITY_FILE":"USER_PASSWORD",sshTunnelHostname:D.ssh_host,sshTunnelPort:D.ssh_port,sshTunnelUsername:D.ssh_user,sshTunnelPassword:D.ssh_password,sshTunnelIdentityFile:D.ssh_key_file,sshTunnelPassphrase:D.ssh_key_passphrase,host:H.host,port:H.port});xt.isSshTunnel=!0,D={...D,hosts:[Q]}}return xt.client=await h(b,D,O),xt.client.on("log",(M,H,Q,Ie)=>{if(O){let xe="["+M+"] "+H+": "+Q+". "+Ie;O.log("info",{message:xe},"Cassandra Info")}}),xt.client.connect()},"connect"),g=u(async b=>{xt.client&&(xt.client.shutdown(),xt.client=null),xt.isSshTunnel&&(await b.require("@hackolade/ssh-service").closeConsumer(),xt.isSshTunnel=!1)},"close"),p=u(b=>xt.client.metadata.keyspaces[b],"getKeyspaceMetaData"),y=u(b=>{let O=p(b),D=e.get(O,"strategy","").split(".").slice(-1).pop(),M={code:b,durableWrites:!!O.durableWrites,replStrategy:D};return D==="SimpleStrategy"?M.replFactor=Number(O.strategyOptions.replication_factor):D==="NetworkTopologyStrategy"&&(M.dataCenters=Object.keys(O.strategyOptions).map(H=>({dataCenterName:H,replFactorValue:Number(O.strategyOptions[H])}))),M},"getKeyspaceInfo"),v=u(()=>Object.keys(xt.client.metadata.keyspaces),"getKeyspacesNames"),m=u(()=>{let b=e.get(xt,"client.hosts._items");if(!b)return!1;let O=b[Object.keys(b)[0]];if(!O)return!1;let D=O.getCassandraVersion();return D.length?e.get(D,"[0]")<3:!1},"isOldVersion"),x=u(b=>{let M=m()?`SELECT columnfamily_name FROM system.schema_columnfamilies WHERE keyspace_name ='${b}'`:`SELECT table_name FROM system_schema.tables WHERE keyspace_name ='${b}'`;return B(M)},"getTablesNames"),w=u(b=>{let O=`SELECT view_name FROM system_schema.views WHERE keyspace_name ='${b}'`;return B(O).then(D=>D.rows.map(M=>M.view_name),()=>[])},"getViewsNames"),B=u(b=>xt.client.execute(b),"execute"),R=u((b,O)=>xt.client.metadata.getTable(b,O),"getTableMetadata"),L=u((b,O,D,M)=>Promise.all(D.map(H=>xt.client.metadata.getMaterializedView(O,H).then(Q=>Y(b,O,H,M).then(Ie=>({documentTemplate:Ie,view:Q})),()=>({documentTemplate:{},view:{}})))),"getViews"),Y=u((b,O,D,M)=>we(O,D,b,M).then(vt,()=>({})),"getViewDocumentTemplate"),X=u(b=>{let O=e.partition(b,Hw);return{views:O[0].map(D=>D.slice(0,-4)),tables:O[1]}},"splitEntityNames"),ne=u((b,O)=>{let D=`SELECT * FROM system_schema.columns WHERE keyspace_name='${b}' AND table_name='${O}';`;return B(D)},"getColumnInfo"),le=u((b,O,D)=>({dbName:b,dbCollections:O,views:D}),"prepareConnectionDataItem"),Ce=u((b,O,D={})=>{let M={};return b.forEach(H=>{let Q=f8(e).getColumnType(H,O,D?D[H.name]:void 0);M[H.name]=Q,M[H.name].code=H.name,M[H.name].static=H.isStatic,M[H.name].frozen=H.type.options.frozen}),{properties:M}},"getTableSchema"),we=u((b,O,D,M)=>ht(b,O,D).then(H=>new Promise((Q,Ie)=>{let xe=[];if(M.log("info",{table:`${b}.${O}`,limit:H},"Scan records"),!H)return Q(xe);let ue={prepare:!0,autoPage:!0,retry:new rg(M)},Ye=`SELECT * FROM "${b}"."${O}" LIMIT ${H}`;xt.client.eachRow(Ye,[],ue,function(Dt,er){xe.push(er)},(Dt,er)=>Dt?Ie(Dt):Q(xe))})),"scanRecords"),ht=u((b,O,D)=>{if(D.active==="absolute")return Promise.resolve(Number(D.absolute.value));let M=$w(D),H=`SELECT COUNT(*) FROM "${b}"."${O}" LIMIT ${M}`;return B(H).then(Q=>{let Ie=e.get(Q,"rows[0].count.low",D.maxValue);return Uw(Ie,D)})},"getSizeOfRows"),mt=u((b,O)=>{let D=tt(b.partitionKeys),M=rt(b),H=ut(b.indexes);return{code:O,compositePartitionKey:D,compositeClusteringKey:M,SecIndxs:H,comments:b.comment,tableOptions:ln(b)}},"getEntityLevelData"),be=u(b=>String(b).replace(/\"/g,"'"),"changeQuotes"),Ze=u(b=>Object.assign({},b.compactionOptions,{class:b.compactionClass}),"getCompaction"),Z=u(b=>b.structure.find(D=>D.propertyName==="Options").structure,"getOptionsFromTab"),ln=u(b=>{let[O]=p8(),D=Z(O);return h8(b,D)},"getTableOptions"),Hn=u(b=>{switch(b){case"DESC":return"descending";case"ASC":default:return"ascending"}},"getKeyOrder"),tt=u(b=>(b||[]).map(O=>O.name),"handlePartitionKeys"),rt=u(b=>(b.clusteringKeys||[]).map((O,D)=>{let M=b.clusteringOrder?b.clusteringOrder[D]:"";return{name:O.name,type:Hn(M)}}),"handleClusteringKeys"),ut=u(b=>b.map(O=>({name:O.name,SecIndxKey:[Tt(O.target)]})),"handleIndexes"),Tt=u(b=>b,"getIndexKey"),pt=u(b=>{if(b&&b.length){let O={},D=[];return b.forEach(({udt:M,sample:H})=>{let Q=e.get(M,"type.info",e.get(M,"info"),{}),Ie=Q.name||M.name,xe=Q.fields||[];O[Ie]={type:"udt",static:M.isStatic,properties:Ce(xe,D,H).properties}}),{...O,...pt(D)||{}}}else return null},"handleUdts"),Ht=u(b=>{let O=`SELECT * FROM system_schema.types WHERE keyspace_name='${b}'`;return B(O)},"getUDT"),_t=u(b=>{let O=`SELECT * FROM system_schema.functions WHERE keyspace_name='${b}'`;return B(O)},"getUDF"),wt=u(b=>{let O=`SELECT * FROM system_schema.aggregates WHERE keyspace_name='${b}'`;return B(O)},"getUDA"),ct=u(b=>b.replace(/frozen\<(.*)\>/i,"$1"),"removeFrozen"),bt=u(b=>b.rows.map(D=>{let M=D.argument_names.map((xe,ue)=>`${xe} ${ct(D.argument_types[ue]||"")}`).join(", "),H=D.deterministic?"DETERMINISTIC":"",Q=D.monotonic?"MONOTONIC ON"+D.monotonic_on.join(", "):"",Ie=`CREATE OR REPLACE FUNCTION ${D.function_name} ( ${M} )
				${D.called_on_null_input?"CALLED":"RETURNS NULL"} ON NULL INPUT
				RETURNS ${ct(D.return_type)}  ${H} ${Q}
				LANGUAGE ${D.language} AS
				$$ ${D.body} $$ ;`;return{name:D.function_name,functionBody:Ie}}),"handleUDF"),It=u(b=>b.rows.map(D=>{let M=D.argument_types.map(ct).join(", "),H=`CREATE OR REPLACE AGGREGATE ${D.aggregate_name} (${M})
			SFUNC ${D.state_func}
			STYPE ${ct(D.state_type)}`+(D.final_func!==null?`
			FINALFUNC ${D.final_func}`:"")+`
			INITCOND ${D.initcond}${D.deterministic?`
			DETERMINISTIC`:""};`;return{name:D.aggregate_name,storedProcFunction:H}}),"handleUDA"),At=u((b,O,D)=>b.filter(M=>e.get(M,"view.tableName")===O).map(M=>{let H=e.get(M,"view",{}),Q=Object.keys(e.get(M,"documentTemplate",{}));return{name:H.name,jsonSchema:Bt(H,D),documentTemplate:Q,data:{compositePartitionKey:tt(H.partitionKeys),compositeClusteringKey:rt(H),comments:H.comment,tableOptions:ln(H)}}}),"getViewsData"),Bt=u((b,O)=>{if(e.isEmpty(e.get(b,"columns")))return{};let D=Object.keys(b.columnsByName);return{properties:Nt(O,b.tableName,D)}},"getViewData"),Nt=u((b,O,D)=>D.reduce((M,H)=>e.get(b,["properties",H])?Object.assign({},M,{[H]:{$ref:`#collection/definitions/${O}/${H}`}}):M,{}),"getViewSchema"),Rt=u((b,O)=>{let D={dbName:b.keyspaceName,collectionName:b.tableName,documents:b.records};if(b.table.columns&&b.table.columns.length){D.bucketInfo=y(b.keyspaceName),D.bucketInfo.UDFs=b.UDFs,D.bucketInfo.UDAs=b.UDAs,D.entityLevel=mt(b.table,b.tableName);let M=[],H=vt(b.records),Q=Ce(b.table.columns,M,H);D.validation={jsonSchema:Q},D.documentTemplate=H,D.modelDefinitions={definitions:pt(M)},e.isEmpty(b.views)||(D.views=At(b.views,b.tableName,Q)),D={...D,documents:d8(e).filterUdts(Q.properties,b.records)}}else O||(D=null);return D},"getPackageData"),vt=u(b=>{let O=u((ue,Ye)=>ue.reduce((Dt,er)=>Ye(er)?[Dt[0].concat([er]),Dt[1]]:[Dt[0],Dt[1].concat([er])],[[],[]]),"split"),D=u(ue=>{let Ye={};return ue.reduce((Dt,er)=>Ye[typeof er]?Dt:(Ye[typeof er]=!0,Dt.concat([er])),[])},"uniqByType"),M=u(ue=>{let[Ye,Dt]=O(ue,Array.isArray),[er,Gw]=O(Dt,H),jw=D(Gw),sg=er.reduce(xe,{}),og=jw.concat(Ye.reduce(xe,[]));return Object.keys(sg).length?og.concat([sg]):og},"mergeByType"),H=u(ue=>ue&&typeof ue=="object"&&!Array.isArray(ue),"isObject"),Q=u((ue,Ye)=>{let Dt=ue.concat(Ye);return Dt.length?M(Dt):[]},"mergeArray"),Ie=u((ue,Ye)=>Object.keys(ue).concat(Object.keys(Ye)).reduce((Dt,er)=>Object.assign({},Dt,{[er]:xe(ue[er],Ye[er])}),{}),"mergeObjects"),xe=u((ue,Ye)=>{if(Array.isArray(ue)&&Array.isArray(Ye))return Q(ue,Ye);if(H(ue)&&H(Ye))return Ie(ue,Ye);if(Array.isArray(ue))return xe(ue,[]);if(Array.isArray(Ye))return xe([],Ye);if(H(ue))return xe(ue,{});if(H(Ye))return xe({},Ye);if(ue!==void 0)return ue;if(Ye!==void 0)return Ye},"merge");if(!Array.isArray(b)||!b.length)return{};try{return JSON.parse(JSON.stringify(b)).reduce(xe,{})}catch{return{}}},"mergeDocuments"),kw=u(b=>b instanceof Error?{message:b.message,stack:b.stack}:b,"prepareError"),qw=u((b,O)=>e.difference(b,O||[]),"filterKeyspaces"),Uw=u((b,O)=>{let D=Math.ceil(b*O.relative.value/100);return Math.min(D,O.maxValue)},"getSampleDocSize"),Vw=u(b=>b.replace(/\/\*([\s\S]+?)\*\//,""),"cleanOutComments"),Mw=u(b=>{let O=u(Q=>(Q.match(/\$\$([\s\S]+?)\$\$/g)||[]).map(Ie=>Ie.trim().replace(/(^\$\$|\$\$$)/g,"")),"findFunctionStatements"),D=u(Q=>`$__HACKOLADE__PLACEHOLDER_${Q}__$`,"getPlaceholder");b=Vw(b);let M=O(b),H=M.reduce((Q,Ie,xe)=>Q.replace(Ie,D(xe)),b).split(";").map(Q=>Q.trim()).filter(Boolean);return M.reduce((Q,Ie,xe)=>Q.map(ue=>ue.replace(D(xe),Ie)),H)},"splitScriptByQueries"),Kw=u((b,O)=>{let D=Mw(b),M=D.length,H=0;return ig(D.map(Q=>()=>xt.client.execute(Q)),Q=>{let Ie=D[H];O(Ie,Q,H,M),H++}).then(Q=>Q,Q=>Promise.reject({error:Q,query:D[H]}))},"batch"),ig=u((b,O)=>b.length?b[0]().then(D=>(O(D),ig(b.slice(1),O))):Promise.resolve(),"promiseSeriesAll"),Hw=u(b=>b.slice(-4)===" (v)","isView"),ol=u(b=>{if(b!==null)return Array.isArray(b)?b.map(ol).filter(O=>O!==void 0):typeof b=="object"?Object.keys(b).reduce((O,D)=>{let M=ol(b[D]);return M===void 0?O:{...O,[D]:M}},{}):b},"filterNullItems"),$w=u(b=>{let O=b.relative.value,D=b.maxValue;return Math.round(D/O*100)},"getCountLimit");return{connect:d,close:g,getKeyspacesNames:v,getTablesNames:x,prepareConnectionDataItem:le,getColumnInfo:ne,getTableMetadata:R,getTableSchema:Ce,scanRecords:we,getEntityLevelData:mt,getKeyspaceMetaData:p,getKeyspaceInfo:y,handleUdts:pt,getUDF:_t,getUDA:wt,handleUDF:bt,handleUDA:It,getPackageData:Rt,prepareError:kw,filterKeyspaces:qw,batch:Kw,isOldVersion:m,getViews:L,getViewsNames:w,splitEntityNames:X,filterNullItems:ol}}});var Cw=_((z7,Ew)=>{"use strict";var g8=u(e=>(t,r,n)=>{let i=t.script,s=e(n.require("lodash"));return s.connect(n)(t).then(()=>(r.log("info",{message:"Applying cassandra script has been started"},"Cassandra script"),s.batch(i,(o,a,c,l)=>{r.progress({message:`Completed queries: ${c+1} / ${l}`})})),o=>{let a=s.prepareError(o);return r.log("error",a,"Cassandra script"),Promise.reject(a)}).then(o=>{r.log("info",{message:"Cassandra script has been applied successfully!"},"Cassandra script"),s.close(n)},o=>{if(!o.query)return Promise.reject(o);let{error:a,query:c}=o,l=y8(a,i,c),f=s.prepareError(l);return r.progress({message:`Query has executed with error: 
 ${c} 
 ${l.message}`}),r.log("error",{query:c,error:f,detail:l},"Cassandra script: query has been executed with error"),Promise.reject(f)}).catch(o=>(s.close(n),Promise.reject(s.prepareError(o))))},"applyToInstance"),y8=u((e,t,r)=>{let n=/^line\ (\d+)\:(\-?\d+)/i,i=t.indexOf(r);if(i===-1)return e;let s=t.slice(0,i).split(`
`).length;if(!n.test(e.message))return Object.assign({},e,{message:`query line ${s}:0 ${e.message}`});let o=e.message.match(n),a=+o[1],c=o[2],l=e.message.replace(n,`line ${s+a-1}:${c}`);return Object.assign({},e,{message:l})},"modifyLineError");Ew.exports=g8});var xw=_((Q7,Sw)=>{"use strict";Sw.exports=e=>(t,r)=>{let n=e(r.require("lodash"));return n.connect(r)(t).then(()=>{n.close(r)},i=>(n.close(r),Promise.reject(n.prepareError(i))))}});var ww=_((Z7,_w)=>{"use strict";var Tw=vw(),m8=Cw()(Tw),v8=xw()(Tw);_w.exports={applyToInstance:m8,testConnection:v8}});var Iw=_((Y7,bw)=>{"use strict";var E8=u(e=>{var t,r,n;return{containers:{skipModified:(n=(r=(t=e.options)==null?void 0:t.additionalOptions)==null?void 0:r.find(i=>i.id==="excludeContainerAlterStatements"))==null?void 0:n.value}}},"getScriptOptions");bw.exports={getScriptOptions:E8}});var{retrieveContainerName:C8,retrieveEntityName:S8,retrieveUDA:x8,retrieveUDF:T8,retrieveIndexes:_8,retrieveIsItemActivated:Aw,commentDeactivatedStatement:Bw}=tr(),{getTableStatement:w8}=us(),{sortUdt:go,getUdtMap:Nw,getUdtScripts:Rw,prepareDefinitions:ng}=Da(),{getIndexes:b8}=La(),{getKeyspaceStatement:Dw}=Oa(),{getAlterScript:Lw,isDropInStatements:Ow}=am(),{getViewScript:Fw}=Tl(),{getCreateTableScript:I8}=cm(),{setDependencies:sl}=Dr(),{applyToInstance:A8,testConnection:B8}=ww(),{getScriptOptions:Pw}=Iw();module.exports={generateScript(e,t,r,n){try{sl(n);let{udtTypeMap:i,modelDefinitions:s,externalDefinitions:o}=ng(e),a=JSON.parse(e.jsonSchema),c=go(JSON.parse(e.internalDefinitions));if(e={...e,jsonSchema:a,udtTypeMap:i,modelDefinitions:s,externalDefinitions:o,internalDefinitions:c},e.isUpdateScript)e.scriptOptions=Pw(e),r(null,Lw(e.jsonSchema,i,e));else{let l=`${Dw(e.containerData)}

${I8(e,!0)}`;r(null,l)}}catch(i){t.log("error",{message:i.message,stack:i.stack},"Cassandra Forward-Engineering Error"),setTimeout(()=>{r({message:i.message,stack:i.stack})},150)}},generateViewScript(e,t,r,n){sl(n);let i=JSON.parse(e.jsonSchema||"{}"),s=Fw({schema:i,viewData:e.viewData,entityData:e.entityData,containerData:e.containerData,collectionRefsDefinitionsMap:e.collectionRefsDefinitionsMap});r(null,s)},generateContainerScript(e,t,r,n){try{if(sl(n),e.isUpdateScript){let{udtTypeMap:i,modelDefinitions:s,externalDefinitions:o}=ng(e);e={...e,udtTypeMap:i,modelDefinitions:s,externalDefinitions:o},e.scriptOptions=Pw(e);let a=e.entities.map(c=>{let l=JSON.parse(e.jsonSchema[c]);return e.internalDefinitions=go(JSON.parse(e.internalDefinitions[c])),Lw(l,e.udtTypeMap,e)});r(null,a.filter(Boolean).join(`

`))}else{let i=go(JSON.parse(e.modelDefinitions)),s=JSON.parse(e.externalDefinitions),o=e.containerData,a=[],c=C8(o),l=Dw(o),f=Aw(o),h=Nw([i,s]),d=Rw(c,[s,i],h,f),g=R8(T8(o)),p=D8(x8(o));a.push(l,...d),e.entities.forEach(y=>{let v=go(JSON.parse(e.internalDefinitions[y])),m=JSON.parse(e.jsonSchema[y]),x=e.entityData[y],w=Object.assign({},h,Nw([v,m])),B=S8(x),R=Aw(x),L=[m,i,v,s],Y=Rw(c,[v,m],w,f&&R).map(le=>Bw(le,R,f)),X=w8({tableData:m,tableMetaData:x,keyspaceMetaData:o,dataSources:L,udtTypeMap:w,isKeyspaceActivated:f}),ne=b8(_8(x),L,B,c,R,f);a.push(...Y,X,ne)}),a=a.concat(e.views.map(y=>{let v=JSON.parse(e.jsonSchema[y]||"{}");return Fw({schema:v,viewData:e.viewData[y],entityData:e.entityData[v.viewOn],containerData:e.containerData,collectionRefsDefinitionsMap:e.collectionRefsDefinitionsMap,isKeyspaceActivated:f})})),a.push(g,p),r(null,Bw(N8(a),f))}}catch(i){t.log("error",{message:i.message,stack:i.stack},"Cassandra Forward-Engineering Error"),setTimeout(()=>{r({message:i.message,stack:i.stack})},150)}},applyToInstance(e,t,r,n){t.clear(),t.log("info",e,"connectionInfo",e.hiddenKeys),A8(e,t,n).then(i=>{r(null,i)}).catch(i=>{r(i)})},testConnection(e,t,r,n){B8(e,n).then(r,r)},isDropInStatements(e,t,r,n){try{sl(n);let i,{udtTypeMap:s,modelDefinitions:o,externalDefinitions:a}=ng(e);if(e.level==="container")e={...e,udtTypeMap:s,modelDefinitions:o,externalDefinitions:a},i=e.entities.map(c=>{let l=JSON.parse(e.jsonSchema[c]);return e.internalDefinitions=go(JSON.parse(e.internalDefinitions[c])),Ow(l,e.udtTypeMap,e)}).some(Boolean);else if(e.level==="entity"){let c=JSON.parse(e.jsonSchema),l=go(JSON.parse(e.internalDefinitions));e={...e,udtTypeMap:s,modelDefinitions:o,externalDefinitions:a,jsonSchema:c,internalDefinitions:l},i=Ow(e.jsonSchema,e.udtTypeMap,e)}r(null,i)}catch(i){r({message:i.message,stack:i.stack})}}};var N8=u(e=>e.filter(t=>t).join(`

`),"getScript"),R8=u(e=>e.map(t=>t.functionBody).filter(t=>t).join(`
`),"getUserDefinedFunctions"),D8=u(e=>e.map(t=>t.storedProcFunction).filter(t=>t).join(`
`),"getUserDefinedAggregations");
/*! Bundled license information:

long/dist/Long.js:
  (**
   * @license Long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
   * Released under the Apache License, Version 2.0
   * see: https://github.com/dcodeIO/Long.js for details
   *)

node-rsa/src/NodeRSA.js:
  (*!
   * RSA library for Node.js
   *
   * Author: rzcoder
   * License MIT
   *)
*/
